/*! For license information please see extension.js.LICENSE.txt */
(()=>{var e,t={9063:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionStatus=void 0,(r=t.ConnectionStatus||(t.ConnectionStatus={})).None="none",r.Connecting="connecting",r.RefreshingTunnelAccessToken="refreshingTunnelAccessToken",r.Connected="connected",r.Disconnected="disconnected"},5891:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionStatusChangedEventArgs=void 0,t.ConnectionStatusChangedEventArgs=class{constructor(e,t,r){this.previousStatus=e,this.status=t,this.disconnectError=r}}},4399:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultTunnelRelayStreamFactory=void 0;const n=r(4516);t.DefaultTunnelRelayStreamFactory=class{async createRelayStream(e,t,r,s){if((0,n.isNode)())return await n.SshHelpers.openConnection(e,[t],Object.assign({},r&&{Authorization:`tunnel ${r}`}),s);{const s=[t];return r&&s.push(r),await n.SshHelpers.openConnection(e,s)}}}},8384:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardedPortConnectingEventArgs=void 0,t.ForwardedPortConnectingEventArgs=class{constructor(e,t){this.port=e,this.stream=t}}},6376:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(6679),t),s(r(3189),t),s(r(6726),t),s(r(3501),t),s(r(8156),t),s(r(8026),t),s(r(6949),t),s(r(4516),t),s(r(6679),t),s(r(8278),t),s(r(3189),t),s(r(8715),t),s(r(8396),t),s(r(4399),t),s(r(8478),t),s(r(1965),t),s(r(3708),t),s(r(5312),t),s(r(9063),t),s(r(5891),t),s(r(8384),t),s(r(30),t),s(r(2088),t),s(r(1781),t)},6726:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiModeTunnelClient=void 0;const n=r(4815),s=r(5312);class i extends s.TunnelConnectionBase{constructor(){super(n.TunnelAccessScopes.Connect),this.clients=[],this.connectionModes=this.clients?[...new Set(...this.clients.map((e=>e.connectionModes)))]:[]}get acceptLocalConnectionsForForwardedPorts(){return!!this.clients.find((e=>e.acceptLocalConnectionsForForwardedPorts))}set acceptLocalConnectionsForForwardedPorts(e){this.clients.forEach((t=>t.acceptLocalConnectionsForForwardedPorts=e))}get localForwardingHostAddress(){var e;return null===(e=this.clients[0])||void 0===e?void 0:e.localForwardingHostAddress}set localForwardingHostAddress(e){this.clients.forEach((t=>t.localForwardingHostAddress=e))}connect(e,t){if(!e)throw new Error("Tunnel cannot be null");return new Promise((e=>{}))}connectToForwardedPort(e,t){throw new Error("Method not implemented.")}waitForForwardedPort(e,t){throw new Error("Method not implemented.")}async refreshPorts(){throw new Error("Method not implemented.")}async dispose(){await super.dispose(),await Promise.all(this.clients.map((e=>e.dispose())))}}t.MultiModeTunnelClient=i},3501:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiModeTunnelHost=void 0;const n=r(4815),s=r(5877),i=r(5312);class o extends i.TunnelConnectionBase{constructor(){super(n.TunnelAccessScopes.Host),this.hosts=[]}async start(e){let t=[];this.hosts.forEach((r=>{t.push(r.start(e))})),await Promise.all(t)}async refreshPorts(){let e=[];this.hosts.forEach((t=>{e.push(t.refreshPorts())})),await Promise.all(e)}async dispose(){await Promise.all(this.hosts.map((e=>e.dispose()))),await super.dispose()}}t.MultiModeTunnelHost=o,o.hostId=(0,s.v4)()},30:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RefreshingTunnelAccessTokenEventArgs=void 0,t.RefreshingTunnelAccessTokenEventArgs=class{constructor(e,t){this.tunnelAccessScope=e,this.cancellation=t}}},7885:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RelayTunnelConnector=void 0;const n=r(4322),s=r(9461),i=r(4516),o=r(2088);t.RelayTunnelConnector=class{constructor(e){this.tunnelSession=e}get trace(){return this.tunnelSession.trace}async connectSession(e,t){var r;let c,h;function l(e){if(e instanceof n.CancellationError&&t.isCancellationRequested)throw h=void 0,c=n.SshDisconnectReason.byApplication,e}function u(e){throw h?h.message=e:h=new Error(e),h}let d,p=0,f=0,g=100,m=!1,y=!0;for(;;){if(t.isCancellationRequested)throw new n.CancellationError;if(p>0){if(h){const e=new o.RetryingTunnelConnectionEventArgs(h,g);if(this.tunnelSession.onRetrying(e),!e.retry)throw h;e.delayMs>=100?g=e.delayMs:y=!1}const e=y?" in "+(g<1e3?`0.${g/100}s`:g/1e3+"s"):"";this.trace(n.TraceLevel.Verbose,0,`Error connecting to tunnel SSH session, retrying${e}${d?`: ${d}`:""}`),y&&(await(0,s.delay)(g,t),g<13e3&&(g<<=1))}let v;p++,y=!0,d=void 0,c=n.SshDisconnectReason.connectionLost,h=void 0;try{return v=await this.tunnelSession.createSessionStream(t),await this.tunnelSession.configureSession(v,e,t),v=void 0,void(c=void 0)}catch(o){if(o instanceof Error||u(`Failed to connect to the tunnel service and start tunnel SSH session: ${o}`),l(o),h=o,d=h.message,o instanceof i.BrowserWebSocketRelayError){if(f++>=5)throw o;continue}if(o instanceof n.SshReconnectError){c=n.SshDisconnectReason.protocolError,y=!1,e=!1;continue}if(o instanceof n.SshConnectionError){const e=o.reason;if(e===n.SshDisconnectReason.connectionLost)continue;c=e||n.SshDisconnectReason.byApplication,u(`Failed to start tunnel SSH session: ${d}`)}if(o instanceof i.RelayConnectionError){const e=null===(r=o.errorContext)||void 0===r?void 0:r.statusCode,n=e?` (${e})`:"";switch(d){case"error.relayClientUnauthorized":const e="Not authorized"+n;m&&u(`${e}. Refreshed tunnel access token also does not work.`);try{m=await this.tunnelSession.refreshTunnelAccessToken(t)}catch(t){l(t),u(`${e}. Refreshing tunnel access token failed with error ${(0,s.getErrorMessage)(t)}`)}m||u(`${e}. Provide a fresh tunnel access token with '${this.tunnelSession.tunnelAccessScope}' scope.`),y=!1,d="The tunnel access token was no longer valid and had just been refreshed.";continue;case"error.relayClientForbidden":u(`Forbidden${n}. Provide a fresh tunnel access token with '${this.tunnelSession.tunnelAccessScope}' scope.`);break;case"error.tunnelPortNotFound":u(`The tunnel or port is not found${n}`);break;case"error.serviceUnavailable":d=`Service temporarily unavailable${n}`;continue;case"error.tooManyRequests":d=`Rate limit exceeded${n}. Too many requests in a given amount of time.`,p>4&&u(d),g<13e3&&(g<<=1);break;default:if(null==d?void 0:d.startsWith("error.relayConnectionError ")){const e=a.find((e=>d.includes(e)));if(e){d=`Failed to connect to Relay server: ${e}`;continue}}}}throw o}finally{h&&c&&!h.reason&&(h.reason=c),c&&await this.tunnelSession.closeSession(h),v&&await v.close(h)}}}};const a=["ECONNRESET","ENOTFOUND","ESOCKETTIMEDOUT","ETIMEDOUT","ECONNREFUSED","EHOSTUNREACH","EPIPE","EAI_AGAIN","EBUSY"]},8156:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryTcpListenerFactory=void 0;const n=r(1808);t.RetryTcpListenerFactory=class{constructor(e){this.localAddress=e}async createTcpListener(e,t,r,s){e.indexOf(":")>=0?"0.0.0.0"===this.localAddress?e="::":"127.0.0.1"===this.localAddress&&(e="::1"):e=this.localAddress;let i=n.createServer();for(let r=0;;r++){let s=10===r?0:t+r;try{return await new Promise(((t,r)=>{i.listen({host:e,port:s,ipv6Only:n.isIPv6(e)}),i.on("listening",(()=>{t(i)})),i.on("error",(e=>{r(e)}))}))}catch(e){console.log("Listening on port "+s+" failed: "+e),console.log("Incrementing port and trying again");continue}}}}},2088:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryingTunnelConnectionEventArgs=void 0,t.RetryingTunnelConnectionEventArgs=class{constructor(e,t){this.error=e,this.delayMs=t,this.retry=!0}}},8026:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionPortKey=void 0,t.SessionPortKey=class{constructor(e,t){this.sessionId=e,this.port=t}equals(e){return this.port===e.port&&this.sessionId===e.sessionId}toString(){return this.port+"_"+this.sessionId.toString("base64")}}},6949:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannelForwarder=void 0;const n=r(4322),s=r(4017);t.SshChannelForwarder=class{constructor(e,t){this.receiveQueue=new n.Queue,this.receiveSemaphore=new s.Semaphore(0),this.channel=e,this.client=t,this.stream=t.getStream(),this.init()}async init(){await this.forwardFromStreamToChannel(new Buffer(4096)),await this.forwardFromChannelToStream()}onChannelDataReceived(e,t){let r=new Buffer(t.length);t.copy(r),this.receiveQueue.enqueue(r);try{this.receiveSemaphore.acquire()}catch(e){}this.channel.adjustWindow(t.length)}onChannelClosed(e,t){this.channelClosedEvent=t;try{this.receiveSemaphore.acquire()}catch(e){}}async forwardFromChannelToStream(){try{let e;do{e=await this.forwardFromChannelToStreamAsync()}while(e)}catch(e){console.log(`Unexpected error reading channel stream: ${e}`)}}async forwardFromChannelToStreamAsync(){var e,t;try{await this.receiveSemaphore.acquire()}catch(e){return this.closeStream(!0),!1}let r=this.receiveQueue.dequeue();if(!r){if(null!=this.channelClosedEvent){let r=null!==(e=this.channelClosedEvent.errorMessage)&&void 0!==e?e:null===(t=this.channelClosedEvent.error)||void 0===t?void 0:t.message,n=r?`Forwarder channel ${this.channel.channelId} closed with error: ${r}`:`Forwarder channel ${this.channel.channelId} closed.`;console.log(n),this.closeStream(!!r)}return!1}try{return await this.stream.write(r),!0}catch(e){return this.closeStream(!0),!1}}closeStream(e){try{e?this.client.Client.close():this.stream.close()}catch(e){return void console.log(`PortForwardingService unexpected error closing connection: ${e}`)}console.log(`Channel forwarder ${e?"aborted":"closed"} connection.`)}async forwardFromStreamToChannel(e){try{let t;do{t=await this.forwardFromStreamToChannelAsync(e)}while(t)}catch(e){console.log(`Unexpected error reading channel stream: ${e}`)}}async forwardFromStreamToChannelAsync(e){let t,r=null;try{const r=await this.stream.read(e.byteLength);t=null==r?void 0:r.byteLength}catch(e){r=e,t=0}if(t&&t>0)return await this.channel.send(e.slice(0,t)),!0;if(r){const e=`Channel forwarder stream read error: ${r}`;console.log(e),await this.channel.close("SIGABRT",r.toString())}else{const e="Channel forwarder reached end of stream.";console.log(e),await this.channel.send(new Buffer("")),await this.channel.close()}return!1}}},4516:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RelayConnectionError=t.RelayErrorType=t.isNode=t.SshHelpers=t.BrowserWebSocketRelayError=void 0;const n=r(4322),s=r(9156);class i extends Error{constructor(e){super(e)}}t.BrowserWebSocketRelayError=i;class o{static openConnection(e,r,n,s){return(0,t.isNode)()?o.nodeSshStreamFactory(e,r,n,s):o.webSshStreamFactory(new WebSocket(e,r))}static createSshClientSession(e){return o.createSshSession((t=>(e&&e(t),new n.SshClientSession(t))))}static createSshServerSession(e,t){return o.createSshSession((r=>(t&&t(r),new n.SshServerSession(r,e))))}static createWebSocketStreamAdapter(e){return new n.WebSocketStream(new a(e))}static webSshStreamFactory(e){return e.binaryType="arraybuffer",new Promise(((t,r)=>{e.onopen=()=>{t(new n.WebSocketStream(e))},e.onerror=e=>{r(new i("Failed to connect to relay url"))}}))}static createSshSession(e){const t=new n.SshSessionConfiguration;return t.keyExchangeAlgorithms.splice(0),t.keyExchangeAlgorithms.push(n.SshAlgorithms.keyExchange.ecdhNistp384Sha384),t.keyExchangeAlgorithms.push(n.SshAlgorithms.keyExchange.ecdhNistp256Sha256),t.keyExchangeAlgorithms.push(n.SshAlgorithms.keyExchange.dhGroup14Sha256),t.protocolExtensions.push(n.SshProtocolExtensionNames.sessionReconnect),t.protocolExtensions.push(n.SshProtocolExtensionNames.sessionLatency),e(t)}static nodeSshStreamFactory(e,t,r,i){const o=new s.client(i);return new Promise(((s,i)=>{o.on("connect",(e=>{s(new n.WebSocketStream(new a(e)))})),o.on("httpResponse",(({statusCode:e,statusMessage:t})=>{var r;const n=null!==(r=l.find((t=>t.statusCode===e)))&&void 0!==r?r:{statusCode:e,errorType:c.ServerError,error:`relayConnectionError Server responded with a non-101 status: ${e} ${t}`};i(new h(`error.${n.error}`,n))})),o.on("connectFailed",(({message:e})=>{var t;e&&e.startsWith("Error: ")&&(e=e.substr(7));const r=null!==(t=l.find((t=>t.regex&&t.regex.test(e))))&&void 0!==t?t:{errorType:c.ServerError,error:`relayConnectionError ${e}`};i(new h(`error.${r.error}`,r))})),o.connect(e,t,void 0,r)}))}}t.SshHelpers=o;class a{constructor(e){this.connection=e}set onmessage(e){e&&this.connection.on("message",(t=>{e({data:t.binaryData})}))}set onclose(e){e&&this.connection.on("close",((t,r)=>{e({code:t,reason:r,wasClean:!(t||r)})}))}send(e){Buffer.isBuffer(e)?this.connection.sendBytes(e):this.connection.sendBytes(Buffer.from(e))}close(e,t){e||t?this.connection.drop(e,t):this.connection.close()}}var c;t.isNode=()=>"undefined"!=typeof process&&void 0!==process.release&&"node"===process.release.name,function(e){e[e.ConnectionError=1]="ConnectionError",e[e.Unauthorized=2]="Unauthorized",e[e.EndpointNotFound=3]="EndpointNotFound",e[e.ListenerOffline=4]="ListenerOffline",e[e.ServerError=5]="ServerError",e[e.TunnelPortNotFound=6]="TunnelPortNotFound",e[e.TooManyRequests=7]="TooManyRequests",e[e.ServiceUnavailable=8]="ServiceUnavailable"}(c=t.RelayErrorType||(t.RelayErrorType={}));class h extends Error{constructor(e,t){super(e),this.errorContext=t}}t.RelayConnectionError=h;const l=[{regex:/status: 401/,statusCode:401,error:"relayClientUnauthorized",errorType:c.Unauthorized},{regex:/status: 403/,statusCode:403,error:"relayClientForbidden",errorType:c.Unauthorized},{regex:/status: 404/,statusCode:404,error:"tunnelPortNotFound",errorType:c.TunnelPortNotFound},{regex:/status: 429/,statusCode:429,error:"tooManyRequests",errorType:c.TooManyRequests},{regex:/status: 500/,statusCode:500,error:"relayServerError",errorType:c.ServerError},{regex:/status: 503/,statusCode:503,error:"serviceUnavailable",errorType:c.ServiceUnavailable}]},6679:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8278:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelClientBase=void 0;const n=r(4815),s=r(4322),i=r(2313),o=r(8156),a=r(4516),c=r(9461),h=r(8231),l=r(416),u=r(4878);class d extends((0,u.tunnelSshSessionClass)(l.TunnelConnectionSession)){constructor(e,t){super(n.TunnelAccessScopes.Connect,e,t),this.sshSessionClosedEmitter=new h.Emitter,this.acceptLocalConnectionsForForwardedPortsValue=(0,a.isNode)(),this.localForwardingHostAddressValue="127.0.0.1",this.connectionModes=[],this.sshSessionClosed=this.sshSessionClosedEmitter.event}get isSshSessionActive(){var e;return!!(null===(e=this.sshSession)||void 0===e?void 0:e.isConnected)}hasForwardedChannels(e){var t;if(!this.isSshSessionActive)return!1;const r=null===(t=this.sshSession)||void 0===t?void 0:t.activateService(i.PortForwardingService),n=null==r?void 0:r.remoteForwardedPorts,s=null==n?void 0:n.find((t=>t.remotePort===e));return!!s&&n.getChannels(s).length>0}get acceptLocalConnectionsForForwardedPorts(){return this.acceptLocalConnectionsForForwardedPortsValue}set acceptLocalConnectionsForForwardedPorts(e){if(e!==this.acceptLocalConnectionsForForwardedPortsValue){if(e&&!(0,a.isNode)())throw new Error("Cannot accept local connections for forwarded ports on this platform.");this.acceptLocalConnectionsForForwardedPortsValue=e,this.configurePortForwardingService()}}get localForwardingHostAddress(){return this.localForwardingHostAddressValue}set localForwardingHostAddress(e){e!==this.localForwardingHostAddressValue&&(this.localForwardingHostAddressValue=e,this.configurePortForwardingService())}get forwardedPorts(){var e;let t=null===(e=this.sshSession)||void 0===e?void 0:e.activateService(i.PortForwardingService);return null==t?void 0:t.remoteForwardedPorts}async connectClient(e,t){this.endpoints=t,await this.connectTunnelSession(e)}async connect(e,t){const r=d.getEndpoints(e,t);await this.connectClient(e,r)}async onConnectingToTunnel(e){this.endpoints||(this.endpoints=d.getEndpoints(e)),await super.onConnectingToTunnel(e)}static getEndpoints(e,t){if(!e)throw new Error("Tunnel must be defined.");if(!e.endpoints)throw new Error("Tunnel endpoints cannot be null");if(0===e.endpoints.length)throw new Error("No hosts are currently accepting connections for the tunnel.");let r,n=c.List.groupBy(e.endpoints,(e=>e.hostId));if(t){if(r=n.get(t),!r)throw new Error("The specified host is not currently accepting connections to the tunnel.")}else{if(n.size>1)throw new Error("There are multiple hosts for the tunnel. Specify a host ID to connect to.");r=n.entries().next().value[1]}return r}onRequest(e){e.request.requestType!==i.PortForwardingService.portForwardRequestType&&e.request.requestType!==i.PortForwardingService.cancelPortForwardRequestType||(e.isAuthorized=!0)}startSshSession(e,t){return this.connectSession((async()=>{this.sshSession=a.SshHelpers.createSshClientSession((e=>{e.addService(i.PortForwardingService)})),this.sshSession.trace=this.trace,this.sshSession.onClosed((e=>this.onSshSessionClosed(e))),this.sshSession.onAuthenticating((e=>this.onSshServerAuthenticating(e))),this.sshSession.onDisconnected((e=>this.onSshSessionDisconnected()));try{this.configurePortForwardingService(),this.sshSession.onRequest((e=>this.onRequest(e))),await this.sshSession.connect(e,t);let r={username:"tunnel",password:void 0};await this.sshSession.authenticate(r,t)}catch(e){const t=(0,c.getError)(e,"Error starting tunnel client SSH session: ");throw await this.closeSession(t),t}}))}configurePortForwardingService(){if(!this.sshSession)return;const e=this.sshSession.activateService(i.PortForwardingService);this.acceptLocalConnectionsForForwardedPortsValue&&(0,a.isNode)()?e.tcpListenerFactory=new o.RetryTcpListenerFactory(this.localForwardingHostAddressValue):e.acceptLocalConnectionsForForwardedPorts=!1}async connectToForwardedPort(e,t){const r=this.getSshSessionPfs();if(!r)throw new Error("Failed to connect to remote port. Ensure that the client has connected by calling connectClient.");return r.connectToForwardedPort(e,t)}async waitForForwardedPort(e,t){const r=this.getSshSessionPfs();if(!r)throw new Error("Port forwarding has not been started. Ensure that the client has connected by calling connectClient.");return r.waitForForwardedPort(e,t)}getSshSessionPfs(){var e,t;return null!==(t=null===(e=this.sshSession)||void 0===e?void 0:e.getService(i.PortForwardingService))&&void 0!==t?t:void 0}onSshServerAuthenticating(e){e.authenticationPromise=Promise.resolve({})}async refreshPorts(){if(!this.sshSession||this.sshSession.isClosed)throw new Error("Not connected.");const e=new s.SessionRequestMessage;e.requestType="RefreshPorts",e.wantReply=!0,await this.sshSession.request(e)}onSshSessionClosed(e){this.sshSessionClosedEmitter.fire(this),e.reason===s.SshDisconnectReason.connectionLost&&this.startReconnectingIfNotDisposed()}onSshSessionDisconnected(){this.startReconnectingIfNotDisposed()}}t.TunnelClientBase=d},3708:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5312:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelConnectionBase=void 0;const n=r(4322),s=r(8231),i=r(9063),o=r(5891),a=r(30),c=r(4215);t.TunnelConnectionBase=class{constructor(e){this.tunnelAccessScope=e,this.disposeCts=new s.CancellationTokenSource,this.status=i.ConnectionStatus.None,this.isRefreshingTunnelAccessTokenEventHandled=!1,this.refreshingTunnelAccessTokenEmitter=new s.Emitter({onFirstListenerAdd:()=>this.isRefreshingTunnelAccessTokenEventHandled=!0,onLastListenerRemove:()=>this.isRefreshingTunnelAccessTokenEventHandled=!1}),this.connectionStatusChangedEmitter=new s.Emitter,this.retryingTunnelConnectionEmitter=new s.Emitter,this.refreshingTunnelAccessToken=this.refreshingTunnelAccessTokenEmitter.event,this.connectionStatusChanged=this.connectionStatusChangedEmitter.event,this.retryingTunnelConnection=this.retryingTunnelConnectionEmitter.event}get isDisposed(){return this.disposeCts.token.isCancellationRequested}get disposeToken(){return this.disposeCts.token}get connectionStatus(){return this.status}set connectionStatus(e){if(this.isDisposed&&e!==i.ConnectionStatus.Disconnected&&this.throwIfDisposed(),e!==this.status){const t=this.connectionStatus;this.status=e,e===i.ConnectionStatus.Connected&&(this.error=void 0),this.onConnectionStatusChanged(t,e)}}get disconnectError(){return this.error}set disconnectError(e){this.error=e}dispose(){return this.disposeCts.cancel(),this.connectionStatus=i.ConnectionStatus.Disconnected,Promise.resolve()}onRetrying(e){this.retryingTunnelConnectionEmitter.fire(e)}async getFreshTunnelAccessToken(e){const t=new a.RefreshingTunnelAccessTokenEventArgs(this.tunnelAccessScope,e);this.refreshingTunnelAccessTokenEmitter.fire(t);const r=t.tunnelAccessToken?await t.tunnelAccessToken:void 0;return r&&c.TunnelAccessTokenProperties.validateTokenExpiration(r),r}onConnectionStatusChanged(e,t){const r=new o.ConnectionStatusChangedEventArgs(e,t,this.disconnectError);this.connectionStatusChangedEmitter.fire(r)}throwIfDisposed(){if(this.isDisposed)throw new n.CancellationError("The tunnel connection is disposed.")}}},416:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelConnectionSession=void 0;const n=r(4815),s=r(4215),i=r(4322),o=r(9063),a=r(7885),c=r(9461),h=r(5312);class l extends h.TunnelConnectionBase{constructor(e,t,r){super(e),this.managementClient=r,this.connectedTunnel=null,this.trace=null!=t?t:()=>{}}get tunnel(){return this.connectedTunnel}set tunnel(e){this.connectedTunnel=e}get isReconnectable(){return!!this.connector}createSessionStream(e){throw new Error("Not implemented")}configureSession(e,t,r){throw new Error("Not implemented")}closeSession(e){return this.disconnectError=e,Promise.resolve()}async refreshTunnelAccessToken(e){if(this.isDisposed)return!1;const t=this.connectionStatus;this.connectionStatus=o.ConnectionStatus.RefreshingTunnelAccessToken;try{this.traceInfo(`Refreshing tunnel access token. Current token: ${s.TunnelAccessTokenProperties.getTokenTrace(this.accessToken)}`);const t=await this.getFreshTunnelAccessToken(e);if(t)return s.TunnelAccessTokenProperties.validateTokenExpiration(t),this.traceInfo(`Refreshed tunnel access token. New token: ${s.TunnelAccessTokenProperties.getTokenTrace(t)}`),this.accessToken=t,!0}finally{this.connectionStatus=t}return!1}async getFreshTunnelAccessToken(e){var t;if(!this.isRefreshingTunnelAccessTokenEventHandled){if(!this.tunnel||!this.managementClient)return;const r={tokenScopes:[this.tunnelAccessScope]};if(this.tunnel=await(0,c.withCancellation)(this.managementClient.getTunnel(this.tunnel,r),e),!(null===(t=this.tunnel)||void 0===t?void 0:t.accessTokens))return;return s.TunnelAccessTokenProperties.getTunnelAccessToken(this.tunnel,this.tunnelAccessScope)}return await super.getFreshTunnelAccessToken(e)}createTunnelConnector(){return new a.RelayTunnelConnector(this)}traceInfo(e){this.trace(i.TraceLevel.Info,0,e)}traceVerbose(e){this.trace(i.TraceLevel.Verbose,0,e)}traceError(e,t){this.trace(i.TraceLevel.Error,0,e,t)}startReconnectingIfNotDisposed(){this.isDisposed||this.reconnectPromise||(this.reconnectPromise=(async()=>{try{await this.connectTunnelSession()}catch(e){}this.reconnectPromise=void 0})())}async connectSession(e){this.connectionStatus=o.ConnectionStatus.Connecting;try{await e(),this.connectionStatus=o.ConnectionStatus.Connected}catch(e){if(!(e instanceof i.CancellationError)){const t=this.tunnelAccessScope===n.TunnelAccessScopes.Connect?"client":"host";if(e instanceof Error)this.traceError(`Error connecting ${t} tunnel session: ${e.message}`,e),this.disconnectError=e;else{const r=`Error connecting ${t} tunnel session: ${e}`;this.traceError(r),this.disconnectError=new Error(r)}}throw this.connectionStatus=o.ConnectionStatus.Disconnected,e}}async connectTunnelSession(e){if(e&&this.tunnel)throw new Error("Already connected to a tunnel. Use separate instances to connect to multiple tunnels.");await this.connectSession((async()=>{const t=this.isReconnectable&&!e;await this.onConnectingToTunnel(e),e&&(this.tunnel=e,this.accessToken=s.TunnelAccessTokenProperties.getTunnelAccessToken(e,this.tunnelAccessScope)),this.connector||(this.connector=this.createTunnelConnector()),await this.connector.connectSession(t,this.disposeToken)}))}onConnectingToTunnel(e){return Promise.resolve()}validateAccessToken(){if(this.accessToken)return s.TunnelAccessTokenProperties.validateTokenExpiration(this.accessToken),this.accessToken}}t.TunnelConnectionSession=l},1781:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3189:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8715:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelHostBase=void 0;const n=r(4815),s=r(4322),i=r(2313),o=r(8026),a=r(416),c=r(4878),h=r(4516),l=r(8231),u=r(8384);class d extends((0,c.tunnelSshSessionClass)(a.TunnelConnectionSession)){constructor(e,t){super(n.TunnelAccessScopes.Host,t,e),this.sshSessions=[],this.remoteForwarders={},this.loopbackIp="127.0.0.1",this.forwardConnectionsToLocalPortsValue=(0,h.isNode)(),this.forwardedPortConnectingEmitter=new l.Emitter,this.forwardedPortConnecting=this.forwardedPortConnectingEmitter.event;const r=s.SshAlgorithms.publicKey.ecdsaSha2Nistp384;r&&(this.hostPrivateKeyPromise=r.generateKeyPair())}get forwardConnectionsToLocalPorts(){return this.forwardConnectionsToLocalPortsValue}set forwardConnectionsToLocalPorts(e){if(e!==this.forwardConnectionsToLocalPortsValue){if(e&&!(0,h.isNode)())throw new Error("Cannot forward connections to local TCP sockets on this platform.");this.forwardConnectionsToLocalPortsValue=e}}async start(e){await this.connectTunnelSession(e)}async refreshPorts(){var e;if(!this.tunnel||!this.managementClient)return;const t=await this.managementClient.getTunnel(this.tunnel,void 0),r=null!==(e=null==t?void 0:t.ports)&&void 0!==e?e:[];this.tunnel.ports=r;const n=[];for(let e of r)for(let t of this.sshSessions.filter((e=>e.isConnected&&e.sessionId))){const r=new o.SessionPortKey(t.sessionId,Number(e.portNumber));if(!this.remoteForwarders[r.toString()]){const r=t.getService(i.PortForwardingService);n.push(this.forwardPort(r,e))}}for(let[e,t]of Object.entries(this.remoteForwarders))r.some((e=>e.portNumber===t.localPort))||(delete this.remoteForwarders[e],t.dispose());await Promise.all(n)}onForwardedPortConnecting(e,t){const r=new u.ForwardedPortConnectingEventArgs(e,new s.SshStream(t));this.forwardedPortConnectingEmitter.fire(r)}async forwardPort(e,t){let r=e.session.sessionId;if(!r)throw new Error("No session id");const n=Number(t.portNumber);if(e.localForwardedPorts.find((e=>e.localPort===n)))return;const s=await e.forwardFromRemotePort(this.loopbackIp,n,this.loopbackIp,n);if(!s)return;const i=new o.SessionPortKey(r,Number(s.localPort));this.remoteForwarders[i.toString()]=s}async onConnectingToTunnel(e){if(this.hostPrivateKey&&this.hostPublicKeys)return;if(!e)throw new Error("Tunnel is required");if(!this.hostPrivateKeyPromise)throw new Error("Cannot create host keys");this.hostPrivateKey=await this.hostPrivateKeyPromise;const t=await this.hostPrivateKey.getPublicKeyBytes(this.hostPrivateKey.keyAlgorithmName);if(!t)throw new Error("Host private key public key bytes is not initialized");this.hostPublicKeys=[t.toString("base64")]}}t.TunnelHostBase=d},2643:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tunnelRelaySessionClass=void 0;const n=r(4815),s=r(4215),i=r(4322),o=r(6376);t.tunnelRelaySessionClass=function(e,t){var r;return(r=class extends e{constructor(){super(...arguments),this.streamFactory=new o.DefaultTunnelRelayStreamFactory}async createSessionStream(e){if(!this.relayUri)throw new Error("Cannot create tunnel session stream. Tunnel relay endpoint URI is missing");const r=this.tunnelAccessScope===n.TunnelAccessScopes.Connect?"client":"host",o=this.validateAccessToken();if(this.trace(i.TraceLevel.Info,0,`Connecting to ${r} tunnel relay ${this.relayUri}`),this.trace(i.TraceLevel.Verbose,0,`Sec-WebSocket-Protocol: ${t}`),o){const e=s.TunnelAccessTokenProperties.getTokenTrace(o);this.trace(i.TraceLevel.Verbose,0,`Authorization: tunnel <${e}>`)}return await this.streamFactory.createRelayStream(this.relayUri,t,o)}async connectTunnelSession(e){try{await super.connectTunnelSession(e)}catch(e){throw new Error("Failed to connect to tunnel relay. "+e)}}async onConnectingToTunnel(e){if(await super.onConnectingToTunnel(e),!this.relayUri&&(this.relayUri=await this.getTunnelRelayUri(e),!this.relayUri))throw new Error("The tunnel relay endpoint URI is missing.")}async getTunnelRelayUri(e){throw new Error("getTunnelRelayUri() is not implemented")}}).webSocketSubProtocol=t,r}},8396:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8478:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelRelayTunnelClient=void 0;const n=r(4815),s=r(8278),i=r(2643);class o extends((0,i.tunnelRelaySessionClass)(s.TunnelClientBase,"tunnel-relay-client")){constructor(e,t){super(e,t),this.connectionModes=[]}async getTunnelRelayUri(e){if(!this.endpoints||0===this.endpoints.length)throw new Error("No hosts are currently accepting connections for the tunnel.");const t=this.endpoints.filter((e=>e.connectionMode===n.TunnelConnectionMode.TunnelRelay));if(0===t.length)throw new Error("The host is not currently accepting Tunnel relay connections.");return t[0].clientRelayUri}async connectClientToRelayServer(e,t){if(!e)throw new Error("Client relay URI must be a non-empty string");this.relayUri=e,this.accessToken=t,await this.connectTunnelSession()}async configureSession(e,t,r){t&&this.sshSession&&!this.sshSession.isClosed?await this.sshSession.reconnect(e,r):await this.startSshSession(e,r)}}t.TunnelRelayTunnelClient=o},1965:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelRelayTunnelHost=void 0;const n=r(4815),s=r(4322),i=r(2313),o=r(4516),a=r(3501),c=r(8715),h=r(2643);class l extends((0,h.tunnelRelaySessionClass)(c.TunnelHostBase,"tunnel-relay-host")){constructor(e,t){super(e,t),this.clientSessionPromises=[],this.reconnectableSessions=[],this.hostId=a.MultiModeTunnelHost.hostId}async configureSession(e,t,r){this.sshSession=new s.MultiChannelStream(e),this.sshSession.channelMaxWindowSize=5*s.SshChannel.defaultMaxWindowSize;const n=this.sshSession.onChannelOpening((e=>{this.hostSession_ChannelOpening(this.sshSession,e)})),i=this.sshSession.onClosed((e=>{this.hostSession_Closed(e,n,i)}));await this.sshSession.connect()}async getTunnelRelayUri(e){if(!e)throw new Error("Tunnel is required");let t,r={hostId:this.hostId,hostPublicKeys:this.hostPublicKeys,connectionMode:n.TunnelConnectionMode.TunnelRelay};return null!=e.ports&&e.ports.find((e=>e.protocol===n.TunnelProtocol.Ssh))&&(t={includeSshGatewayPublicKey:"true"}),r=await this.managementClient.updateTunnelEndpoint(e,r,{additionalQueryParameters:t}),r.hostRelayUri}hostSession_ChannelOpening(e,t){if(!t.isRemoteRequest)return;if(t.channel.channelType!==l.clientStreamChannelType)return t.failureDescription=`Unexpected channel type. Only ${l.clientStreamChannelType} is supported.`,void(t.failureReason=s.SshChannelOpenFailureReason.unknownChannelType);if(this.isDisposed)return t.failureDescription="The host is disconnecting.",void(t.failureReason=s.SshChannelOpenFailureReason.connectFailed);const r=this.acceptClientSession(e,this.disposeToken);this.clientSessionPromises.push(r),r.then((()=>{const e=this.clientSessionPromises.indexOf(r);this.clientSessionPromises.splice(e,1)}))}async acceptClientSession(e,t){try{let r=await e.acceptStream(l.clientStreamChannelType,t);await this.connectAndRunClientSession(r,t)}catch(e){e instanceof s.CancellationError&&t.isCancellationRequested||this.trace(s.TraceLevel.Error,0,`Error running client SSH session: ${e}`)}}async connectAndRunClientSession(e,t){if(t.isCancellationRequested)throw e.destroy(),new s.CancellationError;let r=o.SshHelpers.createSshServerSession(this.reconnectableSessions,(e=>{e.addService(i.PortForwardingService)}));r.trace=this.trace,r.credentials={publicKeys:[this.hostPrivateKey]};let n=new s.PromiseCompletionSource;t.onCancellationRequested((e=>{n.reject(new s.CancellationError)}));const a=r.onAuthenticating((e=>{this.onSshClientAuthenticating(e)}));r.onClientAuthenticated((()=>{this.onSshClientAuthenticated(r)}));const c=r.onRequest((e=>{this.onSshSessionRequest(e,r)})),h=r.onChannelOpening((e=>{this.onSshChannelOpening(e,r)})),l=r.onClosed((e=>{this.session_Closed(r,e,t),n.resolve()}));try{const t=new s.NodeStream(e);await r.connect(t),this.sshSessions.push(r),await n.promise}finally{a.dispose(),c.dispose(),h.dispose(),l.dispose(),await r.close(s.SshDisconnectReason.byApplication),r.dispose()}}onSshClientAuthenticating(e){e.authenticationType===s.SshAuthenticationType.clientNone&&(e.authenticationPromise=Promise.resolve({}))}onSshClientAuthenticated(e){var t,r;let n=e.activateService(i.PortForwardingService);n.forwardConnectionsToLocalPorts=this.forwardConnectionsToLocalPorts,(null!==(r=null===(t=this.tunnel)||void 0===t?void 0:t.ports)&&void 0!==r?r:[]).forEach((async e=>{try{await this.forwardPort(n,e)}catch(t){this.traceError(`Error forwarding port ${e.portNumber}: ${t}`)}}))}onSshSessionRequest(e,t){"RefreshPorts"===e.requestType&&(e.responsePromise=(async()=>(await this.refreshPorts(),new s.SessionRequestSuccessMessage))())}onSshChannelOpening(e,t){if(!(e.request instanceof i.PortForwardChannelOpenMessage)){if(e.request.channelType===s.SshChannel.sessionChannelType)return;return this.trace(s.TraceLevel.Warning,0,"Rejecting request to open non-portforwarding channel."),void(e.failureReason=s.SshChannelOpenFailureReason.administrativelyProhibited)}let r=e.request;"direct-tcpip"===r.channelType?this.tunnel.ports.some((e=>e.portNumber===r.port))||(this.trace(s.TraceLevel.Warning,0,"Rejecting request to connect to non-forwarded port:"+r.port),e.failureReason=s.SshChannelOpenFailureReason.administrativelyProhibited):"forwarded-tcpip"===r.channelType?this.onForwardedPortConnecting(r.port,e.channel):(this.trace(s.TraceLevel.Warning,0,"Nonrecognized channel type "+r.channelType),e.failureReason=s.SshChannelOpenFailureReason.unknownChannelType)}session_Closed(e,t,r){t.reason===s.SshDisconnectReason.byApplication?this.traceInfo("Client ssh session closed."):r.isCancellationRequested?this.traceInfo("Client ssh session cancelled."):this.traceError(`Client ssh session closed unexpectely due to ${t.reason}, "${t.message}"\n${t.error}`);for(const t of Object.keys(this.remoteForwarders)){const r=this.remoteForwarders[t];r.session===e&&(r.dispose(),delete this.remoteForwarders[t])}const n=this.sshSessions.indexOf(e);n>=0&&this.sshSessions.splice(n,1)}hostSession_Closed(e,t,r){r.dispose(),t.dispose(),this.sshSession=void 0,this.traceInfo("Connection to host tunnel relay closed."+(this.isDisposed?"":" Reconnecting.")),e.reason===s.SshDisconnectReason.connectionLost&&this.startReconnectingIfNotDisposed()}async dispose(){await super.dispose();let e=Object.assign([],this.clientSessionPromises);if(this.clientSessionPromises.length=0,this.tunnel){const t=this.managementClient.deleteTunnelEndpoints(this.tunnel,this.hostId,n.TunnelConnectionMode.TunnelRelay);e.push(t)}for(const e of Object.keys(this.remoteForwarders))this.remoteForwarders[e].dispose();await Promise.all(e)}}t.TunnelRelayTunnelHost=l,l.clientStreamChannelType="client-ssh-session-stream"},4878:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tunnelSshSessionClass=void 0;const n=r(4322);t.tunnelSshSessionClass=function(e){return class extends e{async closeSession(e){var t;if(await super.closeSession(e),this.sshSession){if(!this.sshSession.isClosed){let r=n.SshDisconnectReason.byApplication;e&&(r=e instanceof n.SshConnectionError?null!==(t=e.reason)&&void 0!==t?t:n.SshDisconnectReason.connectionLost:e instanceof n.SshReconnectError||e instanceof n.SshChannelError?n.SshDisconnectReason.protocolError:n.SshDisconnectReason.connectionLost),await this.sshSession.close(r,void 0,e)}this.sshSession&&(this.sshSession.dispose(),this.sshSession=void 0)}}async dispose(){await super.dispose();try{await this.closeSession(this.disconnectError)}catch(e){if(!(e instanceof n.ObjectDisposedError))throw e}}}}},9461:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withCancellation=t.getError=t.getErrorMessage=t.delay=t.List=void 0;const n=r(4322);t.List=class{static groupBy(e,t){const r=new Map;return e.forEach((e=>{const n=t(e),s=r.get(n);s?s.push(e):r.set(n,[e])})),r}},t.delay=function(e,t){return new Promise(((r,s)=>{let i,o;if(t){if(t.isCancellationRequested)return void s(new n.CancellationError);i=t.onCancellationRequested((()=>{o&&clearTimeout(o),null==i||i.dispose(),s(new n.CancellationError)}))}o=setTimeout((()=>{null==i||i.dispose(),r()}),e)}))},t.getErrorMessage=function(e){var t;return String(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e)},t.getError=function(e,t){return e instanceof Error?e:new Error(`${null!=t?t:""}${e}`)},t.withCancellation=function(e,t){return t?Promise.race([e,new Promise(((e,r)=>{t.isCancellationRequested?r(new n.CancellationError):t.onCancellationRequested((()=>{r(new n.CancellationError)}))}))]):e}},4815:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelServiceProperties=t.TunnelProtocol=t.TunnelHeaderNames=t.TunnelEndpoint=t.TunnelConnectionMode=t.TunnelAccessScopes=t.TunnelAccessControlEntryType=t.TunnelAccessControl=void 0;var n=r(7412);Object.defineProperty(t,"TunnelAccessControl",{enumerable:!0,get:function(){return n.TunnelAccessControl}});var s=r(7030);Object.defineProperty(t,"TunnelAccessControlEntryType",{enumerable:!0,get:function(){return s.TunnelAccessControlEntryType}});var i=r(6979);Object.defineProperty(t,"TunnelAccessScopes",{enumerable:!0,get:function(){return i.TunnelAccessScopes}});var o=r(3035);Object.defineProperty(t,"TunnelConnectionMode",{enumerable:!0,get:function(){return o.TunnelConnectionMode}});var a=r(1861);Object.defineProperty(t,"TunnelEndpoint",{enumerable:!0,get:function(){return a.TunnelEndpoint}});var c=r(6124);Object.defineProperty(t,"TunnelHeaderNames",{enumerable:!0,get:function(){return c.TunnelHeaderNames}});var h=r(623);Object.defineProperty(t,"TunnelProtocol",{enumerable:!0,get:function(){return h.TunnelProtocol}});var l=r(3563);Object.defineProperty(t,"TunnelServiceProperties",{enumerable:!0,get:function(){return l.TunnelServiceProperties}})},7412:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessControl=void 0;const n=r(9603);t.TunnelAccessControl={validateScopes:n.validateScopes}},7030:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessControlEntryType=void 0,(r=t.TunnelAccessControlEntryType||(t.TunnelAccessControlEntryType={})).None="None",r.Anonymous="Anonymous",r.Users="Users",r.Groups="Groups",r.Organizations="Organizations",r.Repositories="Repositories",r.PublicKeys="PublicKeys",r.IPAddressRanges="IPAddressRanges"},9603:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateScopes=void 0;const n=r(6979),s=[n.TunnelAccessScopes.Manage,n.TunnelAccessScopes.ManagePorts,n.TunnelAccessScopes.Host,n.TunnelAccessScopes.Inspect,n.TunnelAccessScopes.Connect];t.validateScopes=function(e,t,r){if(!Array.isArray(e))throw new TypeError("A scopes array was expected.");r&&(e=e.map((e=>e.split(" "))).reduce(((e,t)=>e.concat(t)),[])),e.forEach((e=>{if(!e)throw new Error("Tunnel access scopes include a null/empty item.");if(!s.includes(e))throw new Error("Invalid tunnel access scope: "+e)})),Array.isArray(t)&&e.forEach((e=>{if(!t.includes(e))throw new Error("Tunnel access scope is invalid for current request: scope")}))}},6979:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessScopes=void 0,(r=t.TunnelAccessScopes||(t.TunnelAccessScopes={})).Create="create",r.Manage="manage",r.ManagePorts="manage:ports",r.Host="host",r.Inspect="inspect",r.Connect="connect"},3035:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelConnectionMode=void 0,(r=t.TunnelConnectionMode||(t.TunnelConnectionMode={})).LocalNetwork="LocalNetwork",r.TunnelRelay="TunnelRelay"},1861:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelEndpoint=t.portToken=void 0,t.portToken="{port}";const n=r(6790);t.TunnelEndpoint={portToken:t.portToken,getPortUri:n.getPortUri,getPortSshCommand:n.getPortSshCommand}},6790:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPortSshCommand=t.getPortUri=void 0;const n=r(1861);t.getPortUri=function(e,t){if(!e)throw new TypeError("A tunnel endpoint is required.");return"number"==typeof t||e.tunnelUri?"number"==typeof t&&e.portUriFormat?e.portUriFormat.replace(n.portToken,t.toString()):void 0:e.tunnelUri},t.getPortSshCommand=function(e,t){if(!e)throw new TypeError("A tunnel endpoint is required.");return"number"==typeof t||e.tunnelSshCommand?"number"==typeof t&&e.portSshCommandFormat?e.portSshCommandFormat.replace(n.portToken,t.toString()):void 0:e.tunnelSshCommand}},6124:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelHeaderNames=void 0,(r=t.TunnelHeaderNames||(t.TunnelHeaderNames={})).XTunnelAuthorization="X-Tunnel-Authorization",r.XRequestID="X-Request-ID",r.XGithubSshKey="X-Github-Ssh-Key",r.XTunnelSkipAntiPhishingPage="X-Tunnel-Skip-AntiPhishing-Page"},623:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelProtocol=void 0,(r=t.TunnelProtocol||(t.TunnelProtocol={})).Auto="auto",r.Tcp="tcp",r.Udp="udp",r.Ssh="ssh",r.Rdp="rdp",r.Http="http",r.Https="https"},3563:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelServiceProperties=t.nonProdGitHubAppClientId=t.prodGitHubAppClientId=t.devThirdPartyAppId=t.ppeThirdPartyAppId=t.prodThirdPartyAppId=t.nonProdFirstPartyAppId=t.prodFirstPartyAppId=t.devDnsName=t.ppeDnsName=t.prodDnsName=void 0,t.prodDnsName="global.rel.tunnels.api.visualstudio.com",t.ppeDnsName="global.rel.tunnels.ppe.api.visualstudio.com",t.devDnsName="global.ci.tunnels.dev.api.visualstudio.com",t.prodFirstPartyAppId="46da2f7e-b5ef-422a-88d4-2a7f9de6a0b2",t.nonProdFirstPartyAppId="54c45752-bacd-424a-b928-652f3eca2b18",t.prodThirdPartyAppId="ce65d243-a913-4cae-a7dd-cb52e9f77647",t.ppeThirdPartyAppId="544167a6-f431-4518-aac6-2fd50071928e",t.devThirdPartyAppId="a118c979-0249-44bb-8f95-eb0457127aeb",t.prodGitHubAppClientId="Iv1.e7b89e013f801f03",t.nonProdGitHubAppClientId="Iv1.b231c327f1eaa229";const n=r(2261);t.TunnelServiceProperties={production:n.production,staging:n.staging,development:n.development,environment:n.environment}},2261:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.environment=t.development=t.staging=t.production=void 0;const n=r(3563);t.production={serviceUri:`https://${n.prodDnsName}/`,serviceAppId:n.prodFirstPartyAppId,serviceInternalAppId:n.prodThirdPartyAppId,gitHubAppClientId:n.prodGitHubAppClientId},t.staging={serviceUri:`https://${n.ppeDnsName}/`,serviceAppId:n.nonProdFirstPartyAppId,serviceInternalAppId:n.ppeThirdPartyAppId,gitHubAppClientId:n.nonProdGitHubAppClientId},t.development={serviceUri:`https://${n.devDnsName}/`,serviceAppId:n.nonProdFirstPartyAppId,serviceInternalAppId:n.devThirdPartyAppId,gitHubAppClientId:n.nonProdGitHubAppClientId},t.environment=function(e){if(!e)throw new Error(`Invalid argument: ${e}`);switch(e.toLowerCase()){case"prod":case"production":return t.production;case"ppe":case"preprod":return t.staging;case"dev":case"development":return t.development;default:throw new Error(`Invalid service environment: ${e}`)}}},4215:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(3599),t),s(r(7034),t),s(r(3838),t),s(r(5804),t)},5804:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAccessTokenProperties=void 0;class r{constructor(e,t,r,n,s,i){this.clusterId=e,this.tunnelId=t,this.tunnelPorts=r,this.scopes=n,this.issuer=s,this.expiration=i}toString(){let e="";return this.tunnelId&&(e+="tunnel=",e+=this.tunnelId,this.clusterId&&(e+=".",e+=this.clusterId)),this.tunnelPorts&&this.tunnelPorts.length>0&&(e.length>0&&(e+=", "),1===this.tunnelPorts.length?e+=`port=${this.tunnelPorts[0]}`:e+=`ports=[${this.tunnelPorts.join(", ")}]`),this.scopes&&(e.length>0&&(e+=", "),e+=`scopes=[${this.scopes.join(", ")}]`),this.issuer&&(e.length>0&&(e+=", "),e+="issuer=",e+=this.issuer),this.expiration&&(e.length>0&&(e+=", "),e+=`expiration=${this.expiration.toString().replace(".000Z","Z")}`),e}static validateTokenExpiration(e){const t=r.tryParse(e);if((null==t?void 0:t.expiration)&&t.expiration<new Date)throw new Error("The access token is expired: "+t)}static tryParse(e){if("string"!=typeof e)throw new TypeError("Token string expected.");const t=e.split(".");if(3!==t.length)return null;const n=r.base64UrlDecode(t[1]);if(!n)return null;try{const e=JSON.parse(n),t=e.clusterId,s=e.tunnelId,i=e.tunnelPorts,o=e.scp,a=e.iss,c=e.exp;return new r(t,s,"number"==typeof i?[i]:i,null==o?void 0:o.split(" "),a,"number"==typeof c?new Date(1e3*c):void 0)}catch(e){return null}}static getTokenTrace(e){var t,n;return e?null!==(n=null===(t=r.tryParse(e))||void 0===t?void 0:t.toString())&&void 0!==n?n:"token":"none"}static getTunnelAccessToken(e,t){if((null==e?void 0:e.accessTokens)&&t){Array.isArray(t)||(t=[t]);for(let n of t)for(let[t,s]of Object.entries(e.accessTokens))if(s&&t.split(" ").includes(n))return r.validateTokenExpiration(s),s}}static base64UrlDecode(e){for(e=e.replace("-","+");e.length%4!=0;)e+="=";try{return atob(e)}catch(e){return null}}}t.TunnelAccessTokenProperties=r},7034:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelAuthenticationSchemes=void 0;class r{}t.TunnelAuthenticationSchemes=r,r.aad="aad",r.github="github",r.tunnel="tunnel"},3599:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TunnelManagementHttpClient=void 0;const n=r(4815),s=r(7034),i=r(5804),o=r(6285),a=r(9669),c="/api/v1",h=c+"/tunnels",l="/endpoints",u="/ports",d=c+"/clusters",p="Authorization";function f(e,t){var r,n;return(null!==(r=e.portNumber)&&void 0!==r?r:Number.MAX_SAFE_INTEGER)-(null!==(n=t.portNumber)&&void 0!==n?n:Number.MAX_SAFE_INTEGER)}function g(e){return"string"==typeof e?new Date(Date.parse(e)):e}function m(e){e&&(e.created=g(e.created),e.status&&(e.status.lastHostConnectionTime=g(e.status.lastHostConnectionTime),e.status.lastClientConnectionTime=g(e.status.lastClientConnectionTime)))}function y(e){e&&e.status&&(e.status.lastClientConnectionTime=g(e.status.lastClientConnectionTime))}const v=[n.TunnelAccessScopes.Manage],w=[n.TunnelAccessScopes.Host],S=[n.TunnelAccessScopes.Manage,n.TunnelAccessScopes.ManagePorts,n.TunnelAccessScopes.Host],b=[n.TunnelAccessScopes.Manage,n.TunnelAccessScopes.ManagePorts,n.TunnelAccessScopes.Host,n.TunnelAccessScopes.Connect];class E{constructor(e,t,r,s){var i;if(this.httpsAgent=s,this.trace=e=>{},!e)throw new TypeError("User agent must be provided.");if(Array.isArray(e)){if(0===e.length)throw new TypeError("User agents cannot be empty.");let t="";e.forEach((e=>{var r;if("string"!=typeof e){if(!e.name)throw new TypeError("Invalid user agent. The name must be provided.");if("string"!=typeof e.name)throw new TypeError("Invalid user agent. The name must be a string.");if(e.version&&"string"!=typeof e.version)throw new TypeError("Invalid user agent. The version must be a string.");t=`${t}${e.name}/${null!==(r=e.version)&&void 0!==r?r:"unknown"} `}else t=`${t}${e} `})),this.userAgents=t.trim()}else if("string"!=typeof e){if(!e.name)throw new TypeError("Invalid user agent. The name must be provided.");if("string"!=typeof e.name)throw new TypeError("Invalid user agent. The name must be a string.");if(e.version&&"string"!=typeof e.version)throw new TypeError("Invalid user agent. The version must be a string.");this.userAgents=`${e.name}/${null!==(i=e.version)&&void 0!==i?i:"unknown"}`}else this.userAgents=e;this.userTokenCallback=null!=t?t:()=>Promise.resolve(null),r||(r=n.TunnelServiceProperties.production.serviceUri);const o=new URL(r);if(!o||"/"!==o.pathname)throw new TypeError(`Invalid tunnel service URI: ${r}`);this.baseAddress=r}async listTunnels(e,t,r){const n=[e?null:"global=true",t?`domain=${t}`:null].filter((e=>!!e)).join("&"),s=await this.sendRequest("GET",e,h,n,r);return s.forEach(m),s}async getTunnel(e,t){const r=await this.sendTunnelRequest("GET",e,b,void 0,void 0,t);return m(r),r}async createTunnel(e,t){if(e.tunnelId)throw new Error("An ID may not be specified when creating a tunnel.");e=this.convertTunnelForRequest(e);const r=await this.sendRequest("POST",e.clusterId,h,void 0,t,e);return m(r),r}async updateTunnel(e,t){const r=await this.sendTunnelRequest("PUT",e,v,void 0,void 0,t,this.convertTunnelForRequest(e));return(null==t?void 0:t.tokenScopes)||(r.accessTokens=e.accessTokens),m(r),r}async deleteTunnel(e,t){return await this.sendTunnelRequest("DELETE",e,v,void 0,void 0,t,void 0,!0)}async updateTunnelEndpoint(e,t,r){const n=`${l}/${t.hostId}/${t.connectionMode}`,s=await this.sendTunnelRequest("PUT",e,w,n,void 0,r,t);return e.endpoints&&(e.endpoints=e.endpoints.filter((e=>e.hostId!==t.hostId||e.connectionMode!==t.connectionMode)).concat(s)),s}async deleteTunnelEndpoints(e,t,r,n){const s=null==r?`${l}/${t}`:`${l}/${t}/${r}`,i=await this.sendTunnelRequest("DELETE",e,w,s,void 0,n,void 0,!0);return i&&e.endpoints&&(e.endpoints=e.endpoints.filter((e=>e.hostId!==t||e.connectionMode!==r))),i}async listTunnelPorts(e,t){const r=await this.sendTunnelRequest("GET",e,b,u,void 0,t);return r.forEach(y),r}async getTunnelPort(e,t,r){const n=`${u}/${t}`,s=await this.sendTunnelRequest("GET",e,b,n,void 0,r);return y(s),s}async createTunnelPort(e,t,r){t=this.convertTunnelPortForRequest(e,t);const n=await this.sendTunnelRequest("POST",e,S,u,void 0,r,t);return e.ports&&(e.ports=e.ports.filter((e=>e.portNumber!==t.portNumber)).concat(n).sort(f)),y(n),n}async updateTunnelPort(e,t,r){if(t.clusterId&&e.clusterId&&t.clusterId!==e.clusterId)throw new Error("Tunnel port cluster ID is not consistent.");const n=t.portNumber,s=`${u}/${n}`;t=this.convertTunnelPortForRequest(e,t);const i=await this.sendTunnelRequest("PUT",e,S,s,void 0,r,t);return e.ports&&(e.ports=e.ports.filter((e=>e.portNumber!==t.portNumber)).concat(i).sort(f)),(null==r?void 0:r.tokenScopes)||(i.accessTokens=t.accessTokens),y(i),i}async deleteTunnelPort(e,t,r){const n=`${u}/${t}`,s=await this.sendTunnelRequest("DELETE",e,S,n,void 0,r,void 0,!0);return s&&e.ports&&(e.ports=e.ports.filter((e=>e.portNumber!==t)).sort(f)),s}async listClusters(){return await this.sendRequest("GET",void 0,d,void 0,void 0,void 0,!1)}async sendTunnelRequest(e,t,r,n,s,i,o,a){const c=this.buildUriForTunnel(t,n,s,i),h=await this.getAxiosRequestConfig(t,i,r);return await this.request(e,c,o,h,a)}async sendRequest(e,t,r,n,s,i,o){const a=this.buildUri(t,r,n,s),c=await this.getAxiosRequestConfig(void 0,s);return await this.request(e,a,i,c,o)}async checkNameAvailablility(e){e=encodeURI(e);const t=this.buildUri(void 0,`${h}/${e}/checkAvailability`);let r={httpsAgent:this.httpsAgent};return await this.request("GET",t,void 0,r)}getResponseErrorMessage(e){var t,r,n,s;let i="";if(null===(t=e.response)||void 0===t?void 0:t.data){let t=e.response.data;(t.title||t.detail)&&(i=`Tunnel service error: ${t.title}`,t.detail&&(i+=" "+t.detail),t.errors&&(i+=JSON.stringify(t.errors)))}i||(i=(null==e?void 0:e.response)?`Tunnel service returned status code: ${e.response.status} ${e.response.statusText}`:null!==(n=null!==(r=null==e?void 0:e.message)&&void 0!==r?r:e)&&void 0!==n?n:"Unknown tunnel service request error.");const o="VsSaaS-Request-Id";return(null===(s=e.response)||void 0===s?void 0:s.headers)&&e.response.headers[o]&&(i+=`\nRequest ID: ${e.response.headers[o]}`),i}buildUri(e,t,r,n){let s=this.baseAddress;if(e){const t=new URL(s),r=parseInt(t.port,10);if("localhost"===t.hostname||t.hostname.startsWith(`${e}.`)){if("https:"===t.protocol&&e.startsWith("localhost")&&r%10>0){const n=parseInt(e.substring("localhost".length),10);n>0&&n<10&&(t.port=(r-r%10+n).toString(),s=t.toString())}}else t.hostname=`${e}.${t.hostname}`.replace("global.",""),s=t.toString()}s=`${s.replace(/\/$/,"")}${t}`;let i=this.tunnelRequestOptionsToQueryString(n,r);return i&&(s+=`?${i}`),s}buildUriForTunnel(e,t,r,n){let s="";if(e.clusterId&&e.tunnelId)s=`${h}/${e.tunnelId}`;else{if(!e.name)throw new Error("Tunnel object must include either a name or tunnel ID and cluster ID.");s=`${h}/${e.name}`}if(null==n?void 0:n.additionalQueryParameters)for(let[e,t]of Object.entries(n.additionalQueryParameters))r?r+=`&${e}=${t}`:r=`${e}=${t}`;return this.buildUri(e.clusterId,s+(t||""),r,n)}async getAxiosRequestConfig(e,t,r){let n={};if(t&&t.accessToken&&(i.TunnelAccessTokenProperties.validateTokenExpiration(t.accessToken),n[p]=`${s.TunnelAuthenticationSchemes.tunnel} ${t.accessToken}`),!(p in n)&&this.userTokenCallback){let e=await this.userTokenCallback();e&&(n[p]=e)}if(!(p in n)){const t=i.TunnelAccessTokenProperties.getTunnelAccessToken(e,r);t&&(n[p]=`${s.TunnelAuthenticationSchemes.tunnel} ${t}`)}const a=e=>{if(e)for(let[t,r]of Object.entries(e))n[t]=r};a(this.additionalRequestHeaders),a(null==t?void 0:t.additionalHeaders);const c=n["User-Agent"]?n["User-Agent"]+" ":"";n["User-Agent"]=`${c}${this.userAgents} ${o.tunnelSdkUserAgent}`;let h=Object.assign({headers:n},this.httpsAgent&&{httpsAgent:this.httpsAgent});return!1===(null==t?void 0:t.followRedirects)&&(h.maxRedirects=0),h}convertTunnelForRequest(e){var t;return{name:e.name,domain:e.domain,description:e.description,tags:e.tags,options:e.options,accessControl:e.accessControl?{entries:e.accessControl.entries.filter((e=>!e.isInherited))}:void 0,endpoints:e.endpoints,ports:null===(t=e.ports)||void 0===t?void 0:t.map((t=>this.convertTunnelPortForRequest(e,t)))}}convertTunnelPortForRequest(e,t){if(t.clusterId&&e.clusterId&&t.clusterId!==e.clusterId)throw new Error("Tunnel port cluster ID does not match tunnel.");if(t.tunnelId&&e.tunnelId&&t.tunnelId!==e.tunnelId)throw new Error("Tunnel port tunnel ID does not match tunnel.");return{portNumber:t.portNumber,protocol:t.protocol,isDefault:t.isDefault,description:t.description,tags:t.tags,sshUser:t.sshUser,options:t.options,accessControl:t.accessControl?{entries:t.accessControl.entries.filter((e=>!e.isInherited))}:void 0}}tunnelRequestOptionsToQueryString(e,t){let r={};const s=[];return e&&(e.includePorts&&(r.includePorts=["true"]),e.includeAccessControl&&(r.includeAccessControl=["true"]),e.tokenScopes&&(n.TunnelAccessControl.validateScopes(e.tokenScopes,void 0,!0),r.tokenScopes=e.tokenScopes),e.forceRename&&(r.forceRename=["true"]),e.tags&&(r.tags=e.tags,e.requireAllTags&&(r.allTags=["true"])),e.limit&&(r.limit=[e.limit.toString()]),s.push(...Object.keys(r).map((e=>`${e}=${r[e].map(encodeURIComponent).join(",")}`)))),t&&s.push(t),s.join("&")}async request(e,t,r,n,s){this.trace(`${e} ${t}`),this.traceHeaders(n.headers),this.traceContent(r);const i=e=>{this.trace(`${e.status} ${e.statusText}`),this.traceHeaders(e.headers),this.traceContent(e.data)};try{n.url=t,n.method=e,n.data=r;let s=await a.default.request(n);return i(s),"DELETE"===e||s.data}catch(t){if(!(t instanceof Error&&t.isAxiosError))throw t;const r=t;if(r.response&&(i(r.response),s&&404===r.response.status))return"DELETE"!==e&&null;throw r.message=this.getResponseErrorMessage(r),delete r.request,r.response&&(delete r.config.httpAgent,delete r.config.httpsAgent,delete r.response.request),r}}traceHeaders(e){for(let[t,r]of Object.entries(e)){if("Authorization"===t)return void this.traceAuthorizationHeader(t,r);this.trace(`${t}: ${null!=r?r:""}`)}}traceAuthorizationHeader(e,t){if("string"!=typeof t)return;const r=t.indexOf(" ");if(r<0)return void this.trace(`${e}: [${t.length}]`);const n=t.substring(0,r),o=t.substring(r+1);if(n.toLowerCase()===s.TunnelAuthenticationSchemes.tunnel.toLowerCase()){const t=i.TunnelAccessTokenProperties.tryParse(o);if(t)return void this.trace(`${e}: ${n} <${t}>`)}this.trace(`${e}: ${n} <token>`)}traceContent(e){"object"==typeof e&&(e=JSON.stringify(e,void 0,"  ")),"string"==typeof e&&this.trace(E.replaceTokensInContent(e))}static replaceTokensInContent(e){var t;const r=/"(eyJ[a-zA-z0-9\-_]+\.[a-zA-z0-9\-_]+\.[a-zA-z0-9\-_]+)"/;let n=r.exec(e);for(;n;){let s=n[1];const o=i.TunnelAccessTokenProperties.tryParse(s);s=null!==(t=null==o?void 0:o.toString())&&void 0!==t?t:"token",e=e.substring(0,n.index+1)+"<"+s+">"+e.substring(n.index+n[0].length-1),n=r.exec(e)}return e}}t.TunnelManagementHttpClient=E},3838:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6285:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tunnelSdkUserAgent=void 0;const n=r(1725).version;t.tunnelSdkUserAgent=`Visual-Studio-Tunnel-Service-SDK/${n}`},6266:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardedPort=void 0,t.ForwardedPort=class{constructor(e,t,r){if(null===e&&null===t)throw new TypeError("Local and remote ports cannot both be null.");if(!r&&null===t)throw new TypeError("The report port number must not be null for locally forwarded ports.");if(null!==e&&("number"!=typeof e||e<=0))throw new TypeError("Local port must be a positive integer.");if(null!==t&&("number"!=typeof t||t<=0))throw new TypeError("Remote port must be a positive integer: "+t);this.localPort=e,this.remotePort=t;const n=r?"->":"<-";null===this.localPort?this.str=`${n}${this.remotePort}`:null==this.remotePort?this.str=`${this.localPort}${n}`:this.str=`${this.localPort}${n}${this.remotePort}`}toString(){return this.str}}},8788:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardedPortChannelEventArgs=t.ForwardedPortEventArgs=void 0;class r{constructor(e){this.port=e}toString(){return this.port.toString()}}t.ForwardedPortEventArgs=r,t.ForwardedPortChannelEventArgs=class extends r{constructor(e,t){super(e),this.port=e,this.channel=t}toString(){return`${this.port} ${this.channel}`}}},1563:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardedPortsCollection=void 0;const n=r(8231),s=r(8788);class i{constructor(){this.portChannelMap=new Map,this.portAddedEmitter=new n.Emitter,this.onPortAdded=this.portAddedEmitter.event,this.portRemovedEmitter=new n.Emitter,this.onPortRemoved=this.portRemovedEmitter.event,this.portChannelAddedEmitter=new n.Emitter,this.onPortChannelAdded=this.portChannelAddedEmitter.event,this.portChannelRemovedEmitter=new n.Emitter,this.onPortChannelRemoved=this.portChannelRemovedEmitter.event}get size(){return this.portChannelMap.size}has(e){return this.portChannelMap.has(e.toString())}*values(){for(const[e,t]of this.portChannelMap.values())yield e}[Symbol.iterator](){return this.values()}*entries(){for(const[e,t]of this.portChannelMap.values())yield[e,e]}keys(){return this.values()}forEach(e,t){for(const[r,n]of this.portChannelMap.values())e.apply(t,[r,r,this])}getChannels(e){const t=this.portChannelMap.get(e.toString());if(!t)throw new Error(`Port ${e} is not in the collection.`);return t[1]}find(e){for(const t of this.values())if(e(t))return t}addPort(e){if(this.has(e))throw new Error(`Port ${e} is already in the collection.`);this.portChannelMap.set(e.toString(),[e,[]]),this.portAddedEmitter.fire(new s.ForwardedPortEventArgs(e))}removePort(e){if(!this.has(e))throw new Error(`Port ${e} is not in the collection.`);this.portChannelMap.delete(e.toString()),this.portRemovedEmitter.fire(new s.ForwardedPortEventArgs(e))}addChannel(e,t){const r=this.portChannelMap.get(e.toString());if(!r)throw new Error(`Port ${e} is not in the collection.`);const n=r[1];if(n.find((e=>e.channelId===t.channelId)))throw new Error(`Channel ${t.channelId} is already in the collection for port ${e}`);n.push(t),t.onClosed((()=>this.tryRemoveChannel(e,t))),this.portChannelAddedEmitter.fire(new s.ForwardedPortChannelEventArgs(e,t))}tryRemoveChannel(e,t){const r=this.portChannelMap.get(e.toString());if(r){const n=r[1],i=n.findIndex((e=>e.channelId===t.channelId));i>=0&&(n.splice(i,1),this.portChannelRemovedEmitter.fire(new s.ForwardedPortChannelEventArgs(e,t)))}}toString(){return[...this].join(", ")}}t.ForwardedPortsCollection=i},2313:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardedPortChannelEventArgs=t.ForwardedPortEventArgs=t.ForwardedPortsCollection=t.ForwardedPort=t.PortForwardChannelOpenMessage=t.PortForwardSuccessMessage=t.PortForwardRequestMessage=t.RemotePortStreamer=t.RemotePortForwarder=t.LocalPortForwarder=t.PortForwardingService=t.SshServer=t.SshClient=void 0;var n=r(4700);Object.defineProperty(t,"SshClient",{enumerable:!0,get:function(){return n.SshClient}});var s=r(3878);Object.defineProperty(t,"SshServer",{enumerable:!0,get:function(){return s.SshServer}});var i=r(84);Object.defineProperty(t,"PortForwardingService",{enumerable:!0,get:function(){return i.PortForwardingService}});var o=r(6272);Object.defineProperty(t,"LocalPortForwarder",{enumerable:!0,get:function(){return o.LocalPortForwarder}});var a=r(2110);Object.defineProperty(t,"RemotePortForwarder",{enumerable:!0,get:function(){return a.RemotePortForwarder}});var c=r(4645);Object.defineProperty(t,"RemotePortStreamer",{enumerable:!0,get:function(){return c.RemotePortStreamer}});var h=r(9846);Object.defineProperty(t,"PortForwardRequestMessage",{enumerable:!0,get:function(){return h.PortForwardRequestMessage}});var l=r(2556);Object.defineProperty(t,"PortForwardSuccessMessage",{enumerable:!0,get:function(){return l.PortForwardSuccessMessage}});var u=r(3123);Object.defineProperty(t,"PortForwardChannelOpenMessage",{enumerable:!0,get:function(){return u.PortForwardChannelOpenMessage}});var d=r(6266);Object.defineProperty(t,"ForwardedPort",{enumerable:!0,get:function(){return d.ForwardedPort}});var p=r(1563);Object.defineProperty(t,"ForwardedPortsCollection",{enumerable:!0,get:function(){return p.ForwardedPortsCollection}});var f=r(8788);Object.defineProperty(t,"ForwardedPortEventArgs",{enumerable:!0,get:function(){return f.ForwardedPortEventArgs}}),Object.defineProperty(t,"ForwardedPortChannelEventArgs",{enumerable:!0,get:function(){return f.ForwardedPortChannelEventArgs}})},9710:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IPAddressConversions=void 0,t.IPAddressConversions=class{static fromSshAddress(e){return e?"localhost"===e?"127.0.0.1":e:"0.0.0.0"}static toSshAddress(e){return e?"0.0.0.0"===e?"":"127.0.0.1"===e?"localhost":e:null}}},3123:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortForwardChannelOpenMessage=void 0;const n=r(4322);class s extends n.ChannelOpenMessage{constructor(){super(...arguments),this.host="",this.port=0,this.originatorIPAddress="",this.originatorPort=0}onRead(e){super.onRead(e),this.host=e.readString("ascii"),this.port=e.readUInt32(),this.originatorIPAddress=e.readString("ascii"),this.originatorPort=e.readUInt32()}onWrite(e){super.onWrite(e),e.writeString(this.validateField(this.host,"host"),"ascii"),e.writeUInt32(this.validateField(this.port,"port")),e.writeString(this.originatorIPAddress||"","ascii"),e.writeUInt32(this.originatorPort||0)}toString(){return`${super.toString()} (host=${this.host} port=${this.port})`}}t.PortForwardChannelOpenMessage=s},9846:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortForwardRequestMessage=void 0;const n=r(4322),s=r(84);class i extends n.SessionRequestMessage{constructor(){super(),this.addressToBind="",this.port=0,this.requestType=s.PortForwardingService.portForwardRequestType,this.wantReply=!0}onRead(e){super.onRead(e),this.addressToBind=e.readString("ascii"),this.port=e.readUInt32()}onWrite(e){super.onWrite(e),e.writeString(this.validateField(this.addressToBind,"address"),"ascii"),e.writeUInt32(this.validateField(this.port,"port"))}toString(){return`${super.toString()} (addressToBind=${this.addressToBind} port=${this.port})`}}t.PortForwardRequestMessage=i},2556:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortForwardSuccessMessage=void 0;const n=r(4322);class s extends n.SessionRequestSuccessMessage{constructor(){super(...arguments),this.port=0}onRead(e){super.onRead(e),e.available>=4&&(this.port=e.readUInt32())}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.port,"port"))}toString(){return`${super.toString()} (port=${this.port})`}}t.PortForwardSuccessMessage=s},765:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultPortForwardMessageFactory=void 0;const n=r(3123),s=r(9846),i=r(2556);t.DefaultPortForwardMessageFactory=class{createRequestMessageAsync(e){return Promise.resolve(new s.PortForwardRequestMessage)}createSuccessMessageAsync(e){return Promise.resolve(new i.PortForwardSuccessMessage)}createChannelOpenMessageAsync(e){return Promise.resolve(new n.PortForwardChannelOpenMessage)}}},3767:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelForwarder=void 0;const n=r(4322),s=r(8231);t.ChannelForwarder=class{constructor(e,t,r){this.pfs=e,this.channel=t,this.socket=r,this.disposeCancellationSource=new s.CancellationTokenSource,r.on("data",this.onSocketDataReceived.bind(this)),r.on("error",this.onSocketError.bind(this)),r.on("close",this.onSocketClosed.bind(this)),t.onDataReceived(this.onChannelDataReceived.bind(this)),t.onClosed(this.onChannelClosed.bind(this))}get trace(){return this.channel.session.trace}onSocketDataReceived(e){this.socket.pause(),this.channel.send(e,this.disposeCancellationSource.token).then(this.socket.resume.bind(this.socket),(e=>{this.trace(n.TraceLevel.Warning,n.SshTraceEventIds.portForwardConnectionFailed,`Forwarder error sending channel data: ${e.message}`,e)}))}onSocketClosed(e){(e?this.channel.close("SIGABRT","Socket closed with error."):this.channel.close()).catch((e=>{this.trace(n.TraceLevel.Error,n.SshTraceEventIds.portForwardConnectionFailed,`Forwarder channel close failed with error: ${e.message}`,e)}))}onSocketError(e){this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardChannelClosed,`Forwarder socket closed with error: ${e.message}`),this.channel.close("SIGABRT",e.message).catch((e=>{this.trace(n.TraceLevel.Error,n.SshTraceEventIds.portForwardConnectionFailed,`Forwarder channel close failed with error: ${e.message}`,e)}))}onChannelDataReceived(e){this.socket.write(e,(t=>{t?this.trace(n.TraceLevel.Error,n.SshTraceEventIds.portForwardConnectionFailed,`Forwarder failed to write to socket: ${t.message}`,t):this.channel.adjustWindow(e.length)}))}onChannelClosed(e){e.errorMessage?(this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardConnectionClosed,`Forwarder channel ${this.channel.channelId} closed with error: ${e.errorMessage}`),this.socket.destroy()):(this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardConnectionClosed,`Forwarder channel ${this.channel.channelId} closed.`),this.socket.end());const t=this.pfs.channelForwarders.indexOf(this);t>=0&&this.pfs.channelForwarders.splice(t,1),this.dispose()}dispose(){this.disposeCancellationSource.dispose(),this.socket.destroy()}}},6272:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalPortForwarder=void 0;const n=r(4322),s=r(3767);class i extends n.SshService{constructor(e,t,r,n,s,i,o){super(t),this.pfs=e,this.channelType=r,this.localIPAddress=n,this.port=s,this.remoteHost=i,this.remotePort=null!=o?o:0!==s?s:void 0}get localPort(){return this.port}async startForwarding(e){var t;let r=this.localIPAddress;try{this.tcpListener=await this.pfs.tcpListenerFactory.createTcpListener(r,this.port,!0);const e=this.tcpListener.address();if(!(e.port>0))throw this.tcpListener.close(),new Error("Could not get server port.");if(this.port=e.port,"127.0.0.1"===this.localIPAddress||"0.0.0.0"===this.localIPAddress){r="0.0.0.0"===this.localIPAddress?"::":"::1";try{this.tcpListener2=await this.pfs.tcpListenerFactory.createTcpListener(r,this.port,!1)}catch(e){if(!(e instanceof Error)||"EADDRNOTAVAIL"!==e.code)throw e;this.trace(n.TraceLevel.Warning,n.SshTraceEventIds.portForwardServerListenFailed,`PortForwardingService failed to listen on ${r}:{this.port}: ${e.message}`,e)}}}catch(e){if(!(e instanceof Error))throw e;throw this.trace(n.TraceLevel.Error,n.SshTraceEventIds.portForwardServerListenFailed,`PortForwardingService failed to listen on ${r}:${this.port}: ${e.message}`,e),e}this.tcpListener.on("connection",this.acceptConnection.bind(this)),null===(t=this.tcpListener2)||void 0===t||t.on("connection",this.acceptConnection.bind(this)),this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardServerListening,`PortForwardingService listening on ${this.localIPAddress}:${this.port}.`),this.tcpListener2&&this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardServerListening,`PortForwardingService also listening on ${r}:${this.port}.`)}async acceptConnection(e){var t,r,i,o;let a;this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardConnectionAccepted,`PortForwardingService accepted connection from: ${e.remoteAddress} on port ${this.port}`);try{a=await this.pfs.openChannel(this.session,this.channelType,null!==(t=e.remoteAddress)&&void 0!==t?t:null,null!==(r=e.remotePort)&&void 0!==r?r:null,null!==(i=this.remoteHost)&&void 0!==i?i:this.localIPAddress,null!==(o=this.remotePort)&&void 0!==o?o:this.localPort)}catch(t){if(!(t instanceof Error))throw t;return void e.destroy()}const c=new s.ChannelForwarder(this.pfs,a,e);this.pfs.channelForwarders.push(c)}dispose(){var e,t;null===(e=this.tcpListener)||void 0===e||e.close(),null===(t=this.tcpListener2)||void 0===t||t.close(),this.trace(n.TraceLevel.Info,n.SshTraceEventIds.portForwardServerListening,`PortForwardingService stopped listening on ${this.localIPAddress}:${this.port}.`),super.dispose()}}t.LocalPortForwarder=i},84:function(e,t,r){"use strict";var n,s=this&&this.__decorate||function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.PortForwardingService=void 0;const i=r(4322),o=r(6266),a=r(1563),c=r(9710),h=r(3123),l=r(9846),u=r(2556),d=r(4547),p=r(765),f=r(6272),g=r(2110),m=r(4645);let y=n=class extends i.SshService{constructor(e){super(e),this.localForwarders=new Map,this.remoteConnectors=new Map,this.channelForwarders=[],this.acceptLocalConnectionsForForwardedPorts=!0,this.forwardConnectionsToLocalPorts=!0,this.acceptRemoteConnectionsForNonForwardedPorts=!0,this.localForwardedPorts=new a.ForwardedPortsCollection,this.remoteForwardedPorts=new a.ForwardedPortsCollection,this.tcpListenerFactory=new d.DefaultTcpListenerFactory,this.messageFactory=new p.DefaultPortForwardMessageFactory}async forwardFromRemotePort(e,t,r,n,s){const i="string"==typeof r?r:"127.0.0.1";if(void 0===n&&(n=t),!e)throw new TypeError("Remote IP address is required.");if(!Number.isInteger(t)||t<0)throw new TypeError("Remote port must be a non-negative integer.");if(!i)throw new TypeError("Local host is required.");if(!Number.isInteger(n)||n<=0)throw new TypeError("Local port must be a positive integer.");if(this.localForwardedPorts.find((e=>e.localPort===n)))throw new Error(`Local port ${n} is already forwarded.`);if(t>0&&this.localForwardedPorts.find((e=>e.remotePort===t)))throw new Error(`Remote port ${t} is already forwarded.`);const a=new g.RemotePortForwarder(this,this.session,e,t,i,n),c=await this.messageFactory.createRequestMessageAsync(t);if(!await a.request(c,s))return a.dispose(),null;t=a.remotePort,this.remoteConnectors.set(t,a);const h=new o.ForwardedPort(n,t,!1);return this.localForwardedPorts.addPort(h),a.onDisposed((()=>{this.localForwardedPorts.removePort(h),this.remoteConnectors.delete(t)})),a}async forwardToRemotePort(e,t,r,s,i){const o="string"==typeof r?r:"127.0.0.1";if(void 0===s&&(s=t),!e)throw new TypeError("Local IP address is required.");if(!Number.isInteger(t)||t<0)throw new TypeError("Local port must be a non-negative integer.");if(!o)throw new TypeError("Remote host is required.");if(!Number.isInteger(s)||s<=0)throw new TypeError("Remote port must be a positive integer.");if(this.localForwarders.has(s))throw new Error(`Port ${s} is already forwarded.`);const a=new f.LocalPortForwarder(this,this.session,n.reversePortForwardChannelType,e,t,o,s);return await a.startForwarding(i),this.localForwarders.set(s,a),a.onDisposed((()=>{this.localForwarders.delete(s)})),a}async streamFromRemotePort(e,t,r){if(!e)throw new TypeError("Remote IP address is required.");if(!Number.isInteger(t)||t<0)throw new TypeError("Remote port must be a non-negative integer.");const n=new m.RemotePortStreamer(this.session,e,t),s=await this.messageFactory.createRequestMessageAsync(t);if(!await n.request(s,r))return n.dispose(),null;t=n.remotePort,this.remoteConnectors.set(t,n);const i=new o.ForwardedPort(null,t,!1);return this.localForwardedPorts.addPort(i),n.onDisposed((()=>{this.localForwardedPorts.removePort(i),this.remoteConnectors.delete(t)})),n}async streamToRemotePort(e,t,r){if(!e)throw new TypeError("Remote host is required.");if(!Number.isInteger(t)||t<=0)throw new TypeError("Remote port must be a positive integer.");const s=await this.openChannel(this.session,n.reversePortForwardChannelType,null,null,e,t,r);return new i.SshStream(s)}async connectToForwardedPort(e,t){if(!Number.isInteger(e)||e<=0)throw new TypeError("Forwarded port must be a positive integer.");const r=await this.openChannel(this.session,n.portForwardChannelType,null,null,"127.0.0.1",e,t);return new i.SshStream(r)}async waitForForwardedPort(e,t){if(this.remoteForwardedPorts.find((t=>t.remotePort===e)))return;const r=new i.PromiseCompletionSource;let n,s,o;t&&(n=t.onCancellationRequested((()=>r.reject(new i.CancellationError))));try{s=this.remoteForwardedPorts.onPortAdded((t=>{t.port.remotePort===e&&r.resolve()})),o=this.session.onClosed((()=>{r.reject(new i.ObjectDisposedError("The session was closed."))})),await r.promise}finally{null==s||s.dispose(),null==o||o.dispose(),null==n||n.dispose()}}async onSessionRequest(e,t){if(!e)throw new TypeError("Request is required.");if(e.requestType!==n.portForwardRequestType&&e.requestType!==n.cancelPortForwardRequestType)throw new Error(`Unexpected request type: ${e.requestType}`);const r=e.request.convertTo(new l.PortForwardRequestMessage),s=c.IPAddressConversions.fromSshAddress(r.addressToBind);if(e.requestType===n.portForwardRequestType&&0!==r.port&&this.localForwarders.has(r.port)){const t=`PortForwardingService blocking attempt to re-forward already-forwarded port ${r.port}.`;return this.session.trace(i.TraceLevel.Warning,i.SshTraceEventIds.portForwardRequestInvalid,t),void(e.isAuthorized=!1)}const a=new i.SshRequestEventArgs(e.requestType,r,this.session.principal);let h;await super.onSessionRequest(a,t);let d=null;if(a.isAuthorized)if(e.requestType===n.portForwardRequestType){try{d=await this.startForwarding(s,r.port,t)}catch(e){}if(null!==d){const e=0===r.port?d:r.port,t=await this.messageFactory.createSuccessMessageAsync(e);t.port=e,h=t}}else e.requestType===n.cancelPortForwardRequestType&&await this.cancelForwarding(r.port,t)&&(h=new i.SessionRequestSuccessMessage);if(e.responsePromise=Promise.resolve(null!=h?h:new i.SessionRequestFailureMessage),h instanceof u.PortForwardSuccessMessage){const e=new o.ForwardedPort(null!=d?d:h.port,h.port,!0);this.remoteForwardedPorts.addPort(e)}}async startForwarding(e,t,r){if("number"!=typeof t)throw new TypeError("Remote port must be an integer.");if(this.acceptLocalConnectionsForForwardedPorts){let s=t;const i=new f.LocalPortForwarder(this,this.session,n.portForwardChannelType,e,s,void 0,0===t?void 0:t);return await i.startForwarding(r),s=i.localPort,0===t&&(t=s),this.localForwarders.has(t)?(i.dispose(),null):(this.localForwarders.set(t,i),s=i.localPort,i.onDisposed((()=>{const e=new o.ForwardedPort(s,t,!0);this.remoteForwardedPorts.removePort(e),this.localForwarders.delete(t)})),s)}return 0!==t?t:null}async cancelForwarding(e,t){const r=this.localForwarders.get(e);return!!r&&(this.localForwarders.delete(e),r.dispose(),!0)}async onChannelOpening(e,t){var r;if(!e)throw new TypeError("Request is required.");const s=e.request.channelType;if(s!==n.portForwardChannelType&&s!==n.reversePortForwardChannelType)return void(e.failureReason=i.SshChannelOpenFailureReason.unknownChannelType);let a=null;const l=e.request instanceof h.PortForwardChannelOpenMessage?e.request:e.request.convertTo(new h.PortForwardChannelOpenMessage);if(e.isRemoteRequest)if(s===n.portForwardChannelType){const t=`${c.IPAddressConversions.fromSshAddress(l.host)}:${l.port}`;if(a=null!==(r=this.remoteConnectors.get(l.port))&&void 0!==r?r:null,!a)return this.trace(i.TraceLevel.Error,i.SshTraceEventIds.portForwardRequestInvalid,`PortForwardingService received forwarding channel for ${t} that was not requested.`),e.failureReason=i.SshChannelOpenFailureReason.connectFailed,void(e.failureDescription="Forwarding channel was not requested.")}else if(!this.acceptRemoteConnectionsForNonForwardedPorts){const t="The session has disabled connections to non-forwarded ports.";return this.session.trace(i.TraceLevel.Warning,i.SshTraceEventIds.portForwardChannelOpenFailed,t),e.failureDescription=t,void(e.failureReason=i.SshChannelOpenFailureReason.administrativelyProhibited)}const u=new i.SshChannelOpeningEventArgs(l,e.channel,e.isRemoteRequest);if(await super.onChannelOpening(u,t),e.failureReason=u.failureReason,e.failureDescription=u.failureDescription,e.failureReason===i.SshChannelOpenFailureReason.none&&e.isRemoteRequest&&this.forwardConnectionsToLocalPorts)if(a){await a.onChannelOpening(e,t);const r=a instanceof g.RemotePortForwarder?a.localPort:null,n=a instanceof g.RemotePortForwarder?a.remotePort:l.port,s=new o.ForwardedPort(r,n,!1);this.localForwardedPorts.addChannel(s,e.channel)}else await g.RemotePortForwarder.forwardChannel(this,e,l.host,l.port,this.trace,t)}async openChannel(e,t,r,s,o,a,c){let h;if(t===n.portForwardChannelType&&(h=this.remoteForwardedPorts.find((e=>e.remotePort===a||null===e.remotePort&&e.localPort===a)),!h))throw new Error(`Port ${a} is not being forwarded.`);const l=await this.messageFactory.createChannelOpenMessageAsync(a);l.channelType=t,l.originatorIPAddress=null!=r?r:"",l.originatorPort=null!=s?s:0,l.host=o,l.port=a;const u=this.session.trace;let d;try{d=await e.openChannel(l,null,c),u(i.TraceLevel.Info,i.SshTraceEventIds.portForwardChannelOpened,`PortForwardingService opened ${t} channel #${d.channelId} for ${o}:${a}.`)}catch(e){if(!(e instanceof Error))throw e;throw u(i.TraceLevel.Error,i.SshTraceEventIds.portForwardChannelOpenFailed,`PortForwardingService failed to open ${t} channel for ${o}:${a}: ${e.message}`,e),e}return t===n.portForwardChannelType&&this.remoteForwardedPorts.addChannel(h,d),d}dispose(){const e=[...this.channelForwarders,...this.localForwarders.values(),...this.remoteConnectors.values()];this.channelForwarders.splice(0,this.channelForwarders.length),this.localForwarders.clear(),this.remoteConnectors.clear();for(const t of e)t.dispose();super.dispose()}};y.portForwardRequestType="tcpip-forward",y.cancelPortForwardRequestType="cancel-tcpip-forward",y.portForwardChannelType="forwarded-tcpip",y.reversePortForwardChannelType="direct-tcpip",y=n=s([(0,i.serviceActivation)({sessionRequest:n.portForwardRequestType}),(0,i.serviceActivation)({sessionRequest:n.cancelPortForwardRequestType}),(0,i.serviceActivation)({channelType:n.portForwardChannelType}),(0,i.serviceActivation)({channelType:n.reversePortForwardChannelType})],y),t.PortForwardingService=y},6127:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemotePortConnector=void 0;const n=r(4322),s=r(9846),i=r(2556),o=r(84);class a extends n.SshService{constructor(e,t,r){super(e),this.forwarding=!1,this.remoteIPAddress=t,this.port=r}get remotePort(){return this.port}async request(e,t){if(this.forwarding)throw new Error("Already forwarding.");e.addressToBind=this.remoteIPAddress,e.port=this.remotePort,e.wantReply=!0;const r=await this.session.requestResponse(e,i.PortForwardSuccessMessage,n.SessionRequestFailureMessage,t);let s=!1;return r instanceof i.PortForwardSuccessMessage&&(0!==r.port&&(this.port=r.port),s=!0),this.forwarding=s,s}dispose(){if(this.forwarding){this.forwarding=!1;const e=new s.PortForwardRequestMessage;e.requestType=o.PortForwardingService.cancelPortForwardRequestType,e.addressToBind=this.remoteIPAddress,e.port=this.remotePort,e.wantReply=!1;try{this.session.request(e).catch((e=>{}))}catch(e){}}super.dispose()}}t.RemotePortConnector=a},2110:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemotePortForwarder=void 0;const n=r(1808),s=r(4322),i=r(3767),o=r(6127);class a extends o.RemotePortConnector{constructor(e,t,r,n,s,i){super(t,r,n),this.pfs=e,this.localHost=s,this.localPort=i}async onChannelOpening(e,t){await a.forwardChannel(this.pfs,e,this.localHost,this.localPort,this.trace,t)}static async forwardChannel(e,t,r,o,a,c){const h=t.channel,l=n.createConnection({host:r,port:o}),u=new s.PromiseCompletionSource,d=c?c.onCancellationRequested((()=>l.destroy(new Error("Cancelled.")))):null;try{l.once("connect",(()=>{u.resolve()})),l.once("error",(e=>{u.reject(e)})),await u.promise}catch(e){if(!(e instanceof Error)||(null==c?void 0:c.isCancellationRequested))throw e;a(s.TraceLevel.Error,s.SshTraceEventIds.portForwardConnectionFailed,`${h.session} PortForwardingService forwarded channel #${h.channelId} connection to ${r}:${o} failed: ${e.message}`,e),t.failureReason=s.SshChannelOpenFailureReason.connectFailed,t.failureDescription=e.message}finally{null==d||d.dispose()}const p=new i.ChannelForwarder(e,h,l);a(s.TraceLevel.Info,s.SshTraceEventIds.portForwardConnectionOpened,`${h.session} PortForwardingService forwarded channel #${h.channelId} connection to ${r}:${o}.`),e.channelForwarders.push(p)}}t.RemotePortForwarder=a},4645:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemotePortStreamer=void 0;const n=r(8231),s=r(4322),i=r(6127);class o extends i.RemotePortConnector{constructor(e,t,r){super(e,t,r),this.streamOpenedEmitter=new n.Emitter,this.onStreamOpened=this.streamOpenedEmitter.event}async onChannelOpening(e,t){const r=new s.SshStream(e.channel);this.streamOpenedEmitter.fire(r)}}t.RemotePortStreamer=o},4700:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshClient=void 0;const n=r(1808),s=r(4322);class i{constructor(e){if(this.config=e,this.sessions=[],this.trace=(e,t,r,n)=>{},!e)throw new TypeError("SshSessionConfiguration is required.")}async openSession(e,t,r){if(!e)throw new TypeError("Server host is reqiured.");const n=await this.openConnection(e,t,r),i=new s.SshClientSession(this.config);return i.trace=this.trace,await i.connect(n,r),this.sessions.push(i),i}async openConnection(e,t,r){const o=new n.Socket;return await new Promise(((n,a)=>{if(o.on("connect",n),o.on("error",a),r){if(r.isCancellationRequested)return void a(new s.CancellationError);r.onCancellationRequested(a)}o.connect(t||i.defaultServerPort,e)})),new s.NodeStream(o)}async reconnectSession(e,t,r,n){const s=await this.openConnection(t,r,n);await e.reconnect(s,n)}dispose(){for(;this.sessions.length>0;)this.sessions.shift().dispose()}}t.SshClient=i,i.defaultServerPort=22},3878:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshServer=void 0;const n=r(8231),s=r(4322),i=r(4547);t.SshServer=class{constructor(e){if(this.config=e,this.sessions=[],this.trace=(e,t,r,n)=>{},this.errorEmitter=new n.Emitter,this.onError=this.errorEmitter.event,this.sessionOpenedEmitter=new n.Emitter,this.onSessionOpened=this.sessionOpenedEmitter.event,this.credentials={publicKeys:[]},this.tcpListenerFactory=new i.DefaultTcpListenerFactory,!e)throw new TypeError("SshSessionConfiguration is required.");e.protocolExtensions.includes(s.SshProtocolExtensionNames.sessionReconnect)&&(this.reconnectableSessions=[])}async acceptSessions(e,t){t||(t="0.0.0.0");const r="0.0.0.0"===t?"port ":t+":";try{this.tcpListener=await this.tcpListenerFactory.createTcpListener(t,e,!1)}catch(t){if(!(t instanceof Error))throw t;throw this.trace(s.TraceLevel.Error,s.SshTraceEventIds.serverListenFailed,`SshServer failed to listen on ${r}${e}: ${t.message}`,t),t}this.tcpListener.addListener("connection",this.acceptSession.bind(this)),this.trace(s.TraceLevel.Info,s.SshTraceEventIds.serverListening,`SshServer listening on ${r}${e}.`)}async acceptConnection(e){return e.setNoDelay(!0),new s.NodeStream(e)}async acceptSession(e){this.trace(s.TraceLevel.Info,s.SshTraceEventIds.serverClientConnected,"SshServer client connected.");const t=await this.acceptConnection(e),r=new s.SshServerSession(this.config,this.reconnectableSessions);r.trace=this.trace,r.credentials=this.credentials,this.sessions.push(r),r.onClosed((e=>{const t=this.sessions.indexOf(r);t>=0&&this.sessions.splice(t,1)})),this.sessionOpenedEmitter.fire(r);try{await r.connect(t)}catch(e){if(!(e instanceof Error))throw e;e instanceof s.SshConnectionError?await r.close(e.reason||s.SshDisconnectReason.connectionLost,e.message,e):await r.close(s.SshDisconnectReason.protocolError,e.message,e),this.errorEmitter.fire(e)}}dispose(){var e;null===(e=this.tcpListener)||void 0===e||e.close()}}},4547:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultTcpListenerFactory=void 0;const n=r(1808);t.DefaultTcpListenerFactory=class{async createTcpListener(e,t,r,s){if(!e)throw new TypeError("Local IP address is required.");if(!Number.isInteger(t)||t<0)throw new TypeError("Local port must be a non-negative integer.");const i=n.createServer();return await new Promise(((r,s)=>{i.listen({host:e,port:t,ipv6Only:n.isIPv6(e),exclusive:!1}),i.on("listening",r),i.on("error",s)})),i}}},5652:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.curves=void 0,t.curves=[{shortName:"P-256",name:"nistp256",oid:"1.2.840.10045.3.1.7",keySize:256},{shortName:"P-384",name:"nistp384",oid:"1.3.132.0.34",keySize:384},{shortName:"P-521",name:"nistp521",oid:"1.3.132.0.35",keySize:521}]},6827:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptionAlgorithm=void 0,t.EncryptionAlgorithm=class{constructor(e){this.name=e}}},4826:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HmacAlgorithm=void 0,t.HmacAlgorithm=class{constructor(e,t,r,n){this.name=e,this.algorithmName=t,this.keyLength=r,this.digestLength=n}}},6133:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyExchangeAlgorithm=void 0,t.KeyExchangeAlgorithm=class{constructor(e,t,r,n){this.name=e,this.keySizeInBits=t,this.hashAlgorithmName=r,this.hashDigestLength=n}}},8661:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sec1KeyFormatter=t.Pkcs1KeyFormatter=t.parsePem=t.formatPem=void 0;const n=r(2309),s=r(3202),i=r(5652);t.formatPem=function(e,t){return`-----BEGIN ${t}-----\n`+e.toString("base64").match(/.{1,64}/g).join("\n")+"\n"+`-----END ${t}-----\n`},t.parsePem=function(e){const t=e.replace(/-+[^-\n]+KEY-+/g,"").replace(/\s/g,"");return Buffer.from(t,"base64")},t.Pkcs1KeyFormatter=class{static formatRsaPublic(e){const t=new s.DerWriter(Buffer.alloc(1024));return t.writeInteger(e.modulus),t.writeInteger(e.exponent),t.toBuffer()}static formatRsaPrivate(e){if(!(e.d&&e.p&&e.q&&e.dp&&e.dq&&e.qi))throw new Error("Missing private key parameters.");const t=new s.DerWriter(Buffer.alloc(2048));return t.writeInteger(n.BigInt.fromInt32(0)),t.writeInteger(e.modulus),t.writeInteger(e.exponent),t.writeInteger(e.d),t.writeInteger(e.p),t.writeInteger(e.q),t.writeInteger(e.dp),t.writeInteger(e.dq),t.writeInteger(e.qi),t.toBuffer()}static parseRsaPublic(e){const t=new s.DerReader(e);return{modulus:t.readInteger(),exponent:t.readInteger()}}static parseRsaPrivate(e){const t=new s.DerReader(e);return t.readInteger(),{modulus:t.readInteger(),exponent:t.readInteger(),d:t.readInteger(),p:t.readInteger(),q:t.readInteger(),dp:t.readInteger(),dq:t.readInteger(),qi:t.readInteger()}}};class o{static formatECPublic(e){const t=i.curves.find((t=>t.oid===e.curve.oid)),r=Math.ceil(t.keySize/8),n=new s.DerWriter(Buffer.alloc(512)),a=new s.DerWriter(Buffer.alloc(100));a.writeObjectIdentifier(o.ecPublicKeyOid),a.writeObjectIdentifier(e.curve.oid),n.writeSequence(a);const c=e.x.toBytes({unsigned:!0,length:r}),h=e.y.toBytes({unsigned:!0,length:r}),l=Buffer.alloc(1+c.length+h.length);return l[0]=4,c.copy(l,1),h.copy(l,1+c.length),n.writeBitString(l),n.toBuffer()}static formatECPrivate(e){const t=i.curves.find((t=>t.oid===e.curve.oid)),r=Math.ceil(t.keySize/8),o=new s.DerWriter(Buffer.alloc(512));o.writeInteger(n.BigInt.fromInt32(1)),o.writeOctetString(e.d.toBytes({unsigned:!0,length:r}));const a=new s.DerWriter(Buffer.alloc(100));a.writeObjectIdentifier(e.curve.oid),o.writeTagged(0,a);const c=e.x.toBytes({unsigned:!0,length:r}),h=e.y.toBytes({unsigned:!0,length:r}),l=Buffer.alloc(1+c.length+h.length);l[0]=4,c.copy(l,1),h.copy(l,1+c.length);const u=new s.DerWriter(Buffer.alloc(512));return u.writeBitString(l),o.writeTagged(1,u),o.toBuffer()}static parseECPublic(e){var t;const r=new s.DerReader(e),a=r.readSequence(),c=a.readObjectIdentifier();if(c!==o.ecPublicKeyOid)throw new Error(`Unexpected key type OID: ${c}`);const h=a.readObjectIdentifier(),l=null===(t=i.curves.find((e=>e.oid===h)))||void 0===t?void 0:t.name,u=r.readBitString();if(u.length%2!=1)throw new Error(`Unexpected key data length: ${u.length}`);const d=n.BigInt.fromBytes(u.slice(1,1+(u.length-1)/2),{unsigned:!0}),p=n.BigInt.fromBytes(u.slice(1+(u.length-1)/2),{unsigned:!0});return{curve:{name:l,oid:h},x:d,y:p}}static parseECPrivate(e){var t;const r=new s.DerReader(e),o=r.readInteger().toInt32();if(1!==o)throw new Error(`Unsupported SEC1 format version: ${o}`);const a=n.BigInt.fromBytes(r.readOctetString(),{unsigned:!0}),c=r.tryReadTagged(0);if(!c)throw new Error("SEC1 curve info not found.");const h=c.readObjectIdentifier(),l=null===(t=i.curves.find((e=>e.oid===h)))||void 0===t?void 0:t.name,u=r.tryReadTagged(1);if(!u)throw new Error("SEC1 public key data not found.");const d=u.readBitString();if(d.length%2!=1)throw new Error(`Unexpected key data length: ${d.length}`);const p=n.BigInt.fromBytes(d.slice(1,1+(d.length-1)/2),{unsigned:!0}),f=n.BigInt.fromBytes(d.slice(1+(d.length-1)/2),{unsigned:!0});return{curve:{name:l,oid:h},x:p,y:f,d:a}}}t.Sec1KeyFormatter=o,o.ecPublicKeyOid="1.2.840.10045.2.1"},3416:(e,t,r)=>{"use strict";t.b=void 0;const n=r(6113),s=r(4300),i=r(5259),o=r(5652),a=r(2309),c=r(3202),h=r(5879),l=r(8661),u=process.versions.node.split(".").map((e=>parseInt(e,10))),d=u[0]>10||10===u[0]&&u[1]>=12,p=u[0]>11||11===u[0]&&u[1]>=6;class f{constructor(e){this.comment=null,e&&(this.algorithmName=e)}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return this.algorithmName}get algorithmName(){return this.algorithm}set algorithmName(e){const t=e.split("-")[2];if(this.curve=o.curves.find((e=>e.name===t)),!this.curve)throw new Error("Invalid or unsupported ECDSA algorithm: "+e);this.algorithm=e}generate(){return d&&p?this.generateNodeKeyPairObjects():d?this.generateNodeKeyPairBuffers():this.generateExternalKeyPair()}async generateNodeKeyPairObjects(){[this.publicKey,this.privateKey]=await new Promise(((e,t)=>{const r={namedCurve:this.curve.shortName};try{n.generateKeyPair("ec",r,((r,n,s)=>{r?t(r):e([n,s])}))}catch(e){t(e)}}))}async generateNodeKeyPairBuffers(){[this.publicKey,this.privateKey]=await new Promise(((e,t)=>{const r={namedCurve:this.curve.shortName,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"sec1",format:"pem",cipher:void 0,passphrase:void 0}};try{n.generateKeyPair("ec",r,((r,n,s)=>{r?t(r):e([n,s])}))}catch(e){t(e)}}))}async generateExternalKeyPair(){throw new Error("This version of node does not support generating key pairs. Use node >= 10.12.")}async setPublicKeyBytes(e,t){if(!e)throw new TypeError("Buffer is required.");const r=new h.SshDataReader(e),s=r.readString("ascii");this.algorithmName=t||s;const i=r.readString("ascii");this.algorithmName=`ecdsa-sha2-${i}`;const o=r.readBinary(),c=a.BigInt.fromBytes(o.slice(1,1+(o.length-1)/2),{unsigned:!0}),u=a.BigInt.fromBytes(o.slice(1+(o.length-1)/2),{unsigned:!0}),d=l.Sec1KeyFormatter.formatECPublic({curve:{name:this.curve.name,oid:this.curve.oid},x:c,y:u});this.publicKey=p?n.createPublicKey({key:d,type:"spki",format:"der"}):(0,l.formatPem)(d,"PUBLIC KEY")}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;t="string"==typeof this.publicKey?(0,l.parsePem)(this.publicKey):this.publicKey.export({type:"spki",format:"der"});const r=l.Sec1KeyFormatter.parseECPublic(t);e=e||this.algorithmName||this.keyAlgorithmName;const n=new h.SshDataWriter(s.Buffer.alloc(512));n.writeString(e,"ascii"),n.writeString(this.curve.name,"ascii");const i=Math.ceil(this.curve.keySize/8),o=r.x.toBytes({unsigned:!0,length:i}),a=r.y.toBytes({unsigned:!0,length:i});return n.writeUInt32(1+o.length+a.length),n.writeByte(4),n.write(o),n.write(a),n.toBuffer()}async importParameters(e){if(!e.curve)throw new TypeError("A curve is required.");let t;if(e.curve.oid){if(t=o.curves.find((t=>t.oid===e.curve.oid)),!t)throw new Error(`Unsupported curve OID: ${e.curve.oid}`)}else{if(!e.curve.name)throw new TypeError("A curve OID or name is required.");if(t=o.curves.find((t=>t.name===e.curve.name)),!t)throw new Error(`Unsupported curve: ${e.curve.name}`)}this.algorithmName="ecdsa-sha2-"+t.name;const r=l.Sec1KeyFormatter.formatECPublic(e);if(this.publicKey=p?n.createPublicKey({key:r,type:"spki",format:"der"}):(0,l.formatPem)(r,"EC PUBLIC KEY"),e.d){const t=l.Sec1KeyFormatter.formatECPrivate(e);this.privateKey=p?n.createPrivateKey({key:t,type:"sec1",format:"der"}):(0,l.formatPem)(t,"EC PRIVATE KEY")}else this.privateKey=void 0}async exportParameters(){var e,t;if(!this.publicKey)throw new Error("Key is not present.");let r;return r="string"==typeof this.publicKey?(0,l.parsePem)(null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey):(null!==(t=this.privateKey)&&void 0!==t?t:this.publicKey).export({type:this.privateKey?"sec1":"spki",format:"der"}),this.privateKey?l.Sec1KeyFormatter.parseECPrivate(r):l.Sec1KeyFormatter.parseECPublic(r)}dispose(){}}class g extends i.PublicKeyAlgorithm{constructor(e,t){super(e,e,t)}createKeyPair(){return new f(this.name)}async generateKeyPair(){const e=new f(this.name);return await e.generate(),e}createSigner(e){if(!(e instanceof f))throw new TypeError("ECDSA key pair object expected.");return new m(e,g.convertHashAlgorithmName(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof f))throw new TypeError("ECDSA key pair object expected.");return new m(e,g.convertHashAlgorithmName(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA")}static getSignatureLength(e){return 2*(5+Math.ceil(e/8))}}t.b=g,g.ecdsaSha2Nistp256="ecdsa-sha2-nistp256",g.ecdsaSha2Nistp384="ecdsa-sha2-nistp384",g.ecdsaSha2Nistp521="ecdsa-sha2-nistp521",g.curves=o.curves,g.KeyPair=f;class m{constructor(e,t){this.keyPair=e,this.hashAlgorithmName=t}get digestLength(){const e=this.keyPair.curve;return e?g.getSignatureLength(e.keySize):0}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");const t=n.createSign(this.hashAlgorithmName);t.update(e);let r=t.sign(this.keyPair.privateKey);const i=new c.DerReader(r),o=i.readInteger(),a=i.readInteger(),l=Math.ceil(this.keyPair.curve.keySize/8),u=new h.SshDataWriter(s.Buffer.alloc(this.digestLength));return u.writeBinary(o.toBytes({unsigned:!0,length:l+1})),u.writeBinary(a.toBytes({unsigned:!0,length:l+1})),r=u.toBuffer(),r}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const r=new h.SshDataReader(t),i=r.readBigInt(),o=r.readBigInt(),a=new c.DerWriter(s.Buffer.alloc(t.length));a.writeInteger(i),a.writeInteger(o),t=a.toBuffer();const l=n.createVerify(this.hashAlgorithmName);return l.update(e),l.verify(this.keyPair.publicKey,t)}dispose(){}}},7397:(e,t,r)=>{"use strict";t.r=void 0;const n=r(6113),s=r(4300),i=r(6827);class o extends i.EncryptionAlgorithm{constructor(e,t,r,n){if(super(e),this.algorithmName=t,this.cipherMode=r,this.keySizeInBits=n,"AES"!==t)throw new Error(`Unsupported encryption algorithm: ${t}`);this.blockSizeInBits=o.getBlockSize(t)}get keyLength(){return this.keySizeInBits/8}get blockLength(){return this.blockSizeInBits/8}async createCipher(e,t,r){let n;if("CTR"===this.cipherMode||"CBC"===this.cipherMode)n=new a(e,this.keySizeInBits,this.blockSizeInBits,t,r,this.cipherMode);else{if("GCM"!==this.cipherMode)throw new Error(`Unsupported cipher mode: ${this.cipherMode}`);n=new c(e,this.keySizeInBits,this.blockSizeInBits,t,r)}return n}static getBlockSize(e){if("AES"===e)return 128;throw new Error(`Unsupported encryption algorithm: ${e}`)}}t.r=o;class a{constructor(e,t,r,s,i,o){this.isEncryption=e,this.keySizeInBits=t,this.blockSizeInBits=r;const a=`AES-${this.keySizeInBits}-${o}`;this.cipher=this.isEncryption?n.createCipheriv(a,s,i):n.createDecipheriv(a,s,i),this.cipher.setAutoPadding(!1)}get blockLength(){return this.blockSizeInBits/8}transform(e){const t=this.cipher.update(e);if(t.length!==e.length){const r=`Result from encrypt/decrypt has invalid length ${t.length}, expected ${e.length}.`;throw new Error(r)}return Promise.resolve(t)}dispose(){}}class c{constructor(e,t,r,n,i){this.isEncryption=e,this.keySizeInBits=t,this.blockSizeInBits=r,this.tag=null,this.algorithmName=`aes-${this.keySizeInBits}-gcm`,this.key=s.Buffer.alloc(n.length),n.copy(this.key),this.nonce=s.Buffer.alloc(12),i.copy(this.nonce,0,0,12),this.associatedData=s.Buffer.alloc(4)}get blockLength(){return this.blockSizeInBits/8}get digestLength(){return 16}get authenticatedEncryption(){return!0}transform(e){if(e.length%this.blockLength!=0){const t=`Encrypt/decrypt input has invalid length ${e.length}, not a multiple of block size ${this.blockLength}.`;throw new Error(t)}const t=this.isEncryption?n.createCipheriv(this.algorithmName,this.key,this.nonce):n.createDecipheriv(this.algorithmName,this.key,this.nonce),r=e.length;if(this.associatedData[0]=r>>>24,this.associatedData[1]=r>>>16,this.associatedData[2]=r>>>8,this.associatedData[3]=r,t.setAAD(this.associatedData),!this.isEncryption){if(!this.tag)throw new Error("AES-GCM tag was not set before decrypting.");t.setAuthTag(this.tag)}const s=t.update(e);if(s.length!==e.length){const t=`Result from encrypt/decrypt has invalid length ${s.length}, expected ${e.length}.`;throw new Error(t)}t.final(),this.isEncryption?this.tag=t.getAuthTag():this.tag=null;let i=12;for(;--i>=4&&(this.nonce[i]++,0===this.nonce[i]););return Promise.resolve(s)}async sign(e){if(!this.tag)throw new Error("AES-GCM tag was not obtained by encrypting.");return this.tag}async verify(e,t){if(t.length!==this.digestLength)throw new Error("Incorrect AES-GCM tag length.");return this.tag=t,!0}dispose(){}}},7259:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeHmac=void 0;const n=r(6113),s=r(4300),i=r(4826);class o extends i.HmacAlgorithm{constructor(e,t,r=!1){super(e,t,o.getHashKeyLength(t),o.getHashDigestLength(t)),this.encryptThenMac=r}async createSigner(e){return new a(o.getNodeHashAlgorithmName(this.algorithmName),this.digestLength,this.encryptThenMac,e)}async createVerifier(e){return new a(o.getNodeHashAlgorithmName(this.algorithmName),this.digestLength,this.encryptThenMac,e)}static getHashKeyLength(e){if("SHA2-512"===e)return 64;if("SHA2-384"===e)return 48;if("SHA2-256"===e)return 32;throw new Error(`Unsupported hash algorithm: ${e}`)}static getHashDigestLength(e){return this.getHashKeyLength(e)}static getNodeHashAlgorithmName(e){if("SHA2-512"===e)return"sha512";if("SHA2-384"===e)return"sha384";if("SHA2-256"===e)return"sha256";throw new Error(`Unsupported hash algorithm: ${e}`)}}t.NodeHmac=o;class a{constructor(e,t,r,i){this.algorithmName=e,this.digestLength=t,this.encryptThenMac=r,this.key=n.createSecretKey?n.createSecretKey(i):s.Buffer.from(i)}async sign(e){const t=n.createHmac(this.algorithmName,this.key);return t.update(e),t.digest()}async verify(e,t){const r=n.createHmac(this.algorithmName,this.key);return r.update(e),r.digest().equals(t)}dispose(){}}},8308:(e,t,r)=>{"use strict";t.th=t.yk=void 0;const n=r(6113),s=r(4300),i=r(6133),o=r(7259),a=r(2309);class c extends i.KeyExchangeAlgorithm{constructor(e,t,r){super(e,t,r,o.NodeHmac.getHashDigestLength(r))}createKeyExchange(){return new h(this.keySizeInBits,o.NodeHmac.getNodeHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.yk=c;class h{constructor(e,t,r){switch(this.hashAlgorithmName=t,this.digestLength=r,e){case 1024:this.dh=n.getDiffieHellman("modp2");break;case 2048:this.dh=n.getDiffieHellman("modp14");break;case 4096:this.dh=n.getDiffieHellman("modp16");break;default:throw new Error("Invalid DH bit length.")}}startKeyExchange(){const e=this.dh.generateKeys(),t=a.BigInt.fromBytes(e,{unsigned:!0}).toBytes();return Promise.resolve(t)}decryptKeyExchange(e){const t=this.dh.computeSecret(e),r=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(r)}async sign(e){const t=n.createHash(this.hashAlgorithmName);return t.update(e),s.Buffer.from(t.digest())}dispose(){}}class l extends i.KeyExchangeAlgorithm{constructor(e,t,r){super(e,t,r,o.NodeHmac.getHashDigestLength(r))}createKeyExchange(){return new u(this.keySizeInBits,o.NodeHmac.getNodeHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.th=l;class u{constructor(e,t,r){switch(this.hashAlgorithmName=t,this.digestLength=r,e){case 256:this.ecdh=n.createECDH("prime256v1");break;case 384:this.ecdh=n.createECDH("secp384r1");break;case 521:this.ecdh=n.createECDH("secp521r1");break;default:throw new Error("Invalid ECDH bit length.")}}startKeyExchange(){const e=this.ecdh.generateKeys();return Promise.resolve(e)}decryptKeyExchange(e){const t=this.ecdh.computeSecret(e),r=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(r)}async sign(e){const t=n.createHash(this.hashAlgorithmName);return t.update(e),s.Buffer.from(t.digest())}dispose(){}}},945:(e,t,r)=>{"use strict";t.e=void 0;const n=r(6113);t.e=class{getBytes(e){n.randomBytes(e.length).copy(e)}}},2870:(e,t,r)=>{"use strict";t.G=void 0;const n=r(6113),s=r(4300),i=r(5259),o=r(5879),a=r(7259),c=r(8661),h=process.versions.node.split(".").map((e=>parseInt(e,10))),l=h[0]>10||10===h[0]&&h[1]>=12,u=h[0]>11||11===h[0]&&h[1]>=6;class d{constructor(){this.comment=null}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return p.keyAlgorithmName}generate(e){return e=null!=e?e:d.defaultKeySize,l&&u?this.generateNodeKeyPairObjects(e):l?this.generateNodeKeyPairBuffers(e):this.generateExternalKeyPair(e)}async generateNodeKeyPairObjects(e){[this.publicKey,this.privateKey]=await new Promise(((t,r)=>{const s={modulusLength:e};try{n.generateKeyPair("rsa",s,((e,n,s)=>{e?r(e):t([n,s])}))}catch(e){r(e)}}))}async generateNodeKeyPairBuffers(e){[this.publicKey,this.privateKey]=await new Promise(((t,r)=>{const s={modulusLength:e,publicKeyEncoding:{type:"pkcs1",format:"pem"},privateKeyEncoding:{type:"pkcs1",format:"pem",cipher:void 0,passphrase:void 0}};try{n.generateKeyPair("rsa",s,((e,n,s)=>{e?r(e):t([n,s])}))}catch(e){r(e)}}))}async generateExternalKeyPair(e){const t=new(await Promise.resolve().then((()=>r(6807))))({b:e});this.publicKey=t.exportKey("pkcs1-public-pem"),this.privateKey=t.exportKey("pkcs1-private-pem"),this.publicKey.endsWith("\n")||(this.publicKey+="\n"),this.privateKey.endsWith("\n")||(this.privateKey+="\n")}async setPublicKeyBytes(e){if(!e)throw new TypeError("Buffer is required.");const t=new o.SshDataReader(e),r=t.readString("ascii");if(r!==this.keyAlgorithmName&&r!==p.rsaWithSha256&&r!==p.rsaWithSha512)throw new Error(`Invalid RSA key algorithm: ${r}`);const s=t.readBigInt(),i=t.readBigInt();e=c.Pkcs1KeyFormatter.formatRsaPublic({modulus:i,exponent:s}),this.publicKey=u?n.createPublicKey({key:e,type:"pkcs1",format:"der"}):(0,c.formatPem)(e,"RSA PUBLIC KEY")}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;e||(e=this.keyAlgorithmName),t="string"==typeof this.publicKey?(0,c.parsePem)(this.publicKey):this.publicKey.export({type:"pkcs1",format:"der"});const r=c.Pkcs1KeyFormatter.parseRsaPublic(t),n=s.Buffer.alloc(512),i=new o.SshDataWriter(n);return i.writeString(e,"ascii"),i.writeBigInt(r.exponent),i.writeBigInt(r.modulus),t=i.toBuffer(),t}async importParameters(e){if(u)this.publicKey=n.createPublicKey({key:c.Pkcs1KeyFormatter.formatRsaPublic(e),format:"der",type:"pkcs1"}),e.d?this.privateKey=n.createPrivateKey({key:c.Pkcs1KeyFormatter.formatRsaPrivate(e),format:"der",type:"pkcs1"}):this.privateKey=void 0;else{const t=c.Pkcs1KeyFormatter.formatRsaPublic(e);if(this.publicKey=(0,c.formatPem)(t,"RSA PUBLIC KEY"),e.d){const t=c.Pkcs1KeyFormatter.formatRsaPrivate(e);this.privateKey=(0,c.formatPem)(t,"RSA PRIVATE KEY")}}}async exportParameters(){var e,t;if(!this.publicKey)throw new Error("Public key not set.");let r;return r=u?(null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey).export({format:"der",type:"pkcs1"}):(0,c.parsePem)(null!==(t=this.privateKey)&&void 0!==t?t:this.publicKey),this.privateKey?c.Pkcs1KeyFormatter.parseRsaPrivate(r):c.Pkcs1KeyFormatter.parseRsaPublic(r)}dispose(){this.publicKey=void 0,this.privateKey=void 0}}d.defaultKeySize=2048;class p extends i.PublicKeyAlgorithm{constructor(e,t){super(e,p.keyAlgorithmName,t)}createKeyPair(){return new d}async generateKeyPair(e){const t=new d;return await t.generate(e),t}createSigner(e){if(!(e instanceof d))throw new TypeError("RSA key pair object expected.");return new f(e,p.convertHashAlgorithmName(this.hashAlgorithmName),a.NodeHmac.getHashDigestLength(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof d))throw new TypeError("RSA key pair object expected.");return new f(e,p.convertHashAlgorithmName(this.hashAlgorithmName),a.NodeHmac.getHashDigestLength(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA")}}t.G=p,p.keyAlgorithmName="ssh-rsa",p.rsaWithSha256="rsa-sha2-256",p.rsaWithSha512="rsa-sha2-512",p.KeyPair=d;class f{constructor(e,t,r){this.keyPair=e,this.hashAlgorithmName=t,this.digestLength=r}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");const t=n.createSign(this.hashAlgorithmName);return t.update(e),t.sign(this.keyPair.privateKey)}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const r=n.createVerify(this.hashAlgorithmName);return r.update(e),r.verify(this.keyPair.publicKey,t)}dispose(){}}},5259:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PublicKeyAlgorithm=void 0;const n=r(4300),s=r(5879);t.PublicKeyAlgorithm=class{constructor(e,t,r){this.name=e,this.keyAlgorithmName=t,this.hashAlgorithmName=r}readSignatureData(e){const t=new s.SshDataReader(e),r=t.readString("ascii");if(r!==this.name)throw new Error(`Mismatched public key algorithm: got '${r}', expected '${this.name}'.`);return t.readBinary()}createSignatureData(e){const t=new s.SshDataWriter(n.Buffer.alloc(this.name.length+e.length+20));return t.writeString(this.name,"ascii"),t.writeBinary(e),t.toBuffer()}}},9483:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.algorithmNames=t.SshAlgorithms=t.Encryption=t.ECDsa=t.Rsa=t.HmacAlgorithm=t.EncryptionAlgorithm=t.PublicKeyAlgorithm=t.KeyExchangeAlgorithm=void 0;const n=r(6133);Object.defineProperty(t,"KeyExchangeAlgorithm",{enumerable:!0,get:function(){return n.KeyExchangeAlgorithm}});const s=r(5259);Object.defineProperty(t,"PublicKeyAlgorithm",{enumerable:!0,get:function(){return s.PublicKeyAlgorithm}});const i=r(6827);Object.defineProperty(t,"EncryptionAlgorithm",{enumerable:!0,get:function(){return i.EncryptionAlgorithm}});const o=r(4826);Object.defineProperty(t,"HmacAlgorithm",{enumerable:!0,get:function(){return o.HmacAlgorithm}});const a=!("object"!=typeof crypto||!crypto.subtle),c=r(2940),h=r(3662),l=r(9239),u=r(3749),d=r(4375),p=r(9067),f=a?c.WebDiffieHellman:r(8308).yk,g=a?c.WebECDiffieHellman:r(8308).th,m=a?h.WebRsa:r(2870).G;t.Rsa=m;const y=a?l.WebECDsa:r(3416).b;t.ECDsa=y;const v=a?u.WebEncryption:r(7397).r;t.Encryption=v;const w=a?d.WebHmac:r(7259).NodeHmac,S=a?p.WebRandom:r(945).e;class b{}t.SshAlgorithms=b,b.keyExchange={none:null,dhGroup14Sha256:new f("diffie-hellman-group14-sha256",2048,"SHA2-256"),dhGroup16Sha512:new f("diffie-hellman-group16-sha512",4096,"SHA2-512"),ecdhNistp256Sha256:new g("ecdh-sha2-nistp256",256,"SHA2-256"),ecdhNistp384Sha384:new g("ecdh-sha2-nistp384",384,"SHA2-384"),ecdhNistp521Sha512:new g("ecdh-sha2-nistp521",521,"SHA2-512")},b.publicKey={none:null,rsaWithSha256:new m("rsa-sha2-256","SHA2-256"),rsaWithSha512:new m("rsa-sha2-512","SHA2-512"),ecdsaSha2Nistp256:new y("ecdsa-sha2-nistp256","SHA2-256"),ecdsaSha2Nistp384:new y("ecdsa-sha2-nistp384","SHA2-384"),ecdsaSha2Nistp521:new y("ecdsa-sha2-nistp521","SHA2-512")},b.encryption={none:null,aes256Ctr:new v("aes256-ctr","AES","CTR",256),aes256Gcm:new v("aes256-gcm@openssh.com","AES","GCM",256)},b.hmac={none:null,hmacSha256:new w("hmac-sha2-256","SHA2-256"),hmacSha512:new w("hmac-sha2-512","SHA2-512"),hmacSha256Etm:new w("hmac-sha2-256-etm@openssh.com","SHA2-256",!0),hmacSha512Etm:new w("hmac-sha2-512-etm@openssh.com","SHA2-512",!0)},b.compression={none:null},b.random=new S,t.algorithmNames=function(e){return e.map((e=>e?e.name:"none"))}},6205:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsonWebKeyFormatter=void 0;const n=r(2309),s=r(5652);class i{static formatRsa(e,t){const r=i.formatBigInt;let n;if(!1!==t&&e.d&&e.p&&e.q&&e.dp&&e.dq&&e.qi)n={kty:"RSA",n:r(e.modulus),e:r(e.exponent),d:r(e.d),p:r(e.p),q:r(e.q),dp:r(e.dp),dq:r(e.dq),qi:r(e.qi)};else{if(t)throw new Error("Missing private key parameters.");n={kty:"RSA",n:r(e.modulus),e:r(e.exponent)}}return n}static parseRsa(e,t){if("RSA"!==(null==e?void 0:e.kty)||!e.n||!e.e)throw new Error("Invalid RSA JWK.");const r=i.parseBigInt;let n;return n=!1!==t&&e.d&&e.p&&e.q&&e.dp&&e.dq&&e.qi?{modulus:r(e.n),exponent:r(e.e),d:r(e.d),p:r(e.p),q:r(e.q),dp:r(e.dp),dq:r(e.dq),qi:r(e.qi)}:{modulus:r(e.n),exponent:r(e.e)},n}static formatEC(e,t){const r=i.formatBigInt,n=s.curves.find((t=>t.oid===e.curve.oid||t.name===e.curve.name||t.shortName===e.curve.name)),o=Math.ceil(n.keySize/8),a={kty:"EC",crv:e.curve.name,x:r(e.x,o),y:r(e.y,o)};if(!1!==t&&e.d)a.d=r(e.d,o);else if(t)throw new Error("Missing private key parameters.");return a}static parseEC(e,t){if("EC"!==(null==e?void 0:e.kty)||!(e.crv&&e.x&&e.y))throw new Error("Invalid EC JWK.");const r=i.parseBigInt,n={curve:{name:e.crv},x:r(e.x),y:r(e.y)};return!1!==t&&e.d&&(n.d=r(e.d)),n}static formatBigInt(e,t){return i.base64UrlEncode(e.toBytes({unsigned:!0,length:t}))}static parseBigInt(e){return n.BigInt.fromBytes(Buffer.from(e,"base64"),{unsigned:!0})}static base64UrlEncode(e){return e.toString("base64").replace(/=+$/g,"").replace(/\+/g,"-").replace(/\//g,"_")}}t.JsonWebKeyFormatter=i},9239:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebECDsa=void 0;const n=r(4300),s=r(5259),i=r(5879),o=r(5652),a=r(2309),c=r(6205);class h{constructor(e){this.comment=null,e&&(this.algorithmName=e)}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return this.algorithmName}get algorithmName(){return this.algorithm}set algorithmName(e){const t=e.split("-")[2];if(this.curve=o.curves.find((e=>e.name===t)),!this.curve)throw new Error("Invalid or unsupported ECDSA algorithm: "+e);this.algorithm=e}async generate(){try{const e={name:"ECDSA",namedCurve:this.curve.shortName},t=await crypto.subtle.generateKey(e,!0,["sign","verify"]);this.publicKey=t.publicKey,this.privateKey=t.privateKey}catch(e){throw new Error("Failed to generate RSA key pair: "+e)}}async setPublicKeyBytes(e,t){if(!e)throw new TypeError("Buffer is required.");const r=new i.SshDataReader(e),n=r.readString("ascii");if(this.algorithmName=t||n,r.readString("ascii")!==this.curve.name)throw new Error("EC curve name does not match.");const s=r.readBinary(),o=Math.ceil(this.curve.keySize/8),h=a.BigInt.fromBytes(s.slice(1,1+o),{unsigned:!0}),l=a.BigInt.fromBytes(s.slice(1+o,s.length),{unsigned:!0}),u=c.JsonWebKeyFormatter.formatEC({curve:{name:this.curve.shortName,oid:this.curve.oid},x:h,y:l});try{const e={name:"ECDSA",namedCurve:this.curve.shortName};this.publicKey=await crypto.subtle.importKey("jwk",u,e,!0,["verify"])}catch(e){throw new Error("Failed to import EC public key: "+e)}}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;try{t=await crypto.subtle.exportKey("jwk",this.publicKey)}catch(e){throw new Error("Failed to export ECDSA public key: "+e)}const r=n.Buffer.from(t.x,"base64"),s=n.Buffer.from(t.y,"base64"),o=Math.ceil(this.curve.keySize/8);if(r.length!==o||s.length!==o)throw new Error("Unexpected key length.");e=e||this.algorithmName||this.keyAlgorithmName;const a=n.Buffer.alloc(e.length+r.length+s.length+10),c=new i.SshDataWriter(a);return c.writeString(e,"ascii"),c.writeString(this.curve.name,"ascii"),c.writeUInt32(1+r.length+s.length),c.writeByte(4),c.write(r),c.write(s),c.toBuffer()}async importParameters(e){if(!e.curve)throw new TypeError("A curve is required.");let t;if(e.curve.oid){if(t=o.curves.find((t=>t.oid===e.curve.oid)),!t)throw new Error(`Unsupported curve OID: ${e.curve.oid}`)}else{if(!e.curve.name)throw new TypeError("A curve OID or name is required.");if(t=o.curves.find((t=>t.name===e.curve.name)),!t)throw new Error(`Unsupported curve: ${e.curve.name}`)}this.algorithmName="ecdsa-sha2-"+t.name;const r={name:"ECDSA",namedCurve:this.curve.shortName},n=c.JsonWebKeyFormatter.formatEC(e);n.crv=this.curve.shortName;try{n.d?(this.privateKey=await crypto.subtle.importKey("jwk",n,r,!0,["sign"]),n.d=void 0):this.privateKey=void 0,this.publicKey=await crypto.subtle.importKey("jwk",n,r,!0,["verify"])}catch(e){throw new Error("Failed to import ECDSA key pair: "+e)}}async exportParameters(){var e;const t=null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey;if(!t)throw new Error("Key not present.");let r;try{r=await crypto.subtle.exportKey("jwk",t)}catch(e){throw new Error("Failed to export ECDSA key pair: "+e)}const n=c.JsonWebKeyFormatter.parseEC(r);return n.curve={name:this.curve.name,oid:this.curve.oid},n}dispose(){}}class l extends s.PublicKeyAlgorithm{constructor(e,t){super(e,e,t)}createKeyPair(){return new h(this.name)}async generateKeyPair(){const e=new h(this.name);return await e.generate(),e}createSigner(e){if(!(e instanceof h))throw new TypeError("ECDSA key pair object expected.");const t=l.convertHashAlgorithmName(this.hashAlgorithmName);return new u(e,t)}createVerifier(e){if(!(e instanceof h))throw new TypeError("ECDSA key pair object expected.");const t=l.convertHashAlgorithmName(this.hashAlgorithmName);return new u(e,t)}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA-")}static getSignatureLength(e){return 2*(5+Math.ceil(e/8))}}t.WebECDsa=l,l.ecdsaSha2Nistp256="ecdsa-sha2-nistp256",l.ecdsaSha2Nistp384="ecdsa-sha2-nistp384",l.ecdsaSha2Nistp521="ecdsa-sha2-nistp521",l.curves=o.curves,l.KeyPair=h;class u{constructor(e,t){this.keyPair=e,this.hashAlgorithm=t}get digestLength(){const e=this.keyPair.curve;return e?l.getSignatureLength(e.keySize):0}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");let t=n.Buffer.from(await crypto.subtle.sign({name:"ECDSA",hash:{name:this.hashAlgorithm}},this.keyPair.privateKey,e));const r=Math.ceil(this.keyPair.curve.keySize/8);if(t.length!==2*r)throw new Error(`Unexpected signature length: ${t.length}`);const s=a.BigInt.fromBytes(t.slice(0,r),{unsigned:!0}),o=a.BigInt.fromBytes(t.slice(r,t.length),{unsigned:!0}),c=new i.SshDataWriter(n.Buffer.alloc(this.digestLength));return c.writeBinary(s.toBytes({unsigned:!0,length:r+1})),c.writeBinary(o.toBytes({unsigned:!0,length:r+1})),t=c.toBuffer(),t}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");const r=new i.SshDataReader(t),s=r.readBigInt(),o=r.readBigInt(),a=Math.ceil(this.keyPair.curve.keySize/8);return t=n.Buffer.alloc(2*a),s.toBytes({unsigned:!0,length:a}).copy(t,0),o.toBytes({unsigned:!0,length:a}).copy(t,a),await crypto.subtle.verify({name:"ECDSA",hash:{name:this.hashAlgorithm}},this.keyPair.publicKey,t,e)}dispose(){}}},3749:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebEncryption=void 0;const n=r(4300),s=r(6827);class i extends s.EncryptionAlgorithm{constructor(e,t,r,n){super(e),this.algorithmName=t,this.cipherMode=r,this.keySizeInBits=n,this.blockSizeInBits=i.getBlockSize(t)}get keyLength(){return this.keySizeInBits/8}get blockLength(){return this.blockSizeInBits/8}async createCipher(e,t,r){const n=new o(e,this.algorithmName,this.cipherMode,this.keySizeInBits,this.blockSizeInBits);return await n.init(t,r),n}static getBlockSize(e){if("AES"===e)return 128;throw new Error(`Unsupported encryption algorithm: ${e}`)}}t.WebEncryption=i;class o{get blockLength(){return this.blockSizeInBits/8}constructor(e,t,r,s,i){if(this.isEncryption=e,this.algorithmName=t,this.cipherMode=r,this.keySizeInBits=s,this.blockSizeInBits=i,this.tag=null,"AES"===this.algorithmName&&"CTR"===this.cipherMode)this.transform=this.aesCtr.bind(this,e);else if("AES"===this.algorithmName&&"CBC"===this.cipherMode)this.transform=this.aesCbc.bind(this,e);else{if("AES"!==this.algorithmName||"GCM"!==this.cipherMode)throw new Error(`Unsupported encryption algorithm: ${this.algorithmName}-${this.cipherMode}`);this.transform=this.aesGcm.bind(this,e),this.associatedData=n.Buffer.alloc(4),this.decryptBuffer=n.Buffer.alloc(4*this.blockLength)}}async init(e,t){try{const t=`${this.algorithmName}-${this.cipherMode}`;this.key=await crypto.subtle.importKey("raw",e,{name:t,length:this.keySizeInBits},!1,this.isEncryption?["encrypt"]:["decrypt"])}catch(e){throw new Error("Failed to initialize AES: "+e)}"GCM"===this.cipherMode?this.iv=n.Buffer.from(t.slice(0,12)):this.iv=n.Buffer.from(t)}async aesCtr(e,t){if(t.length%this.blockLength!=0){const e=`Encrypt/decrypt input has invalid length ${t.length}, not a multiple of block size ${this.blockLength}.`;throw new Error(e)}let r;if(r=e?n.Buffer.from(await crypto.subtle.encrypt({name:"AES-CTR",counter:this.iv,length:this.blockSizeInBits},this.key,t)):n.Buffer.from(await crypto.subtle.decrypt({name:"AES-CTR",counter:this.iv,length:this.blockSizeInBits},this.key,t)),r.length!==t.length){const e=`Result from encrypt/decrypt has invalid length ${r.length}, expected ${t.length}.`;throw new Error(e)}const s=t.length/this.blockLength;for(let e=0;e<s;e++)for(let e=this.iv.length-1;e>=0&&(this.iv[e]=this.iv[e]+1,!this.iv[e]);e--);return r}async aesCbc(e,t){if(e){let e=n.Buffer.from(await crypto.subtle.encrypt({name:"AES-CBC",iv:this.iv},this.key,t));return e=e.slice(0,t.length),e}return n.Buffer.from(await crypto.subtle.decrypt({name:"AES-CBC",iv:this.iv},this.key,t))}async aesGcm(e,t){if(t.length%this.blockLength!=0){const e=`Encrypt/decrypt input has invalid length ${t.length}, not a multiple of block size ${this.blockLength}.`;throw new Error(e)}const r=t.length;let s;if(this.associatedData[0]=r>>>24,this.associatedData[1]=r>>>16,this.associatedData[2]=r>>>8,this.associatedData[3]=r,e)s=n.Buffer.from(await crypto.subtle.encrypt({name:"AES-GCM",iv:this.iv,additionalData:this.associatedData,tagLength:8*this.digestLength},this.key,t)),this.tag=s.slice(s.length-this.digestLength),s=s.slice(0,s.length-this.digestLength);else{if(!this.tag)throw new Error("AES-GCM tag was not set before decrypting.");const e=t.length+this.digestLength;if(this.decryptBuffer.length<e){let t=2*this.decryptBuffer.length;for(;t<e;)t*=2;this.decryptBuffer=n.Buffer.alloc(t)}const r=this.decryptBuffer.slice(0,e);t.copy(r,0),this.tag.copy(r,t.length),s=n.Buffer.from(await crypto.subtle.decrypt({name:"AES-GCM",iv:this.iv,additionalData:this.associatedData,tagLength:8*this.digestLength},this.key,r))}if(s.length!==t.length){const e=`Result from encrypt/decrypt has invalid length ${s.length}, expected ${t.length}.`;throw new Error(e)}let i=12;for(;--i>=4&&(this.iv[i]++,0===this.iv[i]););return s}get digestLength(){return 16}get authenticatedEncryption(){return"GCM"===this.cipherMode}async sign(e){if(!this.tag)throw new Error("AES-GCM tag was not obtained by encrypting.");return this.tag}async verify(e,t){if(t.length!==this.digestLength)throw new Error("Incorrect AES-GCM tag length.");return this.tag=t,!0}dispose(){}}},4375:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebHmac=void 0;const n=r(4300),s=r(4826);class i extends s.HmacAlgorithm{constructor(e,t,r=!1){super(e,t,i.getHashKeyLength(t),i.getHashDigestLength(t)),this.encryptThenMac=r}async createSigner(e){const t=new o(this.algorithmName,!0,this.digestLength,this.encryptThenMac);return await t.init(e),t}async createVerifier(e){const t=new o(this.algorithmName,!1,this.digestLength,this.encryptThenMac);return await t.init(e),t}static getHashKeyLength(e){if("SHA2-512"===e)return 64;if("SHA2-384"===e)return 48;if("SHA2-256"===e)return 32;throw new Error(`Unsupported hash algorithm: ${e}`)}static getHashDigestLength(e){return this.getHashKeyLength(e)}static getWebHashAlgorithmName(e){if("SHA2-512"===e)return"SHA-512";if("SHA2-384"===e)return"SHA-384";if("SHA2-256"===e)return"SHA-256";throw new Error(`Unsupported hash algorithm: ${e}`)}}t.WebHmac=i;class o{constructor(e,t,r,n){this.algorithmName=e,this.isSigning=t,this.digestLength=r,this.encryptThenMac=n}async init(e){try{const t=this.algorithmName.replace("SHA2-","SHA-");this.key=await crypto.subtle.importKey("raw",e,{name:"HMAC",hash:{name:t}},!1,this.isSigning?["sign"]:["verify"])}catch(e){throw new Error("Failed to initialize HMAC: "+e)}}async sign(e){return n.Buffer.from(await crypto.subtle.sign({name:"HMAC",hash:{name:this.algorithmName}},this.key,e))}async verify(e,t){return await crypto.subtle.verify({name:"HMAC",hash:{name:this.algorithmName}},this.key,t,e)}dispose(){}}},2940:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebECDiffieHellman=t.WebDiffieHellman=void 0;const n=r(4300),s=r(9023),i=r(6133),o=r(4375),a=r(2309),c=r(6205);class h extends i.KeyExchangeAlgorithm{constructor(e,t,r){super(e,t,r,o.WebHmac.getHashDigestLength(r))}createKeyExchange(){return new l(this.keySizeInBits,o.WebHmac.getWebHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.WebDiffieHellman=h;class l{constructor(e,t,r){switch(this.hashAlgorithmName=t,this.digestLength=r,e){case 1024:this.dh=(0,s.getDiffieHellman)("modp2");break;case 2048:this.dh=(0,s.getDiffieHellman)("modp14");break;case 4096:this.dh=(0,s.getDiffieHellman)("modp16");break;default:throw new Error("Invalid DH bit length.")}}startKeyExchange(){const e=this.dh.generateKeys(),t=a.BigInt.fromBytes(e,{unsigned:!0}).toBytes();return Promise.resolve(t)}decryptKeyExchange(e){const t=this.dh.computeSecret(e),r=a.BigInt.fromBytes(t,{unsigned:!0}).toBytes();return Promise.resolve(r)}async sign(e){const t=await crypto.subtle.digest(this.hashAlgorithmName,e);return n.Buffer.from(t)}dispose(){}}class u extends i.KeyExchangeAlgorithm{constructor(e,t,r){super(e,t,r,o.WebHmac.getHashDigestLength(r))}createKeyExchange(){return new d(this.keySizeInBits,o.WebHmac.getWebHashAlgorithmName(this.hashAlgorithmName),this.hashDigestLength)}}t.WebECDiffieHellman=u;class d{constructor(e,t,r){this.bitLength=e,this.hashAlgorithmName=t,this.digestLength=r,this.algorithm={name:"ECDH",namedCurve:"P-"+e}}async startKeyExchange(){this.keyPair||(this.keyPair=await crypto.subtle.generateKey(this.algorithm,!0,["deriveBits"]));const e=await crypto.subtle.exportKey("jwk",this.keyPair.publicKey),t=c.JsonWebKeyFormatter.parseEC(e),r=Math.ceil(this.bitLength/8),s=n.Buffer.alloc(1+2*r);return s[0]=4,t.x.toBytes({unsigned:!0,length:r}).copy(s,1),t.y.toBytes({unsigned:!0,length:r}).copy(s,1+r),n.Buffer.from(s)}async decryptKeyExchange(e){if(!this.keyPair)throw new Error("Key exchange not started.");const t=e,r=c.JsonWebKeyFormatter.formatEC({curve:{name:this.algorithm.namedCurve},x:a.BigInt.fromBytes(t.slice(1,1+(t.length-1)/2),{unsigned:!0}),y:a.BigInt.fromBytes(t.slice(1+(t.length-1)/2),{unsigned:!0})}),s=await crypto.subtle.importKey("jwk",r,this.algorithm,!1,[]),i=n.Buffer.from(await crypto.subtle.deriveBits(Object.assign(Object.assign({},this.algorithm),{public:s}),this.keyPair.privateKey,8*Math.ceil(this.bitLength/8)));return a.BigInt.fromBytes(i,{unsigned:!0}).toBytes()}async sign(e){const t=await crypto.subtle.digest(this.hashAlgorithmName,e);return n.Buffer.from(t)}dispose(){}}},9067:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebRandom=void 0,t.WebRandom=class{getBytes(e){crypto.getRandomValues(e)}}},3662:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebRsa=void 0;const n=r(4300),s=r(5259),i=r(4375),o=r(5879),a=r(6205);class c{constructor(e){this.hashAlgorithm=e,this.comment=null}get hasPublicKey(){return!!this.publicKey}get hasPrivateKey(){return!!this.privateKey}get keyAlgorithmName(){return h.keyAlgorithmName}async generate(e){e=null!=e?e:c.defaultKeySize;try{const t={name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:this.hashAlgorithm}},r=await crypto.subtle.generateKey(t,!0,["sign","verify"]);this.publicKey=r.publicKey,this.privateKey=r.privateKey}catch(e){throw new Error("Failed to generate RSA key pair: "+e)}}async setPublicKeyBytes(e){if(!e)throw new TypeError("Buffer is required.");const t=new o.SshDataReader(e),r=t.readString("ascii");if(r!==this.keyAlgorithmName&&r!==h.rsaWithSha256&&r!==h.rsaWithSha512)throw new Error(`Invalid RSA key algorithm: ${r}`);const n=t.readBigInt(),s=t.readBigInt(),i=a.JsonWebKeyFormatter.formatRsa({modulus:s,exponent:n},!1);i.alg="RS"+this.hashAlgorithm.replace("SHA-",""),i.key_ops=["verify"];try{const e={name:"RSASSA-PKCS1-v1_5",hash:{name:this.hashAlgorithm}};this.publicKey=await crypto.subtle.importKey("jwk",i,e,!0,["verify"])}catch(e){throw new Error("Failed to import RSA public key: "+e)}}async getPublicKeyBytes(e){if(!this.publicKey)return null;let t;e||(e=this.keyAlgorithmName);try{t=await crypto.subtle.exportKey("jwk",this.publicKey)}catch(e){throw new Error("Failed to export RSA public key: "+e)}const{modulus:r,exponent:s}=a.JsonWebKeyFormatter.parseRsa(t,!1),i=n.Buffer.alloc(512),c=new o.SshDataWriter(i);return c.writeString(e,"ascii"),c.writeBigInt(s),c.writeBigInt(r),c.toBuffer()}async importParameters(e){const t=e.d?a.JsonWebKeyFormatter.formatRsa(e,!0):null,r=a.JsonWebKeyFormatter.formatRsa(e,!1),n={name:"RSASSA-PKCS1-v1_5",hash:{name:this.hashAlgorithm}};try{this.publicKey=await crypto.subtle.importKey("jwk",r,n,!0,["verify"]),this.privateKey=t?await crypto.subtle.importKey("jwk",t,n,!0,["sign"]):void 0}catch(e){if(!(e instanceof Error))throw e;throw new Error("Failed to import RSA key pair: "+e.message)}}async exportParameters(){var e;if(!this.publicKey)throw new Error("Public key not set.");let t;try{t=await crypto.subtle.exportKey("jwk",null!==(e=this.privateKey)&&void 0!==e?e:this.publicKey)}catch(e){if(!(e instanceof Error))throw e;throw new Error("Failed to export RSA public key: "+e.message)}return a.JsonWebKeyFormatter.parseRsa(t,!!this.privateKey)}dispose(){}}c.defaultKeySize=2048;class h extends s.PublicKeyAlgorithm{constructor(e,t){super(e,h.keyAlgorithmName,t)}createKeyPair(){const e=h.convertHashAlgorithmName(this.hashAlgorithmName);return new c(e)}async generateKeyPair(e){const t=h.convertHashAlgorithmName(this.hashAlgorithmName),r=new c(t);return await r.generate(e),r}createSigner(e){if(!(e instanceof c))throw new TypeError("RSA key pair object expected.");const t=h.convertHashAlgorithmName(this.hashAlgorithmName);return new l(e,t,i.WebHmac.getHashDigestLength(this.hashAlgorithmName))}createVerifier(e){if(!(e instanceof c))throw new TypeError("RSA key pair object expected.");const t=h.convertHashAlgorithmName(this.hashAlgorithmName);return new l(e,t,i.WebHmac.getHashDigestLength(this.hashAlgorithmName))}static convertHashAlgorithmName(e){return e.replace("SHA2-","SHA-")}}t.WebRsa=h,h.keyAlgorithmName="ssh-rsa",h.rsaWithSha256="rsa-sha2-256",h.rsaWithSha512="rsa-sha2-512",h.KeyPair=c;class l{constructor(e,t,r){this.keyPair=e,this.hashAlgorithm=t,this.digestLength=r}async sign(e){if(!this.keyPair.privateKey)throw new Error("Private key not set.");return await this.convertKeyHashAlgorithm(),n.Buffer.from(await crypto.subtle.sign("RSASSA-PKCS1-v1_5",this.keyPair.privateKey,e))}async verify(e,t){if(!this.keyPair.publicKey)throw new Error("Public key not set.");return await this.convertKeyHashAlgorithm(),await crypto.subtle.verify("RSASSA-PKCS1-v1_5",this.keyPair.publicKey,t,e)}async convertKeyHashAlgorithm(){if(this.keyPair.hashAlgorithm!==this.hashAlgorithm){const e=await this.keyPair.exportParameters();this.keyPair=new c(this.hashAlgorithm),await this.keyPair.importParameters(e)}}dispose(){}}},5443:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectDisposedError=t.SshChannelError=t.SshReconnectError=t.SshConnectionError=void 0;class r extends Error{constructor(e,t){super(e),this.reason=t}}t.SshConnectionError=r;class n extends Error{constructor(e,t){super(e),this.reason=t}}t.SshReconnectError=n;class s extends Error{constructor(e,t){super(e),this.reason=t}}t.SshChannelError=s;class i extends Error{constructor(e){var t,r;let n;n="string"==typeof e?e:"function"==typeof e?e.name+" disposed.":(null!==(r=null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name)&&void 0!==r?r:"Object ")+" disposed.",super(n)}}t.ObjectDisposedError=i},3886:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshAuthenticatingEventArgs=t.SshAuthenticationType=void 0;const n=r(8231);var s;!function(e){e[e.clientNone=0]="clientNone",e[e.clientHostBased=1]="clientHostBased",e[e.clientPassword=2]="clientPassword",e[e.clientPublicKeyQuery=3]="clientPublicKeyQuery",e[e.clientPublicKey=4]="clientPublicKey",e[e.serverPublicKey=10]="serverPublicKey"}(s=t.SshAuthenticationType||(t.SshAuthenticationType={})),t.SshAuthenticatingEventArgs=class{constructor(e,{username:t,password:r,publicKey:i,clientHostname:o,clientUsername:a},c){this.authenticationType=e;const h=({usernameRequired:e,passwordRequired:n,publicKeyRequired:s,clientHostnameRequired:c,clientUsernameRequired:h})=>"string"==typeof t==!!e&&"string"==typeof r==!!n&&!!i==!!s&&"string"==typeof o==!!c&&"string"==typeof a==!!h;let l;switch(e){case s.clientNone:l=h({usernameRequired:!0});break;case s.clientHostBased:l=h({usernameRequired:!0,publicKeyRequired:!0,clientHostnameRequired:!0,clientUsernameRequired:!0});break;case s.clientPassword:l=h({usernameRequired:!0,passwordRequired:!0});break;case s.clientPublicKeyQuery:case s.clientPublicKey:l=h({usernameRequired:!0,publicKeyRequired:!0});break;case s.serverPublicKey:l=h({publicKeyRequired:!0});break;default:throw new Error(`Invalid authentication type: ${e}`)}if(!l)throw new Error(`Invalid arguments for authentication type: ${e}`);this.username=null!=t?t:null,this.password=null!=r?r:null,this.publicKey=null!=i?i:null,this.clientHostname=null!=o?o:null,this.clientUsername=null!=a?a:null,this.cancellationValue=null!=c?c:n.CancellationToken.None}get cancellation(){return this.cancellationValue}set cancellation(e){this.cancellationValue=e}toString(){return this.password?(this.username?'"'+this.username+'" ':"")+"[password]":this.publicKey?`${this.username?'"'+this.username+'" ':""}[${this.publicKey.keyAlgorithmName}]`:`"${this.username}"`}}},3565:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannelClosedEventArgs=void 0,t.SshChannelClosedEventArgs=class{constructor(e,t){"number"==typeof e?this.exitStatus=e:"string"==typeof e?(this.exitSignal=e,this.errorMessage=t):e instanceof Error&&(this.error=e)}}},1744:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannelOpeningEventArgs=void 0;const n=r(733),s=r(8231);t.SshChannelOpeningEventArgs=class{constructor(e,t,r,i){if(this.request=e,this.channel=t,this.isRemoteRequest=r,this.failureReason=n.SshChannelOpenFailureReason.none,this.failureDescription=null,!e)throw new TypeError("A channel open message is required.");if(!t)throw new TypeError("A channel is required.");this.cancellationValue=null!=i?i:s.CancellationToken.None}get cancellation(){return this.cancellationValue}set cancellation(e){this.cancellationValue=e}toString(){return`${this.channel.toString()}${this.failureReason?" "+n.SshChannelOpenFailureReason[this.failureReason]:""}`}}},9826:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshRequestEventArgs=void 0;const n=r(8231);t.SshRequestEventArgs=class{constructor(e,t,r,s){this.requestType=e,this.request=t,this.principal=r,this.cancellationValue=null!=s?s:n.CancellationToken.None}get cancellation(){return this.cancellationValue}set cancellation(e){this.cancellationValue=e}toString(){return`RequestType: ${this.requestType}`+this.request?` Request: ${this.request}`:""}}},4709:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionClosedEventArgs=void 0;const n=r(8673);t.SshSessionClosedEventArgs=class{constructor(e,t,r){if(this.reason=e,this.message=t,this.error=r,!t)throw new TypeError("A disconnect message is required.")}toString(){return`${n.SshDisconnectReason[this.reason]}: ${this.message}`}}},4322:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectDisposedError=t.SshReconnectError=t.SshConnectionError=t.SshChannelError=t.BigInt=t.DerWriter=t.DerReader=t.formatBuffer=t.SshDataWriter=t.SshDataReader=t.ECDsa=t.Rsa=t.Encryption=t.HmacAlgorithm=t.EncryptionAlgorithm=t.PublicKeyAlgorithm=t.KeyExchangeAlgorithm=t.SshAlgorithms=t.CommandRequestMessage=t.ChannelRequestType=t.ChannelRequestMessage=t.ChannelOpenMessage=t.SshChannelOpenFailureReason=t.SshReconnectFailureReason=t.SshDisconnectReason=t.SessionRequestFailureMessage=t.SessionRequestSuccessMessage=t.DebugMessage=t.SessionRequestMessage=t.SshMessage=t.SshChannelClosedEventArgs=t.SshSessionClosedEventArgs=t.SshChannelOpeningEventArgs=t.SshRequestEventArgs=t.SshAuthenticatingEventArgs=t.SshAuthenticationType=t.serviceActivation=t.SshService=t.SshRpcMessageStream=t.WebSocketStream=t.NodeStream=t.BaseStream=t.SshStream=t.SshChannel=t.SshServerSession=t.SshClientSession=t.SshSession=t.SshVersionInfo=t.SshProtocolExtensionNames=t.SshSessionConfiguration=void 0,t.SshTraceEventIds=t.TraceLevel=t.SecureStream=t.MultiChannelStream=t.SessionContour=t.ChannelMetrics=t.SessionMetrics=t.Queue=t.Semaphore=t.PromiseCompletionSource=t.CancellationError=t.CancellationTokenSource=t.CancellationToken=void 0;var n=r(3816);Object.defineProperty(t,"SshSessionConfiguration",{enumerable:!0,get:function(){return n.SshSessionConfiguration}}),Object.defineProperty(t,"SshProtocolExtensionNames",{enumerable:!0,get:function(){return n.SshProtocolExtensionNames}});var s=r(9177);Object.defineProperty(t,"SshVersionInfo",{enumerable:!0,get:function(){return s.SshVersionInfo}});var i=r(8016);Object.defineProperty(t,"SshSession",{enumerable:!0,get:function(){return i.SshSession}});var o=r(3398);Object.defineProperty(t,"SshClientSession",{enumerable:!0,get:function(){return o.SshClientSession}});var a=r(6140);Object.defineProperty(t,"SshServerSession",{enumerable:!0,get:function(){return a.SshServerSession}});var c=r(9174);Object.defineProperty(t,"SshChannel",{enumerable:!0,get:function(){return c.SshChannel}});var h=r(3500);Object.defineProperty(t,"SshStream",{enumerable:!0,get:function(){return h.SshStream}});var l=r(7483);Object.defineProperty(t,"BaseStream",{enumerable:!0,get:function(){return l.BaseStream}}),Object.defineProperty(t,"NodeStream",{enumerable:!0,get:function(){return l.NodeStream}}),Object.defineProperty(t,"WebSocketStream",{enumerable:!0,get:function(){return l.WebSocketStream}});var u=r(1391);Object.defineProperty(t,"SshRpcMessageStream",{enumerable:!0,get:function(){return u.SshRpcMessageStream}});var d=r(2100);Object.defineProperty(t,"SshService",{enumerable:!0,get:function(){return d.SshService}});var p=r(8272);Object.defineProperty(t,"serviceActivation",{enumerable:!0,get:function(){return p.serviceActivation}});var f=r(3886);Object.defineProperty(t,"SshAuthenticationType",{enumerable:!0,get:function(){return f.SshAuthenticationType}}),Object.defineProperty(t,"SshAuthenticatingEventArgs",{enumerable:!0,get:function(){return f.SshAuthenticatingEventArgs}});var g=r(9826);Object.defineProperty(t,"SshRequestEventArgs",{enumerable:!0,get:function(){return g.SshRequestEventArgs}});var m=r(1744);Object.defineProperty(t,"SshChannelOpeningEventArgs",{enumerable:!0,get:function(){return m.SshChannelOpeningEventArgs}});var y=r(4709);Object.defineProperty(t,"SshSessionClosedEventArgs",{enumerable:!0,get:function(){return y.SshSessionClosedEventArgs}});var v=r(3565);Object.defineProperty(t,"SshChannelClosedEventArgs",{enumerable:!0,get:function(){return v.SshChannelClosedEventArgs}});var w=r(8973);Object.defineProperty(t,"SshMessage",{enumerable:!0,get:function(){return w.SshMessage}});var S=r(8673);Object.defineProperty(t,"SessionRequestMessage",{enumerable:!0,get:function(){return S.SessionRequestMessage}}),Object.defineProperty(t,"DebugMessage",{enumerable:!0,get:function(){return S.DebugMessage}}),Object.defineProperty(t,"SessionRequestSuccessMessage",{enumerable:!0,get:function(){return S.SessionRequestSuccessMessage}}),Object.defineProperty(t,"SessionRequestFailureMessage",{enumerable:!0,get:function(){return S.SessionRequestFailureMessage}}),Object.defineProperty(t,"SshDisconnectReason",{enumerable:!0,get:function(){return S.SshDisconnectReason}}),Object.defineProperty(t,"SshReconnectFailureReason",{enumerable:!0,get:function(){return S.SshReconnectFailureReason}});var b=r(733);Object.defineProperty(t,"SshChannelOpenFailureReason",{enumerable:!0,get:function(){return b.SshChannelOpenFailureReason}}),Object.defineProperty(t,"ChannelOpenMessage",{enumerable:!0,get:function(){return b.ChannelOpenMessage}}),Object.defineProperty(t,"ChannelRequestMessage",{enumerable:!0,get:function(){return b.ChannelRequestMessage}}),Object.defineProperty(t,"ChannelRequestType",{enumerable:!0,get:function(){return b.ChannelRequestType}}),Object.defineProperty(t,"CommandRequestMessage",{enumerable:!0,get:function(){return b.CommandRequestMessage}});var E=r(9483);Object.defineProperty(t,"SshAlgorithms",{enumerable:!0,get:function(){return E.SshAlgorithms}}),Object.defineProperty(t,"KeyExchangeAlgorithm",{enumerable:!0,get:function(){return E.KeyExchangeAlgorithm}}),Object.defineProperty(t,"PublicKeyAlgorithm",{enumerable:!0,get:function(){return E.PublicKeyAlgorithm}}),Object.defineProperty(t,"EncryptionAlgorithm",{enumerable:!0,get:function(){return E.EncryptionAlgorithm}}),Object.defineProperty(t,"HmacAlgorithm",{enumerable:!0,get:function(){return E.HmacAlgorithm}}),Object.defineProperty(t,"Encryption",{enumerable:!0,get:function(){return E.Encryption}}),Object.defineProperty(t,"Rsa",{enumerable:!0,get:function(){return E.Rsa}}),Object.defineProperty(t,"ECDsa",{enumerable:!0,get:function(){return E.ECDsa}});var C=r(5879);Object.defineProperty(t,"SshDataReader",{enumerable:!0,get:function(){return C.SshDataReader}}),Object.defineProperty(t,"SshDataWriter",{enumerable:!0,get:function(){return C.SshDataWriter}}),Object.defineProperty(t,"formatBuffer",{enumerable:!0,get:function(){return C.formatBuffer}});var T=r(3202);Object.defineProperty(t,"DerReader",{enumerable:!0,get:function(){return T.DerReader}}),Object.defineProperty(t,"DerWriter",{enumerable:!0,get:function(){return T.DerWriter}});var R=r(2309);Object.defineProperty(t,"BigInt",{enumerable:!0,get:function(){return R.BigInt}});var _=r(5443);Object.defineProperty(t,"SshChannelError",{enumerable:!0,get:function(){return _.SshChannelError}}),Object.defineProperty(t,"SshConnectionError",{enumerable:!0,get:function(){return _.SshConnectionError}}),Object.defineProperty(t,"SshReconnectError",{enumerable:!0,get:function(){return _.SshReconnectError}}),Object.defineProperty(t,"ObjectDisposedError",{enumerable:!0,get:function(){return _.ObjectDisposedError}});var P=r(9612);Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return P.CancellationToken}}),Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return P.CancellationTokenSource}}),Object.defineProperty(t,"CancellationError",{enumerable:!0,get:function(){return P.CancellationError}});var x=r(5928);Object.defineProperty(t,"PromiseCompletionSource",{enumerable:!0,get:function(){return x.PromiseCompletionSource}});var A=r(7688);Object.defineProperty(t,"Semaphore",{enumerable:!0,get:function(){return A.Semaphore}});var k=r(1024);Object.defineProperty(t,"Queue",{enumerable:!0,get:function(){return k.Queue}});var M=r(4235);Object.defineProperty(t,"SessionMetrics",{enumerable:!0,get:function(){return M.SessionMetrics}});var I=r(201);Object.defineProperty(t,"ChannelMetrics",{enumerable:!0,get:function(){return I.ChannelMetrics}});var O=r(3250);Object.defineProperty(t,"SessionContour",{enumerable:!0,get:function(){return O.SessionContour}});var B=r(6724);Object.defineProperty(t,"MultiChannelStream",{enumerable:!0,get:function(){return B.MultiChannelStream}});var q=r(8524);Object.defineProperty(t,"SecureStream",{enumerable:!0,get:function(){return q.SecureStream}});var F=r(1618);Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return F.TraceLevel}}),Object.defineProperty(t,"SshTraceEventIds",{enumerable:!0,get:function(){return F.SshTraceEventIds}})},2309:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BigInt=void 0;const n=r(4300),s=r(5879);class i{constructor(e){if(this.buffer=e,0===e.length)throw new Error("BigInt buffer length must be greater than zero.")}get sign(){const e=this.buffer[0];return 0===e?this.buffer.length>1?1:0:0==(128&e)?1:-1}static fromInt32(e){if(0===e)return i.zero;let t=!1;e<0&&(t=!0,e=-e);const r=[];for(let t=24;t>=0;t-=8)(e>=1<<t||r.length>0)&&(r.push(e>>t),e&=~((1<<t)-1));return t&&(0==(128&r[0])?r[0]|=128:r.splice(0,0,128)),new i(n.Buffer.from(new Uint8Array(r)))}toInt32(){if(this.buffer.length>4)throw new TypeError("BigInt value cannot be converted to a 32-bit signed integer.");let e=this.buffer[0];this.sign<0&&(e&=127);for(let t=1;t<this.buffer.length;t++)e=(e<<8)+this.buffer[t];return this.sign<0&&(e=-e),e}static fromBytes(e,t){if(!n.Buffer.isBuffer(e))throw new TypeError("Buffer expected.");if(0===e.length)throw new Error("BigInt buffer length must be greater than zero.");t=null!=t?t:{};const r=0!=(128&e[0]),s=t.unsigned&&r?1:0;let o=0;for(let t=0;t<e.length-1&&0===e[t];t++)0==(128&e[t+1])&&o++;const a=n.Buffer.alloc(e.length+s-o);return e.copy(a,s,o,e.length),new i(a)}toBytes(e){e=null!=e?e:{};let t=this.buffer;if(e.unsigned){if(this.sign<0)throw new TypeError("Cannot format a negative BigInt as unsigned.");if(0===t[0]&&t.length>1&&(t=t.slice(1,t.length)),void 0!==e.length){if(t.length>e.length)throw new Error(`BigInt (${t.length} bytes) is too large for length ${e.length}.`);if(t.length<e.length){const r=n.Buffer.alloc(e.length);return t.copy(r,e.length-t.length),r}}}const r=n.Buffer.alloc(t.length);return t.copy(r,0,0,t.length),r}copyTo(e,t=0){this.buffer.copy(e,t,0,this.buffer.length)}equals(e){return e instanceof i&&this.buffer.equals(e.buffer)}toString(e){return(0,s.formatBuffer)(this.buffer,null!=e?e:"BigInt")}}t.BigInt=i,i.zero=new i(n.Buffer.alloc(1))},3202:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DerWriter=t.DerReader=void 0;const n=r(4300),s=r(2309);class i{constructor(e,t=48){this.buffer=e,this.position=0,this.readType(t);const r=this.readLength();if(r>this.buffer.length-this.position)throw new Error("Read out of bounds.");this.buffer=this.buffer.slice(0,this.position+r)}get available(){return this.buffer.length-this.position}readNull(){if(this.readType(5),0!==this.readByte())throw new Error("Expected a 0 after Null type.")}readInteger(){this.readType(2);const e=this.readLength(),t=this.readBytes(e);return new s.BigInt(t)}readOctetString(){this.readType(4);const e=this.readLength();return this.readBytes(e)}readBitString(){this.readType(3);const e=this.readLength();if(0!==this.readByte())throw new Error("Padded bit strings are not supported.");return this.readBytes(e-1)}readObjectIdentifier(e){this.readType(6);const t=this.readLength(),r=this.position+t,n=[],s=this.readByte();n.push(Math.trunc(s/40)),n.push(s%40);let i=0;for(;this.position<r;){const e=this.readByte();0!=(128&e)?i=128*i+(127&e):(i=128*i+e,n.push(i),i=0)}if(0!==i)throw new Error("Invalid OID format.");const o=n.join(".");if(e&&o!==e)throw new Error(`Expected OID ${e}, found: ${o}`);return o}readSequence(){const e=this.position;this.readType(48);const t=this.readLength();return this.position+=t,new i(this.buffer.slice(e,this.position))}tryReadTagged(e){if(this.position>=this.buffer.length)return null;const t=this.buffer[this.position];if(0==(160&t)||(-161&t)!==e)return null;const r=this.position;this.position++;const n=this.readLength();return this.position+=n,new i(this.buffer.slice(r,this.position),t)}peek(){if(this.position>=this.buffer.length)throw new Error("Read out of bounds.");return this.buffer[this.position]}readLength(){let e=this.readByte();if(128===e)throw new Error("Indefinite-length encoding is not supported.");if(e>127){const t=127&e;if(t>4)throw new Error(`DER length size is ${t} and cannot be more than 4 bytes.`);e=0;for(let r=0;r<t;r++)e=(e<<8)+this.readByte();if(e<0)throw new Error("Corrupted data - negative length found")}return e}readByte(){if(this.position>=this.buffer.length)throw new Error("Read out of bounds.");return this.buffer[this.position++]}readBytes(e){if(this.position+e>this.buffer.length)throw new Error("Read out of bounds.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readType(e){const t=this.readByte();if(t!==e)throw new Error(`Expected ${e} data type, found : ${t}`)}}t.DerReader=i;class o{constructor(e,t=48){this.buffer=e,this.dataType=t,this.position=0,this.buffer=e}toBuffer(){const e=this.position,t=o.getLength(e);this.ensureCapacity(1+t.length+e);const r=this.buffer.slice(0,1+t.length+e);return this.buffer.copy(r,1+t.length),r[0]=this.dataType,t.copy(r,1,0),this.buffer=this.buffer.slice(1+t.length,r.length),this.position=e,r}writeSequence(e){this.writeBytes(e.toBuffer())}writeTagged(e,t){if(e>15)throw new Error("Invalid DER tag.");this.writeByte(160|e);const r=o.getLength(t.position);this.writeBytes(r),this.writeBytes(t.buffer.slice(0,t.position))}writeNull(){this.writeByte(5),this.writeByte(0)}writeInteger(e){this.writeByte(2);const t=e.toBytes(),r=o.getLength(t.length);this.writeBytes(r),this.writeBytes(t)}writeOctetString(e){this.writeByte(4);const t=o.getLength(e.length);this.writeBytes(t),this.writeBytes(e)}writeBitString(e){this.writeByte(3);const t=o.getLength(1+e.length);this.writeBytes(t),this.writeByte(0),this.writeBytes(e)}writeObjectIdentifier(e){if(!e)throw new TypeError("OID value is null or empty.");const t=e.split(".").map(Number);if(t.length<2||t[0]>3||t[1]>=40)throw new Error(`Invalid OID: ${e}`);this.writeByte(6);let r=t.length-1;for(let e=2;e<t.length;e++){let n=t[e];for(;n>128;)r++,n/=128}const n=o.getLength(r);this.writeBytes(n),this.writeByte(40*t[0]+t[1]);for(let e=2;e<t.length;e++){let r=t[e];if(r>=128){const e=[];for(e.push(127&r);r>=128;)r/=128,e.push(128|127&r);for(;e.length>0;)this.writeByte(e.pop())}else this.writeByte(r)}}static getLength(e){if(e>127){let t=1;for(let r=e>>8;0!==r;r>>=8)t++;const r=o.lengthBuffer.slice(0,t+1);r[0]=128|t;for(let n=8*(t-1),s=1;n>=0;n-=8,s++)r[s]=e>>n;return r}{const t=o.lengthBuffer.slice(0,1);return t[0]=e,t}}writeByte(e){this.ensureCapacity(this.position+1),this.buffer[this.position++]=e}writeBytes(e){this.ensureCapacity(this.position+e.length),e.copy(this.buffer,this.position),this.position+=e.length}ensureCapacity(e){if(this.buffer.length<e){let t=Math.max(512,2*this.buffer.length);for(;t<e;)t*=2;const r=n.Buffer.alloc(t);this.buffer.copy(r,0,0,this.position),this.buffer=r}}}t.DerWriter=o,o.lengthBuffer=n.Buffer.alloc(10)},5879:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatBuffer=t.SshDataWriter=t.SshDataReader=void 0;const n=r(4300),s=r(9483),i=r(2309);class o{constructor(e){this.buffer=e,this.position=0}get available(){return this.buffer.length-this.position}read(e){if(this.available<e)throw new Error("Attempted to read past end of buffer.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readByte(){if(0===this.available)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position];return this.position++,e}readBinary(){const e=this.readUInt32();if(this.available<e)throw new Error("Attempted to read past end of buffer.");const t=this.buffer.slice(this.position,this.position+e);return this.position+=e,t}readString(e){return this.readBinary().toString()}readList(e){const t=this.readString(e);return 0===t.length?[]:t.split(",")}readBoolean(){return 0!==this.readByte()}readUInt32(){if(this.available<4)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position+0],t=this.buffer[this.position+1],r=this.buffer[this.position+2],n=this.buffer[this.position+3];return this.position+=4,(e<<24|t<<16|r<<8|n)>>>0}readUInt64(){if(this.available<8)throw new Error("Attempted to read past end of buffer.");const e=this.buffer[this.position+0],t=this.buffer[this.position+1],r=this.buffer[this.position+2],n=this.buffer[this.position+3],s=this.buffer[this.position+4],i=this.buffer[this.position+5],o=this.buffer[this.position+6],a=this.buffer[this.position+7];return this.position+=8,4294967296*((e<<24|t<<16|r<<8|n)>>>0)+((s<<24|i<<16|o<<8|a)>>>0)}readBigInt(){const e=this.readBinary();return 0===e.length?i.BigInt.zero:i.BigInt.fromBytes(e)}}let a;t.SshDataReader=o,o.mpintZero=n.Buffer.alloc(1),t.SshDataWriter=class{constructor(e){this.buffer=e,this.position=0}write(e){this.ensureCapacity(this.position+e.length),e.copy(this.buffer,this.position),this.position+=e.length}writeByte(e){this.ensureCapacity(this.position+1),this.buffer[this.position]=e,this.position++}writeBinary(e){this.ensureCapacity(this.position+4+e.length),this.writeUInt32(e.length),e.copy(this.buffer,this.position),this.position+=e.length}writeString(e,t){this.writeBinary(n.Buffer.from(e))}writeList(e,t){this.writeString(e?e.join(","):"",t)}writeBoolean(e){this.writeByte(e?1:0)}writeUInt32(e){this.ensureCapacity(this.position+4),this.buffer[this.position+0]=e>>>24,this.buffer[this.position+1]=e>>>16,this.buffer[this.position+2]=e>>>8,this.buffer[this.position+3]=e>>>0,this.position+=4}static writeUInt32(e,t,r){e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0}writeUInt64(e){this.ensureCapacity(this.position+8);const t=4294967295&e,r=(e-t)/4294967296;this.buffer[this.position+0]=r>>>24,this.buffer[this.position+1]=r>>>16,this.buffer[this.position+2]=r>>>8,this.buffer[this.position+3]=r>>>0,this.buffer[this.position+4]=t>>>24,this.buffer[this.position+5]=t>>>16,this.buffer[this.position+6]=t>>>8,this.buffer[this.position+7]=t>>>0,this.position+=8}writeBigInt(e){const t=e.toBytes();1===t.length&&0===t[0]?this.writeUInt32(0):this.writeBinary(t)}writeRandom(e){this.ensureCapacity(this.position+e);const t=this.buffer.slice(this.position,this.position+e);s.SshAlgorithms.random.getBytes(t),this.position+=e}skip(e){this.ensureCapacity(this.position+e),this.position+=e}ensureCapacity(e){if(this.buffer.length<e){let t=Math.max(512,2*this.buffer.length);for(;t<e;)t*=2;const r=n.Buffer.alloc(t);this.buffer.copy(r,0,0,this.position),this.buffer=r}}toBuffer(){return this.buffer.slice(0,this.position)}},t.formatBuffer=function(e,t,r){let n=`${void 0===t?"Buffer":t}[${e.length}] (${function(e){a||(a=function(){let e;const t=[];for(let r=0;r<256;r++){e=r;for(let t=0;t<8;t++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}());let t=-1;for(let r=0;r<e.length;r++)t=t>>>8^a[255&(t^e[r])];return(4294967296+((-1^t)>>>0)).toString(16).substr(-8).toUpperCase()}(e)})\n`;if(!1===r)return n;const s=Math.min(2048,e.length);for(let t=0;t<s;t+=16){t<1e3&&(n+="0"),t<100&&(n+="0"),t<10&&(n+="0"),n+=t+":";for(let r=t;r<t+16;r++)n+=r<s?" "+e.slice(r,r+1).toString("hex"):"   ";n+="  ";for(let r=t;r<t+16;r++)if(r<s){const t=e[r];n+=t>32&&t<=127?e.slice(r,r+1).toString():"."}else n+=" ";n+="\n"}return s<e.length&&(n+="...\n"),n}},2438:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshProtocol=void 0;const n=r(4300),s=r(1024),i=r(7688),o=r(8973),a=r(5879),c=r(8673),h=r(4405),l=r(733),u=r(5443),d=r(1618);class p{constructor(e,t){this.sequence=e,this.message=t}}class f{constructor(e,t,r,o){this.config=t,this.metrics=r,this.trace=o,this.sessionSemaphore=new i.Semaphore(1),this.inboundPacketSequence=0,this.outboundPacketSequence=0,this.inboundFlow=0,this.outboundFlow=0,this.recentSentMessages=new s.Queue,this.sendWriter=new a.SshDataWriter(n.Buffer.alloc(1024)),this.receiveWriter=new a.SshDataWriter(n.Buffer.alloc(1024)),this.traceChannelData=!1,this.extensions=null,this.kexService=null,this.algorithms=null,this.outgoingMessagesHaveLatencyInfo=!1,this.incomingMessagesHaveLatencyInfo=!1,this.outgoingMessagesHaveReconnectInfo=!1,this.incomingMessagesHaveReconnectInfo=!1,this.stream=e}get lastIncomingSequence(){return this.inboundPacketSequence-1}getSentMessages(e){if(e===this.outboundPacketSequence+1)return[];if(this.recentSentMessages.size>0&&e<this.recentSentMessages.peek().sequence)return null;const t=new Array;for(const r of this.recentSentMessages)if(r.sequence>=e){const e=r.message;e instanceof h.KeyExchangeMessage||e instanceof c.DisconnectMessage||t.push(e)}return t}async writeProtocolVersion(e,t){const r=this.stream;if(!r)throw new Error("SSH session disconnected.");const s=n.Buffer.from(e+"\r\n");return await r.write(s,t),this.metrics.addMessageSent(s.length),Promise.resolve()}async readProtocolVersion(e){const t=this.stream;if(!t)throw new Error("SSH session disconnected.");const r=n.Buffer.alloc(255);let s=0;for(let n=0;n<r.length;n++){const i=await t.read(1,e);if(!i)break;r[n]=i[0];const o=13,a=10;if(n>0&&r[n-1]===o&&r[n]===a){const e=r.toString("utf8",0,n-1);if(e.startsWith("SSH-"))return this.metrics.addMessageReceived(n+1),e;if(s>20)break;s++,n=-1}}throw new u.SshConnectionError("Failed to read the protocol version",c.SshDisconnectReason.protocolError)}async handleNewKeys(e){try{await this.sessionSemaphore.wait(e),this.inboundFlow=0,this.outboundFlow=0,this.algorithms=this.kexService.finishKeyExchange()}finally{this.sessionSemaphore.release()}}async read(e,t){const r=this.stream;if(!r)return!1;let n=0;do{let s;try{s=await r.read(e.length-n,t)}catch(e){if(!(e instanceof Error))throw e;if(r.isDisposed)return!1;throw r.dispose(),this.stream=null,this.trace(d.TraceLevel.Error,d.SshTraceEventIds.streamReadError,`Error reading from stream: ${e.message}`,e),new u.SshConnectionError("Error reading from stream: "+e.message,c.SshDisconnectReason.connectionLost)}if(!s)return!1;s.copy(e,n),n+=s.length}while(n<e.length);return!0}async write(e,t){const r=this.stream;if(!r)return!1;try{await r.write(e,t)}catch(e){if(!(e instanceof Error))throw e;if(r.isDisposed)return!1;throw r.dispose(),this.stream=null,this.trace(d.TraceLevel.Error,d.SshTraceEventIds.streamWriteError,`Error writing to stream: ${e.message}`,e),new u.SshConnectionError("Error writing to stream: "+e.message,c.SshDisconnectReason.connectionLost)}return!0}async considerReExchange(e,t){const r=this.kexService;if(!r)return;let n=null,s=null;!r.exchanging&&(e||this.inboundFlow+this.outboundFlow>this.config.keyRotationThreshold)&&([n,s]=await r.startKeyExchange(e)),n&&(await this.sendMessage(n,t),s&&await this.sendMessage(s,t))}async computeHmac(e,t,r){const s=new a.SshDataWriter(n.Buffer.alloc(4+t.length));return s.writeUInt32(r),s.write(t),await e.sign(s.toBuffer())}async verifyHmac(e,t,r,s){const i=new a.SshDataWriter(n.Buffer.alloc(4+t.length));return i.writeUInt32(r),i.write(t),await e.verify(i.toBuffer(),s)}async readAndVerifyHmac(e,t,r,n){if(!await this.read(r,n))return!1;if(!await this.verifyHmac(e,t,this.inboundPacketSequence,r))throw new u.SshConnectionError("Invalid MAC",c.SshDisconnectReason.macError);return!0}async sendMessage(e,t){var r;const s=this.algorithms,i=null==s?void 0:s.compressor,o=null==s?void 0:s.cipher,a=null==s?void 0:s.messageSigner;let c;await this.sessionSemaphore.wait(t);try{const s=o?Math.max(8,o.blockLength):8,h=f.packetLengthSize+f.paddingLengthSize;if(this.sendWriter.position=h,e.write(this.sendWriter),this.outgoingMessagesHaveReconnectInfo&&(this.sendWriter.writeUInt64(this.lastIncomingSequence),this.outgoingMessagesHaveLatencyInfo)){const e=Math.min(4294967295,Math.round(1e3*(this.metrics.time-this.lastIncomingTimestamp)));this.sendWriter.writeUInt32(e)}let u=this.sendWriter.toBuffer().slice(h);null!=i&&(u=i.compress(u));let g=s-(((null==a?void 0:a.encryptThenMac)||(null==a?void 0:a.authenticatedEncryption)?0:f.packetLengthSize)+f.paddingLengthSize+u.length)%s;g<4&&(g+=s);const m=f.paddingLengthSize+u.length+g;this.sendWriter.position=0,this.sendWriter.writeUInt32(m),this.sendWriter.writeByte(g),null!=i?this.sendWriter.write(u):this.sendWriter.position+=u.length,this.sendWriter.writeRandom(g),u=this.sendWriter.toBuffer();let y=null;if((null==a?void 0:a.encryptThenMac)&&o){const e=u.slice(f.packetLengthSize,u.length);(await o.transform(e)).copy(e),y=await this.computeHmac(a,u,this.outboundPacketSequence)}else if(null==a?void 0:a.authenticatedEncryption){const e=u.slice(f.packetLengthSize,u.length);(await o.transform(e)).copy(e),y=await a.sign(e)}else a&&(y=await this.computeHmac(a,u,this.outboundPacketSequence)),o&&(u=await o.transform(u));if(e instanceof l.ChannelDataMessage?this.traceChannelData&&this.trace(d.TraceLevel.Verbose,d.SshTraceEventIds.sendingChannelData,`Sending #${this.outboundPacketSequence} ${e}`):this.trace(d.TraceLevel.Verbose,d.SshTraceEventIds.sendingMessage,`Sending #${this.outboundPacketSequence} ${e}`),this.incomingMessagesHaveReconnectInfo){const t=new p(this.outboundPacketSequence,e);t.sentTime=this.metrics.time,this.recentSentMessages.enqueue(t)}if(this.outboundPacketSequence++,this.outboundFlow+=m,y){const e=n.Buffer.concat([u,y],u.length+y.length);c=await this.write(e,t)}else c=await this.write(u,t);this.metrics.addMessageSent(f.packetLengthSize+m+(null!==(r=null==a?void 0:a.digestLength)&&void 0!==r?r:0))}finally{this.sessionSemaphore.release()}return await this.considerReExchange(!1,t),c}async receiveMessage(e){var t;const r=this.algorithms,n=null==r?void 0:r.decipher,s=null==r?void 0:r.messageVerifier,i=null==r?void 0:r.decompressor,h=!((null==s?void 0:s.encryptThenMac)||(null==s?void 0:s.authenticatedEncryption)),p=h?n?Math.max(8,n.blockLength):8:f.packetLengthSize;this.receiveWriter.position=p;let g=this.receiveWriter.toBuffer();if(!await this.read(g,e))return null;this.lastIncomingTimestamp=this.metrics.time,n&&h&&(g=await n.transform(g),this.receiveWriter.position=0,this.receiveWriter.write(g));const m=new a.SshDataReader(g).readUInt32();if(m>f.maxPacketLength)throw new u.SshConnectionError("Invalid packet length.",c.SshDisconnectReason.protocolError);const y=f.packetLengthSize+m;y>p&&this.receiveWriter.skip(y-p),s&&this.receiveWriter.skip(s.digestLength);const v=this.receiveWriter.toBuffer(),w=v.slice(0,y),S=v.slice(y);let b=w.slice(p,y);if(b.length>0){if(!await this.read(b,e))return null;if((null==s?void 0:s.encryptThenMac)&&!await this.readAndVerifyHmac(s,w,S,e))return null;if(n){if(null==s?void 0:s.authenticatedEncryption){if(!await this.read(S,e))return null;await s.verify(b,S)}try{b=await n.transform(b)}catch(e){throw(null==s?void 0:s.authenticatedEncryption)?new u.SshConnectionError("Invalid MAC",c.SshDisconnectReason.macError):e}this.receiveWriter.position=p,this.receiveWriter.write(b)}}if(s&&!s.encryptThenMac&&!s.authenticatedEncryption&&!await this.readAndVerifyHmac(s,w,S,e))return null;const E=w[f.packetLengthSize];let C=w.slice(f.packetLengthSize+f.paddingLengthSize,f.packetLengthSize+(m-E));if(i&&(C=i.decompress(C)),this.incomingMessagesHaveReconnectInfo){let e,t;if(this.incomingMessagesHaveLatencyInfo){const r=new a.SshDataReader(C.slice(C.length-12,C.length));e=r.readUInt64(),t=r.readUInt32()/1e3,C=C.slice(0,C.length-12)}else e=new a.SshDataReader(C.slice(C.length-8,C.length)).readUInt64(),t=0,C=C.slice(0,C.length-8);for(;this.recentSentMessages.size>0;){const r=this.recentSentMessages.peek();if(r.sequence>e)break;if(this.stream&&this.incomingMessagesHaveLatencyInfo&&r.sequence===e){const e=this.lastIncomingTimestamp-r.sentTime-t;this.metrics.updateLatency(e)}this.recentSentMessages.dequeue()}}const T=C[0];let R=o.SshMessage.create(this.config,T,C);if(!R){const e=new c.UnimplementedMessage;e.sequenceNumber=this.inboundPacketSequence,e.unimplementedMessageType=T,R=e}return R instanceof l.ChannelDataMessage?this.traceChannelData&&this.trace(d.TraceLevel.Verbose,d.SshTraceEventIds.receivingChannelData,`Receiving #${this.inboundPacketSequence} ${R}`):this.trace(d.TraceLevel.Verbose,d.SshTraceEventIds.receivingMessage,`Receiving #${this.inboundPacketSequence} ${R}`),await this.sessionSemaphore.wait(e),this.inboundPacketSequence++,this.inboundFlow+=m,this.sessionSemaphore.release(),this.metrics.addMessageReceived(f.packetLengthSize+m+(null!==(t=null==s?void 0:s.digestLength)&&void 0!==t?t:0)),await this.considerReExchange(!1,e),R}dispose(){try{this.stream&&this.stream.close().catch((e=>{this.trace(d.TraceLevel.Error,d.SshTraceEventIds.streamCloseError,`Error closing stream: ${e.message}`,e)}))}catch(e){if(!(e instanceof Error))throw e;this.trace(d.TraceLevel.Error,d.SshTraceEventIds.streamCloseError,`Error closing stream: ${e.message}`,e)}this.stream=null,this.metrics.updateLatency(0),this.algorithms&&this.algorithms.dispose()}}t.SshProtocol=f,f.maxPacketLength=1048576,f.packetLengthSize=4,f.paddingLengthSize=1},2694:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationSuccessMessage=t.AuthenticationFailureMessage=t.PasswordRequestMessage=t.PublicKeyOKMessage=t.PublicKeyRequestMessage=t.AuthenticationRequestMessage=t.AuthenticationMessage=void 0;const n=r(8973);class s extends n.SshMessage{}t.AuthenticationMessage=s;class i extends s{get messageType(){return 50}onRead(e){this.username=e.readString("utf8"),this.serviceName=e.readString("ascii"),this.methodName=e.readString("ascii")}onWrite(e){e.writeString(this.username||"","utf8"),e.writeString(this.serviceName||"","ascii"),e.writeString(this.validateField(this.methodName,"method name"),"ascii")}}t.AuthenticationRequestMessage=i,t.PublicKeyRequestMessage=class extends i{constructor(){super(),this.methodName="publickey"}get hasSignature(){return!!(this.signature&&this.signature.length>0)}onRead(e){super.onRead(e);const t=e.readBoolean();this.keyAlgorithmName=e.readString("ascii"),this.publicKey=e.readBinary(),t?(this.signature=e.readBinary(),this.payloadWithoutSignature=this.rawBytes.slice(0,this.rawBytes.length-this.signature.length-4)):this.signature=void 0}onWrite(e){var t,r;if(super.onWrite(e),!this.keyAlgorithmName)throw new Error("Key algorithm name not set.");if("hostbased"===this.methodName){if(e.writeString(this.keyAlgorithmName,"ascii"),e.writeBinary(this.publicKey||Buffer.alloc(0)),e.writeString(null!==(t=this.clientHostname)&&void 0!==t?t:"","ascii"),e.writeString(null!==(r=this.clientUsername)&&void 0!==r?r:"","ascii"),!this.hasSignature)throw new Error("A signature is required for a host-based authentcation request.");e.writeBinary(this.signature)}else e.writeBoolean(this.hasSignature),e.writeString(this.keyAlgorithmName,"ascii"),e.writeBinary(this.publicKey||Buffer.alloc(0)),this.hasSignature&&e.writeBinary(this.signature)}},t.PublicKeyOKMessage=class extends s{get messageType(){return 60}onRead(e){this.keyAlgorithmName=e.readString("ascii"),this.publicKey=e.readBinary()}onWrite(e){if(!this.keyAlgorithmName)throw new Error("Key algorithm name not set.");if(!this.publicKey)throw new Error("Public key not set.");e.writeString(this.keyAlgorithmName,"ascii"),e.writeBinary(this.publicKey)}},t.PasswordRequestMessage=class extends i{constructor(){super(),this.methodName="password"}onRead(e){super.onRead(e),e.readBoolean(),this.password=e.readString("utf8")}onWrite(e){super.onWrite(e),e.writeBoolean(!1),e.writeString(this.password||"","utf8")}};class o extends s{constructor(){super(...arguments),this.partialSuccess=!1}get messageType(){return 51}onRead(e){this.methodNames=e.readList("ascii"),this.partialSuccess=e.readBoolean()}onWrite(e){e.writeList(this.methodNames||[],"ascii"),e.writeBoolean(this.partialSuccess)}}t.AuthenticationFailureMessage=o;class a extends s{get messageType(){return 52}onRead(e){}onWrite(e){}}t.AuthenticationSuccessMessage=a,n.SshMessage.index.set(50,i),n.SshMessage.index.set(51,o),n.SshMessage.index.set(52,a)},733:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelFailureMessage=t.ChannelSuccessMessage=t.ChannelSignalMessage=t.CommandRequestMessage=t.ChannelRequestMessage=t.ChannelRequestType=t.ChannelCloseMessage=t.ChannelEofMessage=t.ChannelDataMessage=t.ChannelWindowAdjustMessage=t.ChannelOpenFailureMessage=t.SshChannelOpenFailureReason=t.ChannelOpenConfirmationMessage=t.ChannelOpenMessage=t.ChannelMessage=t.ConnectionMessage=void 0;const n=r(8973),s=r(5879);class i extends n.SshMessage{}t.ConnectionMessage=i;class o extends i{get recipientChannel(){return this.recipientChannelValue}set recipientChannel(e){e!==this.recipientChannelValue&&(this.recipientChannelValue=e,this.rawBytes&&s.SshDataWriter.writeUInt32(this.rawBytes,1,null!=e?e:0))}onRead(e){this.recipientChannel=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.recipientChannel,"recipient channel"))}toString(){return`${super.toString()} (recipientChannel=${this.recipientChannel})`}}t.ChannelMessage=o;class a extends i{get messageType(){return 90}get senderChannel(){return this.senderChannelValue}set senderChannel(e){e!==this.senderChannelValue&&(this.senderChannelValue=e,this.rawBytes&&this.channelType&&s.SshDataWriter.writeUInt32(this.rawBytes,5+this.channelType.length,null!=e?e:0))}onRead(e){this.channelType=e.readString("ascii"),this.senderChannel=e.readUInt32(),this.maxWindowSize=e.readUInt32(),this.maxPacketSize=e.readUInt32()}onWrite(e){e.writeString(this.validateField(this.channelType,"channel type"),"ascii"),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),e.writeUInt32(this.maxWindowSize||a.defaultMaxWindowSize),e.writeUInt32(this.maxPacketSize||a.defaultMaxPacketSize)}toString(){return`${super.toString()}(channelType=${this.channelType}, senderChannel=${this.senderChannel})`}}t.ChannelOpenMessage=a,a.defaultMaxPacketSize=32768,a.defaultMaxWindowSize=1048576;class c extends o{get messageType(){return 91}onRead(e){super.onRead(e),this.senderChannel=e.readUInt32(),this.maxWindowSize=e.readUInt32(),this.maxPacketSize=e.readUInt32()}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),e.writeUInt32(this.validateField(this.maxWindowSize,"max window size")),e.writeUInt32(this.validateField(this.maxPacketSize,"max packet size"))}toString(){return`${super.toString()}(senderChannel=${this.senderChannel})`}}var h,l;t.ChannelOpenConfirmationMessage=c,function(e){e[e.none=0]="none",e[e.administrativelyProhibited=1]="administrativelyProhibited",e[e.connectFailed=2]="connectFailed",e[e.unknownChannelType=3]="unknownChannelType",e[e.resourceShortage=4]="resourceShortage"}(h=t.SshChannelOpenFailureReason||(t.SshChannelOpenFailureReason={}));class u extends o{get messageType(){return 92}onRead(e){super.onRead(e),this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),this.language=e.readString("ascii")}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),e.writeString(this.language||"en","ascii")}toString(){return`${super.toString()} (${h[this.reasonCode||0]}: ${this.description})`}}t.ChannelOpenFailureMessage=u;class d extends o{get messageType(){return 93}onRead(e){super.onRead(e),this.bytesToAdd=e.readUInt32()}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.bytesToAdd,"bytes to add"))}toString(){return`${super.toString()} (bytesToAdd=${this.bytesToAdd})`}}t.ChannelWindowAdjustMessage=d;class p extends o{get messageType(){return 94}onRead(e){super.onRead(e),this.data=e.readBinary()}onWrite(e){super.onWrite(e),e.writeBinary(this.validateField(this.data,"data"))}toString(){return this.data?(0,s.formatBuffer)(this.data,""):"[0]"}}t.ChannelDataMessage=p;class f extends o{get messageType(){return 96}}t.ChannelEofMessage=f;class g extends o{get messageType(){return 97}}t.ChannelCloseMessage=g,function(e){e.command="exec",e.shell="shell",e.terminal="pty-req",e.signal="signal",e.exitSignal="exit-signal",e.exitStatus="exit-status"}(l=t.ChannelRequestType||(t.ChannelRequestType={}));class m extends o{constructor(e,t){super(),this.requestType=e,this.wantReply=null!=t&&t}get messageType(){return 98}onRead(e){super.onRead(e),this.requestType=e.readString("ascii"),this.wantReply=e.readBoolean()}onWrite(e){void 0===this.recipientChannel&&(this.recipientChannel=0),super.onWrite(e),e.writeString(this.validateField(this.requestType,"request type"),"ascii"),e.writeBoolean(this.wantReply)}}t.ChannelRequestMessage=m,t.CommandRequestMessage=class extends m{constructor(){super(),this.requestType=l.command}onRead(e){super.onRead(e),this.command=e.readString("utf8")}onWrite(e){super.onWrite(e),e.writeString(this.validateField(this.command,"command"),"utf8")}toString(){return`${super.toString()} (requestType=${this.requestType})`}},t.ChannelSignalMessage=class extends m{constructor(){super()}get signal(){return this.signalValue}set signal(e){this.requestType=l.signal,this.signalValue=e}get exitSignal(){return this.signalValue}set exitSignal(e){this.requestType=l.exitSignal,this.signalValue=e}get errorMessage(){return this.errorMessageValue}set errorMessage(e){if(this.requestType!==l.exitSignal)throw new Error(`Error message property is only valid for ${l.exitSignal} messages.`);this.errorMessageValue=e}get exitStatus(){return this.statusValue}set exitStatus(e){this.requestType=l.exitStatus,this.statusValue=e}onRead(e){switch(super.onRead(e),this.requestType){case l.exitStatus:this.exitStatus=e.readUInt32();break;case l.signal:this.signal=e.readString("ascii");break;case l.exitSignal:this.exitSignal=e.readString("ascii"),e.readBoolean(),this.errorMessage=e.readString("utf8"),e.readString("ascii")}}onWrite(e){if(!this.requestType)throw new Error("Signal message request type not set.");switch(this.wantReply=!1,super.onWrite(e),this.requestType){case l.exitStatus:e.writeUInt32(this.validateField(this.exitStatus,"exit status"));break;case l.signal:e.writeString(this.validateField(this.signal,"signal"),"ascii");break;case l.exitSignal:e.writeString(this.validateField(this.exitSignal,"exit signal"),"ascii"),e.writeBoolean(!1),e.writeString(this.errorMessage||"","utf8"),e.writeString("","ascii");break;default:throw new Error(`Unknown signal message request type: ${this.requestType}`)}}};class y extends o{get messageType(){return 99}}t.ChannelSuccessMessage=y;class v extends o{get messageType(){return 100}}t.ChannelFailureMessage=v,n.SshMessage.index.set(90,a),n.SshMessage.index.set(91,c),n.SshMessage.index.set(92,u),n.SshMessage.index.set(93,d),n.SshMessage.index.set(94,p),n.SshMessage.index.set(96,f),n.SshMessage.index.set(97,g),n.SshMessage.index.set(98,m),n.SshMessage.index.set(99,y),n.SshMessage.index.set(100,v)},4405:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewKeysMessage=t.KeyExchangeDhReplyMessage=t.KeyExchangeDhInitMessage=t.KeyExchangeInitMessage=t.KeyExchangeMessage=void 0;const n=r(4300),s=r(8973),i=r(9483);class o extends s.SshMessage{}t.KeyExchangeMessage=o;class a extends o{get messageType(){return 20}onRead(e){this.cookie=e.read(16),this.keyExchangeAlgorithms=e.readList("ascii"),this.serverHostKeyAlgorithms=e.readList("ascii"),this.encryptionAlgorithmsClientToServer=e.readList("ascii"),this.encryptionAlgorithmsServerToClient=e.readList("ascii"),this.macAlgorithmsClientToServer=e.readList("ascii"),this.macAlgorithmsServerToClient=e.readList("ascii"),this.compressionAlgorithmsClientToServer=e.readList("ascii"),this.compressionAlgorithmsServerToClient=e.readList("ascii"),this.languagesClientToServer=e.readList("ascii"),this.languagesServerToClient=e.readList("ascii"),this.firstKexPacketFollows=e.readBoolean(),this.reserved=e.readUInt32()}onWrite(e){var t;this.cookie||(this.cookie=n.Buffer.alloc(16),i.SshAlgorithms.random.getBytes(this.cookie)),e.write(this.cookie),e.writeList(this.keyExchangeAlgorithms||[],"ascii"),e.writeList(this.serverHostKeyAlgorithms||[],"ascii"),e.writeList(this.encryptionAlgorithmsClientToServer||[],"ascii"),e.writeList(this.encryptionAlgorithmsServerToClient||[],"ascii"),e.writeList(this.macAlgorithmsClientToServer||[],"ascii"),e.writeList(this.macAlgorithmsServerToClient||[],"ascii"),e.writeList(this.compressionAlgorithmsClientToServer||[],"ascii"),e.writeList(this.compressionAlgorithmsServerToClient||[],"ascii"),e.writeList(this.languagesClientToServer||[],"ascii"),e.writeList(this.languagesServerToClient||[],"ascii"),e.writeBoolean(null!==(t=this.firstKexPacketFollows)&&void 0!==t&&t),e.writeUInt32(this.reserved||0)}static CreateNone(){const e=["none"],t=[""],r=new a;return r.cookie=n.Buffer.alloc(16),r.keyExchangeAlgorithms=e,r.serverHostKeyAlgorithms=e,r.encryptionAlgorithmsClientToServer=e,r.encryptionAlgorithmsServerToClient=e,r.macAlgorithmsClientToServer=e,r.macAlgorithmsServerToClient=e,r.compressionAlgorithmsClientToServer=e,r.compressionAlgorithmsServerToClient=e,r.languagesClientToServer=t,r.languagesServerToClient=t,r.rawBytes=r.toBuffer(),r}get allowsNone(){const e=e=>!0===(null==e?void 0:e.includes("none"));return e(this.keyExchangeAlgorithms)&&e(this.serverHostKeyAlgorithms)&&e(this.encryptionAlgorithmsClientToServer)&&e(this.encryptionAlgorithmsServerToClient)&&e(this.macAlgorithmsClientToServer)&&e(this.macAlgorithmsServerToClient)&&e(this.compressionAlgorithmsClientToServer)&&e(this.compressionAlgorithmsServerToClient)&&!0!==this.firstKexPacketFollows}}t.KeyExchangeInitMessage=a,a.none=a.CreateNone();class c extends o{get messageType(){return 30}onRead(e){this.e=e.readBinary()}onWrite(e){e.writeBinary(this.validateField(this.e,"E"))}}t.KeyExchangeDhInitMessage=c;class h extends o{get messageType(){return 31}onRead(e){this.hostKey=e.readBinary(),this.f=e.readBinary(),this.signature=e.readBinary()}onWrite(e){e.writeBinary(this.validateField(this.hostKey,"host key")),e.writeBinary(this.validateField(this.f,"F")),e.writeBinary(this.validateField(this.signature,"signature"))}}t.KeyExchangeDhReplyMessage=h;class l extends o{get messageType(){return 21}onRead(e){}onWrite(e){}}t.NewKeysMessage=l,s.SshMessage.index.set(20,a),s.SshMessage.index.set(30,c),s.SshMessage.index.set(31,h),s.SshMessage.index.set(21,l)},8973:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshMessage=void 0;const n=r(4300),s=r(5879);class i{get messageType(){return 0}toBuffer(){const e=new s.SshDataWriter(n.Buffer.alloc(16));return this.write(e),e.toBuffer()}read(e){this.rawBytes=e.buffer;const t=e.readByte();if(t!==this.messageType)throw new Error(`Message type ${t} is not valid.`);this.onRead(e)}write(e){this.rawBytes?e.write(this.rawBytes):(e.writeByte(this.messageType),this.onWrite(e))}onRead(e){throw new Error("Not supported.")}onWrite(e){throw new Error("Not supported.")}validateField(e,t){if(void 0===e)throw new Error(`${this.constructor.name} ${t} is required.`);return e}toString(){return this.constructor.name}static create(e,t,r){const n=e.messages.get(t);if(n){const e=new n;return e.read(new s.SshDataReader(r)),e}return null}convertTo(e,t=!1){const r=new s.SshDataReader(t?n.Buffer.from(this.rawBytes):this.rawBytes);return e.read(r),e}}t.SshMessage=i,i.index=new Map},8673:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionReconnectFailureMessage=t.SshReconnectFailureReason=t.SessionReconnectResponseMessage=t.SessionReconnectRequestMessage=t.SessionChannelRequestMessage=t.ExtensionInfoMessage=t.SessionRequestFailureMessage=t.SessionRequestSuccessMessage=t.SessionRequestMessage=t.ServiceAcceptMessage=t.ServiceRequestMessage=t.DebugMessage=t.UnimplementedMessage=t.IgnoreMessage=t.DisconnectMessage=t.SshDisconnectReason=void 0;const n=r(8973),s=r(733);var i,o;!function(e){e[e.none=0]="none",e[e.hostNotAllowedToConnect=1]="hostNotAllowedToConnect",e[e.protocolError=2]="protocolError",e[e.keyExchangeFailed=3]="keyExchangeFailed",e[e.reserved=4]="reserved",e[e.macError=5]="macError",e[e.compressionError=6]="compressionError",e[e.serviceNotAvailable=7]="serviceNotAvailable",e[e.protocolVersionNotSupported=8]="protocolVersionNotSupported",e[e.hostKeyNotVerifiable=9]="hostKeyNotVerifiable",e[e.connectionLost=10]="connectionLost",e[e.byApplication=11]="byApplication",e[e.tooManyConnections=12]="tooManyConnections",e[e.authCancelledByUser=13]="authCancelledByUser",e[e.noMoreAuthMethodsAvailable=14]="noMoreAuthMethodsAvailable",e[e.illegalUserName=15]="illegalUserName"}(i=t.SshDisconnectReason||(t.SshDisconnectReason={}));class a extends n.SshMessage{get messageType(){return 1}onRead(e){this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),e.available>=4?this.language=e.readString("ascii"):this.language=null}onWrite(e){e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),this.language&&e.writeString(this.language,"ascii")}toString(){return`${super.toString()} (${i[this.reasonCode||0]}: ${this.description})`}}t.DisconnectMessage=a;class c extends n.SshMessage{get messageType(){return 2}onRead(e){}onWrite(e){}}t.IgnoreMessage=c;class h extends n.SshMessage{get messageType(){return 3}onRead(e){this.sequenceNumber=e.readUInt32()}onWrite(e){e.writeUInt32(this.validateField(this.sequenceNumber,"sequence number"))}toString(){return this.unimplementedMessageType?`${super.toString()} (messageType=${this.unimplementedMessageType})`:`${super.toString()} (sequenceNumber=${this.sequenceNumber})`}}t.UnimplementedMessage=h;class l extends n.SshMessage{constructor(e){super(),this.alwaysDisplay=!1,this.message=e}get messageType(){return 4}onRead(e){this.alwaysDisplay=e.readBoolean(),this.message=e.readString("utf8"),this.language=e.readString("ascii")}onWrite(e){var t,r;e.writeBoolean(this.alwaysDisplay),e.writeString(null!==(t=this.message)&&void 0!==t?t:"","utf8"),e.writeString(null!==(r=this.language)&&void 0!==r?r:"","ascii")}toString(){return`${super.toString()}: ${this.message}`}}t.DebugMessage=l;class u extends n.SshMessage{get messageType(){return 5}onRead(e){this.serviceName=e.readString("ascii")}onWrite(e){e.writeString(this.validateField(this.serviceName,"service name"),"ascii")}}t.ServiceRequestMessage=u;class d extends n.SshMessage{get messageType(){return 6}onRead(e){this.serviceName=e.readString("ascii")}onWrite(e){e.writeString(this.validateField(this.serviceName,"service name"),"ascii")}}t.ServiceAcceptMessage=d;class p extends n.SshMessage{constructor(e,t){super(),this.requestType=e,this.wantReply=null!=t&&t}get messageType(){return 80}onRead(e){this.requestType=e.readString("ascii"),this.wantReply=e.readBoolean()}onWrite(e){e.writeString(this.validateField(this.requestType,"request type"),"ascii"),e.writeBoolean(this.wantReply)}toString(){return`${super.toString()} (requestType=${this.requestType})`}}t.SessionRequestMessage=p;class f extends n.SshMessage{get messageType(){return 81}onRead(e){}onWrite(e){}}t.SessionRequestSuccessMessage=f;class g extends n.SshMessage{get messageType(){return 82}onRead(e){}onWrite(e){}}t.SessionRequestFailureMessage=g;class m extends n.SshMessage{constructor(){super(...arguments),this.extensionInfo={}}get messageType(){return 7}onRead(e){const t=e.readUInt32();this.extensionInfo={};for(let r=0;r<t;r++){const t=e.readString("ascii"),r=e.readString("utf8");this.extensionInfo[t]=r}}onWrite(e){const t=Object.keys(this.extensionInfo);e.writeUInt32(t.length);for(const r of t)e.writeString(r,"ascii"),e.writeString(this.extensionInfo[r]||"","utf8")}toString(){let e="";for(const[t,r]of Object.entries(this.extensionInfo))e&&(e+="; "),e+=t,r&&(e+="="+r);return`${super.toString()} (${e})`}}t.ExtensionInfoMessage=m,m.serverIndicator="ext-info-c",m.clientIndicator="ext-info-c",t.SessionChannelRequestMessage=class extends p{onRead(e){super.onRead(e),this.senderChannel=e.readUInt32();const t=new s.ChannelRequestMessage;t.read(e),this.request=t}onWrite(e){super.onWrite(e),e.writeUInt32(this.validateField(this.senderChannel,"sender channel")),this.validateField(this.request,"request message").write(e)}},t.SessionReconnectRequestMessage=class extends p{onRead(e){super.onRead(e),this.clientReconnectToken=e.readBinary(),this.lastReceivedSequenceNumber=e.readUInt64()}onWrite(e){super.onWrite(e),e.writeBinary(this.validateField(this.clientReconnectToken,"clientReconnectToken")),e.writeUInt64(this.validateField(this.lastReceivedSequenceNumber,"lastReceivedSequenceNumber"))}},t.SessionReconnectResponseMessage=class extends f{onRead(e){super.onRead(e),this.serverReconnectToken=e.readBinary(),this.lastReceivedSequenceNumber=e.readUInt64()}onWrite(e){super.onWrite(e),e.writeBinary(this.validateField(this.serverReconnectToken,"serverReconnectToken")),e.writeUInt64(this.validateField(this.lastReceivedSequenceNumber,"lastReceivedSequenceNumber"))}},function(e){e[e.none=0]="none",e[e.unknownServerFailure=1]="unknownServerFailure",e[e.sessionNotFound=2]="sessionNotFound",e[e.invalidClientReconnectToken=3]="invalidClientReconnectToken",e[e.serverDroppedMessages=4]="serverDroppedMessages",e[e.unknownClientFailure=101]="unknownClientFailure",e[e.differentServerHostKey=102]="differentServerHostKey",e[e.invalidServerReconnectToken=103]="invalidServerReconnectToken",e[e.clientDroppedMessages=104]="clientDroppedMessages"}(o=t.SshReconnectFailureReason||(t.SshReconnectFailureReason={})),t.SessionReconnectFailureMessage=class extends g{onRead(e){e.available>0&&(this.reasonCode=e.readUInt32(),this.description=e.readString("utf8"),this.language=e.readString("ascii"))}onWrite(e){e.writeUInt32(this.validateField(this.reasonCode,"reason code")),e.writeString(this.description||"","utf8"),e.writeString(this.language||"en","ascii")}toString(){return`${super.toString()} (${o[this.reasonCode||0]}: ${this.description})`}},n.SshMessage.index.set(1,a),n.SshMessage.index.set(2,c),n.SshMessage.index.set(3,h),n.SshMessage.index.set(5,u),n.SshMessage.index.set(6,d),n.SshMessage.index.set(7,m),n.SshMessage.index.set(80,p),n.SshMessage.index.set(81,f),n.SshMessage.index.set(82,g)},201:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelMetrics=void 0,t.ChannelMetrics=class{constructor(){this.bytesSentSum=0,this.bytesReceivedSum=0}get bytesSent(){return this.bytesSentSum}get bytesReceived(){return this.bytesReceivedSum}addBytesSent(e){this.bytesSentSum+=e}addBytesReceived(e){this.bytesReceivedSum+=e}toString(){return`Bytes S/R: ${this.bytesSent} / ${this.bytesReceived}; `}}},3250:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionContour=void 0;const n=r(5443),s=r(1024),i=r(7688);class o{constructor(e=256){if(this.intervalMs=o.initialInterval,this.count=0,this.updateQueue=new s.Queue,this.updateSemaphore=new i.Semaphore(0),this.disposed=!1,e<2||0!=(e&e-1))throw new Error("Contour intervals must be a power of two.");this.maxIntervals=e,this.intervalBytesSent=new Array(e),this.intervalBytesReceived=new Array(e),this.intervalLatencyMin=new Array(e),this.intervalLatencyMax=new Array(e),this.intervalLatencySum=new Array(e),this.intervalLatencyCount=new Array(e),this.intervalLatencyAvg=new Array(e),this.intervalBytesSent.fill(0),this.intervalBytesReceived.fill(0),this.intervalLatencyMin.fill(0),this.intervalLatencyMax.fill(0),this.intervalLatencySum.fill(0),this.intervalLatencyCount.fill(0),this.intervalLatencyAvg.fill(0)}get intervalCount(){return this.count}get interval(){return this.intervalMs}get bytesSent(){return this.intervalBytesSent.slice(0,this.count)}get bytesReceived(){return this.intervalBytesReceived.slice(0,this.count)}get latencyMinMs(){return this.intervalLatencyMin.slice(0,this.count)}get latencyMaxMs(){return this.intervalLatencyMax.slice(0,this.count)}get latencyAverageMs(){return this.intervalLatencyAvg.slice(0,this.count)}onMessageSent(e){this.updateQueue.enqueue({time:e.time,bytesSent:e.size}),this.updateSemaphore.tryRelease()}onMessageReceived(e){this.updateQueue.enqueue({time:e.time,bytesReceived:e.size}),this.updateSemaphore.tryRelease()}onLatencyUpdated(e){this.updateQueue.enqueue(e),this.updateSemaphore.tryRelease()}onSessionClosed(){this.updateSemaphore.tryRelease()}async collectMetrics(e,t){if(!e)throw new TypeError("A session metrics object is required.");if(this.disposed)throw new n.ObjectDisposedError(this);const r=[];r.push(e.onMessageSent(this.onMessageSent.bind(this))),r.push(e.onMessageReceived(this.onMessageReceived.bind(this))),r.push(e.onLatencyUpdated(this.onLatencyUpdated.bind(this))),r.push(e.onSessionClosed(this.onSessionClosed.bind(this)));try{for(;!(null==t?void 0:t.isCancellationRequested);){try{await this.updateSemaphore.wait(t)}catch(e){break}const e=this.updateQueue.dequeue();if(!e)break;const r=this.updateInterval(e.time);e.bytesSent&&(this.intervalBytesSent[r]+=e.bytesSent),e.bytesReceived&&(this.intervalBytesReceived[r]+=e.bytesReceived);const n=e.latency;n&&((!this.intervalLatencyMin[r]||n<this.intervalLatencyMin[r])&&(this.intervalLatencyMin[r]=n),(!this.intervalLatencyMax[r]||n>this.intervalLatencyMax[r])&&(this.intervalLatencyMax[r]=n),this.intervalLatencySum[r]+=n,this.intervalLatencyCount[r]++,this.intervalLatencyAvg[r]=this.intervalLatencySum[r]/this.intervalLatencyCount[r])}this.disposed&&this.updateSemaphore.dispose()}finally{for(const e of r)e.dispose()}}updateInterval(e){let t=Math.floor(e/this.intervalMs);if(t>=this.intervalCount){for(;t>=this.maxIntervals;)this.expandIntervals(),t=Math.floor(e/this.intervalMs);this.count=t+1}return t}expandIntervals(){const e=(e,t,r)=>0===e?t:0===t?e:r(e,t),t=this.maxIntervals/2;for(let r=0;r<t;r++){const t=2*r,n=2*r+1;this.intervalBytesSent[r]=this.intervalBytesSent[t]+this.intervalBytesSent[n],this.intervalBytesReceived[r]=this.intervalBytesReceived[t]+this.intervalBytesReceived[n],this.intervalLatencyMin[r]=e(this.intervalLatencyMin[t],this.intervalLatencyMin[n],Math.min),this.intervalLatencyMax[r]=e(this.intervalLatencyMax[t],this.intervalLatencyMax[n],Math.max),this.intervalLatencySum[r]=this.intervalLatencySum[t]+this.intervalLatencySum[n];const s=this.intervalLatencyCount[t]+this.intervalLatencyCount[n];this.intervalLatencyCount[r]=s,this.intervalLatencyAvg[r]=0===s?0:this.intervalLatencySum[r]/this.intervalLatencyCount[r]}this.intervalBytesSent.fill(0,t,this.maxIntervals),this.intervalBytesReceived.fill(0,t,this.maxIntervals),this.intervalLatencyMin.fill(0,t,this.maxIntervals),this.intervalLatencyMax.fill(0,t,this.maxIntervals),this.intervalLatencySum.fill(0,t,this.maxIntervals),this.intervalLatencyCount.fill(0,t,this.maxIntervals),this.intervalLatencyAvg.fill(0,t,this.maxIntervals),this.intervalMs*=2}dispose(){this.disposed=!0,this.updateSemaphore.tryRelease()}export(){const e=e=>Math.max(0,Math.ceil(Math.log2(Math.max(...e)/255))),t=(e,t)=>Math.round(e/Math.pow(2,t)),r=Buffer.alloc(3+5*(2+this.intervalCount)),n=Math.log2(this.interval/o.initialInterval);r[0]=1,r[1]=5,r[2]=n,r[3]=e(this.latencyMinMs),r[4]=e(this.latencyMaxMs),r[5]=e(this.latencyAverageMs),r[6]=e(this.bytesSent),r[7]=e(this.bytesReceived),r[8]=a.latencyMin,r[9]=a.latencyMax,r[10]=a.latencyAverage,r[11]=a.bytesSent,r[12]=a.bytesReceived;for(let e=0;e<this.intervalCount;e++){const n=13+5*e;r[n+0]=t(this.intervalLatencyMin[e],r[3]),r[n+1]=t(this.intervalLatencyMax[e],r[4]),r[n+2]=t(this.intervalLatencyAvg[e],r[5]),r[n+3]=t(this.intervalBytesSent[e],r[6]),r[n+4]=t(this.intervalBytesReceived[e],r[7])}return r.toString("base64")}static import(e){const t=Buffer.from(e,"base64");if(t.length<3)throw new Error("Invalid session contour string.");const r=t[0],n=t[1],s=t[2];if(1!==r)throw new Error(`Unsupported session contour version: ${r}`);const i=(t.length-3)/n-2;if(i<1||t.length!==3+n*(i+2))throw new Error("Incomplete session contour string.");const c=Math.pow(2,Math.ceil(Math.log2(i))),h=new o(c);h.intervalMs=Math.pow(2,s)*o.initialInterval,h.count=i;const l=new Array(n);for(let e=0;e<n;e++)l[e]=Math.pow(2,t[3+e]);const u=new Array(n);for(let e=0;e<n;e++)u[e]=t[3+n+e];for(let e=0;e<i;e++){const r=3+(2+e)*n;for(let s=0;s<n;s++)switch(u[s]){case a.latencyMin:h.intervalLatencyMin[e]=t[r+s]*l[s];break;case a.latencyMax:h.intervalLatencyMax[e]=t[r+s]*l[s];break;case a.latencyAverage:h.intervalLatencyAvg[e]=h.intervalLatencySum[e]=t[r+s]*l[s],h.intervalLatencyCount[e]=0===t[r+s]?0:1;break;case a.bytesSent:h.intervalBytesSent[e]=t[r+s]*l[s];break;case a.bytesReceived:h.intervalBytesReceived[e]=t[r+s]*l[s]}}return h}}var a;t.SessionContour=o,o.initialInterval=1e3,function(e){e[e.none=0]="none",e[e.latencyMin=1]="latencyMin",e[e.latencyMax=2]="latencyMax",e[e.latencyAverage=3]="latencyAverage",e[e.bytesSent=11]="bytesSent",e[e.bytesReceived=12]="bytesReceived"}(a||(a={}))},4235:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionMetrics=void 0;const n=r(8231);t.SessionMetrics=class{constructor(){this.startTime=0,this.messagesSentCount=0,this.messagesReceivedCount=0,this.bytesSentSum=0,this.bytesReceivedSum=0,this.reconnectionsCount=0,this.currentLatency=0,this.minLatency=0,this.maxLatency=0,this.latencySum=0,this.latencyCount=0,this.messageSentEmitter=new n.Emitter,this.onMessageSent=this.messageSentEmitter.event,this.messageReceivedEmitter=new n.Emitter,this.onMessageReceived=this.messageReceivedEmitter.event,this.latencyUpdatedEmitter=new n.Emitter,this.onLatencyUpdated=this.latencyUpdatedEmitter.event,this.sessionClosedEmitter=new n.Emitter,this.onSessionClosed=this.sessionClosedEmitter.event,"object"==typeof performance&&"function"==typeof performance.now?Object.defineProperty(this,"time",{get:this.browserTime}):"object"==typeof process&&"function"==typeof process.hrtime&&Object.defineProperty(this,"time",{get:this.nodejsTime}),this.startTime=this.time}get time(){return Date.now()-this.startTime}browserTime(){return performance.now()-this.startTime}nodejsTime(){const[e,t]=process.hrtime();return 1e3*e+t/1e6-this.startTime}get messagesSent(){return this.messagesSentCount}get messagesReceived(){return this.messagesReceivedCount}get bytesSent(){return this.bytesSentSum}get bytesReceived(){return this.bytesReceivedSum}get reconnections(){return this.reconnectionsCount}get latencyAverageMs(){return 0===this.latencyCount?0:this.latencySum/this.latencyCount}get latencyMinMs(){return this.minLatency}get latencyMaxMs(){return this.maxLatency}get latencyCurrentMs(){return this.currentLatency}addMessageSent(e){this.messagesSentCount++,this.bytesSentSum+=e,this.messageSentEmitter.fire({time:this.time,size:e})}addMessageReceived(e){this.messagesReceivedCount++,this.bytesReceivedSum+=e,this.messageReceivedEmitter.fire({time:this.time,size:e})}addReconnection(){this.reconnectionsCount++}updateLatency(e){if(e<0)throw new Error("Measured latency cannot be negative.");this.currentLatency=e,0!==e&&((0===this.minLatency||e<this.minLatency)&&(this.minLatency=e),(0===this.maxLatency||e>this.maxLatency)&&(this.maxLatency=e),this.latencySum+=e,this.latencyCount++,this.latencyUpdatedEmitter.fire({time:this.time,latency:e}))}close(){this.currentLatency=0,this.sessionClosedEmitter.fire()}toString(){let e=`Messages S/R: ${this.messagesSent} / ${this.messagesReceived}; Bytes S/R: ${this.bytesSent} / ${this.bytesReceived}; Reconnections: ${this.reconnections}; `;const t=this.minLatency>=10?1:this.minLatency>=1?10:100;return this.maxLatency>0&&(e+=`Latency Min-Avg-Max: ${Math.round(this.minLatency*t)/t} - ${Math.round(this.latencySum/this.latencyCount*t)/t} - ${Math.round(this.maxLatency*t)/t} ms; `),this.currentLatency>0&&(e+=`Current Latency: ${Math.round(this.currentLatency*t)/t} ms; `),e}}},6724:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiChannelStream=void 0;const n=r(8231),s=r(9174),i=r(3500),o=r(8016),a=r(3816),c=r(8673),h=r(1618),l=r(733);t.MultiChannelStream=class{constructor(e){if(this.transportStream=e,this.disposed=!1,this.disposables=[],this.channelMaxWindowSize=s.SshChannel.defaultMaxWindowSize,this.closedEmitter=new n.Emitter,this.onClosed=this.closedEmitter.event,this.channelOpeningEmitter=new n.Emitter,this.onChannelOpening=this.channelOpeningEmitter.event,!e)throw new TypeError("transportStream is required.");const t=new a.SshSessionConfiguration(!1);this.session=new o.SshSession(t),this.session.onClosed(this.onSessionClosed,this,this.disposables),this.session.onChannelOpening(this.onSessionChannelOpening,this,this.disposables)}get trace(){return this.session.trace}set trace(e){this.session.trace=e}get isClosed(){return this.disposed||this.session.isClosed}async connect(e){await this.session.connect(this.transportStream,e)}async acceptChannel(e,t){return await this.session.connect(this.transportStream,t),await this.session.acceptChannel(e,t)}async acceptStream(e,t){return this.createStream(await this.acceptChannel(e,t))}async openChannel(e,t){await this.session.connect(this.transportStream,t);const r=new l.ChannelOpenMessage;return r.channelType=null!=e?e:s.SshChannel.sessionChannelType,r.maxWindowSize=this.channelMaxWindowSize,await this.session.openChannel(r,null,t)}async openStream(e,t){return this.createStream(await this.openChannel(e,t))}createStream(e){return new i.SshStream(e)}async connectAndRunUntilClosed(e){const t=[],r=new Promise(((r,n)=>{null==e||e.onCancellationRequested(n,null,t),this.session.onClosed(r,null,t)}));try{await this.connect(e),await r}finally{t.forEach((e=>e.dispose())),await this.close()}}dispose(){if(!this.disposed){this.disposed=!0,this.session.dispose(),this.unsubscribe();try{this.transportStream&&this.transportStream.close().catch((e=>{this.trace(h.TraceLevel.Error,h.SshTraceEventIds.streamCloseError,`Error closing transport stream: ${e.message}`,e)}))}catch(e){if(!(e instanceof Error))throw e;this.trace(h.TraceLevel.Error,h.SshTraceEventIds.streamCloseError,`Error closing transport stream: ${e.message}`,e)}}}async close(){this.disposed||(this.disposed=!0,await this.session.close(c.SshDisconnectReason.none,"SshSession disposed"),this.session.dispose(),this.unsubscribe(),await this.transportStream.close())}onSessionClosed(e){this.unsubscribe(),this.closedEmitter.fire(e)}onSessionChannelOpening(e){e.isRemoteRequest&&(e.channel.maxWindowSize=this.channelMaxWindowSize),this.channelOpeningEmitter.fire(e)}unsubscribe(){this.disposables.forEach((e=>e.dispose())),this.disposables=[]}}},1513:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PipeExtensions=void 0;const n=r(8231),s=r(8673),i=r(733),o=r(5928),a=r(5443);class c{static async pipeSession(e,t){if(!e)throw new TypeError("Session is required.");if(!t)throw new TypeError("Target session is required");const r=new o.PromiseCompletionSource;e.onRequest((e=>{e.responsePromise=c.forwardSessionRequest(e,t,e.cancellation)})),t.onRequest((t=>{t.responsePromise=c.forwardSessionRequest(t,e,t.cancellation)})),e.onChannelOpening((e=>{e.isRemoteRequest&&(e.openingPromise=c.forwardChannel(e,t,e.cancellation))})),t.onChannelOpening((t=>{t.isRemoteRequest&&(t.openingPromise=c.forwardChannel(t,e,t.cancellation))})),e.onClosed((e=>{r.resolve(c.forwardSessionClose(t,e))})),t.onClosed((t=>{r.resolve(c.forwardSessionClose(e,t))}));const n=await r.promise;await n}static async pipeChannel(e,t){if(!e)throw new TypeError("Channel is required.");if(!t)throw new TypeError("Target channel is required");const r=new o.PromiseCompletionSource;let n=!1;e.onRequest((e=>{e.responsePromise=c.forwardChannelRequest(e,t,e.cancellation)})),t.onRequest((t=>{t.responsePromise=c.forwardChannelRequest(t,e,t.cancellation)})),e.onDataReceived((r=>{c.forwardData(e,t,r).catch()})),t.onDataReceived((r=>{c.forwardData(t,e,r).catch()})),e.onClosed((e=>{n||(n=!0,r.resolve(c.forwardChannelClose(t,e)))})),t.onClosed((t=>{n||(n=!0,r.resolve(c.forwardChannelClose(e,t)))}));const s=await r.promise;await s}static async forwardSessionRequest(e,t,r){return await t.requestResponse(e.request,s.SessionRequestSuccessMessage,s.SessionRequestFailureMessage,r)}static async forwardChannel(e,t,r){var n;try{const n=await t.openChannel(e.request,null,r);c.pipeChannel(e.channel,n).catch()}catch(t){if(!(t instanceof Error))throw t;t instanceof a.SshChannelError?e.failureReason=null!==(n=t.reason)&&void 0!==n?n:i.SshChannelOpenFailureReason.connectFailed:e.failureReason=i.SshChannelOpenFailureReason.connectFailed,e.failureDescription=t.message}}static async forwardChannelRequest(e,t,r){return e.request.recipientChannel=t.remoteChannelId,await t.request(e.request,r)?new i.ChannelSuccessMessage:new i.ChannelFailureMessage}static async forwardSessionClose(e,t){var r;return e.close(t.reason,t.message,null!==(r=t.error)&&void 0!==r?r:void 0)}static async forwardData(e,t,r){await t.send(r,n.CancellationToken.None),e.adjustWindow(r.length)}static async forwardChannelClose(e,t){return t.error?(e.close(t.error),Promise.resolve()):t.exitSignal?e.close(t.exitSignal,t.errorMessage):"number"==typeof t.exitStatus?e.close(t.exitStatus):e.close()}}t.PipeExtensions=c},8524:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SecureStream=void 0;const n=r(8231),s=r(3500),i=r(3816),o=r(8673),a=r(1618),c=r(3398),h=r(6140),l=r(5443),u=r(2781);class d extends u.Duplex{constructor(e,t){if(super({write(e,t,r){return this.connectedStream._write(e,t,r)},writev(e,t){return this.connectedStream._writev(e,t)},final(e){return this.connectedStream._final(e)},read(e){return this.connectedStream._read(e)}}),this.transportStream=e,this.clientCredentials=null,this.serverCredentials=null,this.disposed=!1,this.disposables=[],this.closedEmitter=new n.Emitter,this.onClosed=this.closedEmitter.event,!e)throw new TypeError("A transport stream is required.");if(!t)throw new TypeError("Client or server credentials are required.");const r=new i.SshSessionConfiguration(!0);if("username"in t)this.clientCredentials=t,this.session=new c.SshClientSession(r);else{if(!t.publicKeys)throw new TypeError("Client or server credentials are required.");this.serverCredentials=t,this.session=new h.SshServerSession(r)}this.session.onClosed(this.onSessionClosed,this,this.disposables)}get connectedStream(){if(!this.stream)throw new Error("Stream is not connected.");return this.stream}get trace(){return this.session.trace}set trace(e){this.session.trace=e}get isClosed(){return this.disposed||this.session.isClosed}onAuthenticating(e,t,r){return this.session.onAuthenticating(e,t,r)}async connect(e){this.serverCredentials&&(this.session.credentials=this.serverCredentials),await this.session.connect(this.transportStream,e);let t=null;if(this.clientCredentials){let r=null;const n=this.session;if(await n.authenticateServer(e)||(r=new l.SshConnectionError("Server authentication failed.",o.SshDisconnectReason.hostKeyNotVerifiable)),r||await n.authenticateClient(this.clientCredentials,e)||(r=new l.SshConnectionError("Client authentication failed.",o.SshDisconnectReason.noMoreAuthMethodsAvailable)),r)throw await this.session.close(r.reason,r.message,r),r;t=await this.session.openChannel(e)}else t=await this.session.acceptChannel(e);this.stream=this.createStream(t),this.stream.on("data",(e=>this.emit("data",e))),this.stream.on("end",(()=>this.emit("end"))),this.stream.on("close",(()=>this.emit("close"))),this.stream.on("error",(()=>this.emit("error"))),t.onClosed((()=>this.dispose()))}createStream(e){return new s.SshStream(e)}dispose(){if(!this.disposed){this.disposed=!0,this.session.dispose(),this.unsubscribe();try{this.transportStream&&this.transportStream.close().catch((e=>{this.trace(a.TraceLevel.Error,a.SshTraceEventIds.streamCloseError,`Error closing transport stream: ${e.message}`,e)}))}catch(e){if(!(e instanceof Error))throw e;this.trace(a.TraceLevel.Error,a.SshTraceEventIds.streamCloseError,`Error closing transport stream: ${e.message}`,e)}}}async close(){this.disposed||(this.disposed=!0,await this.session.close(o.SshDisconnectReason.none,"SshSession disposed"),this.session.dispose(),this.unsubscribe(),await this.transportStream.close())}onSessionClosed(e){this.unsubscribe(),this.closedEmitter.fire(e)}unsubscribe(){this.disposables.forEach((e=>e.dispose())),this.disposables=[]}}t.SecureStream=d},5300:function(e,t,r){"use strict";var n,s=this&&this.__decorate||function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationService=void 0;const i=r(2100),o=r(2694),a=r(8231),c=r(5879),h=r(8673),l=r(3886),u=r(8402),d=r(8272),p=r(1024),f=r(1618);let g=n=class extends i.SshService{constructor(e){var t;super(e),this.authenticationFailureCount=0,this.disposeCancellationSource=new a.CancellationTokenSource;const r=null===(t=e.algorithms)||void 0===t?void 0:t.publicKeyAlgorithmName;if(!r)throw new Error("Algorithms not initialized.");this.publicKeyAlgorithmName=r}handleMessage(e,t){if(e instanceof o.AuthenticationSuccessMessage)return this.handleSuccessMessage(e);if(e instanceof o.AuthenticationFailureMessage)return this.handleFailureMessage(e);if(e instanceof o.AuthenticationRequestMessage)return this.handleAuthenticationRequestMessage(e,t);throw new Error(`Message not implemented: ${e}`)}async handleAuthenticationRequestMessage(e,t){if(this.trace(f.TraceLevel.Info,f.SshTraceEventIds.sessionAuthenticating,`Authentication request: ${e.methodName}`),"publickey"===e.methodName||"hostbased"===e.methodName)return this.handlePublicKeyRequestMessage(e.convertTo(new o.PublicKeyRequestMessage),t);if("password"===e.methodName)return this.handlePasswordRequestMessage(e.convertTo(new o.PasswordRequestMessage),t);if("none"===e.methodName)return this.handleAuthenticating(e,new l.SshAuthenticatingEventArgs(l.SshAuthenticationType.clientNone,{username:e.username},t));{const e=new o.AuthenticationFailureMessage;e.methodNames=["publickey","password","hostbased"],await this.session.sendMessage(e,t)}}async handlePublicKeyRequestMessage(e,t){var r,n,s;const i=this.session.config.getPublicKeyAlgorithm(e.keyAlgorithmName);if(!i){const e=new o.AuthenticationFailureMessage;return e.methodNames=["publickey","password"],void await this.session.sendMessage(e,t)}const a=i.createKeyPair();let h;if(await a.setPublicKeyBytes(e.publicKey),"hostbased"===e.methodName)h=new l.SshAuthenticatingEventArgs(l.SshAuthenticationType.clientHostBased,{username:null!==(r=e.username)&&void 0!==r?r:"",publicKey:a,clientHostname:e.clientHostname,clientUsername:e.clientUsername});else if(e.hasSignature){const r=i.readSignatureData(e.signature),n=this.session.sessionId;if(null==n)throw new Error("Session ID not initialized.");const o=new c.SshDataWriter(Buffer.alloc(n.length+e.payloadWithoutSignature.length+20));o.writeBinary(n),o.write(e.payloadWithoutSignature);const u=o.toBuffer(),d=i.createVerifier(a);await d.verify(u,r)||await this.handleAuthenticationFailure("Public key authentication failed: invalid signature.",t),h=new l.SshAuthenticatingEventArgs(l.SshAuthenticationType.clientPublicKey,{username:null!==(s=e.username)&&void 0!==s?s:"",publicKey:a})}else h=new l.SshAuthenticatingEventArgs(l.SshAuthenticationType.clientPublicKeyQuery,{username:null!==(n=e.username)&&void 0!==n?n:"",publicKey:a});await this.handleAuthenticating(e,h,t)}async handlePasswordRequestMessage(e,t){var r,n;const s=new l.SshAuthenticatingEventArgs(l.SshAuthenticationType.clientPassword,{username:null!==(r=e.username)&&void 0!==r?r:"",password:null!==(n=e.password)&&void 0!==n?n:""});await this.handleAuthenticating(e,s,t)}async handleAuthenticating(e,t,r){var n;t.cancellation=this.disposeCancellationSource.token;let s=null;try{s=await this.session.raiseAuthenticatingEvent(t)}catch(e){if(!(e instanceof Error))throw e;this.trace(f.TraceLevel.Error,f.SshTraceEventIds.authenticationError,`Error while authenticating client: ${e.message}`,e),s=null}if(s)if(t.authenticationType===l.SshAuthenticationType.clientPublicKeyQuery){const t=e,n=new o.PublicKeyOKMessage;n.keyAlgorithmName=t.keyAlgorithmName,n.publicKey=t.publicKey,await this.session.sendMessage(n,r)}else this.session.principal=s,e.serviceName&&this.session.activateService(e.serviceName),this.trace(f.TraceLevel.Info,f.SshTraceEventIds.sessionAuthenticated,`${l.SshAuthenticationType[t.authenticationType]} authentication succeeded.`),await this.session.sendMessage(new o.AuthenticationSuccessMessage,r),null===(n=this.session)||void 0===n||n.handleClientAuthenticated();else await this.handleAuthenticationFailure(`${l.SshAuthenticationType[t.authenticationType]} authentication failed.`)}async handleAuthenticationFailure(e,t){this.authenticationFailureCount++,this.trace(f.TraceLevel.Warning,f.SshTraceEventIds.clientAuthenticationFailed,e);const r=new o.AuthenticationFailureMessage;r.methodNames=["publickey","password","hostbased"],await this.session.sendMessage(r,t),this.authenticationFailureCount>=this.session.config.maxClientAuthenticationAttempts&&await this.session.close(h.SshDisconnectReason.noMoreAuthMethodsAvailable,"Authentication failed.")}async authenticateClient(e,t){var r,n,s,i;this.clientAuthenticationMethods=new p.Queue;for(const t of null!==(r=e.publicKeys)&&void 0!==r?r:[]){if(!t)continue;const r=null!==(n=e.username)&&void 0!==n?n:"";let s=t;const i=e.privateKeyProvider;this.clientAuthenticationMethods.enqueue((async e=>{if(!s.hasPrivateKey){if(null==i)throw new Error("A private key provider is required.");s=await i(t,null!=e?e:a.CancellationToken.None)}s?await this.requestPublicKeyAuthentication(r,s,e):await this.session.close(h.SshDisconnectReason.authCancelledByUser)}))}const o=e.passwordProvider;if(o)this.clientAuthenticationMethods.enqueue((async e=>{var t;const r=o(null!=e?e:a.CancellationToken.None),n=r?await r:null;n?await this.requestPasswordAuthentication(null!==(t=n[0])&&void 0!==t?t:"",n[1],e):await this.session.close(h.SshDisconnectReason.authCancelledByUser)}));else if(e.password){const t=null!==(s=e.username)&&void 0!==s?s:"",r=e.password;this.clientAuthenticationMethods.enqueue((async e=>{await this.requestPasswordAuthentication(t,r,e)}))}if(0===this.clientAuthenticationMethods.size){const t=null!==(i=e.username)&&void 0!==i?i:"";this.clientAuthenticationMethods.enqueue((async e=>{await this.requestUsernameAuthentication(t,e)}))}const c=this.clientAuthenticationMethods.dequeue();await c(t)}async requestUsernameAuthentication(e,t){const r=new o.AuthenticationRequestMessage;r.serviceName=u.ConnectionService.serviceName,r.methodName="none",r.username=e,await this.session.sendMessage(r,t),this.session.activateService(u.ConnectionService)}async requestPublicKeyAuthentication(e,t,r){const n=this.session.config.publicKeyAlgorithms.find((e=>(null==e?void 0:e.keyAlgorithmName)===t.keyAlgorithmName));if(!n)throw new Error(`Public key algorithm '${t.keyAlgorithmName}' is not in session config.`);const s=new o.PublicKeyRequestMessage;s.serviceName=u.ConnectionService.serviceName,s.username=e,s.keyAlgorithmName=n.name,s.publicKey=await t.getPublicKeyBytes(n.name),s.signature=await this.createAuthenticationSignature(s,n,t),await this.session.sendMessage(s,r),0===this.clientAuthenticationMethods.size&&this.session.activateService(u.ConnectionService)}async requestPasswordAuthentication(e,t,r){const n=new o.PasswordRequestMessage;n.serviceName=u.ConnectionService.serviceName,n.username=e,n.password=t,await this.session.sendMessage(n,r),this.session.activateService(u.ConnectionService)}handleFailureMessage(e){this.session.onAuthenticationComplete(!1)}handleSuccessMessage(e){this.session.activateService(u.ConnectionService),this.session.onAuthenticationComplete(!0)}async createAuthenticationSignature(e,t,r){const n=this.session.sessionId;if(null==n)throw new Error("Session ID not initialized.");const s=new c.SshDataWriter(Buffer.alloc(e.publicKey.length+(e.username||"").length+400));s.writeBinary(n),s.writeByte(e.messageType),s.writeString(e.username||"","utf8"),s.writeString(e.serviceName||"","ascii"),s.writeString("publickey","ascii"),s.writeBoolean(!0),s.writeString(e.keyAlgorithmName,"ascii"),s.writeBinary(e.publicKey);const i=t.createSigner(r),o=await i.sign(s.toBuffer());return t.createSignatureData(o)}dispose(){try{this.disposeCancellationSource.cancel(),this.disposeCancellationSource.dispose()}catch(e){}super.dispose()}};g.serviceName="ssh-userauth",g=n=s([(0,d.serviceActivation)({serviceRequest:n.serviceName})],g),t.AuthenticationService=g},8402:function(e,t,r){"use strict";var n,s=this&&this.__decorate||function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionService=void 0;const i=r(2100),o=r(733),a=r(5928),c=r(9174),h=r(9612),l=r(5443),u=r(1744),d=r(8272),p=r(1618);let f=n=class extends i.SshService{constructor(e){super(e),this.channelCounter=0,this.channelMap=new Map,this.nonAcceptedChannels=new Map,this.pendingChannels=new Map,this.pendingAcceptChannels=new Map}get channels(){return Array.from(this.channelMap.values())}close(e){let t=[...this.pendingChannels.values()].map((e=>e.completionSource));this.pendingAcceptChannels.size>0&&(t=t.concat([...this.pendingAcceptChannels.values()].reduce(((e,t)=>e.concat(t)))));for(const t of this.channelMap.values())t.close(e);for(const r of t)r.reject(e)}dispose(){const e=[...this.channelMap.values()];let t=[...this.pendingChannels.values()].map((e=>e.completionSource));this.pendingAcceptChannels.size>0&&(t=t.concat([...this.pendingAcceptChannels.values()].reduce(((e,t)=>e.concat(t)))));for(const t of e)t.dispose();for(const e of t)e.reject(new l.SshConnectionError("Session closed."));super.dispose()}async acceptChannel(e,t){const r=new a.PromiseCompletionSource;let n;if(t){if(t.isCancellationRequested)throw new h.CancellationError;n=t.onCancellationRequested((()=>{const t=this.pendingAcceptChannels.get(e);if(t){const e=t.findIndex((e=>Object.is(e,r)));e>=0&&t.splice(e,1)}r.reject(new h.CancellationError)}))}let s=null;if(s=Array.from(this.nonAcceptedChannels.values()).find((t=>t.channelType===e))||null,s)this.nonAcceptedChannels.delete(s.channelId);else{let t=this.pendingAcceptChannels.get(e);t||(t=[],this.pendingAcceptChannels.set(e,t)),t.push(r)}try{return s||await r.promise}finally{n&&n.dispose()}}async openChannel(e,t,r){const n=++this.channelCounter;e.senderChannel=n;let s=null;if(r){if(r.isCancellationRequested)throw new h.CancellationError;s=r.onCancellationRequested((()=>{this.pendingChannels.delete(n)&&t.reject(new h.CancellationError)}))}return this.pendingChannels.set(n,{openMessage:e,completionSource:t,cancellationRegistration:s}),await this.session.sendMessage(e),n}handleMessage(e,t){if(e instanceof o.ChannelDataMessage)return this.handleDataMessage(e);if(e instanceof o.ChannelWindowAdjustMessage)return this.handleAdjustWindowMessage(e);if(e instanceof o.ChannelEofMessage)return this.handleEofMessage(e);if(e instanceof o.ChannelOpenMessage)return this.handleOpenMessage(e,t);if(e instanceof o.ChannelCloseMessage)return this.handleCloseMessage(e);if(e instanceof o.ChannelOpenConfirmationMessage)return this.handleOpenConfirmationMessage(e,t);if(e instanceof o.ChannelOpenFailureMessage)return this.handleOpenFailureMessage(e);if(e instanceof o.ChannelRequestMessage)return this.handleRequestMessage(e,t);if(e instanceof o.ChannelSuccessMessage)return this.handleSuccessMessage(e);if(e instanceof o.ChannelFailureMessage)return this.handleFailureMessage(e);throw new Error(`Message not implemented: ${e}`)}async handleOpenMessage(e,t){const r=e.senderChannel;if(!this.session.canAcceptRequests){this.trace(p.TraceLevel.Warning,p.SshTraceEventIds.channelOpenFailed,"Channel open request blocked because the session is not yet authenticated.");const e=new o.ChannelOpenFailureMessage;return e.recipientChannel=r,e.reasonCode=o.SshChannelOpenFailureReason.administrativelyProhibited,e.description="Authenticate before opening channels.",void await this.session.sendMessage(e,t)}if(!e.channelType){const e=new o.ChannelOpenFailureMessage;return e.recipientChannel=r,e.reasonCode=o.SshChannelOpenFailureReason.unknownChannelType,e.description="Channel type not specified.",void await this.session.sendMessage(e,t)}const n=++this.channelCounter,s=new c.SshChannel(this,e.channelType,n,r,e.maxWindowSize,e.maxPacketSize),i=new u.SshChannelOpeningEventArgs(e,s,!0);try{await this.session.handleChannelOpening(i,t)}catch(e){throw s.dispose(),e}if(i.failureReason!==o.SshChannelOpenFailureReason.none){const e=new o.ChannelOpenFailureMessage;e.recipientChannel=r,e.reasonCode=i.failureReason,e.description=i.failureDescription||void 0;try{await this.session.sendMessage(e,t)}finally{s.dispose()}return}if(this.session.isClosed)return void s.dispose();s.isMaxWindowSizeLocked=!0,this.channelMap.set(s.channelId,s);const a=new o.ChannelOpenConfirmationMessage;a.recipientChannel=s.remoteChannelId,a.senderChannel=s.channelId,a.maxWindowSize=s.maxWindowSize,a.maxPacketSize=s.maxPacketSize,await this.session.sendMessage(a,t);let h=!1;const l=this.pendingAcceptChannels.get(s.channelType);for(;l&&l.length>0;){l.shift().resolve(s),h=!0;break}h||this.nonAcceptedChannels.set(s.channelId,s),this.onChannelOpenCompleted(s.channelId,s),s.enableSending()}handleCloseMessage(e){const t=this.findChannelById(e.recipientChannel);t&&t.handleClose()}async handleOpenConfirmationMessage(e,t){var r;let n,s=null;const i=this.pendingChannels.get(e.recipientChannel);if(!i)throw this.channelMap.has(e.recipientChannel)?new Error("Duplicate channel ID."):new Error("Channel confirmation was not requested.");n=i.openMessage,s=i.completionSource,i.cancellationRegistration&&i.cancellationRegistration.dispose(),this.pendingChannels.delete(e.recipientChannel);const a=new c.SshChannel(this,n.channelType||c.SshChannel.sessionChannelType,e.recipientChannel,e.senderChannel,e.maxWindowSize,e.maxPacketSize);"number"==typeof n.maxWindowSize&&(a.maxWindowSize=n.maxWindowSize),a.isMaxWindowSizeLocked=!0,this.channelMap.set(a.channelId,a);const h=new u.SshChannelOpeningEventArgs(n,a,!1);if(await this.session.handleChannelOpening(h,t),s){if(h.failureReason!==o.SshChannelOpenFailureReason.none)return void s.reject(new l.SshChannelError(null!==(r=h.failureDescription)&&void 0!==r?r:"Channel open failure.",h.failureReason));s.resolve(a)}else this.onChannelOpenCompleted(a.channelId,a);a.enableSending()}handleOpenFailureMessage(e){let t=null;const r=this.pendingChannels.get(e.recipientChannel);r&&(t=r.completionSource,r.cancellationRegistration&&r.cancellationRegistration.dispose(),this.pendingChannels.delete(e.recipientChannel)),null!=t?t.reject(new l.SshChannelError(e.description||"Channel open rejected.",e.reasonCode)):this.onChannelOpenCompleted(e.recipientChannel,null)}async handleRequestMessage(e,t){const r=this.findChannelById(e.recipientChannel);r?await r.handleRequest(e,t):this.trace(p.TraceLevel.Warning,p.SshTraceEventIds.channelRequestFailed,`Invalid channel ID ${e.recipientChannel} in channel request message.`)}handleSuccessMessage(e){const t=this.findChannelById(e.recipientChannel);t?t.handleResponse(!0):this.trace(p.TraceLevel.Warning,p.SshTraceEventIds.channelRequestFailed,`Invalid channel ID ${e.recipientChannel} in channel success message.`)}handleFailureMessage(e){const t=this.findChannelById(e.recipientChannel);t?t.handleResponse(!1):this.trace(p.TraceLevel.Warning,p.SshTraceEventIds.channelRequestFailed,`Invalid channel ID ${e.recipientChannel} in channel failure message.`)}handleDataMessage(e){const t=this.findChannelById(e.recipientChannel);if(t)return t.handleDataReceived(e.data)}handleAdjustWindowMessage(e){const t=this.findChannelById(e.recipientChannel);t&&t.adjustRemoteWindow(e.bytesToAdd)}handleEofMessage(e){const t=this.findChannelById(e.recipientChannel);t&&t.handleEof()}onChannelOpenCompleted(e,t){t?this.trace(p.TraceLevel.Info,p.SshTraceEventIds.channelOpened,`${this.session} ChannelOpenCompleted(${t})`):this.trace(p.TraceLevel.Warning,p.SshTraceEventIds.channelOpenFailed,`${this.session} ChannelOpenCompleted(${e} failed)`)}findChannelById(e){var t;return null!==(t=this.channelMap.get(e))&&void 0!==t?t:null}removeChannel(e){this.channelMap.delete(e.channelId),this.pendingChannels.delete(e.channelId)}};f.serviceName="ssh-connection",f=n=s([(0,d.serviceActivation)({serviceRequest:n.serviceName})],f),t.ConnectionService=f},454:function(e,t,r){"use strict";var n,s=this&&this.__decorate||function(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyExchangeService=void 0;const i=r(4300),o=r(8016),a=r(2100),c=r(2309),h=r(4405),l=r(9483),u=r(5879),d=r(5443),p=r(8673),f=r(2725),g=r(8231),m=r(8402),y=r(8272),v=r(1618);class w{}const S="ext-info-s",b="ext-info-c";let E=n=class extends a.SshService{constructor(e,t){super(e),this.isClientSession=t,this.isInitialExchange=!1,this.exchangeContext=null}get exchanging(){return!!this.exchangeContext}async startKeyExchange(e){this.isInitialExchange=e,this.exchangeContext=new w;const t=this.createKeyExchangeInitMessage();let r=null;return this.isClientSession?(e&&this.session.config.enableKeyExchangeGuess&&(r=await this.createKeyExchangeGuessMessage(),t.firstKexPacketFollows=!!r),this.exchangeContext.clientKexInitPayload=t.toBuffer()):this.exchangeContext.serverKexInitPayload=t.toBuffer(),[t,r]}finishKeyExchange(){const e=this.exchangeContext.newAlgorithms;return this.exchangeContext=null,e}abortKeyExchange(){this.exchangeContext=null}createKeyExchangeInitMessage(){const e=this.isClientSession?b:S,t=this.session.config,r=new h.KeyExchangeInitMessage;return r.keyExchangeAlgorithms=(0,l.algorithmNames)(t.keyExchangeAlgorithms).concat(e),r.serverHostKeyAlgorithms=this.getPublicKeyAlgorithms(),r.encryptionAlgorithmsClientToServer=r.encryptionAlgorithmsServerToClient=(0,l.algorithmNames)(t.encryptionAlgorithms),r.macAlgorithmsClientToServer=r.macAlgorithmsServerToClient=(0,l.algorithmNames)(t.hmacAlgorithms),r.compressionAlgorithmsClientToServer=r.compressionAlgorithmsServerToClient=(0,l.algorithmNames)(t.compressionAlgorithms),r.languagesClientToServer=[""],r.languagesServerToClient=[""],r.firstKexPacketFollows=!1,r.reserved=0,r}getPublicKeyAlgorithms(){var e,t;let r=[...this.session.config.publicKeyAlgorithms];if(r.length>1&&!this.isClientSession){const n=null===(t=null===(e=this.session.credentials)||void 0===e?void 0:e.publicKeys)||void 0===t?void 0:t.map((e=>e.keyAlgorithmName));n&&(r=r.filter((e=>e&&n.includes(e.keyAlgorithmName))))}return(0,l.algorithmNames)(r)}async createKeyExchangeGuessMessage(){if(!this.exchangeContext)throw new Error("Key exchange was not started.");const e=this.session.config.keyExchangeAlgorithms[0];if(!e)return null;this.exchangeContext.keyExchange=e.name,this.exchangeContext.exchange=e.createKeyExchange(),this.exchangeContext.exchangeValue=await this.exchangeContext.exchange.startKeyExchange();const t=new h.KeyExchangeDhInitMessage;return t.e=this.exchangeContext.exchangeValue,t}handleMessage(e,t){if(e instanceof h.KeyExchangeInitMessage)return this.handleInitMessage(e,t);if(e instanceof h.KeyExchangeDhInitMessage)return this.handleDhInitMessage(e,t);if(e instanceof h.KeyExchangeDhReplyMessage)return this.handleDhReplyMessage(e,t);throw new Error(`Message not implemented: ${e}`)}async handleInitMessage(e,t){var r,n;if(!this.exchangeContext)throw new Error("Key exchange was not started.");const s=this.session.config;if(this.exchangeContext.keyExchange=this.chooseAlgorithm("KeyExchange",(0,l.algorithmNames)(s.keyExchangeAlgorithms),e.keyExchangeAlgorithms),"none"===this.exchangeContext.keyExchange)return this.trace(v.TraceLevel.Info,v.SshTraceEventIds.algorithmNegotiation,"Client and server negotiated no security. Cancelling key-exchange."),this.session.activateService(m.ConnectionService),this.exchangeContext.newAlgorithms=new f.SshSessionAlgorithms,void await this.session.handleNewKeysMessage(new h.NewKeysMessage,t);let i;if(this.exchangeContext.publicKey=this.chooseAlgorithm("PublicKey",this.getPublicKeyAlgorithms(),e.serverHostKeyAlgorithms),this.exchangeContext.clientEncryption=this.chooseAlgorithm("ClientEncryption",(0,l.algorithmNames)(s.encryptionAlgorithms),e.encryptionAlgorithmsClientToServer),this.exchangeContext.serverEncryption=this.chooseAlgorithm("ServerEncryption",(0,l.algorithmNames)(s.encryptionAlgorithms),e.encryptionAlgorithmsServerToClient),this.exchangeContext.clientHmac=this.chooseAlgorithm("ClientHmac",(0,l.algorithmNames)(s.hmacAlgorithms),e.macAlgorithmsClientToServer),this.exchangeContext.serverHmac=this.chooseAlgorithm("ServerHmac",(0,l.algorithmNames)(s.hmacAlgorithms),e.macAlgorithmsServerToClient),this.exchangeContext.clientCompression=this.chooseAlgorithm("ClientCompression",(0,l.algorithmNames)(s.compressionAlgorithms),e.compressionAlgorithmsClientToServer),this.exchangeContext.serverCompression=this.chooseAlgorithm("ServerCompression",(0,l.algorithmNames)(s.compressionAlgorithms),e.compressionAlgorithmsServerToClient),this.isClientSession){this.exchangeContext.serverKexInitPayload=e.toBuffer();const n=!!this.exchangeContext.exchangeValue,o=this.exchangeContext.keyExchange===(null===(r=s.keyExchangeAlgorithms[0])||void 0===r?void 0:r.name);if(!n||!o){const e=s.getKeyExchangeAlgorithm(this.exchangeContext.keyExchange);this.exchangeContext.exchange=e.createKeyExchange(),this.exchangeContext.exchangeValue=await this.exchangeContext.exchange.startKeyExchange();const r=new h.KeyExchangeDhInitMessage;r.e=this.exchangeContext.exchangeValue,await this.session.sendMessage(r,t)}i=S}else{if(e.firstKexPacketFollows){const t=this.exchangeContext.keyExchange===(null===(n=e.keyExchangeAlgorithms)||void 0===n?void 0:n[0]),r=t?"correct":"incorrect";this.trace(v.TraceLevel.Verbose,v.SshTraceEventIds.algorithmNegotiation,`Client's KeyExchange guess was ${r}.`),this.exchangeContext.discardGuessedInit=!t}this.exchangeContext.clientKexInitPayload=e.toBuffer(),i=b}this.isInitialExchange&&e.keyExchangeAlgorithms.includes(i)&&await this.session.sendExtensionInfo(t)}async handleDhInitMessage(e,t){var r,n,s,o,a;if(this.isClientSession)return;const c=this.session;if(!this.exchangeContext||!this.exchangeContext.keyExchange||!this.exchangeContext.publicKey)throw new d.SshConnectionError("Key exchange not started.",p.SshDisconnectReason.protocolError);if(this.exchangeContext.discardGuessedInit)return void(this.exchangeContext.discardGuessedInit=!1);const l=this.session.config.getKeyExchangeAlgorithm(this.exchangeContext.keyExchange);if(!l)throw new d.SshConnectionError("Key exchange not supported for algorithm: "+this.exchangeContext.keyExchange,p.SshDisconnectReason.keyExchangeFailed);const u=this.session.config.getPublicKeyAlgorithm(this.exchangeContext.publicKey);if(!u)throw new d.SshConnectionError("Public key algorithm not supported: "+this.exchangeContext.publicKey,p.SshDisconnectReason.keyExchangeFailed);let m=null;if(null===(r=c.credentials)||void 0===r?void 0:r.publicKeys){const e=c.credentials.publicKeys.find((e=>e.keyAlgorithmName===u.keyAlgorithmName));if(m=null!=e?e:null,!1===(null==m?void 0:m.hasPrivateKey)){if(!c.credentials.privateKeyProvider)throw new Error("A private key provider is required.");m=await c.credentials.privateKeyProvider(e,null!=t?t:g.CancellationToken.None)}}if(null==m)throw new d.SshConnectionError("Private key not found for algorithm: "+this.exchangeContext.publicKey,p.SshDisconnectReason.keyExchangeFailed);const y=this.session.config.getEncryptionAlgorithm(this.exchangeContext.clientEncryption),v=this.session.config.getEncryptionAlgorithm(this.exchangeContext.serverEncryption),w=this.session.config.getHmacAlgorithm(this.exchangeContext.serverHmac),S=this.session.config.getHmacAlgorithm(this.exchangeContext.clientHmac),b=l.createKeyExchange(),E=e.e||i.Buffer.alloc(0),C=await b.startKeyExchange(),T=await b.decryptKeyExchange(E),R=await m.getPublicKeyBytes(u.name);if(!R)throw new d.SshConnectionError("Public key not set.",p.SshDisconnectReason.keyExchangeFailed);const _=await this.computeExchangeHash(b,R,E,C,T);this.session.sessionId||(this.session.sessionId=_);const[P,x,A,k,M,I]=await this.computeKeys(b,T,_,y,v,S,w),O=null!==(n=await(null==v?void 0:v.createCipher(!0,k,x)))&&void 0!==n?n:null,B=null!==(s=await(null==y?void 0:y.createCipher(!1,A,P)))&&void 0!==s?s:null,q=null!==(o=await(null==w?void 0:w.createSigner(I)))&&void 0!==o?o:null,F=null!==(a=await(null==S?void 0:S.createVerifier(M)))&&void 0!==a?a:null,L=new f.SshSessionAlgorithms;L.publicKeyAlgorithmName=this.exchangeContext.publicKey,L.cipher=O,L.decipher=B,L.signer=q,L.verifier=F,L.messageSigner=(null==O?void 0:O.authenticatedEncryption)?O:q,L.messageVerifier=(null==B?void 0:B.authenticatedEncryption)?B:F,L.compressor=this.session.config.getCompressionAlgorithm(this.exchangeContext.serverCompression),L.decompressor=this.session.config.getCompressionAlgorithm(this.exchangeContext.clientCompression),this.exchangeContext.newAlgorithms=L,P&&P.fill(0),A&&A.fill(0),M&&M.fill(0),x&&x.fill(0),k&&k.fill(0),I&&I.fill(0);const D=u.createSigner(m);let N=await D.sign(_);N=u.createSignatureData(N);const j=new h.KeyExchangeDhReplyMessage;j.hostKey=R,j.f=C,j.signature=N,await this.session.sendMessage(j,t),await this.session.sendMessage(new h.NewKeysMessage,t)}async handleDhReplyMessage(e,t){var r,n,s,i;if(!this.isClientSession)return;if(!this.exchangeContext)throw new d.SshConnectionError("Key exchange was not started.",p.SshDisconnectReason.protocolError);const o=this.session.config,a=this.exchangeContext.exchange,c=this.exchangeContext.publicKey,l=o.getPublicKeyAlgorithm(c),u=o.getEncryptionAlgorithm(this.exchangeContext.clientEncryption),g=o.getEncryptionAlgorithm(this.exchangeContext.serverEncryption),m=o.getHmacAlgorithm(this.exchangeContext.serverHmac),y=o.getHmacAlgorithm(this.exchangeContext.clientHmac),w=this.exchangeContext.exchangeValue,S=e.f;if(!a||!w)throw new d.SshConnectionError("Failed to initialize crypto after key exchange.",p.SshDisconnectReason.keyExchangeFailed);this.hostKey=l.createKeyPair(),await this.hostKey.setPublicKeyBytes(e.hostKey);const b=await a.decryptKeyExchange(S),E=e.hostKey,C=await this.computeExchangeHash(a,E,w,S,b),T=l.readSignatureData(e.signature),R=l.createVerifier(this.hostKey);let _;try{_=await R.verify(C,T)}catch(e){if(!(e instanceof Error))throw e;throw this.trace(v.TraceLevel.Error,v.SshTraceEventIds.serverAuthenticationFailed,`Server public key verification error: ${e.message}`,e),new d.SshConnectionError(`Server public key verification failed: ${e.message}`,p.SshDisconnectReason.hostKeyNotVerifiable)}if(!_)throw this.trace(v.TraceLevel.Warning,v.SshTraceEventIds.serverAuthenticationFailed,"Server public key verification failed."),new d.SshConnectionError("Server public key verification failed.",p.SshDisconnectReason.hostKeyNotVerifiable);this.trace(v.TraceLevel.Verbose,v.SshTraceEventIds.sessionAuthenticated,"Server public key verification succeeded."),null==this.session.sessionId&&(this.session.sessionId=C);const[P,x,A,k,M,I]=await this.computeKeys(a,b,C,u,g,y,m),O=null!==(r=await(null==u?void 0:u.createCipher(!0,A,P)))&&void 0!==r?r:null,B=null!==(n=await(null==g?void 0:g.createCipher(!1,k,x)))&&void 0!==n?n:null,q=null!==(s=await(null==y?void 0:y.createSigner(M)))&&void 0!==s?s:null,F=null!==(i=await(null==m?void 0:m.createVerifier(I)))&&void 0!==i?i:null,L=new f.SshSessionAlgorithms;L.publicKeyAlgorithmName=c,L.cipher=O,L.decipher=B,L.signer=q,L.verifier=F,L.messageSigner=(null==O?void 0:O.authenticatedEncryption)?O:q,L.messageVerifier=(null==B?void 0:B.authenticatedEncryption)?B:F,L.compressor=o.getCompressionAlgorithm(this.exchangeContext.clientCompression),L.decompressor=o.getCompressionAlgorithm(this.exchangeContext.serverCompression),this.exchangeContext.newAlgorithms=L,P&&P.fill(0),A&&A.fill(0),M&&M.fill(0),x&&x.fill(0),k&&k.fill(0),I&&I.fill(0),await this.session.sendMessage(new h.NewKeysMessage,t)}chooseAlgorithm(e,t,r){let n,s;this.isClientSession?(n=r||[],s=t):(n=t,s=r||[]);const i=`${e} negotiation: Server (${n.join(", ")}) Client (${s.join(", ")})`;for(const e of s)for(const t of n)if(t===e){const e=t;return this.trace(v.TraceLevel.Info,v.SshTraceEventIds.algorithmNegotiation,`${i} => ${e}`),e}throw new Error(`Failed ${i}`)}async computeExchangeHash(e,t,r,n,s){if(!this.session.remoteVersion)throw new Error("Key exchange not completed.");const a=new u.SshDataWriter(i.Buffer.alloc(2048));return this.isClientSession?(a.writeString(o.SshSession.localVersion.toString(),"ascii"),a.writeString(this.session.remoteVersion.toString(),"ascii")):(a.writeString(this.session.remoteVersion.toString(),"ascii"),a.writeString(o.SshSession.localVersion.toString(),"ascii")),a.writeBinary(this.exchangeContext.clientKexInitPayload),a.writeBinary(this.exchangeContext.serverKexInitPayload),a.writeBinary(t),a.writeBigInt(c.BigInt.fromBytes(r,{unsigned:!0})),a.writeBigInt(c.BigInt.fromBytes(n,{unsigned:!0})),a.writeBigInt(c.BigInt.fromBytes(s,{unsigned:!0})),await e.sign(a.toBuffer())}async computeKeys(e,t,r,n,s,o,a){var c,h;const l=new u.SshDataWriter(i.Buffer.alloc(4+t.length+r.length+Math.max(1+(null!==(h=null===(c=this.session.sessionId)||void 0===c?void 0:c.length)&&void 0!==h?h:0),e.digestLength)));l.writeBinary(t),l.write(r);const d=l.position;return[n&&await this.computeKey(e,l,d,n.blockLength,"A"),s&&await this.computeKey(e,l,d,s.blockLength,"B"),n&&await this.computeKey(e,l,d,n.keyLength,"C"),s&&await this.computeKey(e,l,d,s.keyLength,"D"),o&&await this.computeKey(e,l,d,o.keyLength,"E"),a&&await this.computeKey(e,l,d,a.keyLength,"F")]}async computeKey(e,t,r,n,s){const o=i.Buffer.alloc(n);let a=0,c=0,h=null;if(!this.session.sessionId)throw new Error("Session ID not set.");for(;a<n;)t.position=r,h?t.write(h):(t.writeByte(s.charCodeAt(0)),t.write(this.session.sessionId)),h=await e.sign(t.toBuffer()),c=Math.min(h.length,n-a),h.copy(o,a),a+=c;return h&&h.fill(0),o}};E.serviceName="ssh-keyexchange",E=n=s([(0,y.serviceActivation)({serviceRequest:n.serviceName})],E),t.KeyExchangeService=E},8272:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findService=t.serviceActivation=void 0,t.serviceActivation=function(e){return t=>{t.activations||(t.activations=[]),t.activations.push(e)}},t.findService=function(e,t){for(const r of e.keys()){const e=r.activations;let n=!1;for(const s of e)if(n=!0,t(s))return r;if(!n)throw new Error(`SSH service type '${r.name}' must have one or more 'serviceActivation' decorators.`)}return null}},2100:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshService=void 0;const n=r(8231),s=r(8016);t.SshService=class{constructor(e){if(this.session=e,this.disposed=!1,this.disposedEmitter=new n.Emitter,this.onDisposed=this.disposedEmitter.event,!(e instanceof s.SshSession))throw new TypeError("Session is not an instance of SshSession. (This may be due to a version mismatch between SSH packages.)")}get trace(){return this.session.trace}dispose(){this.disposed||(this.disposed=!0,this.disposedEmitter.fire())}async onSessionRequest(e,t){this.session.raiseSessionRequest(e)}async onChannelOpening(e,t){if(!e)throw new TypeError("Request is required.");return this.session.handleChannelOpening(e,t,!1)}async onChannelRequest(e,t,r){}async sendMessage(e,t){await this.session.sendMessage(e,t)}}},9174:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshChannel=void 0;const n=r(8231),s=r(8272),i=r(733),o=r(8673),a=r(201),c=r(5928),h=r(5443),l=r(9826),u=r(3565),d=r(9612),p=r(7688),f=r(1618),g=r(1513);class m{constructor(e,t,r,s,i,o){this.connectionService=e,this.channelType=t,this.channelId=r,this.remoteChannelId=s,this.remoteClosed=!1,this.localClosed=!1,this.sentEof=!1,this.disposed=!1,this.openSendingWindowCompletionSource=null,this.requestCompletionSource=null,this.sendSemaphore=new p.Semaphore(0),this.metrics=new a.ChannelMetrics,this.dataReceivedEmitter=new n.Emitter,this.onDataReceived=this.dataReceivedEmitter.event,this.eofEmitter=new n.Emitter,this.onEof=this.eofEmitter.event,this.closedEmitter=new n.Emitter,this.onClosed=this.closedEmitter.event,this.requestEmitter=new n.Emitter,this.onRequest=this.requestEmitter.event,this.isMaxWindowSizeLocked=!1,this.remoteWindowSize=i,this.maxWindowSizeValue=m.defaultMaxWindowSize,this.windowSize=this.maxWindowSizeValue,this.maxPacketSize=Math.min(o,m.defaultMaxPacketSize)}get session(){return this.connectionService.session}get isClosed(){return this.localClosed||this.remoteClosed}get maxWindowSize(){return this.maxWindowSizeValue}set maxWindowSize(e){if(this.isMaxWindowSizeLocked)throw new Error("Cannot change the max window size after opening the channel.");if(e<this.maxPacketSize)throw new Error("Maximum window size cannot be less than maximum packet size.");this.maxWindowSizeValue=e}async request(e,t){if(!e)throw new TypeError("Request is required.");if(this.disposed)throw new h.ObjectDisposedError(this);if(e.recipientChannel=this.remoteChannelId,!e.wantReply)return await this.session.sendMessage(e,t),!0;if(null!=this.requestCompletionSource)throw new Error("Another request is already pending.");const r=new c.PromiseCompletionSource;if(this.requestCompletionSource=r,t){if(t.isCancellationRequested)throw new d.CancellationError;t.onCancellationRequested((()=>{r.reject(new d.CancellationError)}))}return await this.session.sendMessage(e,t),await r.promise}async send(e,t){if(this.disposed)throw new h.ObjectDisposedError(this);if(0!==e.length){if(this.sentEof)throw new Error("Cannot send more data after EOF.");await this.sendSemaphore.wait(t);try{let r=0,n=e.length;for(;n>0;){let s=Math.min(Math.min(this.remoteWindowSize,this.maxPacketSize),n);for(;0===s;)this.openSendingWindowCompletionSource||(this.openSendingWindowCompletionSource=new c.PromiseCompletionSource),this.session.trace(f.TraceLevel.Warning,f.SshTraceEventIds.channelWaitForWindowAdjust,`${this} send window is full. Waiting for window adjustment before sending.`),await(0,d.withCancellation)(this.openSendingWindowCompletionSource.promise,t),this.openSendingWindowCompletionSource=null,s=Math.min(Math.min(this.remoteWindowSize,this.maxPacketSize),n);const o=new i.ChannelDataMessage;o.recipientChannel=this.remoteChannelId,o.data=Buffer.from(e.slice(r,r+s)),await this.session.sendMessage(o,t),this.remoteWindowSize-=s,n-=s,r+=s,this.metrics.addBytesSent(s)}}finally{this.sendSemaphore.tryRelease()}}else await this.sendEof()}enableSending(){this.sendSemaphore.tryRelease()}async sendEof(e){if(!this.sentEof){await this.sendSemaphore.wait(e);try{this.sentEof=!0;const t=new i.ChannelEofMessage;t.recipientChannel=this.remoteChannelId,await this.session.sendMessage(t,e)}finally{this.sendSemaphore.tryRelease()}}}async handleRequest(e,t){if(!e.requestType)throw new h.SshConnectionError("Channel request type not specified.",o.SshDisconnectReason.protocolError);if(e.requestType===i.ChannelRequestType.exitStatus){const t=new i.ChannelSignalMessage;return e.convertTo(t),this.exitStatus=t.exitStatus,!0}if(e.requestType===i.ChannelRequestType.exitSignal){const t=new i.ChannelSignalMessage;return e.convertTo(t),this.exitSignal=t.exitSignal,this.exitErrorMessage=t.errorMessage,!0}if(e.requestType===i.ChannelRequestType.signal){const t=new i.ChannelSignalMessage;e.convertTo(t)}const r=new l.SshRequestEventArgs(e.requestType,e,this.session.principal,t),n=(0,s.findService)(this.session.config.services,(t=>(!t.channelType||t.channelType===this.channelType)&&t.channelRequest===e.requestType));await this.sendSemaphore.wait(t);try{let s=null;if(n){const e=this.session.activateService(n);await e.onChannelRequest(this,r,t)}else this.requestEmitter.fire(r);r.responsePromise&&(s=await r.responsePromise,r.isAuthorized=s instanceof i.ChannelSuccessMessage),e.wantReply&&(r.isAuthorized?(s=null!=s?s:new i.ChannelSuccessMessage,s.recipientChannel=this.remoteChannelId):(s=null!=s?s:new i.ChannelFailureMessage,s.recipientChannel=this.remoteChannelId),await this.session.sendMessage(s,t))}finally{this.sendSemaphore.tryRelease()}return r.isAuthorized||!1}handleResponse(e){this.requestCompletionSource&&(this.requestCompletionSource.resolve(e),this.requestCompletionSource=null)}handleDataReceived(e){this.metrics.addBytesReceived(e.length),this.dataReceivedEmitter.fire(e)}adjustWindow(e){if(!this.disposed&&(this.windowSize-=e,this.windowSize<=this.maxWindowSizeValue/2)){const e=new i.ChannelWindowAdjustMessage;e.recipientChannel=this.remoteChannelId,e.bytesToAdd=this.maxWindowSizeValue-this.windowSize,this.windowSize=this.maxWindowSizeValue,this.session.sendMessage(e).catch((e=>{this.session.trace(f.TraceLevel.Error,f.SshTraceEventIds.channelWindowAdjustFailed,`Error sending window adjust message: ${e.message}`,e)}))}}adjustRemoteWindow(e){this.remoteWindowSize+=e,this.openSendingWindowCompletionSource&&this.openSendingWindowCompletionSource.resolve(void 0)}handleEof(){this.session.trace(f.TraceLevel.Info,f.SshTraceEventIds.channelEofReceived,`${this} EOF received.`),this.eofEmitter.fire()}close(e,t,r){if(e instanceof Error){const t=e;return this.localClosed||(this.localClosed=!0,this.session.trace(f.TraceLevel.Info,f.SshTraceEventIds.channelClosed,`${this} Closed: ${t.message}`),this.closedEmitter.fire(new u.SshChannelClosedEventArgs(t))),void this.disposeInternal()}return"number"==typeof e?this.closeWithStatus(e,t):"string"==typeof e?this.closeWithSignal(e,t,r):this.closeDefault(e)}async closeDefault(e){var t;if(!this.remoteClosed&&!this.localClosed){this.remoteClosed=!0,await this.sendSemaphore.wait(e);try{const e=new i.ChannelCloseMessage;e.recipientChannel=this.remoteChannelId,await this.session.sendMessage(e)}catch(e){}finally{this.sendSemaphore.tryRelease()}}if(!this.localClosed){this.localClosed=!0;const e=this.raiseClosedEvent();null===(t=this.requestCompletionSource)||void 0===t||t.reject(new h.SshChannelError(e))}this.disposeInternal()}async closeWithStatus(e,t){if(!this.remoteClosed&&!this.localClosed){this.exitStatus=e;const t=new i.ChannelSignalMessage;t.recipientChannel=this.remoteChannelId,t.exitStatus=e,await this.session.sendMessage(t)}await this.closeDefault(t)}async closeWithSignal(e,t,r){if(!this.remoteClosed&&!this.localClosed){this.exitSignal=e,this.exitErrorMessage=t;const r=new i.ChannelSignalMessage;r.recipientChannel=this.remoteChannelId,r.exitSignal=e,r.errorMessage=t,await this.session.sendMessage(r)}await this.closeDefault(r)}handleClose(){var e;if(!this.localClosed){this.localClosed=!0;const t=this.raiseClosedEvent(!0);null===(e=this.requestCompletionSource)||void 0===e||e.reject(new h.SshChannelError(t))}this.disposeInternal()}raiseClosedEvent(e=!1){const t=` (S: ${this.metrics.bytesSent}, R: ${this.metrics.bytesReceived})`,r=e?"remotely":"locally";let n,s;return void 0!==this.exitStatus?(s=new u.SshChannelClosedEventArgs(this.exitStatus),n=`${this} closed ${r}: status=${this.exitStatus}`):void 0!==this.exitSignal?(s=new u.SshChannelClosedEventArgs(this.exitSignal,this.exitErrorMessage),n=`${this} closed ${r}: signal=${this.exitSignal} ${this.exitErrorMessage}`):(s=new u.SshChannelClosedEventArgs,n=`${this} closed ${r}.`),this.session.trace(f.TraceLevel.Info,f.SshTraceEventIds.channelClosed,n+t),this.closedEmitter.fire(s),n}dispose(){var e;if(!this.disposed&&!this.localClosed){if(!this.remoteClosed){this.remoteClosed=!0;const e=new i.ChannelCloseMessage;e.recipientChannel=this.remoteChannelId,this.session.sendMessage(e).catch((e=>{}))}const t=this.session.isClosed?`${this.session} closed.`:`${this} disposed.`;this.session.trace(f.TraceLevel.Info,f.SshTraceEventIds.channelClosed,t);const r=new u.SshChannelClosedEventArgs("SIGABRT",t);this.localClosed=!0,this.closedEmitter.fire(r),null===(e=this.requestCompletionSource)||void 0===e||e.reject(new h.SshChannelError(t))}this.disposeInternal()}disposeInternal(){var e;this.disposed||(this.disposed=!0,null===(e=this.requestCompletionSource)||void 0===e||e.reject(new h.ObjectDisposedError(this)),this.connectionService.removeChannel(this),this.sendSemaphore.dispose())}pipe(e){return g.PipeExtensions.pipeChannel(this,e)}toString(){return`SshChannel(Type: ${this.channelType}, Id: ${this.channelId}, RemoteId: ${this.remoteChannelId})`}}t.SshChannel=m,m.sessionChannelType="session",m.defaultMaxPacketSize=i.ChannelOpenMessage.defaultMaxPacketSize,m.defaultMaxWindowSize=i.ChannelOpenMessage.defaultMaxWindowSize},3398:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshClientSession=void 0;const n=r(8016),s=r(8673),i=r(3886),o=r(5928),a=r(9612),c=r(3816),h=r(5300),l=r(8402),u=r(5443),d=r(1618);class p extends n.SshSession{constructor(e){super(e,!0),this.serviceRequests=new Map,this.clientAuthCompletion=null}async authenticate(e,t){return!!await this.authenticateServer(t)&&!!await this.authenticateClient(e,t)}async authenticateServer(e){if(!this.kexService||!this.kexService.hostKey)throw new Error("Encrypt the session before authenticating.");try{this.principal=await this.raiseAuthenticatingEvent(new i.SshAuthenticatingEventArgs(i.SshAuthenticationType.serverPublicKey,{publicKey:this.kexService.hostKey},e))}catch(e){if(!(e instanceof Error))throw e;throw this.trace(d.TraceLevel.Error,d.SshTraceEventIds.authenticationError,`Error while authenticating server: ${e.message}`,e),e}return this.principal?(this.trace(d.TraceLevel.Info,d.SshTraceEventIds.sessionAuthenticated,`${this} server authenticated.`),!0):(await this.close(s.SshDisconnectReason.hostKeyNotVerifiable,"Server authentication failed."),this.trace(d.TraceLevel.Warning,d.SshTraceEventIds.serverAuthenticationFailed,`${this} server authentication failed.`),!1)}authenticateClient(e,t,r){if(!e)throw new TypeError("A credentials object is required.");return"function"==typeof t?this.authenticateClientWithCompletion(e,t,r):new Promise(((r,n)=>this.authenticateClientWithCompletion(e,((e,t)=>{e?n(e):r(t)}),t)))}async authenticateClientWithCompletion(e,t,r){if(this.clientAuthCompletion=new o.PromiseCompletionSource,this.clientAuthCompletion.promise.then((e=>t(void 0,e)),(e=>t(e))),r){if(r.isCancellationRequested)throw new a.CancellationError;r.onCancellationRequested((e=>{this.clientAuthCompletion&&this.clientAuthCompletion.reject(new a.CancellationError)}))}let n=this.getService(h.AuthenticationService);if(!n){const e=new s.ServiceRequestMessage;e.serviceName=h.AuthenticationService.serviceName,await this.sendMessage(e,r),n=this.activateService(h.AuthenticationService)}await n.authenticateClient(e,r)}onAuthenticationComplete(e){e?this.trace(d.TraceLevel.Info,d.SshTraceEventIds.sessionAuthenticated,`${this} client authenticated.`):this.trace(d.TraceLevel.Warning,d.SshTraceEventIds.clientAuthenticationFailed,`${this} client authentication failed.`),this.clientAuthCompletion&&(this.clientAuthCompletion.resolve(e),this.clientAuthCompletion=null)}async requestService(e,t){let r=!1,n=this.serviceRequests.get(e);if(n||(n=new o.PromiseCompletionSource,this.serviceRequests.set(e,n),r=!0),r){const r=new s.ServiceRequestMessage;r.serviceName=e,await this.sendMessage(r,t)}await n.promise}async handleServiceAcceptMessage(e,t){const r=this.serviceRequests.get(e.serviceName);null==r||r.resolve(!0)}async openChannel(e,t,r){if(!this.connectionService){const e=new s.ServiceRequestMessage;e.serviceName=l.ConnectionService.serviceName,await this.sendMessage(e,r)}return await super.openChannel(e,t,r)}handleDisconnected(){return this.reconnecting?(this.reconnecting=!1,!1):super.handleDisconnected()}async reconnect(e,t){if(this.trace(d.TraceLevel.Verbose,d.SshTraceEventIds.clientSessionReconnecting,"Attempting to reconnect..."),this.isClosed)throw new u.ObjectDisposedError(this);if(this.isConnected)throw new Error("Already connected.");if(!this.protocol)throw new Error("The session was never previously connected.");if(this.reconnecting)throw new Error("Already reconnecting.");this.reconnecting=!0;try{await this.reconnectInternal(e,t)}finally{this.reconnecting=!1}}async reconnectInternal(e,t){var r,n,i,o,a,h;const l=this.sessionId,p=this.protocol,f=null===(r=this.kexService)||void 0===r?void 0:r.hostKey;if(!(l&&p&&this.kexService&&f&&(null===(n=p.extensions)||void 0===n?void 0:n.has(c.SshProtocolExtensionNames.sessionReconnect))))throw new Error("Reconnect was not enabled for this session.");let g;try{if(this.sessionId=null,await this.connect(e,t),!this.sessionId||!this.algorithms||!this.algorithms.signer)throw new Error("Session is not encrypted.");const r=this.kexService.hostKey,n=r?await r.getPublicKeyBytes():null,i=await f.getPublicKeyBytes();if(!n||!i||!n.equals(i)){const e="The server host key is different.";throw this.trace(d.TraceLevel.Error,d.SshTraceEventIds.clientSessionReconnectFailed,`Reconnection failed: ${e}`),new u.SshReconnectError(e,s.SshReconnectFailureReason.differentServerHostKey)}g=this.sessionId}catch(e){throw this.protocol=p,super.handleDisconnected(),e}finally{this.sessionId=l,this.kexService.hostKey=f}const m=await this.createReconnectToken(l,g),y=new s.SessionReconnectRequestMessage;y.requestType="session-reconnect@microsoft.com",y.clientReconnectToken=m,y.lastReceivedSequenceNumber=p.lastIncomingSequence,y.wantReply=!0;const v=await this.requestResponse(y,s.SessionReconnectResponseMessage,s.SessionReconnectFailureMessage,t);if(v instanceof s.SessionReconnectFailureMessage){const e=null!==(i=v.reasonCode)&&void 0!==i?i:s.SshReconnectFailureReason.unknownServerFailure,t=null!==(o=v.description)&&void 0!==o?o:"The server rejected the reconnect request.";throw this.trace(d.TraceLevel.Error,d.SshTraceEventIds.clientSessionReconnectFailed,`Reconnection failed: ${t}`),this.protocol=p,new u.SshReconnectError(t,e)}if(!this.verifyReconnectToken(l,g,null!==(a=v.serverReconnectToken)&&void 0!==a?a:Buffer.alloc(0))){const e="The reconnect token provided by the server was invalid.";throw this.trace(d.TraceLevel.Error,d.SshTraceEventIds.clientSessionReconnectFailed,`Reconnection failed: ${e}`),new u.SshReconnectError(e,s.SshReconnectFailureReason.invalidServerReconnectToken)}this.trace(d.TraceLevel.Info,d.SshTraceEventIds.clientSessionReconnecting,"Reconnect request was accepted by the server.");const w=p.getSentMessages((null!==(h=v.lastReceivedSequenceNumber)&&void 0!==h?h:0)+1);if(!w){const e="Client is unable to re-send messages requested by the server.";throw this.trace(d.TraceLevel.Error,d.SshTraceEventIds.clientSessionReconnectFailed,`Reconnection failed: ${e}`),new u.SshReconnectError(e,s.SshReconnectFailureReason.clientDroppedMessages)}let S=0;for(const e of w)await this.sendMessage(e,t),S++;p.dispose(),this.metrics.addReconnection(),this.trace(d.TraceLevel.Info,d.SshTraceEventIds.clientSessionReconnecting,`{this} reconnected. Re-sent ${S} dropped messages.`)}dispose(){this.clientAuthCompletion&&this.clientAuthCompletion.reject(new u.ObjectDisposedError(this)),super.dispose()}}t.SshClientSession=p},1391:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshRpcMessageStream=void 0;const n=r(8231),s=r(4300),i=r(5879),o="Content-Length: ",a="\r\n\r\n";class c{constructor(e){this.channel=e,this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter,this.partialMessageEmitter=new n.Emitter,this.callback=null,this.messageBuffer=new i.SshDataWriter(s.Buffer.alloc(1024)),this.headersLength=null,this.messageLength=null,this.onError=this.errorEmitter.event,this.onClose=this.closeEmitter.event,this.onPartialMessage=this.partialMessageEmitter.event,this.eventRegistration=this.channel.onDataReceived(this.onDataReceived.bind(this)),this.channel.onClosed((e=>{e.error&&this.errorEmitter.fire(e.error),this.closeEmitter.fire()}))}listen(e){return this.callback=e,n.Disposable.create((()=>{this.callback=null}))}dispose(){this.eventRegistration&&this.eventRegistration.dispose()}onDataReceived(e){if(this.messageBuffer.write(e),this.channel.adjustWindow(e.length),e=this.messageBuffer.toBuffer(),null===this.messageLength){const t=e.indexOf(a);if(t<0)return;const r=e.slice(0,t).toString();if(!r.startsWith(o))throw new Error(`Message does not start with JSON-RPC headers.\n${r}`);this.headersLength=t+a.length,this.messageLength=parseInt(r.substr(o.length,t-o.length),10)}const t=this.messageBuffer.position,r=this.headersLength+this.messageLength;if(t>=r){if(this.callback){const t=e.slice(this.headersLength,r).toString();let n;try{n=JSON.parse(t)}catch(e){if(!(e instanceof Error))throw e;throw new Error(`Failed to parse JSON-RPC message: ${e.message}\n${t}`)}this.callback(n)}this.messageLength=null,this.messageBuffer.position=0,t>r&&this.onDataReceived(e.slice(r))}}}class h{constructor(e){this.channel=e,this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter,this.onError=this.errorEmitter.event,this.onClose=this.closeEmitter.event,this.channel.onClosed((e=>{e.error&&this.errorEmitter.fire([e.error,e.errorMessage&&{jsonrpc:e.errorMessage}||void 0,e.exitStatus]),this.closeEmitter.fire()}))}write(e){const t=JSON.stringify(e),r=s.Buffer.from(t),n=s.Buffer.from(o+r.length+a),i=s.Buffer.alloc(n.length+r.length);return n.copy(i,0),r.copy(i,n.length),this.channel.send(i).catch((e=>{this.errorEmitter.fire([e,void 0,void 0])}))}end(){}dispose(){}}t.SshRpcMessageStream=class{constructor(e){this.reader=new c(e),this.writer=new h(e)}}},6140:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshServerSession=void 0;const n=r(8016),s=r(8231),i=r(8673),o=r(5443),a=r(3816),c=r(1618);class h extends n.SshSession{constructor(e,t){super(e,!1),this.clientAuthenticatedEmitter=new s.Emitter,this.onClientAuthenticated=this.clientAuthenticatedEmitter.event,this.reconnectedEmitter=new s.Emitter,this.onReconnected=this.reconnectedEmitter.event,this.credentials={publicKeys:[]};const r=e.protocolExtensions.includes(a.SshProtocolExtensionNames.sessionReconnect);if(r&&!t)throw new Error("When reconnect is enabled, server sessions require a reference to a shared collection to track reconnectable sessions.");if(!r&&t)throw new Error("When reconnect is not enabled, the reconnectable sessions collection is not applicable.");this.reconnectableSessions=t}async handleServiceRequestMessage(e,t){if(!this.activateService(e.serviceName))throw new o.SshConnectionError(`Service "${e.serviceName}" not available.`,i.SshDisconnectReason.serviceNotAvailable);{const r=new i.ServiceAcceptMessage;r.serviceName=e.serviceName,await this.sendMessage(r,t)}}async handleRequestMessage(e,t){var r;if("session-reconnect@microsoft.com"===e.requestType&&(null===(r=this.config.protocolExtensions)||void 0===r?void 0:r.includes(a.SshProtocolExtensionNames.sessionReconnect))){const r=e.convertTo(new i.SessionReconnectRequestMessage);await this.reconnect(r,t)}else await super.handleRequestMessage(e,t)}handleClientAuthenticated(){this.clientAuthenticatedEmitter.fire()}async enableReconnect(e){await super.enableReconnect(e),this.reconnectableSessions.includes(this)||this.reconnectableSessions.push(this)}handleDisconnected(){return!!this.reconnecting||super.handleDisconnected()}async reconnect(e,t){var r,n,s;if(!this.reconnectableSessions)throw new Error("Disconnected sessions collection should have been initialied when reconnect is enabled.");let o;for(const t of this.reconnectableSessions)if(t!==this&&await this.verifyReconnectToken(t.sessionId,this.sessionId,null!==(r=e.clientReconnectToken)&&void 0!==r?r:Buffer.alloc(0))){o=t,this.reconnectableSessions.splice(this.reconnectableSessions.indexOf(o),1);break}if(!o||o.isClosed){const e="Requested reconnect session was not found or the reconnect token provided by the client was invalid.";this.trace(c.TraceLevel.Error,c.SshTraceEventIds.serverSessionReconnectFailed,`Reconnect failed: ${e}`);const r=new i.SessionReconnectFailureMessage;return r.reasonCode=i.SshReconnectFailureReason.sessionNotFound,r.description=e,void await this.sendMessage(r,t)}const a=o.protocol.getSentMessages((null!==(n=e.lastReceivedSequenceNumber)&&void 0!==n?n:0)+1);if(!a){this.reconnectableSessions.push(o);const e="Server is unable to re-send messages requested by the client.";this.trace(c.TraceLevel.Error,c.SshTraceEventIds.serverSessionReconnectFailed,`Reconnect failed: ${e}`);const r=new i.SessionReconnectFailureMessage;return r.reasonCode=i.SshReconnectFailureReason.serverDroppedMessages,r.description=e,void await this.sendMessage(r,t)}const h=new i.SessionReconnectResponseMessage;h.serverReconnectToken=await this.createReconnectToken(o.sessionId,this.sessionId),h.lastReceivedSequenceNumber=o.protocol.lastIncomingSequence,await this.sendMessage(h,t);try{for(o.reconnecting=!0,null===(s=o.protocol)||void 0===s||s.dispose();o.isConnected;)await new Promise((e=>setTimeout((()=>e()),5)));o.protocol=this.protocol,o.protocol.kexService=o.kexService,this.protocol=void 0;for(const e of a)await o.sendMessage(e,t);this.dispose()}finally{o.reconnecting=!1}this.reconnectableSessions.push(o),o.metrics.addReconnection(),o.processMessages().catch((e=>{this.trace(c.TraceLevel.Error,c.SshTraceEventIds.unknownError,`Unhandled error processing messages: ${e.message}`,e)})),this.trace(c.TraceLevel.Info,c.SshTraceEventIds.serverSessionReconnecting,`${o} reconnected. Re-sent ${a.length} dropped messages.`),o.reconnectedEmitter.fire()}dispose(){if(this.reconnectableSessions){const e=this.reconnectableSessions.indexOf(this);e>=0&&this.reconnectableSessions.splice(e,1)}super.dispose()}}t.SshServerSession=h},8016:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSession=void 0;const n=r(1618),s=r(4300),i=r(8231),o=r(3816),a=r(9174),c=r(9177),h=r(2438),l=r(454),u=r(8272),d=r(8402),p=r(5300),f=r(8973),g=r(4405),m=r(733),y=r(2694),v=r(8673),w=r(4235),S=r(5928),b=r(4709),E=r(9826),C=r(9483),T=r(9612),R=r(5443),_=r(7688),P=r(1513);class x{get algorithms(){return this.protocol?this.protocol.algorithms:null}get principal(){return this.principalValue}set principal(e){this.principalValue=e}constructor(e,t){if(this.config=e,this.remoteVersion=null,this.activatedServices=new Map,this.connectionService=null,this.requestHandler=null,this.blockedMessages=[],this.blockedMessagesSemaphore=new _.Semaphore(1),this.connected=!1,this.disposed=!1,this.metrics=new w.SessionMetrics,this.reconnecting=!1,this.sessionId=null,this.principalValue=null,this.authenticatingEmitter=new i.Emitter,this.onAuthenticating=this.authenticatingEmitter.event,this.closedEmitter=new i.Emitter,this.onClosed=this.closedEmitter.event,this.disconnectedEmitter=new i.Emitter,this.onDisconnected=this.disconnectedEmitter.event,this.serviceActivatedEmitter=new i.Emitter,this.onServiceActivated=this.serviceActivatedEmitter.event,this.channelOpeningEmitter=new i.Emitter,this.onChannelOpening=this.channelOpeningEmitter.event,this.requestEmitter=new i.Emitter,this.onRequest=this.requestEmitter.event,this.trace=(e,t,r,n)=>{},!e)throw new TypeError("Session configuration is required.");if(e.keyExchangeAlgorithms.find((e=>!!e)))this.kexService=new l.KeyExchangeService(this,null!=t&&t);else{if(e.encryptionAlgorithms.length>0&&e.encryptionAlgorithms.indexOf(null)<0)throw new Error("Encryption requires a key-exchange algorithm to be configured.");if(e.hmacAlgorithms.length>0&&e.hmacAlgorithms.indexOf(null)<0)throw new Error("HMAC requires a key-exchange algorithm to be configured.");if(e.publicKeyAlgorithms.length>0&&e.publicKeyAlgorithms.indexOf(null)<0)throw new Error("Host authentication requires a key-exchange algorithm to be configured.");this.kexService=null,this.activateService(d.ConnectionService)}e.onConfigurationChanged((()=>{const t=this.protocol;t&&(t.traceChannelData=e.traceChannelData)}))}get isConnected(){return this.connected}get isClosed(){return this.disposed}get services(){return[...this.activatedServices.values()]}get channels(){var e,t;return null!==(t=null===(e=this.connectionService)||void 0===e?void 0:e.channels)&&void 0!==t?t:[]}get protocolExtensions(){var e;return(null===(e=this.protocol)||void 0===e?void 0:e.extensions)||null}getService(e){return this.activatedServices.get(e)||null}activateService(e){let t;if("function"==typeof e)t=e;else{const r=e;if(t=(0,u.findService)(this.config.services,(e=>e.serviceRequest===r)),!t)return null}let r=this.activatedServices.get(t);if(!r){if(!this.config.services.has(t))throw new Error(`Service type not configured: ${t.name}`);r=new t(this,this.config.services.get(t)),t===d.ConnectionService&&(this.connectionService=r),this.activatedServices.set(t,r),this.serviceActivatedEmitter.fire(r)}return r}async connect(e,t){if(!e)throw new TypeError("A session stream is required.");if(this.disposed)throw new R.ObjectDisposedError(this);this.connectPromise||(this.connectPromise=this.doConnect(e,t)),await this.connectPromise}async doConnect(e,t){this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionConnecting,`${this} ${this.reconnecting?"re":""}connecting...`),this.protocol=new h.SshProtocol(e,this.config,this.metrics,this.trace),this.protocol.kexService=this.kexService,await this.exchangeVersions(t),this.kexService?await this.encrypt(t):(await this.sendMessage(g.KeyExchangeInitMessage.none,t),await(0,T.withCancellation)(this.versionExchangePromise,t),this.connected=!0),this.processMessages().catch((e=>{this.trace(n.TraceLevel.Error,n.SshTraceEventIds.unknownError,`Unhandled error processing messages: ${e.message}`,e)}))}async exchangeVersions(e){const t=this.protocol.writeProtocolVersion(x.localVersion.toString(),e),r=this.protocol.readProtocolVersion(e);this.versionExchangePromise=r.then((async e=>{let t;this.trace(n.TraceLevel.Info,n.SshTraceEventIds.protocolVersion,`Local version: ${x.localVersion}, remote version: ${e}`);const r=c.SshVersionInfo.tryParse(e);if(r){if(this.remoteVersion=r,"2.0"===r.protocolVersion)return;t=`Remote SSH version ${this.remoteVersion} is not supported. This library only supports SSH v2.0.`}else t=`Could not parse remote SSH version ${e}`;await this.close(v.SshDisconnectReason.protocolVersionNotSupported,t,new Error(t))})),await t}async encrypt(e){var t,r;const s=this.protocol;if(!s)throw new R.ObjectDisposedError(this);await s.considerReExchange(!0,e),await(0,T.withCancellation)(this.versionExchangePromise,e),this.connected=!0;let i=null;for(;!(this.isClosed||(null===(t=this.protocol)||void 0===t?void 0:t.algorithms)||i instanceof v.DisconnectMessage)&&(i=await s.receiveMessage(e),i);)await this.handleMessage(i,e);if(!(null===(r=this.protocol)||void 0===r?void 0:r.algorithms))throw new R.SshConnectionError("Session closed while encrypting.",v.SshDisconnectReason.connectionLost);this.protocol.algorithms.cipher&&this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionEncrypted,`${this} encrypted.`)}async processMessages(){var e;for(this.connected=!0;!this.disposed;){const t=this.protocol;if(!t)break;let r=null;try{r=await t.receiveMessage()}catch(t){if(!(t instanceof Error))throw t;let r=v.SshDisconnectReason.protocolError;t instanceof R.SshConnectionError?r=null!==(e=t.reason)&&void 0!==e?e:r:this.trace(n.TraceLevel.Error,n.SshTraceEventIds.receiveMessageFailed,`Error receiving message: ${t.message}`,t),await this.close(r,t.message,t)}if(!r){await this.close(v.SshDisconnectReason.connectionLost,"Connection lost.");break}try{await this.handleMessage(r)}catch(e){if(!(e instanceof Error))throw e;this.trace(n.TraceLevel.Error,n.SshTraceEventIds.handleMessageFailed,`Error handling ${r}: ${e.message}`,e),await this.close(v.SshDisconnectReason.protocolError,e.message,e)}}this.connected=!1}get canAcceptRequests(){var e;return!(this.kexService&&(!(null===(e=this.protocol)||void 0===e?void 0:e.algorithms)||this.protocol.algorithms.cipher&&!this.principal))}async sendMessage(e,t){var r,s;if(!e)throw new TypeError("Message expected.");if(t&&t.isCancellationRequested)throw new T.CancellationError;const i=this.protocol;if(!i||this.disposed)throw new R.ObjectDisposedError(this);if(this.kexService&&this.kexService.exchanging&&e.messageType>4&&(e.messageType<20||e.messageType>49))return void this.blockedMessages.push(e);let a;await this.blockedMessagesSemaphore.wait(t);try{a=await i.sendMessage(e,t),this.blockedMessagesSemaphore.release()}catch(t){if(this.blockedMessagesSemaphore.release(),t instanceof R.SshConnectionError&&t.reason===v.SshDisconnectReason.connectionLost&&(null===(r=this.protocolExtensions)||void 0===r?void 0:r.has(o.SshProtocolExtensionNames.sessionReconnect)))return;if(!(t instanceof Error))throw t;throw this.trace(n.TraceLevel.Error,n.SshTraceEventIds.sendMessageFailed,`Error sending ${e}: ${t.message}`,t),t}if(!a&&!(null===(s=this.protocolExtensions)||void 0===s?void 0:s.has(o.SshProtocolExtensionNames.sessionReconnect)))throw new R.SshConnectionError("Session disconnected.",v.SshDisconnectReason.connectionLost)}handleMessage(e,t){var r;if(e instanceof m.ConnectionMessage&&this.connectionService)return this.connectionService.handleMessage(e,t);if(e instanceof g.NewKeysMessage)return this.handleNewKeysMessage(e,t);if(e instanceof g.KeyExchangeMessage)return this.handleKeyExchangeMessage(e,t);if(e instanceof y.AuthenticationMessage)return null===(r=this.getService(p.AuthenticationService))||void 0===r?void 0:r.handleMessage(e,t);if(e instanceof v.ServiceRequestMessage)return this.handleServiceRequestMessage(e,t);if(e instanceof v.ServiceAcceptMessage)return this.handleServiceAcceptMessage(e,t);if(e instanceof v.SessionRequestMessage)return this.handleRequestMessage(e,t);if(e instanceof v.SessionRequestSuccessMessage)return this.handleRequestSuccessMessage(e);if(e instanceof v.SessionRequestFailureMessage)return this.handleRequestFailureMessage(e);if(e instanceof v.ExtensionInfoMessage)return this.handleExtensionInfoMessage(e,t);if(e instanceof v.DisconnectMessage)return this.handleDisconnectMessage(e);if(e instanceof v.UnimplementedMessage)return this.handleUnimplementedMessage(e,t);if(e instanceof v.DebugMessage)return this.handleDebugMessage(e);if(!(e instanceof v.IgnoreMessage))throw e instanceof f.SshMessage?new Error(`Unhandled message type: ${e.constructor.name}`):new TypeError("Message argument was "+(e?"invalid type.":"null."))}async handleRequestMessage(e,t){var r;let s=!1,i=null;if("initial-channel-request@microsoft.com"===e.requestType&&this.config.protocolExtensions.includes(o.SshProtocolExtensionNames.openChannelRequest)){const r=e.convertTo(new v.SessionChannelRequestMessage),n=r.senderChannel,i=this.channels.find((e=>e.remoteChannelId===n));i&&r.request&&(r.request.wantReply=!1,s=await i.handleRequest(r.request,t))}else if("enable-session-reconnect@microsoft.com"===e.requestType&&(null===(r=this.config.protocolExtensions)||void 0===r?void 0:r.includes(o.SshProtocolExtensionNames.sessionReconnect)))this.protocol.incomingMessagesHaveReconnectInfo||(this.protocol.incomingMessagesHaveReconnectInfo=!0,this.protocol.incomingMessagesHaveLatencyInfo=this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionLatency),s=!0);else if(this.canAcceptRequests){const r=new E.SshRequestEventArgs(e.requestType||"",e,this.principal,t),n=(0,u.findService)(this.config.services,(t=>t.sessionRequest===e.requestType));if(n){const e=this.activateService(n);await e.onSessionRequest(r,t)}else this.raiseSessionRequest(r);r.responsePromise?(i=await r.responsePromise,s=i instanceof v.SessionRequestSuccessMessage):s=r.isAuthorized||!1}else this.trace(n.TraceLevel.Warning,n.SshTraceEventIds.sessionRequestFailed,"Session request blocked because the session is not yet authenticated."),s=!1;e.wantReply&&(s?i instanceof v.SessionRequestSuccessMessage||(i=new v.SessionRequestSuccessMessage):i instanceof v.SessionRequestFailureMessage||(i=new v.SessionRequestFailureMessage),await this.sendMessage(i,t))}raiseSessionRequest(e){this.requestEmitter.fire(e)}async handleServiceRequestMessage(e,t){}async handleServiceAcceptMessage(e,t){}async handleKeyExchangeMessage(e,t){this.kexService?await this.kexService.handleMessage(e,t):e instanceof g.KeyExchangeInitMessage&&e.allowsNone||await this.close(v.SshDisconnectReason.keyExchangeFailed,"Encryption is disabled.")}async handleNewKeysMessage(e,t){try{await this.blockedMessagesSemaphore.wait(t),await this.protocol.handleNewKeys(t);try{for(;this.blockedMessages.length>0;){const e=this.blockedMessages.shift();if(!this.protocol)throw new R.ObjectDisposedError(this);await this.protocol.sendMessage(e,t)}}catch(e){if(!(e instanceof Error))throw e;await this.close(v.SshDisconnectReason.protocolError,void 0,e)}}finally{this.blockedMessagesSemaphore.release()}}async handleUnimplementedMessage(e,t){void 0!==e.unimplementedMessageType&&await this.sendMessage(e,t)}handleDebugMessage(e){e.message&&this.trace(e.alwaysDisplay?n.TraceLevel.Info:n.TraceLevel.Verbose,n.SshTraceEventIds.debugMessage,e.message)}async raiseAuthenticatingEvent(e){this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionAuthenticating,`${this} Authenticating(${e})`),this.authenticatingEmitter.fire(e);let t=e.authenticationPromise;return t||(t=Promise.resolve(null)),await t}async request(e,t){if(!e)throw new TypeError("Request is required.");return e.wantReply?await this.requestResponse(e,v.SessionRequestSuccessMessage,v.SessionRequestFailureMessage,t)instanceof v.SessionRequestSuccessMessage:(await this.sendMessage(e,t),!0)}async requestResponse(e,t,r,n){if(!e)throw new TypeError("Request is required.");if(!t)throw new TypeError("Success response type is required.");if(!r)throw new TypeError("Failure response type is required.");if(this.requestHandler)throw new Error("Another request is already pending.");e.wantReply=!0;const s=new S.PromiseCompletionSource;if(n){if(n.isCancellationRequested)throw new T.CancellationError;n.onCancellationRequested((()=>{this.requestHandler=null,s.reject(new T.CancellationError)}))}return this.requestHandler=(e,n)=>{var i,o;if(this.requestHandler=null,e)s.reject(e);else if(n instanceof v.SessionRequestFailureMessage){const e=null!==(i=null==n?void 0:n.convertTo(new r,!0))&&void 0!==i?i:null;s.resolve(e)}else if(n instanceof v.SessionRequestSuccessMessage){const e=null!==(o=null==n?void 0:n.convertTo(new t,!0))&&void 0!==o?o:null;s.resolve(e)}else s.reject(new Error("Unknown response message type."))},await this.sendMessage(e,n),await s.promise}handleRequestSuccessMessage(e){this.requestHandler&&this.requestHandler(void 0,e)}handleRequestFailureMessage(e){this.requestHandler&&this.requestHandler(void 0,e)}async acceptChannel(e,t){const r="string"==typeof e?e:void 0;t||"object"!=typeof e||(t=e),this.activateService(d.ConnectionService);const n=this.connectionService.acceptChannel(r||a.SshChannel.sessionChannelType,t);return await n}async openChannel(e,t,r){let n;if("string"==typeof e||null===e?(n=new m.ChannelOpenMessage,n.channelType=null!=e?e:a.SshChannel.sessionChannelType):e instanceof m.ChannelOpenMessage?n=e:(n=new m.ChannelOpenMessage,n.channelType=a.SshChannel.sessionChannelType,r=e),t instanceof m.ChannelRequestMessage)return await this.openChannelWithInitialRequest(n,t,r);r||null===t||(r=t),this.activateService(d.ConnectionService);const s=new S.PromiseCompletionSource;return await this.connectionService.openChannel(n,s,r),await s.promise}async openChannelWithInitialRequest(e,t,r){var n;this.activateService(d.ConnectionService);const s=new S.PromiseCompletionSource,i=await this.connectionService.openChannel(e,s,r);if(r){if(r.isCancellationRequested)throw new T.CancellationError;r.onCancellationRequested((()=>s.reject(new T.CancellationError)))}let a,c;const h=this.config.protocolExtensions.includes(o.SshProtocolExtensionNames.openChannelRequest)&&(null===(n=this.protocolExtensions)||void 0===n?void 0:n.has(o.SshProtocolExtensionNames.openChannelRequest));if(!1===h)a=await s.promise,c=await a.request(t,r);else{const e=t.wantReply||void 0===h,n=new v.SessionChannelRequestMessage;n.requestType="initial-channel-request@microsoft.com",n.senderChannel=i,n.request=t,n.wantReply=e;const o=this.request(n,r);a=await s.promise,e?(c=await o,c||void 0!==h||(c=await a.request(t))):c=!0}if(!c)throw await a.close(),new Error("The initial channel request was denied.");return a}async handleChannelOpening(e,t,r=!0){if(r){const r=(0,u.findService)(this.config.services,(t=>t.channelType===e.channel.channelType&&!t.channelRequest));if(r){const n=this.activateService(r);return void await n.onChannelOpening(e,t)}}e.cancellation=null!=t?t:i.CancellationToken.None,this.channelOpeningEmitter.fire(e),e.openingPromise&&await e.openingPromise}async sendExtensionInfo(e){const t=new v.ExtensionInfoMessage;t.extensionInfo={};for(const e of this.config.protocolExtensions)if(e===o.SshProtocolExtensionNames.serverSignatureAlgorithms){const r=Array.from(new Set((0,C.algorithmNames)(this.config.publicKeyAlgorithms))).join(",");t.extensionInfo[e]=r}else t.extensionInfo[e]="";await this.sendMessage(t,e)}async handleExtensionInfoMessage(e,t){if(this.protocol&&(this.protocol.extensions=new Map,e.extensionInfo)){for(const t of this.config.protocolExtensions){const r=e.extensionInfo[t];"string"==typeof r&&this.protocol.extensions.set(t,r)}this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionReconnect)&&await this.enableReconnect(t)}}async close(e,t,r){var s,i,o;if(!this.disposed&&this.connected){if(this.connected=!1,this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionClosing,`${this} Close(${v.SshDisconnectReason[e]}, "${t||""}")`),e!==v.SshDisconnectReason.connectionLost)try{const r=new v.DisconnectMessage;r.reasonCode=e,r.description=t||"",await(null===(s=this.protocol)||void 0===s?void 0:s.sendMessage(r))}catch(e){}else if(this.handleDisconnected())return null===(i=this.protocol)||void 0===i||i.dispose(),this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionDisconnected,`${this} disconnected.`),void this.disconnectedEmitter.fire();this.disposed=!0,this.closedError=r,(r=null!=r?r:new R.SshConnectionError(t,e))&&(null===(o=this.connectionService)||void 0===o||o.close(r)),this.closedEmitter.fire(new b.SshSessionClosedEventArgs(e,t||"Disconnected.",r)),this.dispose()}}handleDisconnected(){var e,t;return this.connectPromise=void 0,null===(e=this.kexService)||void 0===e||e.abortKeyExchange(),!!(null===(t=this.protocolExtensions)||void 0===t?void 0:t.has(o.SshProtocolExtensionNames.sessionReconnect))}async handleDisconnectMessage(e){var t;const r=e.description||"Received disconnect message.";await this.close(null!==(t=e.reasonCode)&&void 0!==t?t:v.SshDisconnectReason.none,r)}dispose(){var e,t;const r=this.closedError instanceof R.SshConnectionError?this.closedError:new R.SshConnectionError("Session disposed.");this.disposed||(this.trace(n.TraceLevel.Info,n.SshTraceEventIds.sessionClosing,`${this} disposed.`),this.disposed=!0,this.closedEmitter.fire(new b.SshSessionClosedEventArgs(v.SshDisconnectReason.none,"SshSession disposed",r))),this.requestHandler&&this.requestHandler(r),this.metrics.close(),null===(e=this.connectionService)||void 0===e||e.dispose();for(const e of this.activatedServices.values())e!==this.connectionService&&e.dispose();this.activatedServices.clear(),null===(t=this.protocol)||void 0===t||t.dispose(),this.protocol=void 0}async enableReconnect(e){var t;try{if(await this.blockedMessagesSemaphore.wait(),null===(t=this.kexService)||void 0===t?void 0:t.exchanging)this.trace(n.TraceLevel.Error,n.SshTraceEventIds.sessionReconnectInitFailed,"Failed to initialize session reconnect because a key-exchange was in-progress.");else{const t=new v.SessionRequestMessage("enable-session-reconnect@microsoft.com",!1);await this.protocol.sendMessage(t,e),this.protocol&&(this.protocol.outgoingMessagesHaveReconnectInfo=!0,this.protocol.outgoingMessagesHaveLatencyInfo=this.protocol.extensions.has(o.SshProtocolExtensionNames.sessionLatency))}this.blockedMessagesSemaphore.release()}catch(e){throw this.blockedMessagesSemaphore.release(),e instanceof Error&&await this.close(v.SshDisconnectReason.protocolError,void 0,e),e}}async createReconnectToken(e,t){return await this.algorithms.signer.sign(s.Buffer.concat([e,t]))}async verifyReconnectToken(e,t,r){return await this.algorithms.verifier.verify(s.Buffer.concat([e,t]),r)}pipe(e){return P.PipeExtensions.pipeSession(this,e)}toString(){return this.constructor.name}}t.SshSession=x,x.localVersion=c.SshVersionInfo.getLocalVersion()},2725:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionAlgorithms=void 0,t.SshSessionAlgorithms=class{dispose(){this.cipher&&this.cipher.dispose(),this.decipher&&this.decipher.dispose(),this.signer&&this.signer.dispose(),this.verifier&&this.verifier.dispose()}}},3816:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshSessionConfiguration=t.SshProtocolExtensionNames=void 0;const n=r(8231),s=r(9483),i=r(454),o=r(8402),a=r(5300),c=r(8973);var h;!function(e){e.serverSignatureAlgorithms="server-sig-algs",e.openChannelRequest="open-channel-request@microsoft.com",e.sessionReconnect="session-reconnect@microsoft.com",e.sessionLatency="session-latency@microsoft.com"}(h=t.SshProtocolExtensionNames||(t.SshProtocolExtensionNames={})),t.SshSessionConfiguration=class{constructor(e=!0){this.protocolExtensions=[],this.services=new Map,this.messages=new Map,this.keyExchangeAlgorithms=[],this.publicKeyAlgorithms=[],this.encryptionAlgorithms=[],this.hmacAlgorithms=[],this.compressionAlgorithms=[],this.traceChannelDataValue=!1,this.configurationChangedEmitter=new n.Emitter,this.onConfigurationChanged=this.configurationChangedEmitter.event,this.maxClientAuthenticationAttempts=5,this.enableKeyExchangeGuess=!1,this.keyRotationThreshold=536870912,this.protocolExtensions.push(h.serverSignatureAlgorithms),this.protocolExtensions.push(h.openChannelRequest),this.services.set(i.KeyExchangeService,null),this.services.set(o.ConnectionService,null),this.services.set(a.AuthenticationService,null);for(const[e,t]of c.SshMessage.index)this.messages.set(e,t);e?(this.keyExchangeAlgorithms.push(s.SshAlgorithms.keyExchange.ecdhNistp384Sha384),this.keyExchangeAlgorithms.push(s.SshAlgorithms.keyExchange.ecdhNistp256Sha256),this.keyExchangeAlgorithms.push(s.SshAlgorithms.keyExchange.dhGroup16Sha512),this.keyExchangeAlgorithms.push(s.SshAlgorithms.keyExchange.dhGroup14Sha256),this.publicKeyAlgorithms.push(s.SshAlgorithms.publicKey.rsaWithSha512),this.publicKeyAlgorithms.push(s.SshAlgorithms.publicKey.rsaWithSha256),this.publicKeyAlgorithms.push(s.SshAlgorithms.publicKey.ecdsaSha2Nistp384),this.publicKeyAlgorithms.push(s.SshAlgorithms.publicKey.ecdsaSha2Nistp256),this.encryptionAlgorithms.push(s.SshAlgorithms.encryption.aes256Gcm),this.encryptionAlgorithms.push(s.SshAlgorithms.encryption.aes256Ctr),this.hmacAlgorithms.push(s.SshAlgorithms.hmac.hmacSha512Etm),this.hmacAlgorithms.push(s.SshAlgorithms.hmac.hmacSha256Etm),this.hmacAlgorithms.push(s.SshAlgorithms.hmac.hmacSha512),this.hmacAlgorithms.push(s.SshAlgorithms.hmac.hmacSha256)):(this.keyExchangeAlgorithms.push(s.SshAlgorithms.keyExchange.none),this.publicKeyAlgorithms.push(s.SshAlgorithms.publicKey.none),this.encryptionAlgorithms.push(s.SshAlgorithms.encryption.none),this.hmacAlgorithms.push(s.SshAlgorithms.hmac.none)),this.compressionAlgorithms.push(s.SshAlgorithms.compression.none)}addService(e,t){if(this.services.has(e))throw new Error("Duplicate service entry.");this.services.set(e,t)}getKeyExchangeAlgorithm(e){return this.getAlgorithm(e,this.keyExchangeAlgorithms)}getPublicKeyAlgorithm(e){return this.getAlgorithm(e,this.publicKeyAlgorithms)}getEncryptionAlgorithm(e){return this.getAlgorithm(e,this.encryptionAlgorithms)}getHmacAlgorithm(e){return this.getAlgorithm(e,this.hmacAlgorithms)}getCompressionAlgorithm(e){return this.getAlgorithm(e,this.compressionAlgorithms)}getAlgorithm(e,t){const r=t.find((t=>!!t&&t.name===e));if(!r){if("none"===e)return null;throw new Error("Algorithm not found: "+e)}return r}get traceChannelData(){return this.traceChannelDataValue}set traceChannelData(e){e!==this.traceChannelDataValue&&(this.traceChannelDataValue=e,this.configurationChangedEmitter.fire())}}},3500:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshStream=void 0;const n=r(5928),s=r(2781);class i extends s.Duplex{constructor(e){let t=null;super({async write(t,r,n){let s;try{let n;if("string"==typeof t)n=Buffer.from(t,r);else{if(!(t instanceof Buffer||t instanceof Uint8Array))throw new Error("Unsupported chunk type: "+typeof t);n=t}await e.send(n)}catch(e){if(!(e instanceof Error))throw e;s=e}n&&n(s)},async writev(t,r){let n;try{if(1===t.length)return this.write(t[0].chunk,t[0].encoding,r);{function s(e,t){if(t.chunk instanceof Buffer||t.chunk instanceof Uint8Array)return e+t.chunk.length;throw new Error("Unsupported chunk type: "+typeof t.chunk)}const i=t.reduce(s,0),o=Buffer.alloc(i);let a=0;for(let c=0;c<t.length;c++)t[c].chunk.copy(o,a),a+=t[c].chunk.length;await e.send(o)}}catch(h){if(!(h instanceof Error))throw h;n=h}r&&r(n)},async final(t){let r;try{await e.close()}catch(e){if(!(e instanceof Error))throw e;r=e}t&&t(r)},read(){t&&(t.resolve(),t=null)}}),e.onDataReceived((async r=>{const s=Buffer.alloc(r.length);r.copy(s),this.push(s)||(t||(t=new n.PromiseCompletionSource),await t.promise),e.adjustWindow(s.length)})),e.onClosed((()=>{this.push(null)})),this.channel=e}destroy(e){return this.channel.close().catch(),super.destroy(e),this}toString(){return`SshStream(Channel Type: ${this.channel.channelType}, Id: ${this.channel.channelId}, RemoteId: ${this.channel.remoteChannelId})`}}t.SshStream=i},9177:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SshVersionInfo=void 0;const n=r(730),s=n.name.replace(/^@\w+\//,""),i=n.version;class o{static tryParse(e){if(!e)throw new TypeError("Version string expected.");if(!e.startsWith("SSH-"))return null;const t=e.indexOf("-",4);if(t<=0)return null;const r=e.substring(4,t);if(!/^\d+\.\d+$/.test(r))return null;let n,s;const i=e.substring(t+1),a=i.indexOf(" "),c=i.lastIndexOf("_",a>=0?a:i.length-1);if(c>=0){n=i.substring(0,c).replace(/_/g," "),s=i.substring(c+1);for(let e=0;e<s.length;e++){const t=s[e];if(!(t>="0"&&t<="9")&&"."!==t){s=s.substring(0,e);break}}/^\d+(\.\d+)*$/.test(s)||(s=null)}else n=i,s=null;return new o(e,r,n,s)}static getLocalVersion(){return new o(`SSH-2.0-${s}_${i}`,"2.0",s,i)}constructor(e,t,r,n){this.versionString=e,this.protocolVersion=t,this.name=r,this.version=n}toString(){return this.versionString}get isVsSsh(){return this.isVsSshCS||this.isVsSshTS}get isVsSshCS(){return"Microsoft.VisualStudio.Ssh"===this.name||"Microsoft.DevTunnels.Ssh"===this.name}get isVsSshTS(){return"vs-ssh"===this.name||"dev-tunnels-ssh"===this.name}}t.SshVersionInfo=o},7483:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketStream=t.NodeStream=t.BaseStream=void 0;const n=r(4300),s=r(8231),i=r(9612),o=r(5443);function a(e,t){t&&(t.isCancellationRequested?e(new i.CancellationError):t.onCancellationRequested((()=>{e(new i.CancellationError)})))}class c{constructor(){this.incomingData=[],this.pendingReads=[],this.error=null,this.disposed=!1,this.closedEmitter=new s.Emitter,this.closed=this.closedEmitter.event}onData(e){for(;this.pendingReads.length>0;){const t=this.pendingReads.shift();if(t.count>=e.length)return void t.resolve(e);{const r=e.slice(0,t.count);e=e.slice(t.count),t.resolve(r)}}this.incomingData.push(e)}onEnd(){for(;this.pendingReads.length>0;)this.pendingReads.shift().resolve(null);this.incomingData.push(n.Buffer.alloc(0))}onError(e){for(this.error||(this.error=e);this.pendingReads.length>0;)this.pendingReads.shift().reject(e)}async read(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);if(this.incomingData.length>0){let t=this.incomingData[0];return 0===t.length?null:(e>=t.length?this.incomingData.shift():(this.incomingData[0]=t.slice(e),t=t.slice(0,e)),t)}if(this.error)throw this.error;return await new Promise(((r,n)=>{if(t){if(t.isCancellationRequested)return void n(new i.CancellationError);t.onCancellationRequested((()=>{for(let e=0;e<this.pendingReads.length;e++)Object.is(t,this.pendingReads[e].cancellation)&&this.pendingReads.splice(e--,1)[0].reject(new i.CancellationError)}))}this.pendingReads.push({count:e,resolve:r,reject:n,cancellation:t})}))}dispose(){if(!this.disposed){this.disposed=!0;const e=new o.ObjectDisposedError(this);this.onError(e),this.fireOnClose(e)}}fireOnClose(e){this.closedEmitter.fire({error:e})}get isDisposed(){return this.disposed}}t.BaseStream=c,t.NodeStream=class extends c{constructor(e,t){if(super(),!e)throw new TypeError("Duplex or Readable/Writable stream are required.");this.readStream=e,this.writeStream=t||e,this.readStream.on("data",this.onData.bind(this)),this.readStream.on("end",this.onEnd.bind(this)),this.readStream.on("error",this.onError.bind(this)),this.readStream.on("close",(()=>{this.onEnd(),this.fireOnClose()}))}async write(e,t){if(!e)throw new TypeError("Data is required.");if(this.disposed)throw new o.ObjectDisposedError(this);return new Promise(((r,n)=>{a(n,t),this.writeStream.write(e,(e=>{e?n(e):r()}))}))}async close(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);await new Promise(((e,r)=>{a(r,t),this.writeStream.end(e)})),this.disposed=!0,this.onError(e||new o.ObjectDisposedError(this)),this.closedEmitter.fire({error:e})}dispose(){if(!this.disposed){const e=new o.ObjectDisposedError(this);this.readStream.destroy(e),this.writeStream.destroy(e)}super.dispose()}},t.WebSocketStream=class extends c{constructor(e){if(super(),this.websocket=e,!e)throw new TypeError("WebSocket is required.");if("string"==typeof e.binaryType&&"arraybuffer"!==e.binaryType)throw new Error("WebSocket must use arraybuffer binary type.");e.onmessage=e=>{this.onData(n.Buffer.from(e.data))},e.onclose=e=>{if(e.wasClean)this.onEnd();else{const t=new Error(e.reason);t.code=e.code,this.onError(t)}}}async write(e,t){if(!e)throw new TypeError("Data is required.");if(this.disposed)throw new o.ObjectDisposedError(this);if("readyState"in this.websocket&&(2===this.websocket.readyState||3===this.websocket.readyState))throw new DOMException("WebSocket is already in CLOSING or CLOSED state.","InvalidStateError");this.websocket.send(e)}async close(e,t){if(this.disposed)throw new o.ObjectDisposedError(this);if(e){const t="number"==typeof e.code?e.code:void 0;this.websocket.close(t,e.message)}else this.websocket.close();this.disposed=!0,this.closedEmitter.fire({error:e}),this.onError(e||new Error("Stream closed."))}dispose(){this.disposed||this.websocket.close(),super.dispose()}}},1618:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SshTraceEventIds=t.TraceLevel=void 0,(r=t.TraceLevel||(t.TraceLevel={})).Error="error",r.Warning="warning",r.Info="info",r.Verbose="verbose";class n{}t.SshTraceEventIds=n,n.unknownError=9e3,n.streamReadError=9001,n.streamWriteError=9002,n.streamCloseError=9003,n.sendMessageFailed=9004,n.receiveMessageFailed=9005,n.handleMessageFailed=9006,n.serverAuthenticationFailed=9007,n.clientAuthenticationFailed=9008,n.authenticationError=9009,n.channelWindowAdjustFailed=9010,n.channelWaitForWindowAdjust=9011,n.sessionReconnectInitFailed=9020,n.serverSessionReconnectFailed=9021,n.clientSessionReconnectFailed=9022,n.sessionRequestFailed=9023,n.channelRequestFailed=9024,n.serverListenFailed=9050,n.portForwardServerListenFailed=9051,n.portForwardRequestInvalid=9052,n.portForwardChannelInvalid=9053,n.portForwardChannelOpenFailed=9054,n.portForwardConnectionFailed=9055,n.protocolVersion=9100,n.sendingMessage=9101,n.receivingMessage=9102,n.sendingChannelData=9103,n.receivingChannelData=9104,n.sessionEncrypted=9110,n.sessionAuthenticating=9111,n.sessionAuthenticated=9112,n.sessionClosing=9113,n.sessionConnecting=9114,n.channelOpened=9120,n.channelOpenFailed=9121,n.channelEofReceived=9122,n.channelClosed=9123,n.serverListening=9150,n.serverClientConnected=9151,n.portForwardServerListening=9152,n.portForwardConnectionAccepted=9153,n.portForwardChannelOpened=9154,n.portForwardChannelClosed=9155,n.portForwardConnectionOpened=9156,n.portForwardConnectionClosed=9157,n.sessionDisconnected=9160,n.clientSessionReconnecting=9161,n.serverSessionReconnecting=9162,n.clientSessionStartReconnecting=9163,n.algorithmNegotiation=9170,n.debugMessage=9200},9612:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withCancellation=t.CancellationError=t.CancellationTokenSource=t.CancellationToken=void 0;const n=r(8231);Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return n.CancellationToken}}),Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return n.CancellationTokenSource}});class s extends Error{constructor(e){super(e||"Operation cancelled.")}}t.CancellationError=s,t.withCancellation=function(e,t){return t?Promise.race([e,new Promise(((e,r)=>{t.isCancellationRequested?r(new s):t.onCancellationRequested((()=>{r(new s)}))}))]):e}},5928:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseCompletionSource=void 0,t.PromiseCompletionSource=class{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}resolve(e){}reject(e){}}},1024:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=void 0;class r{constructor(){this.array=new Array,this.first=0,this.count=0,this.version=0}get size(){return this.count}enqueue(e){if(this.count===this.array.length){const e=new Array(Math.max(16,2*this.count));for(let t=0;t<this.count;t++)e[t]=this.array[(this.first+t)%this.count];this.array=e,this.first=0}this.array[(this.first+this.count)%this.array.length]=e,this.count++,this.version++}dequeue(){if(0===this.count)return;const e=this.array[this.first];return this.array[this.first]=void 0,this.first=(this.first+1)%this.array.length,this.count--,this.version++,e}peek(){if(0!==this.count)return this.array[this.first]}clear(){this.first=0,this.count=0,this.array.fill(void 0),this.version++}*[Symbol.iterator](){const e=this.version;for(let t=0;t<this.count;t++){const r=this.array[(this.first+t)%this.array.length];if(yield r,this.version!==e)throw new Error("Iterator is invalid due to changes in the collection.")}}}t.Queue=r},7688:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const n=r(5928),s=r(9612),i=r(5443);t.Semaphore=class{constructor(e=0){this.completions=[],this.disposed=!1,this.count=e}get currentCount(){return this.count}release(e=1){if(this.disposed)throw new i.ObjectDisposedError(this);const t=this.count;for(;e>0;e--)this.completions.length>0?this.completions.shift().resolve(!0):this.count++;return t}tryRelease(){try{this.release()}catch(e){if(!(e instanceof i.ObjectDisposedError))throw e}}async wait(e,t){const r="number"==typeof e?e:void 0;if(void 0===t&&"object"==typeof e&&(t=e),this.disposed)throw new i.ObjectDisposedError(this);if(null==t?void 0:t.isCancellationRequested)throw new s.CancellationError;if(this.count>0)return this.count--,!0;if(0===r)return!1;{const e=new n.PromiseCompletionSource;this.completions.push(e);const i=[e.promise];if(r&&i.push(new Promise((e=>setTimeout((()=>e(!1)),r)))),t){const e=new n.PromiseCompletionSource;t.onCancellationRequested((()=>{e.reject(new s.CancellationError)})),i.push(e.promise)}if(await Promise.race(i))return!0;{const t=this.completions.indexOf(e);return t>=0&&this.completions.splice(t,1),!1}}}dispose(){if(!this.disposed){this.disposed=!0;for(const e of this.completions)e.reject(new i.ObjectDisposedError(this));this.completions.splice(0,this.completions.length),this.count=0}}}},5100:(e,t,r)=>{(()=>{"use strict";var e,n,s=[,(e,t,r)=>{r.r(t),r.d(t,{TimeoutError:()=>s,firstPromise:()=>n,timeoutPromise:()=>i});const n=e=>new Promise(((t,r)=>{let n=e.length;for(const s of e)s.then((e=>{n--,void 0===e&&0!==n||(t(e),n=-1)})).catch(r)}));class s extends Error{}const i=(e,t,r)=>new Promise(((n,i)=>{const o=setTimeout((()=>i(new s(r??"Operation timed out"))),t);e.then(n,i).finally((()=>clearTimeout(o)))}))},(e,t,r)=>{r.r(t),r.d(t,{encodeBase64:()=>i});const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function i(e,t=!0,r=!1){const i=r?s:n;let o="";const a=e.byteLength%3;let c=0;for(;c<e.byteLength-a;c+=3){const t=e[c+0],r=e[c+1],n=e[c+2];o+=i[t>>>2],o+=i[63&(t<<4|r>>>4)],o+=i[63&(r<<2|n>>>6)],o+=i[63&n]}if(1===a){const r=e[c+0];o+=i[r>>>2],o+=i[r<<4&63],t&&(o+="==")}else if(2===a){const r=e[c+0],n=e[c+1];o+=i[r>>>2],o+=i[63&(r<<4|n>>>4)],o+=i[n<<2&63],t&&(o+="=")}return o}},(e,t,r)=>{r.r(t),r.d(t,{AccessTokenBasisClient:()=>a,BasisClient:()=>o,TunnelNotFoundError:()=>c});var n=r(4),s=r(5),i=r(6);class o{constructor(){this.managementClient=new i.Lazy((()=>this.createTunnelManagementClient())),this.tunnelLookupCache=new Map,this.taggedTunnelLookupCache=new Map}getManagementClient(){return this.managementClient.getValue()}async connect(e){if(!e.endpoints){const t=await this.getTunnel(e);if(!t)throw new c;e=t}const{TunnelRelayTunnelClient:t}=await Promise.resolve().then(r.t.bind(r,28,23)),n=new t;return n.acceptLocalConnectionsForForwardedPorts=!1,await n.connectClient(e,e.endpoints),n}async getTunnelForTag(e){if(this.taggedTunnelLookupCache.has(e))return this.taggedTunnelLookupCache.get(e);const t=await this.getManagementClient(),[r]=await t.listTunnels(void 0,void 0,{tags:[e,"vscode-server-launcher"],requireAllTags:!0,limit:1});if(!r)return;const n=await this.getTunnel(r);return n&&this.taggedTunnelLookupCache.set(e,n),n}async getTunnel(e,t=!0){const r=e.name||e.tunnelId;if(t&&this.tunnelLookupCache.has(r))return this.tunnelLookupCache.get(r);try{const t=await this.getManagementClient(),n=await t.getTunnel(e,{includePorts:!0,tokenScopes:["connect"]});return n&&this.tunnelLookupCache.set(r,n),n||void 0}catch(e){if(e instanceof Error&&e.message.includes("Not Found"))return;throw e}}}o.BASIS_SCOPES=[`${n.TunnelServiceProperties.production.serviceAppId}/.default`];class a extends o{constructor(e,t,r){super(),this.provider=e,this.userAgent=t,this.getAccessToken=r}async createTunnelManagementClient(){const e="microsoft"===this.provider?`Bearer ${await this.getAccessToken()}`:`github client_id=01ab8ac9400c4e429b23 ${await this.getAccessToken()}`;return new s.TunnelManagementHttpClient(this.userAgent,(async()=>e))}}class c extends Error{constructor(){super("Tunnel not found")}}},e=>{e.exports=r(4815)},e=>{e.exports=r(4215)},(e,t,r)=>{r.r(t),r.d(t,{Lazy:()=>n});class n{constructor(e){this.executor=e,this._didRun=!1}hasValue(){return this._didRun}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}map(e){return new n((()=>e(this.getValue())))}}},(e,t,r)=>{r.r(t),r.d(t,{sha256:()=>s});var n=r(8);const s=e=>{const t=(0,n.createHash)("sha256");return t.update(e),Promise.resolve(t.digest())}},e=>{e.exports=r(6113)},(e,t,r)=>{r.r(t),r.d(t,{RemoteVersion:()=>n});class n{constructor(e,t=0){this.cliVersion=e,this.protocolVerson=t}canPing(){return this.protocolVerson>=1}canCompressServerMsg(){return this.protocolVerson>=2}usesConnectionToken(){return this.protocolVerson>=3}}},(e,t,r)=>{r.r(t),r.d(t,{BasisConnectionBearer:()=>h});var n=r(11),s=r(1),i=r(12),o=r(14),a=r(9);const c=3e4;class h extends i.ConnectionBearer{constructor(e,t,r){super("Port Forwarding Service"),this.basis=e,this.tunnel=t,this.port=r,this.tunnelMayBeStale=!1,this.onStartConnecting((e=>{e.onNotification("version",(({version:e,protocol_version:t})=>{this.version=new a.RemoteVersion(e,t)}))}))}async isStreamValid(e){if(!0!==this.version?.canPing())return!0;const t=new AbortController,r=setTimeout((()=>t.abort()),5e3);try{return await e.call("ping",{},t.signal),!0}catch{return!1}finally{clearTimeout(r)}}async getConnectionTunnel(){if(this.tunnelMayBeStale){const e=await this.basis.getTunnel(this.tunnel,!1);e&&(this.tunnel=e)}if(!this.tunnel.endpoints?.length)throw new o.BasisError(new Error("The VS Code gateway is not currently running."),"EHOSTDOWN");const e=await(0,s.timeoutPromise)(this.basis.connect(this.tunnel),c,"Timeout connecting to relay");try{await(0,s.timeoutPromise)(e.waitForForwardedPort(this.port),c,"Timeout waiting for forwarded port");const t=await(0,s.timeoutPromise)(e.connectToForwardedPort(this.port),c,"Timeout connecting to port");return t.on("close",(()=>{this.tunnelMayBeStale=!0})),t.on("error",(()=>{this.tunnelMayBeStale=!0})),t}catch(t){throw e.dispose(),t}}encodeMessage(e){const t=(0,n.encode)(e),r=new Uint8Array(4+t.length);return new DataView(r.buffer).setUint32(0,t.length),r.set(t,4),r}}},e=>{e.exports=r(9676)},(e,t,r)=>{r.r(t),r.d(t,{Connection:()=>a,ConnectionBearer:()=>h,RPCError:()=>o});var n=r(13),s=r(11);let i=0;class o extends Error{constructor(e,t){super(`json rpc error ${e}: message`),this.code=e,this.message=t}}class a{constructor(e,t,r=new c){this.tunnel=e,this.encode=t,this.globalHandlers=r,this.callbacks=new Map,this.notifyEmitter=new n.EventEmitter,this.closeEmitter=new n.EventEmitter,this.ownHandlers=new c,this.onClose=this.closeEmitter.event,this.registerRequestHandler=this.ownHandlers.register,(async()=>{for await(const t of(0,s.decodeMultiStream)(e)){const e=t;"result"in e||"error"in e?this.callbacks.get(e.id)?.resolve(e):"id"in e&&"number"==typeof e.id?this.handleRequest(e):this.notifyEmitter.fire(e)}})(),e.once("close",(()=>{this.rejectAllCalls(new o(0,"Connection closed")),this.closeEmitter.fire(void 0)})),e.once("error",(e=>{const t=new o(0,e.message);this.rejectAllCalls(t),this.closeEmitter.fire(t)}))}dispose(){this.tunnel.end()}async call(e,t,r){const n=i++;return new Promise(((s,i)=>{this.callbacks.set(n,{resolve:e=>{"error"in e?i(new o(e.error?.code,e.error?.message)):s(e.result)},reject:i}),r?.addEventListener("abort",(()=>i(new o(0,"Operation cancelled")))),this.write(this.encode({id:n,method:e,params:t}))})).finally((()=>this.callbacks.delete(n)))}onNotification(e,t){return this.notifyEmitter.event((r=>{r.method===e&&t(r.params)}))}notify(e,t){this.write(this.encode({method:e,params:t}))}async handleRequest(e){const t=this.ownHandlers.map.get(e.method)||this.globalHandlers.map.get(e.method);if(!t){const t={id:e.id,error:{message:"Unknown method. Cannot resolve request",code:36}};return void this.write(this.encode(t))}let r;try{r={id:e.id,result:await t(e.params,this)}}catch(t){t instanceof o?r={id:e.id,error:{code:t.code,message:t.message}}:(console.warn("Unexpected error handling request",e,t),r={id:e.id,error:{code:-1,message:String(t)}})}this.write(this.encode(r))}write(e){this.tunnel.write(e)}rejectAllCalls(e){for(const{reject:t}of this.callbacks.values())t(e);this.callbacks.clear()}}class c{constructor(){this.map=new Map,this.register=(e,t)=>{this.map.has(e)&&console.warn("Overriding previous handler for method: ",e),this.map.set(e,t)}}}class h{constructor(e){this.callHandlers=new c,this.startEmitter=new n.EventEmitter,this.onStartConnecting=this.startEmitter.event,this.notifyEmitter=new n.EventEmitter,this.closeEmitter=new n.EventEmitter,this.onClose=this.closeEmitter.event,this.registerRequestHandler=this.callHandlers.register,this.BEARER_TYPE=e}async checkedAcquire(){if(this.streamPromise){const e=await this.streamPromise;if(await this.isStreamValid(e))return e;e.dispose()}this.streamPromise=this.acquireNow();try{return await this.streamPromise}catch(e){throw this.streamPromise=void 0,e}}async acquire(){this.streamPromise??(this.streamPromise=this.acquireNow());try{return await this.streamPromise}catch(e){throw this.streamPromise=void 0,e}}async isStreamValid(e){return!0}async close(){this.streamPromise?.then((e=>e.dispose())),this.streamPromise=void 0}async acquireNow(){const e=await this.getConnectionTunnel(),t=new a(e,(e=>this.encodeMessage(e)),this.callHandlers);return t.onClose((e=>{this.streamPromise=void 0,this.closeEmitter.fire(e)})),this.startEmitter.fire(t),t}}},e=>{e.exports=r(7923)},(e,t,r)=>{r.r(t),r.d(t,{BasisError:()=>n});class n extends Error{constructor(e,t="ECONNREFUSED"){super(e.message),this.code=t,this.syscall="connect",this.stack=e.stack}}},(e,t,r)=>{r.r(t),r.d(t,{BasisWebSocketFactory:()=>n});class n{constructor(e){this.manager=e}create(e){return this.manager.getWebSocket(e)}}},(e,t,r)=>{r.r(t),r.d(t,{ConnectionManager:()=>l});var n=r(13),s=r(10),i=r(17),o=r(22),a=r(24),c=r(9),h=r(18);class l{constructor(e){this.options=e,this.socketId=0,this.connectingEmitter=new n.EventEmitter,this.onStartConnecting=this.connectingEmitter.event,this.connectedEmitter=new n.EventEmitter,this.onConnected=this.connectedEmitter.event,this.logEmitter=new n.EventEmitter,this.onLog=this.logEmitter.event,this.versionPromise=new a.DeferredPromise,this.loopbackHandler=async e=>{try{const t=await this.bearer.acquire(),r=await t.call("callserverhttp",{path:"/vscode-remote-resource?"+new URLSearchParams({path:e.uri.path}),method:e.method,headers:e.headers}),n=new ArrayBuffer(r.body.length);return new Uint8Array(n).set(r.body),{status:r.status,body:n,headers:r.headers}}catch(e){return{status:500,headers:{},body:(new TextEncoder).encode(e.message).buffer}}},this.bearer=e.bearer||new s.BasisConnectionBearer(e.basis,e.tunnel,e.port),this.bearer.onStartConnecting((e=>{e.onNotification("version",(({version:e,protocol_version:t})=>{this.versionPromise.isSettled&&(this.versionPromise=new a.DeferredPromise),this.versionPromise.complete(new c.RemoteVersion(e,t))}))})),this.onClose=this.bearer.onClose;let t=!0;this.bearer.onStartConnecting((e=>{if(this.connectingEmitter.fire(),e.onNotification("serverlog",(e=>{this.logEmitter.fire(e)})),e.onNotification("makehttpreq",(async({url:t,method:r,req_id:n})=>{this.makeHttpCall(e,t,r,n)})),t){const r=e.onNotification("servermsg",(()=>{t&&(this.connectedEmitter.fire(),r.dispose(),t=!1)}))}}))}get version(){return this.versionPromise.p}async makeHttpCall(e,t,r,n){let s;try{s=await(0,o.fetchFn)(t,{method:r})}catch(t){return e.notify("httpheaders",{headers:[],status_code:503,req_id:n}),void e.notify("httpbody",{segment:(new TextEncoder).encode(String(t)),complete:!0,req_id:n})}e.notify("httpheaders",{headers:[...s.headers],status_code:s.status,req_id:n});const i=()=>e.notify("httpbody",{segment:new Uint8Array,complete:!0,req_id:n});if(s.body&&"function"==typeof s.body.on){const t=s.body;return t.on("data",(t=>e.notify("httpbody",{segment:t,complete:!1,req_id:n}))),t.on("end",i),t.on("error",i),void t.resume()}const a=s.body;if(a)try{const t=a.getReader();for(;;){const{done:r,value:s}=await t.read();if(e.notify("httpbody",{segment:s||new Uint8Array,complete:r,req_id:n}),r)break}}catch(e){throw i(),e}else i()}getWebSocket(e){let t=new i.BasisWebSocket({socketId:this.socketId++,url:e,bearer:this.bearer,product:this.options.productInfo,extensions:this.options.installExtensionsOnRemote},this.version);return t.initialize(),t}getServerWebSocket(){return new h.ServerWebSocket({socketId:this.socketId++,bearer:this.bearer,product:this.options.productInfo,extensions:this.options.installExtensionsOnRemote},this.version)}async checkForUpdates(e){return(await this.bearer.acquire()).call("update",{do_update:e?.doUpdate??!1})}async call(e,t){return(await this.bearer.acquire()).call(e,t)}}},(e,t,r)=>{r.r(t),r.d(t,{BasisWebSocket:()=>a});var n=r(13),s=r(1),i=r(14),o=r(18);class a extends o.ServerWebSocket{constructor(e,t){super(e,t),this._options=e,this.onDataEmitter=new n.EventEmitter,this.onData=this.onDataEmitter.event,this.onOpenEmitter=new n.EventEmitter,this.onOpen=this.onOpenEmitter.event,this.onCloseEmitter=new n.EventEmitter,this.onClose=this.onCloseEmitter.event,this.onErrorEmitter=new n.EventEmitter,this.onError=this.onErrorEmitter.event,this.waitingForOpen=!0,this.SOCKET_TYPE="Basis Socket"}async initialize(){try{await super.initialize()}catch(e){return e instanceof s.TimeoutError&&(e=new i.BasisError(e)),void this.onErrorEmitter.fire(e)}}onMessage(e){this.waitingForOpen?(this.onOpenEmitter.fire(),this.waitingForOpen=!1):this.onDataEmitter.fire(e)}async upgradeToWebSocketConnection(){const e=this._options.url.replace(/skipWebSocketFrames=false/gim,"skipWebSocketFrames=true");this.send((new TextEncoder).encode(this.createHandshakeRequest(e)))}createHandshakeRequest(e){return[`GET ${e} HTTP/1.1`,"Connection: Upgrade","Upgrade: websocket",`Sec-WebSocket-Key: ${this.randomString(32)}`,"\r\n"].join("\r\n")}randomString(e=16){const t=new Uint32Array(e);return crypto.getRandomValues(t),t.toString()}}},(e,t,r)=>{r.r(t),r.d(t,{ServerWebSocket:()=>a});var n=r(13),s=r(19),i=r(14),o=r(21);class a{constructor(e,t){this.options=e,this.version=t,this.SOCKET_TYPE="Local Proxy Server Socket",this.dispose=[],this.onDataEmitter=new n.EventEmitter,this.onData=this.onDataEmitter.event,this.onOpenEmitter=new n.EventEmitter,this.onOpen=this.onOpenEmitter.event,this.onCloseEmitter=new n.EventEmitter,this.onClose=this.onCloseEmitter.event,this.onErrorEmitter=new n.EventEmitter,this.onError=this.onErrorEmitter.event}send(e){const t=this.options.socketId,r=e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength);this.connection?this.zip?this.zip.deflate.write(r,void 0,(()=>{this.zip.deflate.flush(2)})):this.connection.notify("servermsg",{i:t,body:r}):console.warn(new Error("attempted to send data before socket was open").stack)}close(){this.dispose.forEach((e=>e.dispose()))}onMessage(e){this.onDataEmitter.fire(e)}upgradeToWebSocketConnection(){}async initialize(){const e=this.connection=await this.options.bearer.checkedAcquire(),t=await this.version;t.canCompressServerMsg()&&(this.zip={deflate:(0,s.createDeflateRaw)(),inflate:(0,s.createInflateRaw)()},this.zip.inflate.on("data",(e=>this.onMessage(e))),this.zip.deflate.on("data",(t=>{e.notify("servermsg",{i:this.options.socketId,body:t})}))),await(0,o.prepareCodeServer)(e,this.options.product,this.options.socketId,t.canCompressServerMsg(),this.options.extensions),this.dispose.push(e.onNotification("servermsg",(({i:e,body:t})=>{e===this.options.socketId&&(this.zip?this.zip.inflate.write(t):this.onMessage(t))}))),this.upgradeToWebSocketConnection(),e.onClose((e=>{e&&this.onErrorEmitter.fire(new i.BasisError(e)),this.onCloseEmitter.fire()}))}}},(e,t,r)=>{r.r(t),r.d(t,{createDeflateRaw:()=>n.createDeflateRaw,createInflateRaw:()=>n.createInflateRaw});var n=r(20)},e=>{e.exports=r(9796)},(e,t,r)=>{async function n(e,t,r,n,s){let i=function(e,t,r){return{socket_id:t,commit_id:e.commit,quality:e.quality,extensions:r??[]}}(t,r,s);i.compress=n;let o=await e.call("serve",i);return{tunnel:o.tunnel,port:o.listening_port}}r.r(t),r.d(t,{prepareCodeServer:()=>n})},(e,t,r)=>{r.r(t),r.d(t,{fetchFn:()=>s});var n=r(23);const s=r.n(n)()},e=>{e.exports=r(4126)},(e,t,r)=>{r.r(t),r.d(t,{DeferredPromise:()=>n});class n{constructor(){this.rejected=!1,this.resolved=!1,this.p=new Promise(((e,t)=>{this.completeCallback=e,this.errorCallback=t}))}get isRejected(){return this.rejected}get isResolved(){return this.resolved}get isSettled(){return this.rejected||this.resolved}complete(e){this.completeCallback(e),this.resolved=!0}error(e){this.errorCallback(e),this.rejected=!0}}},(e,t,r)=>{r.r(t),r.d(t,{TunnelProvider:()=>s});var n=r(13);class s{constructor(e){this.rpc=e,this.features={elevation:!1,public:!1},this.tunnelFactory=async(e,t)=>{let r;try{r=await this.rpc.call("forward",{port:e.remoteAddress.port})}catch(e){throw new Error(`Could not forward port: ${e}`)}const s=new n.EventEmitter,i=this.rpc.onClose((()=>s.fire()));return s.event((()=>i.dispose())),{remoteAddress:e.remoteAddress,localAddress:r.uri,public:!1,onDidDispose:s.event,dispose:async()=>{try{await this.rpc.call("unforward",{port:e.remoteAddress.port})}catch{}s.fire()}}}}}},(e,t,r)=>{r.r(t)},(e,t,r)=>{r.r(t),r.d(t,{WebExtHostRPC:()=>o});var n=r(13);const s=e=>`${e}.internal.stateChange`,i=e=>`${e}.internal.call`;class o{constructor(e,t){this.extensionId=e,this.commands=t,this.startEmitter=new n.EventEmitter,this.closeEmitter=new n.EventEmitter,this.connectedEmitter=new n.EventEmitter,this.logEmitter=new n.EventEmitter,this.onStartConnecting=this.startEmitter.event,this.onClose=this.closeEmitter.event,this.onConnected=this.connectedEmitter.event,this.onLog=this.logEmitter.event,t.registerCommand(s(e),(e=>{switch(e.state){case 2:this.startEmitter.fire();break;case 1:this.connectedEmitter.fire();break;case 0:this.closeEmitter.fire(e.reason);break;case 3:this.logEmitter.fire(e.line)}}))}static commands(e,t,r){return t.onClose((t=>r(s(e),{state:0,reason:t}).catch((()=>{})))),t.onConnected((()=>r(s(e),{state:1}).catch((()=>{})))),t.onStartConnecting((()=>r(s(e),{state:1}).catch((()=>{})))),t.onLog((t=>r(s(e),{state:3,line:t}).catch((()=>{})))),[{id:i(e),handler:t.call.bind(t)}]}async call(e,t){return await this.commands.executeCommand(i(this.extensionId),e,t)}}},e=>{e.exports=r(6376)}],i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}};return s[e](r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(t,r){if(1&r&&(t=this(t)),8&r)return t;if("object"==typeof t&&t){if(4&r&&t.__esModule)return t;if(16&r&&"function"==typeof t.then)return t}var s=Object.create(null);o.r(s);var i={};e=e||[null,n({}),n([]),n(n)];for(var a=2&r&&t;"object"==typeof a&&!~e.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((e=>i[e]=()=>t[e]));return i.default=()=>t,o.d(s,i),s},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};(()=>{o.r(a),o.d(a,{AccessTokenBasisClient:()=>r.AccessTokenBasisClient,BasisClient:()=>r.BasisClient,BasisConnectionBearer:()=>i.BasisConnectionBearer,BasisWebSocketFactory:()=>c.BasisWebSocketFactory,Connection:()=>h.Connection,ConnectionBearer:()=>h.ConnectionBearer,ConnectionManager:()=>l.ConnectionManager,RPCError:()=>h.RPCError,TunnelNotFoundError:()=>r.TunnelNotFoundError,TunnelNotFoundInSessionsError:()=>y,TunnelProvider:()=>u.TunnelProvider,WebExtHostRPC:()=>d.WebExtHostRPC,getConnectionToken:()=>v,getMatchingSessionForTunnel:()=>g,getMatchingSessionForTunnelName:()=>f,getTunnelNameFromTags:()=>p});var e=o(1),t=o(2),r=o(3),n=o(7),s=o(9),i=o(10),c=o(15),h=o(12),l=o(16),u=o(25),d=(o(26),o(27));function p(e){if(e.tags?.includes("vscode-server-launcher"))return e.tags.length>=2?e.tags.find((e=>"vscode-server-launcher"!==e&&!/^protocolv\d+$/.test(e))):e.name||e.tunnelId}async function f({userAgent:e,name:t,sessions:r}){const n=await m({lookup:t,userAgent:e,getTunnel:async(e,t)=>e.getTunnelForTag(t),lookupToString:e=>e,sessions:r});return void 0!==n?n:g({userAgent:e,sessions:r,tunnel:{name:t}})}async function g({userAgent:e,tunnel:t,sessions:r}){return m({lookup:t,userAgent:e,getTunnel:async(e,t)=>e.getTunnel(t),lookupToString:e=>e.name||e.tunnelId,sessions:r})}async function m({lookup:t,userAgent:n,getTunnel:s,lookupToString:i,sessions:o}){const a=`tunneling-${n}-auth-attempted`,c=`tunneling-${n}-session-${i(t)}`,h=localStorage.getItem(c);if(h){const e=o.find((e=>e.id===h));if(e){const i=new r.AccessTokenBasisClient(e.provider,n,(()=>e.getAccessToken()));try{const r=await s(i,t);if(r)return console.log("Reusing session from localStorage"),localStorage.removeItem(a),{client:i,session:e,tunnel:r};localStorage.removeItem(c)}catch(e){console.error(e)}}}const l=await(0,e.firstPromise)(o.map((async e=>{if(e.id===h)return;const i=new r.AccessTokenBasisClient(e.provider,n,(()=>e.getAccessToken()));try{const r=await s(i,t);if(r)return{client:i,session:e,tunnel:r}}catch(e){console.error(e)}})));if(l)return localStorage.setItem(c,l.session.id),localStorage.removeItem(a),l;if(localStorage.getItem(a))throw localStorage.removeItem(a),new y(i(t));localStorage.setItem(a,"1")}class y extends Error{constructor(e){super(`Could not find a tunnel named ${e}. Please make sure you are logged into the correct account. You can reloading, logging in, then running 'Connect to Remote Server'.`),this.tunnelIdentifier=e}}async function v(e){const r=new s.RemoteVersion("",function(e){const t="protocolv",r=e.tags?.find((e=>e.startsWith(t)));if(r)return Number(r.slice(t.length))||void 0}(e));if(!r.usesConnectionToken())return;const i=await(0,n.sha256)(e.tunnelId);return(0,t.encodeBase64)(i,!1,!0)}})();var c=t;for(var h in a)c[h]=a[h];a.__esModule&&Object.defineProperty(c,"__esModule",{value:!0})})()},3407:e=>{e.exports={newInvalidAsn1Error:function(e){var t=new Error;return t.name="InvalidAsn1Error",t.message=e||"",t}}},279:(e,t,r)=>{var n=r(3407),s=r(4478),i=r(4578),o=r(3609);for(var a in e.exports={Reader:i,Writer:o},s)s.hasOwnProperty(a)&&(e.exports[a]=s[a]);for(var c in n)n.hasOwnProperty(c)&&(e.exports[c]=n[c])},4578:(e,t,r)=>{var n=r(9491),s=r(2399).Buffer,i=r(4478),o=r(3407).newInvalidAsn1Error;function a(e){if(!e||!s.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e,this._size=e.length,this._len=0,this._offset=0}Object.defineProperty(a.prototype,"length",{enumerable:!0,get:function(){return this._len}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){return this._offset}}),Object.defineProperty(a.prototype,"remain",{get:function(){return this._size-this._offset}}),Object.defineProperty(a.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}}),a.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=255&this._buf[this._offset];return e||(this._offset+=1),t},a.prototype.peek=function(){return this.readByte(!0)},a.prototype.readLength=function(e){if(void 0===e&&(e=this._offset),e>=this._size)return null;var t=255&this._buf[e++];if(null===t)return null;if(128==(128&t)){if(0==(t&=127))throw o("Indefinite length not supported");if(t>4)throw o("encoding too long");if(this._size-e<t)return null;this._len=0;for(var r=0;r<t;r++)this._len=(this._len<<8)+(255&this._buf[e++])}else this._len=t;return e},a.prototype.readSequence=function(e){var t=this.peek();if(null===t)return null;if(void 0!==e&&e!==t)throw o("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);return null===r?null:(this._offset=r,t)},a.prototype.readInt=function(){return this._readTag(i.Integer)},a.prototype.readBoolean=function(){return 0!==this._readTag(i.Boolean)},a.prototype.readEnumeration=function(){return this._readTag(i.Enumeration)},a.prototype.readString=function(e,t){e||(e=i.OctetString);var r=this.peek();if(null===r)return null;if(r!==e)throw o("Expected 0x"+e.toString(16)+": got 0x"+r.toString(16));var n=this.readLength(this._offset+1);if(null===n)return null;if(this.length>this._size-n)return null;if(this._offset=n,0===this.length)return t?s.alloc(0):"";var a=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?a:a.toString("utf8")},a.prototype.readOID=function(e){e||(e=i.OID);var t=this.readString(e,!0);if(null===t)return null;for(var r=[],n=0,s=0;s<t.length;s++){var o=255&t[s];n<<=7,n+=127&o,0==(128&o)&&(r.push(n),n=0)}return n=r.shift(),r.unshift(n%40),r.unshift(n/40>>0),r.join(".")},a.prototype._readTag=function(e){n.ok(void 0!==e);var t=this.peek();if(null===t)return null;if(t!==e)throw o("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);if(null===r)return null;if(this.length>4)throw o("Integer too long: "+this.length);if(this.length>this._size-r)return null;this._offset=r;for(var s=this._buf[this._offset],i=0,a=0;a<this.length;a++)i<<=8,i|=255&this._buf[this._offset++];return 128==(128&s)&&4!==a&&(i-=1<<8*a),i>>0},e.exports=a},4478:e=>{e.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}},3609:(e,t,r)=>{var n=r(9491),s=r(2399).Buffer,i=r(4478),o=r(3407).newInvalidAsn1Error,a={size:1024,growthFactor:8};function c(e){var t,r;t=a,r=e||{},n.ok(t),n.equal(typeof t,"object"),n.ok(r),n.equal(typeof r,"object"),Object.getOwnPropertyNames(t).forEach((function(e){if(!r[e]){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n)}})),e=r,this._buf=s.alloc(e.size||1024),this._size=this._buf.length,this._offset=0,this._options=e,this._seq=[]}Object.defineProperty(c.prototype,"buffer",{get:function(){if(this._seq.length)throw o(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}}),c.prototype.writeByte=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=e},c.prototype.writeInt=function(e,t){if("number"!=typeof e)throw new TypeError("argument must be a Number");"number"!=typeof t&&(t=i.Integer);for(var r=4;(0==(4286578688&e)||-8388608==(4286578688&e))&&r>1;)r--,e<<=8;if(r>4)throw o("BER ints cannot be > 0xffffffff");for(this._ensure(2+r),this._buf[this._offset++]=t,this._buf[this._offset++]=r;r-- >0;)this._buf[this._offset++]=(4278190080&e)>>>24,e<<=8},c.prototype.writeNull=function(){this.writeByte(i.Null),this.writeByte(0)},c.prototype.writeEnumeration=function(e,t){if("number"!=typeof e)throw new TypeError("argument must be a Number");return"number"!=typeof t&&(t=i.Enumeration),this.writeInt(e,t)},c.prototype.writeBoolean=function(e,t){if("boolean"!=typeof e)throw new TypeError("argument must be a Boolean");"number"!=typeof t&&(t=i.Boolean),this._ensure(3),this._buf[this._offset++]=t,this._buf[this._offset++]=1,this._buf[this._offset++]=e?255:0},c.prototype.writeString=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string (was: "+typeof e+")");"number"!=typeof t&&(t=i.OctetString);var r=s.byteLength(e);this.writeByte(t),this.writeLength(r),r&&(this._ensure(r),this._buf.write(e,this._offset),this._offset+=r)},c.prototype.writeBuffer=function(e,t){if("number"!=typeof t)throw new TypeError("tag must be a number");if(!s.isBuffer(e))throw new TypeError("argument must be a buffer");this.writeByte(t),this.writeLength(e.length),this._ensure(e.length),e.copy(this._buf,this._offset,0,e.length),this._offset+=e.length},c.prototype.writeStringArray=function(e){if(!e instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;e.forEach((function(e){t.writeString(e)}))},c.prototype.writeOID=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string");if("number"!=typeof t&&(t=i.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(e))throw new Error("argument is not a valid OID string");var r=e.split("."),n=[];n.push(40*parseInt(r[0],10)+parseInt(r[1],10)),r.slice(2).forEach((function(e){!function(e,t){t<128?e.push(t):t<16384?(e.push(t>>>7|128),e.push(127&t)):t<2097152?(e.push(t>>>14|128),e.push(255&(t>>>7|128)),e.push(127&t)):t<268435456?(e.push(t>>>21|128),e.push(255&(t>>>14|128)),e.push(255&(t>>>7|128)),e.push(127&t)):(e.push(255&(t>>>28|128)),e.push(255&(t>>>21|128)),e.push(255&(t>>>14|128)),e.push(255&(t>>>7|128)),e.push(127&t))}(n,parseInt(e,10))}));var s=this;this._ensure(2+n.length),this.writeByte(t),this.writeLength(n.length),n.forEach((function(e){s.writeByte(e)}))},c.prototype.writeLength=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");if(this._ensure(4),e<=127)this._buf[this._offset++]=e;else if(e<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=e;else if(e<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e;else{if(!(e<=16777215))throw o("Length too long (> 4 bytes)");this._buf[this._offset++]=131,this._buf[this._offset++]=e>>16,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e}},c.prototype.startSequence=function(e){"number"!=typeof e&&(e=i.Sequence|i.Constructor),this.writeByte(e),this._seq.push(this._offset),this._ensure(3),this._offset+=3},c.prototype.endSequence=function(){var e=this._seq.pop(),t=e+3,r=this._offset-t;if(r<=127)this._shift(t,r,-2),this._buf[e]=r;else if(r<=255)this._shift(t,r,-1),this._buf[e]=129,this._buf[e+1]=r;else if(r<=65535)this._buf[e]=130,this._buf[e+1]=r>>8,this._buf[e+2]=r;else{if(!(r<=16777215))throw o("Sequence too long");this._shift(t,r,1),this._buf[e]=131,this._buf[e+1]=r>>16,this._buf[e+2]=r>>8,this._buf[e+3]=r}},c.prototype._shift=function(e,t,r){n.ok(void 0!==e),n.ok(void 0!==t),n.ok(r),this._buf.copy(this._buf,e+r,e,e+t),this._offset+=r},c.prototype._ensure=function(e){if(n.ok(e),this._size-this._offset<e){var t=this._size*this._options.growthFactor;t-this._offset<e&&(t+=e);var r=s.alloc(t);this._buf.copy(r,0,0,this._offset),this._buf=r,this._size=t}},e.exports=c},476:(e,t,r)=>{var n=r(279);e.exports={Ber:n,BerReader:n.Reader,BerWriter:n.Writer}},4017:(e,t)=>{"use strict";class r{constructor(e){this.tasks=[],this.count=e}sched(){if(this.count>0&&this.tasks.length>0){this.count--;let e=this.tasks.shift();if(void 0===e)throw"Unexpected undefined value in tasks list";e()}}acquire(){return new Promise(((e,t)=>{this.tasks.push((()=>{var t=!1;e((()=>{t||(t=!0,this.count++,this.sched())}))})),process&&process.nextTick?process.nextTick(this.sched.bind(this)):setImmediate(this.sched.bind(this))}))}use(e){return this.acquire().then((t=>e().then((e=>(t(),e))).catch((e=>{throw t(),e}))))}}t.Semaphore=r,t.Mutex=class extends r{constructor(){super(1)}}},9669:(e,t,r)=>{e.exports=r(1609)},7970:(e,t,r)=>{"use strict";var n=r(4867),s=r(6026),i=r(4097),o=r(5327),a=r(3685),c=r(5687),h=r(938).http,l=r(938).https,u=r(7310),d=r(9796),p=r(8593),f=r(5061),g=r(481),m=/https:?/;function y(e,t,r){if(e.hostname=t.host,e.host=t.host,e.port=t.port,e.path=r,t.auth){var n=Buffer.from(t.auth.username+":"+t.auth.password,"utf8").toString("base64");e.headers["Proxy-Authorization"]="Basic "+n}e.beforeRedirect=function(e){e.headers.host=e.host,y(e,t,e.href)}}e.exports=function(e){return new Promise((function(t,r){var v=function(e){t(e)},w=function(e){r(e)},S=e.data,b=e.headers;if("User-Agent"in b||"user-agent"in b?b["User-Agent"]||b["user-agent"]||(delete b["User-Agent"],delete b["user-agent"]):b["User-Agent"]="axios/"+p.version,S&&!n.isStream(S)){if(Buffer.isBuffer(S));else if(n.isArrayBuffer(S))S=Buffer.from(new Uint8Array(S));else{if(!n.isString(S))return w(f("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",e));S=Buffer.from(S,"utf-8")}b["Content-Length"]=S.length}var E=void 0;e.auth&&(E=(e.auth.username||"")+":"+(e.auth.password||""));var C=i(e.baseURL,e.url),T=u.parse(C),R=T.protocol||"http:";if(!E&&T.auth){var _=T.auth.split(":");E=(_[0]||"")+":"+(_[1]||"")}E&&delete b.Authorization;var P=m.test(R),x=P?e.httpsAgent:e.httpAgent,A={path:o(T.path,e.params,e.paramsSerializer).replace(/^\?/,""),method:e.method.toUpperCase(),headers:b,agent:x,agents:{http:e.httpAgent,https:e.httpsAgent},auth:E};e.socketPath?A.socketPath=e.socketPath:(A.hostname=T.hostname,A.port=T.port);var k,M=e.proxy;if(!M&&!1!==M){var I=R.slice(0,-1)+"_proxy",O=process.env[I]||process.env[I.toUpperCase()];if(O){var B=u.parse(O),q=process.env.no_proxy||process.env.NO_PROXY,F=!0;if(q&&(F=!q.split(",").map((function(e){return e.trim()})).some((function(e){return!!e&&("*"===e||"."===e[0]&&T.hostname.substr(T.hostname.length-e.length)===e||T.hostname===e)}))),F&&(M={host:B.hostname,port:B.port,protocol:B.protocol},B.auth)){var L=B.auth.split(":");M.auth={username:L[0],password:L[1]}}}}M&&(A.headers.host=T.hostname+(T.port?":"+T.port:""),y(A,M,R+"//"+T.hostname+(T.port?":"+T.port:"")+A.path));var D=P&&(!M||m.test(M.protocol));e.transport?k=e.transport:0===e.maxRedirects?k=D?c:a:(e.maxRedirects&&(A.maxRedirects=e.maxRedirects),k=D?l:h),e.maxBodyLength>-1&&(A.maxBodyLength=e.maxBodyLength);var N=k.request(A,(function(t){if(!N.aborted){var r=t,i=t.req||N;if(204!==t.statusCode&&"HEAD"!==i.method&&!1!==e.decompress)switch(t.headers["content-encoding"]){case"gzip":case"compress":case"deflate":r=r.pipe(d.createUnzip()),delete t.headers["content-encoding"]}var o={status:t.statusCode,statusText:t.statusMessage,headers:t.headers,config:e,request:i};if("stream"===e.responseType)o.data=r,s(v,w,o);else{var a=[],c=0;r.on("data",(function(t){a.push(t),c+=t.length,e.maxContentLength>-1&&c>e.maxContentLength&&(r.destroy(),w(f("maxContentLength size of "+e.maxContentLength+" exceeded",e,null,i)))})),r.on("error",(function(t){N.aborted||w(g(t,e,null,i))})),r.on("end",(function(){var t=Buffer.concat(a);"arraybuffer"!==e.responseType&&(t=t.toString(e.responseEncoding),e.responseEncoding&&"utf8"!==e.responseEncoding||(t=n.stripBOM(t))),o.data=t,s(v,w,o)}))}}}));if(N.on("error",(function(t){N.aborted&&"ERR_FR_TOO_MANY_REDIRECTS"!==t.code||w(g(t,e,null,N))})),e.timeout){var j=parseInt(e.timeout,10);if(isNaN(j))return void w(f("error trying to parse `config.timeout` to int",e,"ERR_PARSE_TIMEOUT",N));N.setTimeout(j,(function(){N.abort(),w(f("timeout of "+j+"ms exceeded",e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",N))}))}e.cancelToken&&e.cancelToken.promise.then((function(e){N.aborted||(N.abort(),w(e))})),n.isStream(S)?S.on("error",(function(t){w(g(t,e,null,N))})).pipe(N):N.end(S)}))}},5448:(e,t,r)=>{"use strict";var n=r(4867),s=r(6026),i=r(4372),o=r(5327),a=r(4097),c=r(4109),h=r(7985),l=r(5061);e.exports=function(e){return new Promise((function(t,r){var u=e.data,d=e.headers,p=e.responseType;n.isFormData(u)&&delete d["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var g=e.auth.username||"",m=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";d.Authorization="Basic "+btoa(g+":"+m)}var y=a(e.baseURL,e.url);function v(){if(f){var n="getAllResponseHeaders"in f?c(f.getAllResponseHeaders()):null,i={data:p&&"text"!==p&&"json"!==p?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};s(t,r,i),f=null}}if(f.open(e.method.toUpperCase(),o(y,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,"onloadend"in f?f.onloadend=v:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(v)},f.onabort=function(){f&&(r(l("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){r(l("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(l(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",f)),f=null},n.isStandardBrowserEnv()){var w=(e.withCredentials||h(y))&&e.xsrfCookieName?i.read(e.xsrfCookieName):void 0;w&&(d[e.xsrfHeaderName]=w)}"setRequestHeader"in f&&n.forEach(d,(function(e,t){void 0===u&&"content-type"===t.toLowerCase()?delete d[t]:f.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),p&&"json"!==p&&(f.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),r(e),f=null)})),u||(u=null),f.send(u)}))}},1609:(e,t,r)=>{"use strict";var n=r(4867),s=r(1849),i=r(321),o=r(7185);function a(e){var t=new i(e),r=s(i.prototype.request,t);return n.extend(r,i.prototype,t),n.extend(r,t),r}var c=a(r(5655));c.Axios=i,c.create=function(e){return a(o(c.defaults,e))},c.Cancel=r(5263),c.CancelToken=r(4972),c.isCancel=r(6502),c.all=function(e){return Promise.all(e)},c.spread=r(8713),c.isAxiosError=r(6268),e.exports=c,e.exports.default=c},5263:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4972:(e,t,r)=>{"use strict";var n=r(5263);function s(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.source=function(){var e;return{token:new s((function(t){e=t})),cancel:e}},e.exports=s},6502:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:(e,t,r)=>{"use strict";var n=r(4867),s=r(5327),i=r(782),o=r(3572),a=r(7185),c=r(4875),h=c.validators;function l(e){this.defaults=e,this.interceptors={request:new i,response:new i}}l.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:h.transitional(h.boolean,"1.0.0"),forcedJSONParsing:h.transitional(h.boolean,"1.0.0"),clarifyTimeoutError:h.transitional(h.boolean,"1.0.0")},!1);var r=[],n=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(n=n&&t.synchronous,r.unshift(t.fulfilled,t.rejected))}));var s,i=[];if(this.interceptors.response.forEach((function(e){i.push(e.fulfilled,e.rejected)})),!n){var l=[o,void 0];for(Array.prototype.unshift.apply(l,r),l=l.concat(i),s=Promise.resolve(e);l.length;)s=s.then(l.shift(),l.shift());return s}for(var u=e;r.length;){var d=r.shift(),p=r.shift();try{u=d(u)}catch(e){p(e);break}}try{s=o(u)}catch(e){return Promise.reject(e)}for(;i.length;)s=s.then(i.shift(),i.shift());return s},l.prototype.getUri=function(e){return e=a(this.defaults,e),s(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,r){return this.request(a(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,r,n){return this.request(a(n||{},{method:e,url:t,data:r}))}})),e.exports=l},782:(e,t,r)=>{"use strict";var n=r(4867);function s(){this.handlers=[]}s.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},s.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},s.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=s},4097:(e,t,r)=>{"use strict";var n=r(1793),s=r(7303);e.exports=function(e,t){return e&&!n(t)?s(e,t):t}},5061:(e,t,r)=>{"use strict";var n=r(481);e.exports=function(e,t,r,s,i){var o=new Error(e);return n(o,t,r,s,i)}},3572:(e,t,r)=>{"use strict";var n=r(4867),s=r(8527),i=r(6502),o=r(5655);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=s.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return a(e),t.data=s.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(a(e),t&&t.response&&(t.response.data=s.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:e=>{"use strict";e.exports=function(e,t,r,n,s){return e.config=t,r&&(e.code=r),e.request=n,e.response=s,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},7185:(e,t,r)=>{"use strict";var n=r(4867);e.exports=function(e,t){t=t||{};var r={},s=["url","method","data"],i=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function h(s){n.isUndefined(t[s])?n.isUndefined(e[s])||(r[s]=c(void 0,e[s])):r[s]=c(e[s],t[s])}n.forEach(s,(function(e){n.isUndefined(t[e])||(r[e]=c(void 0,t[e]))})),n.forEach(i,h),n.forEach(o,(function(s){n.isUndefined(t[s])?n.isUndefined(e[s])||(r[s]=c(void 0,e[s])):r[s]=c(void 0,t[s])})),n.forEach(a,(function(n){n in t?r[n]=c(e[n],t[n]):n in e&&(r[n]=c(void 0,e[n]))}));var l=s.concat(i).concat(o).concat(a),u=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===l.indexOf(e)}));return n.forEach(u,h),r}},6026:(e,t,r)=>{"use strict";var n=r(5061);e.exports=function(e,t,r){var s=r.config.validateStatus;r.status&&s&&!s(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},8527:(e,t,r)=>{"use strict";var n=r(4867),s=r(5655);e.exports=function(e,t,r){var i=this||s;return n.forEach(r,(function(r){e=r.call(i,e,t)})),e}},5655:(e,t,r)=>{"use strict";var n=r(4867),s=r(6016),i=r(481),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,h={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:("undefined"!=typeof XMLHttpRequest?c=r(5448):"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)&&(c=r(7970)),c),transformRequest:[function(e,t){return s(t,"Accept"),s(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,r){if(n.isString(e))try{return(0,JSON.parse)(e),n.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,r=t&&t.silentJSONParsing,s=t&&t.forcedJSONParsing,o=!r&&"json"===this.responseType;if(o||s&&n.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(o){if("SyntaxError"===e.name)throw i(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(e){h.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){h.headers[e]=n.merge(o)})),e.exports=h},1849:e=>{"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},5327:(e,t,r)=>{"use strict";var n=r(4867);function s(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(n.isURLSearchParams(t))i=t.toString();else{var o=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),o.push(s(t)+"="+s(e))})))})),i=o.join("&")}if(i){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},7303:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:(e,t,r)=>{"use strict";var n=r(4867);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,s,i,o){var a=[];a.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),n.isString(s)&&a.push("path="+s),n.isString(i)&&a.push("domain="+i),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},6268:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},7985:(e,t,r)=>{"use strict";var n=r(4867);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function s(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=s(window.location.href),function(t){var r=n.isString(t)?s(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},6016:(e,t,r)=>{"use strict";var n=r(4867);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},4109:(e,t,r)=>{"use strict";var n=r(4867),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,i,o={};return e?(n.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=n.trim(e.substr(0,i)).toLowerCase(),r=n.trim(e.substr(i+1)),t){if(o[t]&&s.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([r]):o[t]?o[t]+", "+r:r}})),o):o}},8713:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},4875:(e,t,r)=>{"use strict";var n=r(8593),s={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){s[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var i={},o=n.version.split(".");function a(e,t){for(var r=t?t.split("."):o,n=e.split("."),s=0;s<3;s++){if(r[s]>n[s])return!0;if(r[s]<n[s])return!1}return!1}s.transitional=function(e,t,r){var s=t&&a(t);function o(e,t){return"[Axios v"+n.version+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,n,a){if(!1===e)throw new Error(o(n," has been removed in "+t));return s&&!i[n]&&(i[n]=!0,console.warn(o(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,a)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var n=Object.keys(e),s=n.length;s-- >0;){var i=n[s],o=t[i];if(o){var a=e[i],c=void 0===a||o(a,i,e);if(!0!==c)throw new TypeError("option "+i+" must be "+c)}else if(!0!==r)throw Error("Unknown option "+i)}},validators:s}},4867:(e,t,r)=>{"use strict";var n=r(1849),s=Object.prototype.toString;function i(e){return"[object Array]"===s.call(e)}function o(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==s.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function h(e){return"[object Function]"===s.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:o,isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:h,isStream:function(e){return a(e)&&h(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function e(){var t={};function r(r,n){c(t[n])&&c(r)?t[n]=e(t[n],r):c(r)?t[n]=e({},r):i(r)?t[n]=r.slice():t[n]=r}for(var n=0,s=arguments.length;n<s;n++)l(arguments[n],r);return t},extend:function(e,t,r){return l(t,(function(t,s){e[s]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},9376:e=>{"use strict";e.exports={mask:(e,t,r,n,s)=>{for(var i=0;i<s;i++)r[n+i]=e[i]^t[3&i]},unmask:(e,t)=>{const r=e.length;for(var n=0;n<r;n++)e[n]^=t[3&n]}}},1891:(e,t,r)=>{"use strict";try{e.exports=r(9516)(__dirname)}catch(t){e.exports=r(9376)}},1227:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(s=n))})),t.splice(s,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(2447)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},2447:(e,t,r)=>{e.exports=function(e){function t(e){let r,s,i,o=null;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),i=s-(r||s);n.diff=i,n.prev=r,n.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,s)=>{if("%%"===r)return"%";o++;const i=t.formatters[s];if("function"==typeof i){const t=e[o];r=i.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==t.namespaces&&(s=t.namespaces,i=t.enabled(e)),i),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(s),...t.skips.map(s).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(7824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},5158:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(1227):e.exports=r(39)},39:(e,t,r)=>{const n=r(6224),s=r(3837);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(s.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:s}=this;if(s){const t=this.color,s="[3"+(t<8?t:"8;5;"+t),i=`  ${s};1m${n} [0m`;r[0]=i+r[0].split("\n").join("\n"+i),r.push(s+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=s.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(2130);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(2447)(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts)}},9023:(e,t,r)=>{var n=r(6113);t.DiffieHellmanGroup=n.DiffieHellmanGroup,t.createDiffieHellmanGroup=n.createDiffieHellmanGroup,t.getDiffieHellman=n.getDiffieHellman,t.createDiffieHellman=n.createDiffieHellman,t.DiffieHellman=n.DiffieHellman},9395:(e,t,r)=>{var n;e.exports=function(){if(!n){try{n=r(5158)("follow-redirects")}catch(e){}"function"!=typeof n&&(n=function(){})}n.apply(null,arguments)}},938:(e,t,r)=>{var n=r(7310),s=n.URL,i=r(3685),o=r(5687),a=r(2781).Writable,c=r(9491),h=r(9395),l=["abort","aborted","connect","error","socket","timeout"],u=Object.create(null);l.forEach((function(e){u[e]=function(t,r,n){this._redirectable.emit(e,t,r,n)}}));var d=E("ERR_INVALID_URL","Invalid URL",TypeError),p=E("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),f=E("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded"),g=E("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),m=E("ERR_STREAM_WRITE_AFTER_END","write after end");function y(e,t){a.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var r=this;this._onNativeResponse=function(e){r._processResponse(e)},this._performRequest()}function v(e){var t={maxRedirects:21,maxBodyLength:10485760},r={};return Object.keys(e).forEach((function(i){var o=i+":",a=r[o]=e[i],l=t[i]=Object.create(a);Object.defineProperties(l,{request:{value:function(e,i,a){if(T(e)){var l;try{l=S(new s(e))}catch(t){l=n.parse(e)}if(!T(l.protocol))throw new d({input:e});e=l}else s&&e instanceof s?e=S(e):(a=i,i=e,e={protocol:o});return R(i)&&(a=i,i=null),(i=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},e,i)).nativeProtocols=r,T(i.host)||T(i.hostname)||(i.hostname="::1"),c.equal(i.protocol,o,"protocol mismatch"),h("options",i),new y(i,a)},configurable:!0,enumerable:!0,writable:!0},get:{value:function(e,t,r){var n=l.request(e,t,r);return n.end(),n},configurable:!0,enumerable:!0,writable:!0}})})),t}function w(){}function S(e){var t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:e.pathname+e.search,href:e.href};return""!==e.port&&(t.port=Number(e.port)),t}function b(e,t){var r;for(var n in t)e.test(n)&&(r=t[n],delete t[n]);return null==r?void 0:String(r).trim()}function E(e,t,r){function n(r){Error.captureStackTrace(this,this.constructor),Object.assign(this,r||{}),this.code=e,this.message=this.cause?t+": "+this.cause.message:t}return n.prototype=new(r||Error),n.prototype.constructor=n,n.prototype.name="Error ["+e+"]",n}function C(e){for(var t of l)e.removeListener(t,u[t]);e.on("error",w),e.abort()}function T(e){return"string"==typeof e||e instanceof String}function R(e){return"function"==typeof e}y.prototype=Object.create(a.prototype),y.prototype.abort=function(){C(this._currentRequest),this.emit("abort")},y.prototype.write=function(e,t,r){if(this._ending)throw new m;if(!(T(e)||"object"==typeof(n=e)&&"length"in n))throw new TypeError("data should be a string, Buffer or Uint8Array");var n;R(t)&&(r=t,t=null),0!==e.length?this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,r)):(this.emit("error",new g),this.abort()):r&&r()},y.prototype.end=function(e,t,r){if(R(e)?(r=e,e=t=null):R(t)&&(r=t,t=null),e){var n=this,s=this._currentRequest;this.write(e,t,(function(){n._ended=!0,s.end(null,null,r)})),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,r)},y.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)},y.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)},y.prototype.setTimeout=function(e,t){var r=this;function n(t){t.setTimeout(e),t.removeListener("timeout",t.destroy),t.addListener("timeout",t.destroy)}function s(t){r._timeout&&clearTimeout(r._timeout),r._timeout=setTimeout((function(){r.emit("timeout"),i()}),e),n(t)}function i(){r._timeout&&(clearTimeout(r._timeout),r._timeout=null),r.removeListener("abort",i),r.removeListener("error",i),r.removeListener("response",i),t&&r.removeListener("timeout",t),r.socket||r._currentRequest.removeListener("socket",s)}return t&&this.on("timeout",t),this.socket?s(this.socket):this._currentRequest.once("socket",s),this.on("socket",n),this.on("abort",i),this.on("error",i),this.on("response",i),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach((function(e){y.prototype[e]=function(t,r){return this._currentRequest[e](t,r)}})),["aborted","connection","socket"].forEach((function(e){Object.defineProperty(y.prototype,e,{get:function(){return this._currentRequest[e]}})})),y.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}},y.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(t){if(this._options.agents){var r=e.slice(0,-1);this._options.agent=this._options.agents[r]}var s=this._currentRequest=t.request(this._options,this._onNativeResponse);for(var i of(s._redirectable=this,l))s.on(i,u[i]);if(this._currentUrl=/^\//.test(this._options.path)?n.format(this._options):this._options.path,this._isRedirect){var o=0,a=this,c=this._requestBodyBuffers;!function e(t){if(s===a._currentRequest)if(t)a.emit("error",t);else if(o<c.length){var r=c[o++];s.finished||s.write(r.data,r.encoding,e)}else a._ended&&s.end()}()}}else this.emit("error",new TypeError("Unsupported protocol "+e))},y.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var r=e.headers.location;if(!r||!1===this._options.followRedirects||t<300||t>=400)return e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),void(this._requestBodyBuffers=[]);if(C(this._currentRequest),e.destroy(),++this._redirectCount>this._options.maxRedirects)this.emit("error",new f);else{var s,i=this._options.beforeRedirect;i&&(s=Object.assign({Host:e.req.getHeader("host")},this._options.headers));var o=this._options.method;((301===t||302===t)&&"POST"===this._options.method||303===t&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],b(/^content-/i,this._options.headers));var a,l=b(/^host$/i,this._options.headers),u=n.parse(this._currentUrl),d=l||u.host,g=/^\w+:/.test(r)?this._currentUrl:n.format(Object.assign(u,{host:d}));try{a=n.resolve(g,r)}catch(e){return void this.emit("error",new p({cause:e}))}h("redirecting to",a),this._isRedirect=!0;var m=n.parse(a);if(Object.assign(this._options,m),(m.protocol!==u.protocol&&"https:"!==m.protocol||m.host!==d&&!function(e,t){c(T(e)&&T(t));var r=e.length-t.length-1;return r>0&&"."===e[r]&&e.endsWith(t)}(m.host,d))&&b(/^(?:authorization|cookie)$/i,this._options.headers),R(i)){var y={headers:e.headers,statusCode:t},v={url:g,method:o,headers:s};try{i(this._options,y,v)}catch(e){return void this.emit("error",e)}this._sanitizeOptions(this._options)}try{this._performRequest()}catch(e){this.emit("error",new p({cause:e}))}}},e.exports=v({http:i,https:o}),e.exports.wrap=v},6560:e=>{"use strict";e.exports=(e,t=process.argv)=>{const r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),s=t.indexOf("--");return-1!==n&&(-1===s||n<s)}},4501:e=>{e.exports=n,n.strict=s,n.loose=i;var t=Object.prototype.toString,r={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function n(e){return s(e)||i(e)}function s(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function i(e){return r[t.call(e)]}},7824:e=>{var t=1e3,r=60*t,n=60*r,s=24*n;function i(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}e.exports=function(e,o){o=o||{};var a,c,h=typeof e;if("string"===h&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(i){var o=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*n;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if("number"===h&&isFinite(e))return o.long?(a=e,(c=Math.abs(a))>=s?i(a,c,s,"day"):c>=n?i(a,c,n,"hour"):c>=r?i(a,c,r,"minute"):c>=t?i(a,c,t,"second"):a+" ms"):function(e){var i=Math.abs(e);return i>=s?Math.round(e/s)+"d":i>=n?Math.round(e/n)+"h":i>=r?Math.round(e/r)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},3414:(e,t,r)=>{if(!globalThis.DOMException)try{const{MessageChannel:e}=r(1267),t=(new e).port1,n=new ArrayBuffer;t.postMessage(n,[n,n])}catch(e){"DOMException"===e.constructor.name&&(globalThis.DOMException=e.constructor)}e.exports=globalThis.DOMException},9516:(e,t,r)=>{"function"==typeof process.addon?e.exports=process.addon.bind(process):e.exports=r(7524)},7524:(e,t,r)=>{var n=r(7147),s=r(1017),i=r(2037),o=require,a=process.config&&process.config.variables||{},c=!!process.env.PREBUILDS_ONLY,h=process.versions.modules,l=process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE||"undefined"!=typeof window&&window.process&&"renderer"===window.process.type?"electron":process.versions&&process.versions.nw?"node-webkit":"node",u=process.env.npm_config_arch||i.arch(),d=process.env.npm_config_platform||i.platform(),p=process.env.LIBC||(function(e){return"linux"===e&&n.existsSync("/etc/alpine-release")}(d)?"musl":"glibc"),f=process.env.ARM_VERSION||("arm64"===u?"8":a.arm_version)||"",g=(process.versions.uv||"").split(".")[0];function m(e){return o(m.resolve(e))}function y(e){try{return n.readdirSync(e)}catch(e){return[]}}function v(e,t){var r=y(e).filter(t);return r[0]&&s.join(e,r[0])}function w(e){return/\.node$/.test(e)}function S(e){var t=e.split("-");if(2===t.length){var r=t[0],n=t[1].split("+");if(r&&n.length&&n.every(Boolean))return{name:e,platform:r,architectures:n}}}function b(e,t){return function(r){return null!=r&&r.platform===e&&r.architectures.includes(t)}}function E(e,t){return e.architectures.length-t.architectures.length}function C(e){var t=e.split("."),r={file:e,specificity:0};if("node"===t.pop()){for(var n=0;n<t.length;n++){var s=t[n];if("node"===s||"electron"===s||"node-webkit"===s)r.runtime=s;else if("napi"===s)r.napi=!0;else if("abi"===s.slice(0,3))r.abi=s.slice(3);else if("uv"===s.slice(0,2))r.uv=s.slice(2);else if("armv"===s.slice(0,4))r.armv=s.slice(4);else{if("glibc"!==s&&"musl"!==s)continue;r.libc=s}r.specificity++}return r}}function T(e,t){return function(r){return!(null==r||r.runtime!==e&&!function(e){return"node"===e.runtime&&e.napi}(r)||r.abi!==t&&!r.napi||r.uv&&r.uv!==g||r.armv&&r.armv!==f||r.libc&&r.libc!==p)}}function R(e){return function(t,r){return t.runtime!==r.runtime?t.runtime===e?-1:1:t.abi!==r.abi?t.abi?-1:1:t.specificity!==r.specificity?t.specificity>r.specificity?-1:1:0}}e.exports=m,m.resolve=m.path=function(e){e=s.resolve(e||".");try{var t=o(s.join(e,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[t+"_PREBUILD"]&&(e=process.env[t+"_PREBUILD"])}catch(e){}if(!c){var r=v(s.join(e,"build/Release"),w);if(r)return r;var n=v(s.join(e,"build/Debug"),w);if(n)return n}var i=_(e);if(i)return i;var a=_(s.dirname(process.execPath));if(a)return a;var m=["platform="+d,"arch="+u,"runtime="+l,"abi="+h,"uv="+g,f?"armv="+f:"","libc="+p,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"","webpack=true"].filter(Boolean).join(" ");throw new Error("No native build was found for "+m+"\n    loaded from: "+e+"\n");function _(e){var t=y(s.join(e,"prebuilds")).map(S).filter(b(d,u)).sort(E)[0];if(t){var r=s.join(e,"prebuilds",t.name),n=y(r).map(C).filter(T(l,h)).sort(R(l))[0];return n?s.join(r,n.file):void 0}}},m.parseTags=C,m.matchTags=T,m.compareTags=R,m.parseTuple=S,m.matchTuple=b,m.compareTuples=E},6807:(e,t,r)=>{var n=r(2057),s=r(4032),i=(r(6113),r(476).Ber,r(4087)._),o=r(4087),a=r(6160),c=r(5159);void 0===n.RSA_NO_PADDING&&(n.RSA_NO_PADDING=3),e.exports=function(){var e={node10:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],node:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],iojs:["md4","md5","ripemd160","sha1","sha224","sha256","sha384","sha512"],browser:["md5","ripemd160","sha1","sha256","sha512"]},t="pkcs1_oaep",r="pkcs1",n={private:"pkcs1-private-pem","private-der":"pkcs1-private-der",public:"pkcs8-public-pem","public-der":"pkcs8-public-der"};function h(e,n,a){if(!(this instanceof h))return new h(e,n,a);i.isObject(n)&&(a=n,n=void 0),this.$options={signingScheme:r,signingSchemeOptions:{hash:"sha256",saltLength:null},encryptionScheme:t,encryptionSchemeOptions:{hash:"sha1",label:null},environment:o.detectEnvironment(),rsaUtils:this},this.keyPair=new s.Key,this.$cache={},Buffer.isBuffer(e)||i.isString(e)?this.importKey(e,n):i.isObject(e)&&this.generateKeyPair(e.b,e.e),this.setOptions(a)}return h.prototype.setOptions=function(n){if((n=n||{}).environment&&(this.$options.environment=n.environment),n.signingScheme){if(i.isString(n.signingScheme)){var s=n.signingScheme.toLowerCase().split("-");1==s.length?e.node.indexOf(s[0])>-1?(this.$options.signingSchemeOptions={hash:s[0]},this.$options.signingScheme=r):(this.$options.signingScheme=s[0],this.$options.signingSchemeOptions={hash:null}):(this.$options.signingSchemeOptions={hash:s[1]},this.$options.signingScheme=s[0])}else i.isObject(n.signingScheme)&&(this.$options.signingScheme=n.signingScheme.scheme||r,this.$options.signingSchemeOptions=i.omit(n.signingScheme,"scheme"));if(!a.isSignature(this.$options.signingScheme))throw Error("Unsupported signing scheme");if(this.$options.signingSchemeOptions.hash&&-1===e[this.$options.environment].indexOf(this.$options.signingSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}if(n.encryptionScheme){if(i.isString(n.encryptionScheme)?(this.$options.encryptionScheme=n.encryptionScheme.toLowerCase(),this.$options.encryptionSchemeOptions={}):i.isObject(n.encryptionScheme)&&(this.$options.encryptionScheme=n.encryptionScheme.scheme||t,this.$options.encryptionSchemeOptions=i.omit(n.encryptionScheme,"scheme")),!a.isEncryption(this.$options.encryptionScheme))throw Error("Unsupported encryption scheme");if(this.$options.encryptionSchemeOptions.hash&&-1===e[this.$options.environment].indexOf(this.$options.encryptionSchemeOptions.hash))throw Error("Unsupported hashing algorithm for "+this.$options.environment+" environment")}this.keyPair.setOptions(this.$options)},h.prototype.generateKeyPair=function(e,t){if(t=t||65537,(e=e||2048)%8!=0)throw Error("Key size must be a multiple of 8.");return this.keyPair.generate(e,t.toString(16)),this.$cache={},this},h.prototype.importKey=function(e,t){if(!e)throw Error("Empty key given");if(t&&(t=n[t]||t),!c.detectAndImport(this.keyPair,e,t)&&void 0===t)throw Error("Key format must be specified");return this.$cache={},this},h.prototype.exportKey=function(e){return e=n[e=e||"private"]||e,this.$cache[e]||(this.$cache[e]=c.detectAndExport(this.keyPair,e)),this.$cache[e]},h.prototype.isPrivate=function(){return this.keyPair.isPrivate()},h.prototype.isPublic=function(e){return this.keyPair.isPublic(e)},h.prototype.isEmpty=function(e){return!(this.keyPair.n||this.keyPair.e||this.keyPair.d)},h.prototype.encrypt=function(e,t,r){return this.$$encryptKey(!1,e,t,r)},h.prototype.decrypt=function(e,t){return this.$$decryptKey(!1,e,t)},h.prototype.encryptPrivate=function(e,t,r){return this.$$encryptKey(!0,e,t,r)},h.prototype.decryptPublic=function(e,t){return this.$$decryptKey(!0,e,t)},h.prototype.$$encryptKey=function(e,t,r,n){try{var s=this.keyPair.encrypt(this.$getDataForEncrypt(t,n),e);return"buffer"!=r&&r?s.toString(r):s}catch(e){throw Error("Error during encryption. Original error: "+e)}},h.prototype.$$decryptKey=function(e,t,r){try{t=i.isString(t)?Buffer.from(t,"base64"):t;var n=this.keyPair.decrypt(t,e);if(null===n)throw Error("Key decrypt method returns null.");return this.$getDecryptedData(n,r)}catch(e){throw Error("Error during decryption (probably incorrect key). Original error: "+e)}},h.prototype.sign=function(e,t,r){if(!this.isPrivate())throw Error("This is not private key");var n=this.keyPair.sign(this.$getDataForEncrypt(e,r));return t&&"buffer"!=t&&(n=n.toString(t)),n},h.prototype.verify=function(e,t,r,n){if(!this.isPublic())throw Error("This is not public key");return n=n&&"buffer"!=n?n:null,this.keyPair.verify(this.$getDataForEncrypt(e,r),t,n)},h.prototype.getKeySize=function(){return this.keyPair.keySize},h.prototype.getMaxMessageSize=function(){return this.keyPair.maxMessageLength},h.prototype.$getDataForEncrypt=function(e,t){if(i.isString(e)||i.isNumber(e))return Buffer.from(""+e,t||"utf8");if(Buffer.isBuffer(e))return e;if(i.isObject(e))return Buffer.from(JSON.stringify(e));throw Error("Unexpected data type")},h.prototype.$getDecryptedData=function(e,t){return"buffer"==(t=t||"buffer")?e:"json"==t?JSON.parse(e.toString()):e.toString(t)},h}()},767:(e,t,r)=>{var n=r(6113);e.exports={getEngine:function(e,t){var s=r(6120);return"node"===t.environment&&"function"==typeof n.publicEncrypt&&"function"==typeof n.privateDecrypt&&(s="function"==typeof n.privateEncrypt&&"function"==typeof n.publicDecrypt?r(9954):r(4034)),s(e,t)}}},9954:(e,t,r)=>{var n=r(6113),s=r(2057),i=r(6160);e.exports=function(e,t){var r=i.pkcs1.makeScheme(e,t);return{encrypt:function(e,i){var o;if(i)return o=s.RSA_PKCS1_PADDING,t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(o=t.encryptionSchemeOptions.padding),n.privateEncrypt({key:t.rsaUtils.exportKey("private"),padding:o},e);o=s.RSA_PKCS1_OAEP_PADDING,"pkcs1"===t.encryptionScheme&&(o=s.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(o=t.encryptionSchemeOptions.padding);var a=e;return o===s.RSA_NO_PADDING&&(a=r.pkcs0pad(e)),n.publicEncrypt({key:t.rsaUtils.exportKey("public"),padding:o},a)},decrypt:function(e,i){var o;if(i)return o=s.RSA_PKCS1_PADDING,t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(o=t.encryptionSchemeOptions.padding),n.publicDecrypt({key:t.rsaUtils.exportKey("public"),padding:o},e);o=s.RSA_PKCS1_OAEP_PADDING,"pkcs1"===t.encryptionScheme&&(o=s.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(o=t.encryptionSchemeOptions.padding);var a=n.privateDecrypt({key:t.rsaUtils.exportKey("private"),padding:o},e);return o===s.RSA_NO_PADDING?r.pkcs0unpad(a):a}}}},6120:(e,t,r)=>{var n=r(3810),s=r(6160);e.exports=function(e,t){var r=s.pkcs1.makeScheme(e,t);return{encrypt:function(t,s){var i,o;return s?(i=new n(r.encPad(t,{type:1})),o=e.$doPrivate(i)):(i=new n(e.encryptionScheme.encPad(t)),o=e.$doPublic(i)),o.toBuffer(e.encryptedDataLength)},decrypt:function(t,s){var i,o=new n(t);return s?(i=e.$doPublic(o),r.encUnPad(i.toBuffer(e.encryptedDataLength),{type:1})):(i=e.$doPrivate(o),e.encryptionScheme.encUnPad(i.toBuffer(e.encryptedDataLength)))}}}},4034:(e,t,r)=>{var n=r(6113),s=r(2057),i=r(6160);e.exports=function(e,t){var o=r(6120)(e,t),a=i.pkcs1.makeScheme(e,t);return{encrypt:function(e,r){if(r)return o.encrypt(e,r);var i=s.RSA_PKCS1_OAEP_PADDING;"pkcs1"===t.encryptionScheme&&(i=s.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(i=t.encryptionSchemeOptions.padding);var c=e;return i===s.RSA_NO_PADDING&&(c=a.pkcs0pad(e)),n.publicEncrypt({key:t.rsaUtils.exportKey("public"),padding:i},c)},decrypt:function(e,r){if(r)return o.decrypt(e,r);var i=s.RSA_PKCS1_OAEP_PADDING;"pkcs1"===t.encryptionScheme&&(i=s.RSA_PKCS1_PADDING),t.encryptionSchemeOptions&&t.encryptionSchemeOptions.padding&&(i=t.encryptionSchemeOptions.padding);var c=n.privateDecrypt({key:t.rsaUtils.exportKey("private"),padding:i},e);return i===s.RSA_NO_PADDING?a.pkcs0unpad(c):c}}}},5629:(e,t,r)=>{r(4087)._,r(4087),e.exports={privateExport:function(e,t){return{n:e.n.toBuffer(),e:e.e,d:e.d.toBuffer(),p:e.p.toBuffer(),q:e.q.toBuffer(),dmp1:e.dmp1.toBuffer(),dmq1:e.dmq1.toBuffer(),coeff:e.coeff.toBuffer()}},privateImport:function(e,t,r){if(!(t.n&&t.e&&t.d&&t.p&&t.q&&t.dmp1&&t.dmq1&&t.coeff))throw Error("Invalid key data");e.setPrivate(t.n,t.e,t.d,t.p,t.q,t.dmp1,t.dmq1,t.coeff)},publicExport:function(e,t){return{n:e.n.toBuffer(),e:e.e}},publicImport:function(e,t,r){if(!t.n||!t.e)throw Error("Invalid key data");e.setPublic(t.n,t.e)},autoImport:function(t,r){return!(!r.n||!r.e||(r.d&&r.p&&r.q&&r.dmp1&&r.dmq1&&r.coeff?(e.exports.privateImport(t,r),0):(e.exports.publicImport(t,r),0)))}}},5159:(e,t,r)=>{function n(e){e=e.split("-");for(var t="private",r={type:"default"},n=1;n<e.length;n++)if(e[n])switch(e[n]){case"public":case"private":t=e[n];break;case"pem":case"der":r.type=e[n]}return{scheme:e[0],keyType:t,keyOpt:r}}r(4087)._,e.exports={pkcs1:r(5217),pkcs8:r(5531),components:r(5629),openssh:r(1059),isPrivateExport:function(t){return e.exports[t]&&"function"==typeof e.exports[t].privateExport},isPrivateImport:function(t){return e.exports[t]&&"function"==typeof e.exports[t].privateImport},isPublicExport:function(t){return e.exports[t]&&"function"==typeof e.exports[t].publicExport},isPublicImport:function(t){return e.exports[t]&&"function"==typeof e.exports[t].publicImport},detectAndImport:function(t,r,s){if(void 0===s){for(var i in e.exports)if("function"==typeof e.exports[i].autoImport&&e.exports[i].autoImport(t,r))return!0}else if(s){var o=n(s);if(!e.exports[o.scheme])throw Error("Unsupported key format");"private"===o.keyType?e.exports[o.scheme].privateImport(t,r,o.keyOpt):e.exports[o.scheme].publicImport(t,r,o.keyOpt)}return!1},detectAndExport:function(t,r){if(r){var s=n(r);if(e.exports[s.scheme]){if("private"===s.keyType){if(!t.isPrivate())throw Error("This is not private key");return e.exports[s.scheme].privateExport(t,s.keyOpt)}if(!t.isPublic())throw Error("This is not public key");return e.exports[s.scheme].publicExport(t,s.keyOpt)}throw Error("Unsupported key format")}}}},1059:(e,t,r)=>{var n=r(4087)._,s=r(4087),i=r(3810);const o="-----BEGIN OPENSSH PRIVATE KEY-----",a="-----END OPENSSH PRIVATE KEY-----";function c(e){const t=e.buf.readInt32BE(e.off);e.off+=4;const r=e.buf.slice(e.off,e.off+t);return e.off+=t,r}function h(e,t){e.buf.writeInt32BE(t.byteLength,e.off),e.off+=4,e.off+=t.copy(e.buf,e.off)}e.exports={privateExport:function(e,t){const r=e.n.toBuffer();let n=Buffer.alloc(4);for(n.writeUInt32BE(e.e,0);0===n[0];)n=n.slice(1);const i=e.d.toBuffer(),c=e.coeff.toBuffer(),l=e.p.toBuffer(),u=e.q.toBuffer();let d;d=void 0!==e.sshcomment?Buffer.from(e.sshcomment):Buffer.from([]);const p=15+n.byteLength+4+r.byteLength,f=23+r.byteLength+4+n.byteLength+4+i.byteLength+4+c.byteLength+4+l.byteLength+4+u.byteLength+4+d.byteLength;let g=43+p+4+f;g+=8*Math.ceil(f/8)-f;const m=Buffer.alloc(g),y={buf:m,off:0};m.write("openssh-key-v1","utf8"),m.writeUInt8(0,14),y.off+=15,h(y,Buffer.from("none")),h(y,Buffer.from("none")),h(y,Buffer.from("")),y.off=y.buf.writeUInt32BE(1,y.off),y.off=y.buf.writeUInt32BE(p,y.off),h(y,Buffer.from("ssh-rsa")),h(y,n),h(y,r),y.off=y.buf.writeUInt32BE(g-47-p,y.off),y.off+=8,h(y,Buffer.from("ssh-rsa")),h(y,r),h(y,n),h(y,i),h(y,c),h(y,l),h(y,u),h(y,d);let v=1;for(;y.off<g;)y.off=y.buf.writeUInt8(v++,y.off);return"der"===t.type?y.buf:o+"\n"+s.linebrk(m.toString("base64"),70)+"\n"+a+"\n"},privateImport:function(e,t,r){var h;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),!n.isString(t))throw Error("Unsupported key format");var l=s.trimSurroundingText(t,o,a).replace(/\s+|\n\r|\n|\r$/gm,"");h=Buffer.from(l,"base64")}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");h=t}const u={buf:h,off:0};if("openssh-key-v1"!==h.slice(0,14).toString("ascii"))throw"Invalid file format.";if(u.off+=15,"none"!==c(u).toString("ascii"))throw Error("Unsupported key type");if("none"!==c(u).toString("ascii"))throw Error("Unsupported key type");if(""!==c(u).toString("ascii"))throw Error("Unsupported key type");if(u.off+=4,u.off+=4,"ssh-rsa"!==c(u).toString("ascii"))throw Error("Unsupported key type");if(c(u),c(u),u.off+=12,"ssh-rsa"!==c(u).toString("ascii"))throw Error("Unsupported key type");const d=c(u),p=c(u),f=c(u),g=c(u),m=c(u),y=c(u),v=new i(f),w=new i(y),S=new i(m),b=v.mod(S.subtract(i.ONE)),E=v.mod(w.subtract(i.ONE));e.setPrivate(d,p,f,m,y,b.toBuffer(),E.toBuffer(),g),e.sshcomment=c(u).toString("ascii")},publicExport:function(e,t){let r=Buffer.alloc(4);for(r.writeUInt32BE(e.e,0);0===r[0];)r=r.slice(1);const n=e.n.toBuffer(),s=Buffer.alloc(r.byteLength+4+n.byteLength+4+"ssh-rsa".length+4),i={buf:s,off:0};h(i,Buffer.from("ssh-rsa")),h(i,r),h(i,n);let o=e.sshcomment||"";return"der"===t.type?i.buf:"ssh-rsa "+s.toString("base64")+" "+o+"\n"},publicImport:function(e,t,r){var s;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),!n.isString(t))throw Error("Unsupported key format");{if("ssh-rsa "!==t.substring(0,8))throw Error("Unsupported key format");let r=t.indexOf(" ",8);-1===r?r=t.length:e.sshcomment=t.substring(r+1).replace(/\s+|\n\r|\n|\r$/gm,"");const n=t.substring(8,r).replace(/\s+|\n\r|\n|\r$/gm,"");s=Buffer.from(n,"base64")}}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");s=t}const i={buf:s,off:0},o=c(i).toString("ascii");if("ssh-rsa"!==o)throw Error("Invalid key type: "+o);const a=c(i),h=c(i);e.setPublic(h,a)},autoImport:function(t,r){return/^[\S\s]*-----BEGIN OPENSSH PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END OPENSSH PRIVATE KEY-----[\S\s]*$/g.test(r)?(e.exports.privateImport(t,r),!0):!!/^[\S\s]*ssh-rsa \s*(?=(([A-Za-z0-9+/=]+\s*)+))\1[\S\s]*$/g.test(r)&&(e.exports.publicImport(t,r),!0)}}},5217:(e,t,r)=>{var n=r(476).Ber,s=r(4087)._,i=r(4087);const o="-----BEGIN RSA PRIVATE KEY-----",a="-----END RSA PRIVATE KEY-----",c="-----BEGIN RSA PUBLIC KEY-----",h="-----END RSA PUBLIC KEY-----";e.exports={privateExport:function(e,t){t=t||{};var r=e.n.toBuffer(),s=e.d.toBuffer(),c=e.p.toBuffer(),h=e.q.toBuffer(),l=e.dmp1.toBuffer(),u=e.dmq1.toBuffer(),d=e.coeff.toBuffer(),p=r.length+s.length+c.length+h.length+l.length+u.length+d.length+512,f=new n.Writer({size:p});return f.startSequence(),f.writeInt(0),f.writeBuffer(r,2),f.writeInt(e.e),f.writeBuffer(s,2),f.writeBuffer(c,2),f.writeBuffer(h,2),f.writeBuffer(l,2),f.writeBuffer(u,2),f.writeBuffer(d,2),f.endSequence(),"der"===t.type?f.buffer:o+"\n"+i.linebrk(f.buffer.toString("base64"),64)+"\n"+a},privateImport:function(e,t,r){var c;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),!s.isString(t))throw Error("Unsupported key format");var h=i.trimSurroundingText(t,o,a).replace(/\s+|\n\r|\n|\r$/gm,"");c=Buffer.from(h,"base64")}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");c=t}var l=new n.Reader(c);l.readSequence(),l.readString(2,!0),e.setPrivate(l.readString(2,!0),l.readString(2,!0),l.readString(2,!0),l.readString(2,!0),l.readString(2,!0),l.readString(2,!0),l.readString(2,!0),l.readString(2,!0))},publicExport:function(e,t){t=t||{};var r=e.n.toBuffer(),s=r.length+512,o=new n.Writer({size:s});return o.startSequence(),o.writeBuffer(r,2),o.writeInt(e.e),o.endSequence(),"der"===t.type?o.buffer:c+"\n"+i.linebrk(o.buffer.toString("base64"),64)+"\n"+h},publicImport:function(e,t,r){var o;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),s.isString(t)){var a=i.trimSurroundingText(t,c,h).replace(/\s+|\n\r|\n|\r$/gm,"");o=Buffer.from(a,"base64")}}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");o=t}var l=new n.Reader(o);l.readSequence(),e.setPublic(l.readString(2,!0),l.readString(2,!0))},autoImport:function(t,r){return/^[\S\s]*-----BEGIN RSA PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PRIVATE KEY-----[\S\s]*$/g.test(r)?(e.exports.privateImport(t,r),!0):!!/^[\S\s]*-----BEGIN RSA PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END RSA PUBLIC KEY-----[\S\s]*$/g.test(r)&&(e.exports.publicImport(t,r),!0)}}},5531:(e,t,r)=>{var n=r(476).Ber,s=r(4087)._,i="1.2.840.113549.1.1.1",o=r(4087);const a="-----BEGIN PRIVATE KEY-----",c="-----END PRIVATE KEY-----",h="-----BEGIN PUBLIC KEY-----",l="-----END PUBLIC KEY-----";e.exports={privateExport:function(e,t){t=t||{};var r=e.n.toBuffer(),s=e.d.toBuffer(),h=e.p.toBuffer(),l=e.q.toBuffer(),u=e.dmp1.toBuffer(),d=e.dmq1.toBuffer(),p=e.coeff.toBuffer(),f=r.length+s.length+h.length+l.length+u.length+d.length+p.length+512,g=new n.Writer({size:f});g.startSequence(),g.writeInt(0),g.writeBuffer(r,2),g.writeInt(e.e),g.writeBuffer(s,2),g.writeBuffer(h,2),g.writeBuffer(l,2),g.writeBuffer(u,2),g.writeBuffer(d,2),g.writeBuffer(p,2),g.endSequence();var m=new n.Writer({size:f});return m.startSequence(),m.writeInt(0),m.startSequence(),m.writeOID(i),m.writeNull(),m.endSequence(),m.writeBuffer(g.buffer,4),m.endSequence(),"der"===t.type?m.buffer:a+"\n"+o.linebrk(m.buffer.toString("base64"),64)+"\n"+c},privateImport:function(e,t,r){var h;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),!s.isString(t))throw Error("Unsupported key format");var l=o.trimSurroundingText(t,a,c).replace("-----END PRIVATE KEY-----","").replace(/\s+|\n\r|\n|\r$/gm,"");h=Buffer.from(l,"base64")}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");h=t}var u=new n.Reader(h);if(u.readSequence(),u.readInt(0),new n.Reader(u.readString(48,!0)).readOID(6,!0)!==i)throw Error("Invalid Public key format");var d=new n.Reader(u.readString(4,!0));d.readSequence(),d.readString(2,!0),e.setPrivate(d.readString(2,!0),d.readString(2,!0),d.readString(2,!0),d.readString(2,!0),d.readString(2,!0),d.readString(2,!0),d.readString(2,!0),d.readString(2,!0))},publicExport:function(e,t){t=t||{};var r=e.n.toBuffer(),s=r.length+512,a=new n.Writer({size:s});a.writeByte(0),a.startSequence(),a.writeBuffer(r,2),a.writeInt(e.e),a.endSequence();var c=new n.Writer({size:s});return c.startSequence(),c.startSequence(),c.writeOID(i),c.writeNull(),c.endSequence(),c.writeBuffer(a.buffer,3),c.endSequence(),"der"===t.type?c.buffer:h+"\n"+o.linebrk(c.buffer.toString("base64"),64)+"\n"+l},publicImport:function(e,t,r){var a;if("der"!==(r=r||{}).type){if(Buffer.isBuffer(t)&&(t=t.toString("utf8")),s.isString(t)){var c=o.trimSurroundingText(t,h,l).replace(/\s+|\n\r|\n|\r$/gm,"");a=Buffer.from(c,"base64")}}else{if(!Buffer.isBuffer(t))throw Error("Unsupported key format");a=t}var u=new n.Reader(a);if(u.readSequence(),new n.Reader(u.readString(48,!0)).readOID(6,!0)!==i)throw Error("Invalid Public key format");var d=new n.Reader(u.readString(3,!0));d.readByte(),d.readSequence(),e.setPublic(d.readString(2,!0),d.readString(2,!0))},autoImport:function(t,r){return/^[\S\s]*-----BEGIN PRIVATE KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PRIVATE KEY-----[\S\s]*$/g.test(r)?(e.exports.privateImport(t,r),!0):!!/^[\S\s]*-----BEGIN PUBLIC KEY-----\s*(?=(([A-Za-z0-9+/=]+\s*)+))\1-----END PUBLIC KEY-----[\S\s]*$/g.test(r)&&(e.exports.publicImport(t,r),!0)}}},3810:(e,t,r)=>{var n=r(6113),s=r(4087)._;function i(e,t){null!=e&&("number"==typeof e?this.fromNumber(e,t):Buffer.isBuffer(e)?this.fromBuffer(e):null==t&&"string"!=typeof e?this.fromByteArray(e):this.fromString(e,t))}function o(){return new i(null)}i.prototype.am=function(e,t,r,n,s,i){for(var o=16383&t,a=t>>14;--i>=0;){var c=16383&this[e],h=this[e++]>>14,l=a*c+h*o;s=((c=o*c+((16383&l)<<14)+r[n]+s)>>28)+(l>>14)+a*h,r[n++]=268435455&c}return s},i.prototype.DB=28,i.prototype.DM=268435455,i.prototype.DV=1<<28,i.prototype.FV=Math.pow(2,52),i.prototype.F1=24,i.prototype.F2=4;var a,c,h="0123456789abcdefghijklmnopqrstuvwxyz",l=new Array;for(a="0".charCodeAt(0),c=0;c<=9;++c)l[a++]=c;for(a="a".charCodeAt(0),c=10;c<36;++c)l[a++]=c;for(a="A".charCodeAt(0),c=10;c<36;++c)l[a++]=c;function u(e){return h.charAt(e)}function d(e,t){var r=l[e.charCodeAt(t)];return null==r?-1:r}function p(e){var t=o();return t.fromInt(e),t}function f(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function g(e){this.m=e}function m(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function y(e,t){return e&t}function v(e,t){return e|t}function w(e,t){return e^t}function S(e,t){return e&~t}function b(e){if(0===e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function E(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function C(){}function T(e){return e}function R(e){this.r2=o(),this.q3=o(),i.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}g.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},g.prototype.revert=function(e){return e},g.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},g.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},g.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},m.prototype.convert=function(e){var t=o();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(i.ZERO)>0&&this.m.subTo(t,t),t},m.prototype.revert=function(e){var t=o();return e.copyTo(t),this.reduce(t),t},m.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},m.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},m.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},C.prototype.convert=T,C.prototype.revert=T,C.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},C.prototype.sqrTo=function(e,t){e.squareTo(t)},R.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=o();return e.copyTo(t),this.reduce(t),t},R.prototype.revert=function(e){return e},R.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},R.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},R.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var _=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],P=(1<<26)/_[_.length-1];i.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},i.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+DV:this.t=0},i.prototype.fromString=function(e,t,r){var n;switch(t){case 2:n=1;break;case 4:n=2;break;case 8:n=3;break;case 16:n=4;break;case 32:n=5;break;case 256:n=8;break;default:return void this.fromRadix(e,t)}this.t=0,this.s=0;for(var s=e.length,o=!1,a=0;--s>=0;){var c=8==n?255&e[s]:d(e,s);c<0?"-"==e.charAt(s)&&(o=!0):(o=!1,0===a?this[this.t++]=c:a+n>this.DB?(this[this.t-1]|=(c&(1<<this.DB-a)-1)<<a,this[this.t++]=c>>this.DB-a):this[this.t-1]|=c<<a,(a+=n)>=this.DB&&(a-=this.DB))}r||8!=n||0==(128&e[0])||(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),o&&i.ZERO.subTo(this,this)},i.prototype.fromByteArray=function(e,t){this.fromString(e,256,t)},i.prototype.fromBuffer=function(e){this.fromString(e,256,!0)},i.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},i.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},i.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},i.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,s=this.DB-n,i=(1<<s)-1,o=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+o+1]=this[r]>>s|a,a=(this[r]&i)<<n;for(r=o-1;r>=0;--r)t[r]=0;t[o]=a,t.t=this.t+o+1,t.s=this.s,t.clamp()},i.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,s=this.DB-n,i=(1<<n)-1;t[0]=this[r]>>n;for(var o=r+1;o<this.t;++o)t[o-r-1]|=(this[o]&i)<<s,t[o-r]=this[o]>>n;n>0&&(t[this.t-r-1]|=(this.s&i)<<s),t.t=this.t-r,t.clamp()}},i.prototype.subTo=function(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},i.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),s=r.t;for(t.t=s+n.t;--s>=0;)t[s]=0;for(s=0;s<n.t;++s)t[s+r.t]=r.am(0,n[s],t,s,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&i.ZERO.subTo(t,t)},i.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},i.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var s=this.abs();if(s.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=o());var a=o(),c=this.s,h=e.s,l=this.DB-f(n[n.t-1]);l>0?(n.lShiftTo(l,a),s.lShiftTo(l,r)):(n.copyTo(a),s.copyTo(r));var u=a.t,d=a[u-1];if(0!==d){var p=d*(1<<this.F1)+(u>1?a[u-2]>>this.F2:0),g=this.FV/p,m=(1<<this.F1)/p,y=1<<this.F2,v=r.t,w=v-u,S=null==t?o():t;for(a.dlShiftTo(w,S),r.compareTo(S)>=0&&(r[r.t++]=1,r.subTo(S,r)),i.ONE.dlShiftTo(u,S),S.subTo(a,a);a.t<u;)a[a.t++]=0;for(;--w>=0;){var b=r[--v]==d?this.DM:Math.floor(r[v]*g+(r[v-1]+y)*m);if((r[v]+=a.am(0,b,r,w,0,u))<b)for(a.dlShiftTo(w,S),r.subTo(S,r);r[v]<--b;)r.subTo(S,r)}null!=t&&(r.drShiftTo(u,t),c!=h&&i.ZERO.subTo(t,t)),r.t=u,r.clamp(),l>0&&r.rShiftTo(l,r),c<0&&i.ZERO.subTo(r,r)}}},i.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},i.prototype.isEven=function(){return 0===(this.t>0?1&this[0]:this.s)},i.prototype.exp=function(e,t){if(e>4294967295||e<1)return i.ONE;var r=o(),n=o(),s=t.convert(this),a=f(e)-1;for(s.copyTo(r);--a>=0;)if(t.sqrTo(r,n),(e&1<<a)>0)t.mulTo(n,s,r);else{var c=r;r=n,n=c}return t.revert(r)},i.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},i.prototype.toRadix=function(e){if(null==e&&(e=10),0===this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=p(r),s=o(),i=o(),a="";for(this.divRemTo(n,s,i);s.signum()>0;)a=(r+i.intValue()).toString(e).substr(1)+a,s.divRemTo(n,s,i);return i.intValue().toString(e)+a},i.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),s=!1,o=0,a=0,c=0;c<e.length;++c){var h=d(e,c);h<0?"-"==e.charAt(c)&&0===this.signum()&&(s=!0):(a=t*a+h,++o>=r&&(this.dMultiply(n),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(a,0)),s&&i.ZERO.subTo(this,this)},i.prototype.fromNumber=function(e,t){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e),this.testBit(e-1)||this.bitwiseTo(i.ONE.shiftLeft(e-1),v,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(i.ONE.shiftLeft(e-1),this);else{var r=n.randomBytes(1+(e>>3)),s=7&e;s>0?r[0]&=(1<<s)-1:r[0]=0,this.fromByteArray(r)}},i.prototype.bitwiseTo=function(e,t,r){var n,s,i=Math.min(e.t,this.t);for(n=0;n<i;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(s=e.s&this.DM,n=i;n<this.t;++n)r[n]=t(this[n],s);r.t=this.t}else{for(s=this.s&this.DM,n=i;n<e.t;++n)r[n]=t(s,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},i.prototype.changeBit=function(e,t){var r=i.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},i.prototype.addTo=function(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},i.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},i.prototype.dAddOffset=function(e,t){if(0!==e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},i.prototype.multiplyLowerTo=function(e,t,r){var n,s=Math.min(this.t+e.t,t);for(r.s=0,r.t=s;s>0;)r[--s]=0;for(n=r.t-this.t;s<n;++s)r[s+this.t]=this.am(0,e[s],r,s,0,this.t);for(n=Math.min(e.t,t);s<n;++s)this.am(0,e[s],r,s,0,t-s);r.clamp()},i.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},i.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0===t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},i.prototype.millerRabin=function(e){var t=this.subtract(i.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);(e=e+1>>1)>_.length&&(e=_.length);for(var s=o(),a=0;a<e;++a){s.fromInt(_[Math.floor(Math.random()*_.length)]);var c=s.modPow(n,this);if(0!=c.compareTo(i.ONE)&&0!=c.compareTo(t)){for(var h=1;h++<r&&0!=c.compareTo(t);)if(0===(c=c.modPowInt(2,this)).compareTo(i.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},i.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,s=!1,i="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(r=this[o]>>a)>0&&(s=!0,i=u(r));o>=0;)a<t?(r=(this[o]&(1<<a)-1)<<t-a,r|=this[--o]>>(a+=this.DB-t)):(r=this[o]>>(a-=t)&n,a<=0&&(a+=this.DB,--o)),r>0&&(s=!0),s&&(i+=u(r));return s?i:"0"},i.prototype.negate=function(){var e=o();return i.ZERO.subTo(this,e),e},i.prototype.abs=function(){return this.s<0?this.negate():this},i.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},i.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+f(this[this.t-1]^this.s&this.DM)},i.prototype.mod=function(e){var t=o();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(i.ZERO)>0&&e.subTo(t,t),t},i.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new g(t):new m(t),this.exp(e,r)},i.prototype.clone=function(){var e=o();return this.copyTo(e),e},i.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0===this.t)return-1}else{if(1==this.t)return this[0];if(0===this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},i.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},i.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},i.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},i.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,s=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[s++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0===s&&(128&this.s)!=(128&r)&&++s,(s>0||r!=this.s)&&(t[s++]=r);return t},i.prototype.toBuffer=function(e){var t=Buffer.from(this.toByteArray());if(!0===e&&0===t[0])t=t.slice(1);else if(s.isNumber(e)){if(t.length>e){for(var r=0;r<t.length-e;r++)if(0!==t[r])return null;return t.slice(t.length-e)}if(t.length<e){var n=Buffer.alloc(e);return n.fill(0,0,e-t.length),t.copy(n,e-t.length),n}}return t},i.prototype.equals=function(e){return 0==this.compareTo(e)},i.prototype.min=function(e){return this.compareTo(e)<0?this:e},i.prototype.max=function(e){return this.compareTo(e)>0?this:e},i.prototype.and=function(e){var t=o();return this.bitwiseTo(e,y,t),t},i.prototype.or=function(e){var t=o();return this.bitwiseTo(e,v,t),t},i.prototype.xor=function(e){var t=o();return this.bitwiseTo(e,w,t),t},i.prototype.andNot=function(e){var t=o();return this.bitwiseTo(e,S,t),t},i.prototype.not=function(){for(var e=o(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},i.prototype.shiftLeft=function(e){var t=o();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},i.prototype.shiftRight=function(e){var t=o();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},i.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+b(this[e]);return this.s<0?this.t*this.DB:-1},i.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=E(this[r]^t);return e},i.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},i.prototype.setBit=function(e){return this.changeBit(e,v)},i.prototype.clearBit=function(e){return this.changeBit(e,S)},i.prototype.flipBit=function(e){return this.changeBit(e,w)},i.prototype.add=function(e){var t=o();return this.addTo(e,t),t},i.prototype.subtract=function(e){var t=o();return this.subTo(e,t),t},i.prototype.multiply=function(e){var t=o();return this.multiplyTo(e,t),t},i.prototype.divide=function(e){var t=o();return this.divRemTo(e,t,null),t},i.prototype.remainder=function(e){var t=o();return this.divRemTo(e,null,t),t},i.prototype.divideAndRemainder=function(e){var t=o(),r=o();return this.divRemTo(e,t,r),new Array(t,r)},i.prototype.modPow=function(e,t){var r,n,s=e.bitLength(),i=p(1);if(s<=0)return i;r=s<18?1:s<48?3:s<144?4:s<768?5:6,n=s<8?new g(t):t.isEven()?new R(t):new m(t);var a=new Array,c=3,h=r-1,l=(1<<r)-1;if(a[1]=n.convert(this),r>1){var u=o();for(n.sqrTo(a[1],u);c<=l;)a[c]=o(),n.mulTo(u,a[c-2],a[c]),c+=2}var d,y,v=e.t-1,w=!0,S=o();for(s=f(e[v])-1;v>=0;){for(s>=h?d=e[v]>>s-h&l:(d=(e[v]&(1<<s+1)-1)<<h-s,v>0&&(d|=e[v-1]>>this.DB+s-h)),c=r;0==(1&d);)d>>=1,--c;if((s-=c)<0&&(s+=this.DB,--v),w)a[d].copyTo(i),w=!1;else{for(;c>1;)n.sqrTo(i,S),n.sqrTo(S,i),c-=2;c>0?n.sqrTo(i,S):(y=i,i=S,S=y),n.mulTo(S,a[d],i)}for(;v>=0&&0==(e[v]&1<<s);)n.sqrTo(i,S),y=i,i=S,S=y,--s<0&&(s=this.DB-1,--v)}return n.revert(i)},i.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0===e.signum())return i.ZERO;for(var r=e.clone(),n=this.clone(),s=p(1),o=p(0),a=p(0),c=p(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(s.isEven()&&o.isEven()||(s.addTo(this,s),o.subTo(e,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(e,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),t&&s.subTo(a,s),o.subTo(c,o)):(n.subTo(r,n),t&&a.subTo(s,a),c.subTo(o,c))}return 0!=n.compareTo(i.ONE)?i.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},i.prototype.pow=function(e){return this.exp(e,new C)},i.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var s=t.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return t;for(s<i&&(i=s),i>0&&(t.rShiftTo(i,t),r.rShiftTo(i,r));t.signum()>0;)(s=t.getLowestSetBit())>0&&t.rShiftTo(s,t),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r},i.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=_[_.length-1]){for(t=0;t<_.length;++t)if(r[0]==_[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<_.length;){for(var n=_[t],s=t+1;s<_.length&&n<P;)n*=_[s++];for(n=r.modInt(n);t<s;)if(n%_[t++]==0)return!1}return r.millerRabin(e)},i.int2char=u,i.ZERO=p(0),i.ONE=p(1),i.prototype.square=function(){var e=o();return this.squareTo(e),e},e.exports=i},4032:(e,t,r)=>{var n=r(4087)._,s=(r(6113),r(3810)),i=r(4087),o=r(6160),a=r(767);t.BigInteger=s,e.exports.Key=function(){function e(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return e.prototype.setOptions=function(e){var t=o[e.signingScheme],r=o[e.encryptionScheme];t===r?this.signingScheme=this.encryptionScheme=r.makeScheme(this,e):(this.encryptionScheme=r.makeScheme(this,e),this.signingScheme=t.makeScheme(this,e)),this.encryptEngine=a.getEngine(this,e)},e.prototype.generate=function(e,t){var r=e>>1;this.e=parseInt(t,16);for(var n=new s(t,16);;){for(;this.p=new s(e-r,1),0!==this.p.subtract(s.ONE).gcd(n).compareTo(s.ONE)||!this.p.isProbablePrime(10););for(;this.q=new s(r,1),0!==this.q.subtract(s.ONE).gcd(n).compareTo(s.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var i=this.p;this.p=this.q,this.q=i}var o=this.p.subtract(s.ONE),a=this.q.subtract(s.ONE),c=o.multiply(a);if(0===c.gcd(n).compareTo(s.ONE)){if(this.n=this.p.multiply(this.q),this.n.bitLength()<e)continue;this.d=n.modInverse(c),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}this.$$recalculateCache()},e.prototype.setPrivate=function(e,t,r,o,a,c,h,l){if(!(e&&t&&r&&e.length>0&&(n.isNumber(t)||t.length>0)&&r.length>0))throw Error("Invalid RSA private key");this.n=new s(e),this.e=n.isNumber(t)?t:i.get32IntFromBuffer(t,0),this.d=new s(r),o&&a&&c&&h&&l&&(this.p=new s(o),this.q=new s(a),this.dmp1=new s(c),this.dmq1=new s(h),this.coeff=new s(l)),this.$$recalculateCache()},e.prototype.setPublic=function(e,t){if(!(e&&t&&e.length>0&&(n.isNumber(t)||t.length>0)))throw Error("Invalid RSA public key");this.n=new s(e),this.e=n.isNumber(t)?t:i.get32IntFromBuffer(t,0),this.$$recalculateCache()},e.prototype.$doPrivate=function(e){if(this.p||this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),r=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(r)<0;)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},e.prototype.$doPublic=function(e){return e.modPowInt(this.e,this.n)},e.prototype.encrypt=function(e,t){var r=[],n=[],s=e.length,i=Math.ceil(s/this.maxMessageLength)||1,o=Math.ceil(s/i||1);if(1==i)r.push(e);else for(var a=0;a<i;a++)r.push(e.slice(a*o,(a+1)*o));for(var c=0;c<r.length;c++)n.push(this.encryptEngine.encrypt(r[c],t));return Buffer.concat(n)},e.prototype.decrypt=function(e,t){if(e.length%this.encryptedDataLength>0)throw Error("Incorrect data or key");for(var r=[],n=0,s=0,i=e.length/this.encryptedDataLength,o=0;o<i;o++)s=(n=o*this.encryptedDataLength)+this.encryptedDataLength,r.push(this.encryptEngine.decrypt(e.slice(n,Math.min(s,e.length)),t));return Buffer.concat(r)},e.prototype.sign=function(e){return this.signingScheme.sign.apply(this.signingScheme,arguments)},e.prototype.verify=function(e,t,r){return this.signingScheme.verify.apply(this.signingScheme,arguments)},e.prototype.isPrivate=function(){return!!(this.n&&this.e&&this.d)},e.prototype.isPublic=function(e){return this.n&&this.e&&!(e&&this.d)||!1},Object.defineProperty(e.prototype,"keySize",{get:function(){return this.cache.keyBitLength}}),Object.defineProperty(e.prototype,"encryptedDataLength",{get:function(){return this.cache.keyByteLength}}),Object.defineProperty(e.prototype,"maxMessageLength",{get:function(){return this.encryptionScheme.maxMessageLength()}}),e.prototype.$$recalculateCache=function(){this.cache=this.cache||{},this.cache.keyBitLength=this.n.bitLength(),this.cache.keyByteLength=this.cache.keyBitLength+6>>3},e}()},5218:(e,t,r)=>{r(3810);var n=r(6113);e.exports={isEncryption:!0,isSignature:!1},e.exports.digestLength={md4:16,md5:16,ripemd160:20,rmd160:20,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64};var s="sha1";e.exports.eme_oaep_mgf1=function(t,r,i){i=i||s;for(var o=e.exports.digestLength[i],a=Math.ceil(r/o),c=Buffer.alloc(o*a),h=Buffer.alloc(4),l=0;l<a;++l){var u=n.createHash(i);u.update(t),h.writeUInt32BE(l,0),u.update(h),u.digest().copy(c,l*o)}return c.slice(0,r)},e.exports.makeScheme=function(t,r){function i(e,t){this.key=e,this.options=t}return i.prototype.maxMessageLength=function(){return this.key.encryptedDataLength-2*e.exports.digestLength[this.options.encryptionSchemeOptions.hash||s]-2},i.prototype.encPad=function(t){var r=this.options.encryptionSchemeOptions.hash||s,i=this.options.encryptionSchemeOptions.mgf||e.exports.eme_oaep_mgf1,o=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),a=this.key.encryptedDataLength,c=e.exports.digestLength[r];if(t.length>a-2*c-2)throw new Error("Message is too long to encode into an encoded message with a length of "+a+" bytes, increaseemLen to fix this error (minimum value for given parameters and options: "+(a-2*c-2)+")");var h=n.createHash(r);h.update(o),h=h.digest();var l=Buffer.alloc(a-t.length-2*c-1);l.fill(0),l[l.length-1]=1;for(var u=Buffer.concat([h,l,t]),d=n.randomBytes(c),p=i(d,u.length,r),f=0;f<u.length;f++)u[f]^=p[f];for(p=i(u,c,r),f=0;f<d.length;f++)d[f]^=p[f];var g=Buffer.alloc(1+d.length+u.length);return g[0]=0,d.copy(g,1),u.copy(g,1+d.length),g},i.prototype.encUnPad=function(t){var r=this.options.encryptionSchemeOptions.hash||s,i=this.options.encryptionSchemeOptions.mgf||e.exports.eme_oaep_mgf1,o=this.options.encryptionSchemeOptions.label||Buffer.alloc(0),a=e.exports.digestLength[r];if(t.length<2*a+2)throw new Error("Error decoding message, the supplied message is not long enough to be a valid OAEP encoded message");for(var c=t.slice(1,a+1),h=t.slice(1+a),l=i(h,a,r),u=0;u<c.length;u++)c[u]^=l[u];for(l=i(c,h.length,r),u=0;u<h.length;u++)h[u]^=l[u];var d=n.createHash(r);if(d.update(o),d=d.digest(),h.slice(0,a).toString("hex")!=d.toString("hex"))throw new Error("Error decoding message, the lHash calculated from the label provided and the lHash in the encrypted data do not match.");for(u=a;0===h[u++]&&u<h.length;);if(1!=h[u-1])throw new Error("Error decoding message, there is no padding message separator byte");return h.slice(u)},new i(t,r)}},3047:(e,t,r)=>{var n=r(3810),s=r(6113),i=r(2057),o={md2:Buffer.from("3020300c06082a864886f70d020205000410","hex"),md5:Buffer.from("3020300c06082a864886f70d020505000410","hex"),sha1:Buffer.from("3021300906052b0e03021a05000414","hex"),sha224:Buffer.from("302d300d06096086480165030402040500041c","hex"),sha256:Buffer.from("3031300d060960864801650304020105000420","hex"),sha384:Buffer.from("3041300d060960864801650304020205000430","hex"),sha512:Buffer.from("3051300d060960864801650304020305000440","hex"),ripemd160:Buffer.from("3021300906052b2403020105000414","hex"),rmd160:Buffer.from("3021300906052b2403020105000414","hex")},a={ripemd160:"rmd160"},c="sha256";e.exports={isEncryption:!0,isSignature:!0},e.exports.makeScheme=function(e,t){function r(e,t){this.key=e,this.options=t}return r.prototype.maxMessageLength=function(){return this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==i.RSA_NO_PADDING?this.key.encryptedDataLength:this.key.encryptedDataLength-11},r.prototype.encPad=function(e,t){var r;if(t=t||{},e.length>this.key.maxMessageLength)throw new Error("Message too long for RSA (n="+this.key.encryptedDataLength+", l="+e.length+")");if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==i.RSA_NO_PADDING)return(r=Buffer.alloc(this.key.maxMessageLength-e.length)).fill(0),Buffer.concat([r,e]);if(1===t.type)return(r=Buffer.alloc(this.key.encryptedDataLength-e.length-1)).fill(255,0,r.length-1),r[0]=1,r[r.length-1]=0,Buffer.concat([r,e]);(r=Buffer.alloc(this.key.encryptedDataLength-e.length))[0]=0,r[1]=2;for(var n=s.randomBytes(r.length-3),o=0;o<n.length;o++){for(var a=n[o];0===a;)a=s.randomBytes(1)[0];r[o+2]=a}return r[r.length-1]=0,Buffer.concat([r,e])},r.prototype.encUnPad=function(e,t){t=t||{};var r=0;if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==i.RSA_NO_PADDING)return"function"==typeof e.lastIndexOf?e.slice(e.lastIndexOf("\0")+1,e.length):e.slice(String.prototype.lastIndexOf.call(e,"\0")+1,e.length);if(e.length<4)return null;if(1===t.type){if(0!==e[0]||1!==e[1])return null;for(r=3;0!==e[r];)if(255!=e[r]||++r>=e.length)return null}else{if(0!==e[0]||2!==e[1])return null;for(r=3;0!==e[r];)if(++r>=e.length)return null}return e.slice(r+1,e.length)},r.prototype.sign=function(e){var t=this.options.signingSchemeOptions.hash||c;if("browser"===this.options.environment){t=a[t]||t;var r=s.createHash(t);r.update(e);var i=this.pkcs1pad(r.digest(),t);return this.key.$doPrivate(new n(i)).toBuffer(this.key.encryptedDataLength)}var o=s.createSign("RSA-"+t.toUpperCase());return o.update(e),o.sign(this.options.rsaUtils.exportKey("private"))},r.prototype.verify=function(e,t,r){if(this.options.encryptionSchemeOptions&&this.options.encryptionSchemeOptions.padding==i.RSA_NO_PADDING)return!1;var o=this.options.signingSchemeOptions.hash||c;if("browser"===this.options.environment){o=a[o]||o,r&&(t=Buffer.from(t,r));var h=s.createHash(o);h.update(e);var l=this.pkcs1pad(h.digest(),o);return this.key.$doPublic(new n(t)).toBuffer().toString("hex")==l.toString("hex")}var u=s.createVerify("RSA-"+o.toUpperCase());return u.update(e),u.verify(this.options.rsaUtils.exportKey("public"),t,r)},r.prototype.pkcs0pad=function(e){var t=Buffer.alloc(this.key.maxMessageLength-e.length);return t.fill(0),Buffer.concat([t,e])},r.prototype.pkcs0unpad=function(e){return"function"==typeof e.lastIndexOf?e.slice(e.lastIndexOf("\0")+1,e.length):e.slice(String.prototype.lastIndexOf.call(e,"\0")+1,e.length)},r.prototype.pkcs1pad=function(e,t){var r=o[t];if(!r)throw Error("Unsupported hash algorithm");var n=Buffer.concat([r,e]);if(n.length+10>this.key.encryptedDataLength)throw Error("Key is too short for signing algorithm ("+t+")");var s=Buffer.alloc(this.key.encryptedDataLength-n.length-1);return s.fill(255,0,s.length-1),s[0]=1,s[s.length-1]=0,Buffer.concat([s,n])},new r(e,t)}},6256:(e,t,r)=>{var n=r(3810),s=r(6113);e.exports={isEncryption:!1,isSignature:!0};var i="sha1";e.exports.makeScheme=function(e,t){var o=r(6160).pkcs1_oaep;function a(e,t){this.key=e,this.options=t}return a.prototype.sign=function(e){var t=s.createHash(this.options.signingSchemeOptions.hash||i);t.update(e);var r=this.emsa_pss_encode(t.digest(),this.key.keySize-1);return this.key.$doPrivate(new n(r)).toBuffer(this.key.encryptedDataLength)},a.prototype.verify=function(e,t,r){r&&(t=Buffer.from(t,r)),t=new n(t);var o=Math.ceil((this.key.keySize-1)/8),a=this.key.$doPublic(t).toBuffer(o),c=s.createHash(this.options.signingSchemeOptions.hash||i);return c.update(e),this.emsa_pss_verify(c.digest(),a,this.key.keySize-1)},a.prototype.emsa_pss_encode=function(e,t){var r=this.options.signingSchemeOptions.hash||i,n=this.options.signingSchemeOptions.mgf||o.eme_oaep_mgf1,a=this.options.signingSchemeOptions.saltLength||20,c=o.digestLength[r],h=Math.ceil(t/8);if(h<c+a+2)throw new Error("Output length passed to emBits("+t+") is too small for the options specified("+r+", "+a+"). To fix this issue increase the value of emBits. (minimum size: "+(8*c+8*a+9)+")");var l=s.randomBytes(a),u=Buffer.alloc(8+c+a);u.fill(0,0,8),e.copy(u,8),l.copy(u,8+e.length);var d=s.createHash(r);d.update(u),d=d.digest();var p=Buffer.alloc(h-l.length-c-2);p.fill(0);var f=Buffer.alloc(p.length+1+l.length);p.copy(f),f[p.length]=1,l.copy(f,p.length+1);for(var g=n(d,f.length,r),m=Buffer.alloc(f.length),y=0;y<g.length;y++)m[y]=f[y]^g[y];var v=8*h-t,w=255^255>>8-v<<8-v;m[0]=m[0]&w;var S=Buffer.alloc(m.length+d.length+1);return m.copy(S,0),d.copy(S,m.length),S[S.length-1]=188,S},a.prototype.emsa_pss_verify=function(e,t,r){var n=this.options.signingSchemeOptions.hash||i,a=this.options.signingSchemeOptions.mgf||o.eme_oaep_mgf1,c=this.options.signingSchemeOptions.saltLength||20,h=o.digestLength[n],l=Math.ceil(r/8);if(l<h+c+2||188!=t[t.length-1])return!1;var u=Buffer.alloc(l-h-1);t.copy(u,0,0,l-h-1);for(var d=0,p=0,f=8*l-r;p<f;p++)d|=1<<7-p;if(0!=(u[0]&d))return!1;var g=t.slice(l-h-1,l-1),m=a(g,u.length,n);for(p=0;p<u.length;p++)u[p]^=m[p];for(d=255^255>>8-(f=8*l-r)<<8-f,u[0]=u[0]&d,p=0;0===u[p]&&p<u.length;p++);if(1!=u[p])return!1;var y=u.slice(u.length-c),v=Buffer.alloc(8+h+c);v.fill(0,0,8),e.copy(v,8),y.copy(v,8+e.length);var w=s.createHash(n);return w.update(v),w=w.digest(),g.toString("hex")===w.toString("hex")},new a(e,t)}},6160:(e,t,r)=>{e.exports={pkcs1:r(3047),pkcs1_oaep:r(5218),pss:r(6256),isEncryption:function(t){return e.exports[t]&&e.exports[t].isEncryption},isSignature:function(t){return e.exports[t]&&e.exports[t].isSignature}}},4087:(e,t,r)=>{r(6113),e.exports.linebrk=function(e,t){for(var r="",n=0;n+t<e.length;)r+=e.substring(n,n+t)+"\n",n+=t;return r+e.substring(n,e.length)},e.exports.detectEnvironment=function(){return"undefined"==typeof window||!window||process&&"node"===process.title?"node":"browser"},e.exports.get32IntFromBuffer=function(e,t){var r;if(t=t||0,(r=e.length-t)>0){if(r>=4)return e.readUIntBE(t,r);for(var n=0,s=t+r,i=0;s>t;s--,i+=2)n+=e[s-1]*Math.pow(16,i);return n}return NaN},e.exports._={isObject:function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)},isString:function(e){return"string"==typeof e||e instanceof String},isNumber:function(e){return"number"==typeof e||!isNaN(parseFloat(e))&&isFinite(e)},omit:function(e,t){var r={};for(var n in e)e.hasOwnProperty(n)&&n!==t&&(r[n]=e[n]);return r}},e.exports.trimSurroundingText=function(e,t,r){var n=0,s=e.length,i=e.indexOf(t);i>=0&&(n=i+t.length);var o=e.indexOf(r,i);return o>=0&&(s=o),e.substring(n,s)}},2399:(e,t,r)=>{"use strict";var n,s=r(4300),i=s.Buffer,o={};for(n in s)s.hasOwnProperty(n)&&"SlowBuffer"!==n&&"Buffer"!==n&&(o[n]=s[n]);var a=o.Buffer={};for(n in i)i.hasOwnProperty(n)&&"allocUnsafe"!==n&&"allocUnsafeSlow"!==n&&(a[n]=i[n]);if(o.Buffer.prototype=i.prototype,a.from&&a.from!==Uint8Array.from||(a.from=function(e,t,r){if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&void 0===e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return i(e,t,r)}),a.alloc||(a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var n=i(e);return t&&0!==t.length?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n}),!o.kStringMaxLength)try{o.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}o.constants||(o.constants={MAX_LENGTH:o.kMaxLength},o.kStringMaxLength&&(o.constants.MAX_STRING_LENGTH=o.kStringMaxLength)),e.exports=o},2130:(e,t,r)=>{"use strict";const n=r(2037),s=r(6224),i=r(6560),{env:o}=process;let a;function c(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function h(e,t){if(0===a)return 0;if(i("color=16m")||i("color=full")||i("color=truecolor"))return 3;if(i("color=256"))return 2;if(e&&!t&&void 0===a)return 0;const r=a||0;if("dumb"===o.TERM)return r;if("win32"===process.platform){const e=n.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some((e=>e in o))||"codeship"===o.CI_NAME?1:r;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:r}i("no-color")||i("no-colors")||i("color=false")||i("color=never")?a=0:(i("color")||i("colors")||i("color=true")||i("color=always"))&&(a=1),"FORCE_COLOR"in o&&(a="true"===o.FORCE_COLOR?1:"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(parseInt(o.FORCE_COLOR,10),3)),e.exports={supportsColor:function(e){return c(h(e,e&&e.isTTY))},stdout:c(h(!0,s.isatty(1))),stderr:c(h(!0,s.isatty(2)))}},8689:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VIEW_ID=void 0,t.VIEW_ID="remoteTargets"},3970:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteTreeDataProvider=void 0;const n=r(9496),s=r(5100),i=r(9496),o=r(8689),a=r(6236),c=r(1413),h=r(3286),l="remote-internal.getSshFoldersHistory",u="ms-vscode-remote.remote-ssh",d="remote-tunnels.internal.getFoldersHistory",p="ms-vscode.remote-server";t.RemoteTreeDataProvider=class{constructor(e){this.tunnels=[],this.sshHosts={},this.onDidChangeTreeDataEmitter=new i.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event,e.subscriptions.push(this.onDidChangeTreeDataEmitter),e.subscriptions.push(n.commands.registerCommand("remote-explorer.signIntoTunnel",(()=>this.refresh(!0))),n.commands.registerCommand("remote-explorer.refresh",this.refresh,this),n.commands.registerCommand("remote-explorer.add",this.add,this),n.commands.registerCommand("remote-explorer.configureSsh",this.configure,this),n.commands.registerCommand("remote-explorer.deleteFolderHistoryItem",this.deleteFolderFromHistory,this),n.commands.registerCommand("remote-explorer.unregisterTunnel",this.unregisterTunnel,this),n.commands.registerCommand("remote-explorer.connectToRemoteInCurrentWindow",this.openRemoteInCurrentWindow,this),n.commands.registerCommand("remote-explorer.connectToRemoteInNewWindow",this.openRemoteInNewWindow,this),n.commands.registerCommand("remote-explorer.connectToFolderInCurrentWindow",this.openFolderCurrentWindow,this),n.commands.registerCommand("remote-explorer.connectToFolderInNewWindow",this.openFolderInNewWindow,this));const t=()=>n.extensions.allAcrossExtensionHosts.filter((e=>e.id===p)).length>0,r=()=>n.extensions.allAcrossExtensionHosts.filter((e=>e.id===u)).length>0;e.subscriptions.push(n.extensions.onDidChange((async()=>{this.tunnelExtInstalled=t(),this.sshExtInstalled=r(),await this.refresh()}))),this.tunnelExtInstalled=t(),this.sshExtInstalled=r(),this.initRefreshSshHostsPromise=this.refeshSshHosts(),this.initRefreshTunnelsPromise=this.refreshTunnels()}getTreeItem(e){return e.getTreeItem()}async getChildren(e){if(void 0===e){const e=[];return this.tunnelExtInstalled&&e.push(new c.RemoteGroupItem(c.RemoteGroupType.tunnels)),this.sshExtInstalled&&e.push(new c.RemoteGroupItem(c.RemoteGroupType.ssh)),e}if(e instanceof c.RemoteGroupItem&&e.type===c.RemoteGroupType.tunnels){if(await this.initRefreshTunnelsPromise,void 0!==this.authenticatedIntoTunnelExt&&!1===this.authenticatedIntoTunnelExt)return[new c.RemoteTunnelNotAuthenticated];const e=[],t=[];for(const r of this.tunnels){const i=r,o=(0,s.getTunnelNameFromTags)(i);if(void 0===o)continue;const a=void 0!==i.status.hostConnectionCount&&0!==i.status.hostConnectionCount,h=i.tunnelId===this.activeTunnel?.tunnelId,l=(await n.commands.executeCommand(d,o)).length>0;a?e.push(new c.RemoteTunnelItem(i,o,h,a,l)):t.push(new c.RemoteTunnelItem(i,o,h,a,l))}return[...e.sort(c.RemoteTunnelItem.compare),...t.sort(c.RemoteTunnelItem.compare)]}if(e instanceof c.RemoteGroupItem&&e.type===c.RemoteGroupType.ssh){await this.initRefreshSshHostsPromise;const e=[],t=Object.keys(this.sshHosts);for(const r of t){const t=r===this.activeSshHost?.hostName,s=(await n.commands.executeCommand(l,r)).length>0;e.push(new c.RemoteSshItem(r,r,t,s))}return e}if(e instanceof c.RemoteTargetItem&&e.hasFolders){const t=e instanceof c.RemoteTunnelItem,r=await n.commands.executeCommand(t?d:l,e.label),s=(0,a.getActiveFolders)(),i=[];for(const e of r)i.push(new c.FolderItem(e,t?c.RemoteProtocol.tunnel:c.RemoteProtocol.ssh,s.includes(e)));return(0,h.explorerFolderSortOrder)()===h.FolderSortOrder.alphabetical?i.sort(c.FolderItem.compare):i}return[]}async refresh(e=!1){await n.window.withProgress({location:{viewId:o.VIEW_ID}},(()=>Promise.all([this.refreshTunnels(e),this.refeshSshHosts()]))),this.onDidChangeTreeDataEmitter.fire()}async unregisterTunnel(e){e instanceof c.RemoteTunnelItem&&await n.window.withProgress({location:{viewId:o.VIEW_ID}},(async()=>{await n.commands.executeCommand("remote-tunnels.internal.unregisterTunnel",e.tunnel),this.tunnels=this.tunnels.filter((t=>t.tunnelId!==e.tunnel.tunnelId)),this.onDidChangeTreeDataEmitter.fire()}))}async openRemoteInCurrentWindow(e){e instanceof c.RemoteTunnelItem?this.openRemoteTunnel(e,!1):e instanceof c.RemoteSshItem&&this.openSshHost(e,!1)}async openRemoteInNewWindow(e){e instanceof c.RemoteTunnelItem?this.openRemoteTunnel(e,!0):e instanceof c.RemoteSshItem&&this.openSshHost(e,!0)}async add(e){if(e.type===c.RemoteGroupType.ssh)try{return await n.commands.executeCommand("opensshremotes.addNewSshHost")}catch(e){n.commands.executeCommand("workbench.extensions.action.showExtensionsWithIds",[u])}else try{return await n.commands.executeCommand("remote-tunnels.connectCurrentWindowToTunnel")}catch(e){n.commands.executeCommand("workbench.extensions.action.showExtensionsWithIds",[p])}}async configure(){return await n.commands.executeCommand("opensshremotes.openConfigFile")}async openFolderCurrentWindow(e){await n.commands.executeCommand("vscode.openFolder",e.toUri())}async openFolderInNewWindow(e){await n.commands.executeCommand("vscode.openFolder",e.toUri(),!0)}async deleteFolderFromHistory(e){e.protocol===c.RemoteProtocol.ssh?await n.commands.executeCommand("remote-internal.deleteSshFolderFromHistory",e.fd):await n.commands.executeCommand("remote-tunnels.internal.deleteFolderFromHistory",e.fd),this.onDidChangeTreeDataEmitter.fire()}async refreshTunnels(e=!1){if(this.tunnelExtInstalled){try{e||(this.authenticatedIntoTunnelExt=await n.commands.executeCommand("remote-tunnels.internal.isAuthenticated"))}catch(e){}if(this.authenticatedIntoTunnelExt||e)try{[this.tunnels,this.activeTunnel]=await Promise.all([n.commands.executeCommand("remote-tunnels.internal.getTunnelsList"),n.commands.executeCommand("remote-tunnels.internal.getActiveRemote")]),this.authenticatedIntoTunnelExt=!0}catch(e){console.warn("error refreshing tunnels",e)}}}async refeshSshHosts(){if(this.sshExtInstalled)try{[this.activeSshHost,this.sshHosts]=await Promise.all([n.commands.executeCommand("remote-internal.getActiveSshRemote"),n.commands.executeCommand("remote-internal.getConfiguredHostnames")])}catch(e){}}async openRemoteTunnel(e,t){await n.commands.executeCommand("remote-tunnels.internal.connectToRemote",e.label,t)}async openSshHost(e,t){const r={hostName:e.hostName};await n.commands.executeCommand("remote-internal.openRemoteSshTarget",r,t)}}},6236:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveFolders=t.deactivate=t.activate=void 0;const n=r(9496),s=r(8689),i=r(3970);let o=[];t.activate=async function(e){n.window.createTreeView(s.VIEW_ID,{treeDataProvider:new i.RemoteTreeDataProvider(e),showCollapseAll:!0}),e.subscriptions.push(n.commands.registerCommand("remote-internal.setActiveFolders",(e=>{o=e})))},t.deactivate=function(){},t.getActiveFolders=function(){return o}},1413:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteProtocol=t.FolderItem=t.RemoteSshItem=t.RemoteTunnelItem=t.RemoteTargetItem=t.RemoteTunnelNotAuthenticated=t.RemoteGroupItem=t.RemoteGroupType=void 0;const n=r(1017),s=r(9496),i=r(143);var o,a;!function(e){e[e.tunnels=0]="tunnels",e[e.ssh=1]="ssh"}(o=t.RemoteGroupType||(t.RemoteGroupType={})),t.RemoteGroupItem=class{constructor(e){this.type=e}getTreeItem(){const e=new s.TreeItem(this.label,s.TreeItemCollapsibleState.Expanded);return this.type===o.ssh?e.contextValue="remote-explorer.sshGroup":e.contextValue="remote-explorer.tunnelGroup",e}get label(){return this.type===o.tunnels?"Tunnels":"SSH"}},t.RemoteTunnelNotAuthenticated=class{getTreeItem(){const e=new s.TreeItem(s.l10n.t("Sign in to see the registered tunnels"));return e.contextValue="remote-explorer.remoteTunnelSignIn",e.iconPath=new s.ThemeIcon("github"),e}};class c{constructor(e,t,r){this.label=e,this.isActive=t,this.hasFolders=r,this.iconActive="vm-active",this.iconDefault="vm"}getTreeItem(){const e=new s.TreeItem(this.getLabel(),this.hasFolders?s.TreeItemCollapsibleState.Expanded:s.TreeItemCollapsibleState.None);return e.contextValue=this.type()===a.ssh?"remote-explorer.sshRemoteTarget":"remote-explorer.tunnelRemoteTarget",e.iconPath=new s.ThemeIcon(this.isActive?this.iconActive:this.iconDefault,this.isActive?new s.ThemeColor("debugIcon.startForeground"):this.iconColor),e.tooltip=this.tooltip,e.description=this.isActive?s.l10n.t("connected"):this.description,e}getLabel(){return this.label}get tooltip(){return this.label}get description(){return""}get iconColor(){}}t.RemoteTargetItem=c;class h extends c{constructor(e,t,r,n,s){super(t,r,s),this.tunnel=e,this.isOnline=n,this.iconDefault=n?"vm-running":"vm-outline"}get tooltip(){return this.isOnline?`${this.label} is ready to connect to.`:`${this.label} is offline.`}get description(){return this.isOnline?s.l10n.t("running"):s.l10n.t("offline")}type(){return a.tunnel}}t.RemoteTunnelItem=h,h.compare=(e,t)=>e.label>t.label?1:e.label<t.label?-1:0,t.RemoteSshItem=class extends c{constructor(e,t,r,n){super(t,r,n),this.hostName=e}type(){return a.ssh}};class l{constructor(e,t,r){this.fd=e,this.protocol=t,this.isActive=r}getTreeItem(){let e=this.fd.name??n.posix.basename(this.fd.folder);e.endsWith(".code-workspace")&&(e=`${e.replace(/\.code-workspace$/,"")} (Workspace)`);const t=new s.TreeItem(e),r=(0,i.clientPlatformAgnosticFsPath)(this.fd.folder);return t.description=r.split(/[\\/]/g).pop(),t.tooltip=`'${r}' on ${this.fd.remote}`,t.contextValue="remote-explorer.remoteFolder",t.resourceUri=this.toUri(),t.iconPath=new s.ThemeIcon(this.isActive?"folder-active":"folder"),t}toUri(){return s.Uri.parse(`vscode-remote://${this.protocol}+${this.fd.remote}${this.fd.folder}`)}}t.FolderItem=l,l.compare=(e,t)=>e.fd.folder>t.fd.folder?1:e.fd.folder<t.fd.folder?-1:0,function(e){e.ssh="ssh-remote",e.tunnel="tunnel"}(a=t.RemoteProtocol||(t.RemoteProtocol={}))},3286:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.explorerFolderSortOrder=t.FolderSortOrder=void 0;const n=r(9496);var s;!function(e){e[e.mru=1]="mru",e[e.alphabetical=2]="alphabetical"}(s=t.FolderSortOrder||(t.FolderSortOrder={}));t.explorerFolderSortOrder=function(){const e=n.l10n.t("most recently used");let t=n.workspace.getConfiguration().get("remote-explorer.foldersSortOrder")||n.workspace.getConfiguration().get("remote.SSH.foldersSortOrder")||e;return t===e&&(t="mru"),s[t]}},7780:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWindows=void 0,t.isWindows="win32"===process.platform},143:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clientPlatformAgnosticFsPath=void 0;const n=r(9496),s=r(7780);t.clientPlatformAgnosticFsPath=function(e){const t=n.Uri.file(e);return s.isWindows&&!e.match(/^[a-z]:/i)?t.fsPath.replace(/\\/g,"/"):t.fsPath}},5054:(e,t,r)=>{var n=r(4501).strict;e.exports=function(e){if(n(e)){var t=Buffer.from(e.buffer);return e.byteLength!==e.buffer.byteLength&&(t=t.slice(e.byteOffset,e.byteOffset+e.byteLength)),t}return Buffer.from(e)}},137:e=>{"use strict";e.exports=function(e){const t=e.length;let r=0;for(;r<t;)if(0==(128&e[r]))r++;else if(192==(224&e[r])){if(r+1===t||128!=(192&e[r+1])||192==(254&e[r]))return!1;r+=2}else if(224==(240&e[r])){if(r+2>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||224===e[r]&&128==(224&e[r+1])||237===e[r]&&160==(224&e[r+1]))return!1;r+=3}else{if(240!=(248&e[r]))return!1;if(r+3>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||128!=(192&e[r+3])||240===e[r]&&128==(240&e[r+1])||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}return!0}},311:(e,t,r)=>{"use strict";try{e.exports=r(9516)(__dirname)}catch(t){e.exports=r(137)}},5877:(e,t,r)=>{var n=r(3570),s=r(1171),i=s;i.v1=n,i.v4=s,e.exports=i},3075:e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,r){var n=r||0,s=t;return[s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]]].join("")}},556:(e,t,r)=>{var n=r(6113);e.exports=function(){return n.randomBytes(16)}},3570:(e,t,r)=>{var n,s,i=r(556),o=r(3075),a=0,c=0;e.exports=function(e,t,r){var h=t&&r||0,l=t||[],u=(e=e||{}).node||n,d=void 0!==e.clockseq?e.clockseq:s;if(null==u||null==d){var p=i();null==u&&(u=n=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=s=16383&(p[6]<<8|p[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:c+1,m=f-a+(g-c)/1e4;if(m<0&&void 0===e.clockseq&&(d=d+1&16383),(m<0||f>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=f,c=g,s=d;var y=(1e4*(268435455&(f+=122192928e5))+g)%4294967296;l[h++]=y>>>24&255,l[h++]=y>>>16&255,l[h++]=y>>>8&255,l[h++]=255&y;var v=f/4294967296*1e4&268435455;l[h++]=v>>>8&255,l[h++]=255&v,l[h++]=v>>>24&15|16,l[h++]=v>>>16&255,l[h++]=d>>>8|128,l[h++]=255&d;for(var w=0;w<6;++w)l[h+w]=u[w];return t||o(l)}},1171:(e,t,r)=>{var n=r(556),s=r(3075);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[i+a]=o[a];return t||s(o)}},3126:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3680),s=r(2593);var i;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:n.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:n.Event.None}),e.is=function(t){let r=t;return r&&(r===e.None||r===e.Cancelled||s.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}}(i=t.CancellationToken||(t.CancellationToken={}));const o=Object.freeze((function(e,t){let r=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(r)}}}));class a{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this._emitter=void 0))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?o:(this._emitter||(this._emitter=new n.Emitter),this._emitter.event)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new a),this._token}cancel(){this._token?this._token.cancel():this._token=i.Cancelled}dispose(){this.cancel()}}},3680:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(t.Disposable||(t.Disposable={})).create=function(e){return{dispose:e}},function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class r{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(this._callbacks){for(var r=!1,n=0,s=this._callbacks.length;n<s;n++)if(this._callbacks[n]===e){if(this._contexts[n]===t)return this._callbacks.splice(n,1),void this._contexts.splice(n,1);r=!0}if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}}invoke(...e){if(!this._callbacks)return[];for(var t=[],r=this._callbacks.slice(0),n=this._contexts.slice(0),s=0,i=r.length;s<i;s++)try{t.push(r[s].apply(n[s],e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class n{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,s)=>{let i;return this._callbacks||(this._callbacks=new r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t),i={dispose:()=>{this._callbacks.remove(e,t),i.dispose=n._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this)}},Array.isArray(s)&&s.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}n._noop=function(){},t.Emitter=n},2593:(e,t)=>{"use strict";function r(e){return"string"==typeof e||e instanceof String}function n(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=r,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=n,t.stringArray=function(e){return n(e)&&e.every((e=>r(e)))}},397:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.None=0,e.First=1,e.Last=2}(r=t.Touch||(t.Touch={})),t.LinkedMap=class{constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}has(e){return this._map.has(e)}get(e){const t=this._map.get(e);if(t)return t.value}set(e,t,n=r.None){let s=this._map.get(e);if(s)s.value=t,n!==r.None&&this.touch(s,n);else{switch(s={key:e,value:t,next:void 0,previous:void 0},n){case r.None:this.addItemLast(s);break;case r.First:this.addItemFirst(s);break;case r.Last:default:this.addItemLast(s)}this._map.set(e,s),this._size++}}delete(e){const t=this._map.get(e);return!!t&&(this._map.delete(e),this.removeItem(t),this._size--,!0)}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._head;for(;r;)t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),r=r.next}forEachReverse(e,t){let r=this._tail;for(;r;)t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),r=r.previous}values(){let e=[],t=this._head;for(;t;)e.push(t.value),t=t.next;return e}keys(){let e=[],t=this._head;for(;t;)e.push(t.key),t=t.next;return e}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head)this._head=e.next;else if(e===this._tail)this._tail=e.previous;else{const t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===r.First||t===r.Last)if(t===r.First){if(e===this._head)return;const t=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(t.previous=r,r.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===r.Last){if(e===this._tail)return;const t=e.next,r=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=r,r.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}}}},8231:(e,t,r)=>{"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});const s=r(2593),i=r(3234);t.RequestType=i.RequestType,t.RequestType0=i.RequestType0,t.RequestType1=i.RequestType1,t.RequestType2=i.RequestType2,t.RequestType3=i.RequestType3,t.RequestType4=i.RequestType4,t.RequestType5=i.RequestType5,t.RequestType6=i.RequestType6,t.RequestType7=i.RequestType7,t.RequestType8=i.RequestType8,t.RequestType9=i.RequestType9,t.ResponseError=i.ResponseError,t.ErrorCodes=i.ErrorCodes,t.NotificationType=i.NotificationType,t.NotificationType0=i.NotificationType0,t.NotificationType1=i.NotificationType1,t.NotificationType2=i.NotificationType2,t.NotificationType3=i.NotificationType3,t.NotificationType4=i.NotificationType4,t.NotificationType5=i.NotificationType5,t.NotificationType6=i.NotificationType6,t.NotificationType7=i.NotificationType7,t.NotificationType8=i.NotificationType8,t.NotificationType9=i.NotificationType9;const o=r(6386);t.MessageReader=o.MessageReader,t.StreamMessageReader=o.StreamMessageReader,t.IPCMessageReader=o.IPCMessageReader,t.SocketMessageReader=o.SocketMessageReader;const a=r(9725);t.MessageWriter=a.MessageWriter,t.StreamMessageWriter=a.StreamMessageWriter,t.IPCMessageWriter=a.IPCMessageWriter,t.SocketMessageWriter=a.SocketMessageWriter;const c=r(3680);t.Disposable=c.Disposable,t.Event=c.Event,t.Emitter=c.Emitter;const h=r(3126);t.CancellationTokenSource=h.CancellationTokenSource,t.CancellationToken=h.CancellationToken;const l=r(397);var u,d,p,f,g,m,y;n(r(3377)),n(r(2674)),function(e){e.type=new i.NotificationType("$/cancelRequest")}(u||(u={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(d=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){switch(t=t.toLowerCase()){case"off":default:return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(d=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(p=t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(p=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new i.NotificationType("$/setTraceNotification")}(f=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new i.NotificationType("$/logTraceNotification")}(g=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(m=t.ConnectionErrors||(t.ConnectionErrors={}));class v extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,v.prototype)}}function w(e,t,r,n){let o=0,a=0,w=0;const S="2.0";let b,E,C,T,R=Object.create(null),_=Object.create(null),P=new l.LinkedMap,x=Object.create(null),A=Object.create(null),k=d.Off,M=p.Text,I=y.New,O=new c.Emitter,B=new c.Emitter,q=new c.Emitter,F=new c.Emitter;function L(e){return"req-"+e.toString()}function D(e){}function N(){return I===y.Listening}function j(){return I===y.Closed}function $(){return I===y.Disposed}function U(){I!==y.New&&I!==y.Listening||(I=y.Closed,B.fire(void 0))}function K(){C||0===P.size||(C=setImmediate((()=>{C=void 0,function(){if(0===P.size)return;let e=P.shift();try{i.isRequestMessage(e)?function(e){if($())return;function r(r,n,s){let o={jsonrpc:S,id:e.id};r instanceof i.ResponseError?o.error=r.toJson():o.result=void 0===r?null:r,H(o,n,s),t.write(o)}function n(r,n,s){let i={jsonrpc:S,id:e.id,error:r.toJson()};H(i,n,s),t.write(i)}!function(e){if(k!==d.Off&&T)if(M===p.Text){let t;k===d.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),T.log(`Received request '${e.method} - (${e.id})'.`,t)}else z("receive-request",e)}(e);let o,a,c=R[e.method];c&&(o=c.type,a=c.handler);let l=Date.now();if(a||b){let c=new h.CancellationTokenSource,u=String(e.id);A[u]=c;try{let h;h=void 0===e.params||void 0!==o&&0===o.numberOfParams?a?a(c.token):b(e.method,c.token):s.array(e.params)&&(void 0===o||o.numberOfParams>1)?a?a(...e.params,c.token):b(e.method,...e.params,c.token):a?a(e.params,c.token):b(e.method,e.params,c.token);let d=h;h?d.then?d.then((t=>{delete A[u],r(t,e.method,l)}),(t=>{delete A[u],t instanceof i.ResponseError?n(t,e.method,l):t&&s.string(t.message)?n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)})):(delete A[u],r(h,e.method,l)):(delete A[u],function(r,n,s){void 0===r&&(r=null);let i={jsonrpc:S,id:e.id,result:r};H(i,n,s),t.write(i)}(h,e.method,l))}catch(t){delete A[u],t instanceof i.ResponseError?r(t,e.method,l):t&&s.string(t.message)?n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,l):n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,l)}}else n(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,l)}(e):i.isNotificationMessage(e)?function(e){if($())return;let t,n;if(e.method===u.type.method)n=e=>{let t=e.id,r=A[String(t)];r&&r.cancel()};else{let r=_[e.method];r&&(n=r.handler,t=r.type)}if(n||E)try{!function(e){if(k!==d.Off&&T&&e.method!==g.type.method)if(M===p.Text){let t;k===d.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),T.log(`Received notification '${e.method}'.`,t)}else z("receive-notification",e)}(e),void 0===e.params||void 0!==t&&0===t.numberOfParams?n?n():E(e.method):s.array(e.params)&&(void 0===t||t.numberOfParams>1)?n?n(...e.params):E(e.method,...e.params):n?n(e.params):E(e.method,e.params)}catch(t){t.message?r.error(`Notification handler '${e.method}' failed with message: ${t.message}`):r.error(`Notification handler '${e.method}' failed unexpectedly.`)}else q.fire(e)}(e):i.isResponseMessage(e)?function(e){if(!$())if(null===e.id)e.error?r.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):r.error("Received response message without id. No further error information provided.");else{let t=String(e.id),n=x[t];if(function(e,t){if(k!==d.Off&&T)if(M===p.Text){let r;if(k===d.Verbose&&(e.error&&e.error.data?r=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?r=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(r="No result returned.\n\n")),t){let n=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";T.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${n}`,r)}else T.log(`Received response ${e.id} without active response promise.`,r)}else z("receive-response",e)}(e,n),n){delete x[t];try{if(e.error){let t=e.error;n.reject(new i.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?r.error(`Response handler '${n.method}' failed with message: ${e.message}`):r.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void r.error("Received empty message.");r.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);let t=e;if(s.string(t.id)||s.number(t.id)){let e=String(t.id),r=x[e];r&&r.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{K()}}()})))}e.onClose(U),e.onError((function(e){O.fire([e,void 0,void 0])})),t.onClose(U),t.onError((function(e){O.fire(e)}));let W=e=>{try{if(i.isNotificationMessage(e)&&e.method===u.type.method){let r=L(e.params.id),s=P.get(r);if(i.isRequestMessage(s)){let i=n&&n.cancelUndispatched?n.cancelUndispatched(s,D):void 0;if(i&&(void 0!==i.error||void 0!==i.result))return P.delete(r),i.id=s.id,H(i,e.method,Date.now()),void t.write(i)}}!function(e,t){var r;i.isRequestMessage(t)?e.set(L(t.id),t):i.isResponseMessage(t)?e.set(null===(r=t.id)?"res-unknown-"+(++w).toString():"res-"+r.toString(),t):e.set("not-"+(++a).toString(),t)}(P,e)}finally{K()}};function H(e,t,r){if(k!==d.Off&&T)if(M===p.Text){let n;k===d.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),T.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-r}ms`,n)}else z("send-response",e)}function z(e,t){if(!T||k===d.Off)return;const r={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};T.log(r)}function V(){if(j())throw new v(m.Closed,"Connection is closed.");if($())throw new v(m.Disposed,"Connection is disposed.")}function G(e){return void 0===e?null:e}function Y(e,t){let r,n=e.numberOfParams;switch(n){case 0:r=null;break;case 1:r=G(t[0]);break;default:r=[];for(let e=0;e<t.length&&e<n;e++)r.push(G(t[e]));if(t.length<n)for(let e=t.length;e<n;e++)r.push(null)}return r}let J={sendNotification:(e,...r)=>{let n,i;if(V(),s.string(e))switch(n=e,r.length){case 0:i=null;break;case 1:i=r[0];break;default:i=r}else n=e.method,i=Y(e,r);let o={jsonrpc:S,method:n,params:i};!function(e){if(k!==d.Off&&T)if(M===p.Text){let t;k===d.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),T.log(`Sending notification '${e.method}'.`,t)}else z("send-notification",e)}(o),t.write(o)},onNotification:(e,t)=>{V(),s.func(e)?E=e:t&&(s.string(e)?_[e]={type:void 0,handler:t}:_[e.method]={type:e,handler:t})},sendRequest:(e,...r)=>{let n,a,c;if(V(),function(){if(!N())throw new Error("Call listen() first.")}(),s.string(e))switch(n=e,r.length){case 0:a=null;break;case 1:h.CancellationToken.is(r[0])?(a=null,c=r[0]):a=G(r[0]);break;default:const e=r.length-1;h.CancellationToken.is(r[e])?(c=r[e],a=2===r.length?G(r[0]):r.slice(0,e).map((e=>G(e)))):a=r.map((e=>G(e)))}else{n=e.method,a=Y(e,r);let t=e.numberOfParams;c=h.CancellationToken.is(r[t])?r[t]:void 0}let l=o++,f=new Promise(((e,r)=>{let s={jsonrpc:S,id:l,method:n,params:a},o={method:n,timerStart:Date.now(),resolve:e,reject:r};!function(e){if(k!==d.Off&&T)if(M===p.Text){let t;k===d.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),T.log(`Sending request '${e.method} - (${e.id})'.`,t)}else z("send-request",e)}(s);try{t.write(s)}catch(e){o.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),o=null}o&&(x[String(l)]=o)}));return c&&c.onCancellationRequested((()=>{J.sendNotification(u.type,{id:l})})),f},onRequest:(e,t)=>{V(),s.func(e)?b=e:t&&(s.string(e)?R[e]={type:void 0,handler:t}:R[e.method]={type:e,handler:t})},trace:(e,t,r)=>{let n=!1,i=p.Text;void 0!==r&&(s.boolean(r)?n=r:(n=r.sendNotification||!1,i=r.traceFormat||p.Text)),k=e,M=i,T=k===d.Off?void 0:t,!n||j()||$()||J.sendNotification(f.type,{value:d.toString(e)})},onError:O.event,onClose:B.event,onUnhandledNotification:q.event,onDispose:F.event,dispose:()=>{if($())return;I=y.Disposed,F.fire(void 0);let r=new Error("Connection got disposed.");Object.keys(x).forEach((e=>{x[e].reject(r)})),x=Object.create(null),A=Object.create(null),P=new l.LinkedMap,s.func(t.dispose)&&t.dispose(),s.func(e.dispose)&&e.dispose()},listen:()=>{V(),function(){if(N())throw new v(m.AlreadyListening,"Connection is already listening")}(),I=y.Listening,e.listen(W)},inspect:()=>{console.log("inspect")}};return J.onNotification(g.type,(e=>{k!==d.Off&&T&&T.log(e.message,k===d.Verbose?e.verbose:void 0)})),J}t.ConnectionError=v,(t.ConnectionStrategy||(t.ConnectionStrategy={})).is=function(e){let t=e;return t&&s.func(t.cancelUndispatched)},function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(y||(y={})),t.createMessageConnection=function(e,r,n,s){n||(n=t.NullLogger);let i=void 0!==(c=e).listen&&void 0===c.read?e:new o.StreamMessageReader(e);var c;let h=function(e){return void 0!==e.write&&void 0===e.end}(r)?r:new a.StreamMessageWriter(r);return w(i,h,n,s)}},6386:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3680),s=r(2593);let i=8192,o=Buffer.from("\r","ascii")[0],a=Buffer.from("\n","ascii")[0];class c{constructor(e="utf8"){this.encoding=e,this.index=0,this.buffer=Buffer.allocUnsafe(i)}append(e){var t=e;if("string"==typeof e){var r=e,n=Buffer.byteLength(r,this.encoding);(t=Buffer.allocUnsafe(n)).write(r,0,n,this.encoding)}if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{var s=(Math.ceil((this.index+t.length)/i)+1)*i;0===this.index?(this.buffer=Buffer.allocUnsafe(s),t.copy(this.buffer,0,0,t.length)):this.buffer=Buffer.concat([this.buffer.slice(0,this.index),t],s)}this.index+=t.length}tryReadHeaders(){let e,t=0;for(;t+3<this.index&&(this.buffer[t]!==o||this.buffer[t+1]!==a||this.buffer[t+2]!==o||this.buffer[t+3]!==a);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split("\r\n").forEach((t=>{let r=t.indexOf(":");if(-1===r)throw new Error("Message header must separate key and value using :");let n=t.substr(0,r),s=t.substr(r+1).trim();e[n]=s}));let r=t+4;return this.buffer=this.buffer.slice(r),this.index=this.index-r,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e),r=e;return this.buffer.copy(this.buffer,0,r),this.index=this.index-r,t}get numberOfBytes(){return this.index}}(t.MessageReader||(t.MessageReader={})).is=function(e){let t=e;return t&&s.func(t.listen)&&s.func(t.dispose)&&s.func(t.onError)&&s.func(t.onClose)&&s.func(t.onPartialMessage)};class h{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter,this.partialMessageEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader recevied error. Reason: ${s.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=h;class l extends h{constructor(e,t="utf8"){super(),this.readable=e,this.buffer=new c(t),this._partialMessageTimeout=1e4}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",(e=>{this.onData(e)})),this.readable.on("error",(e=>this.fireError(e))),this.readable.on("close",(()=>this.fireClose()))}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){let e=this.buffer.tryReadHeaders();if(!e)return;let t=e["Content-Length"];if(!t)throw new Error("Header must provide a Content-Length property.");let r=parseInt(t);if(isNaN(r))throw new Error("Content-Length value must be a number.");this.nextMessageLength=r}var t=this.buffer.tryReadContent(this.nextMessageLength);if(null===t)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var r=JSON.parse(t);this.callback(r)}}clearPartialMessageTimer(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}t.StreamMessageReader=l,t.IPCMessageReader=class extends h{constructor(e){super(),this.process=e;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose()))}listen(e){this.process.on("message",e)}},t.SocketMessageReader=class extends l{constructor(e,t="utf-8"){super(e,t)}}},9725:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3680),s=r(2593);let i="Content-Length: ",o="\r\n";(t.MessageWriter||(t.MessageWriter={})).is=function(e){let t=e;return t&&s.func(t.dispose)&&s.func(t.onClose)&&s.func(t.onError)&&s.func(t.write)};class a{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer recevied error. Reason: ${s.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=a,t.StreamMessageWriter=class extends a{constructor(e,t="utf8"){super(),this.writable=e,this.encoding=t,this.errorCount=0,this.writable.on("error",(e=>this.fireError(e))),this.writable.on("close",(()=>this.fireClose()))}write(e){let t=JSON.stringify(e),r=Buffer.byteLength(t,this.encoding),n=[i,r.toString(),o,o];try{this.writable.write(n.join(""),"ascii"),this.writable.write(t,this.encoding),this.errorCount=0}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}},t.IPCMessageWriter=class extends a{constructor(e){super(),this.process=e,this.errorCount=0,this.queue=[],this.sending=!1;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose))}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){try{this.process.send&&(this.sending=!0,this.process.send(e,void 0,void 0,(t=>{this.sending=!1,t?(this.errorCount++,this.fireError(t,e,this.errorCount)):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())})))}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}},t.SocketMessageWriter=class extends a{constructor(e,t="utf8"){super(),this.socket=e,this.queue=[],this.sending=!1,this.encoding=t,this.errorCount=0,this.socket.on("error",(e=>this.fireError(e))),this.socket.on("close",(()=>this.fireClose()))}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){let t=JSON.stringify(e),r=Buffer.byteLength(t,this.encoding),n=[i,r.toString(),o,o];try{this.sending=!0,this.socket.write(n.join(""),"ascii",(r=>{r&&this.handleError(r,e);try{this.socket.write(t,this.encoding,(t=>{this.sending=!1,t?this.handleError(t,e):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())}))}catch(r){this.handleError(r,e)}}))}catch(t){this.handleError(t,e)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}}},3234:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2593);var s;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.serverErrorStart=-32099,e.serverErrorEnd=-32e3,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.RequestCancelled=-32800,e.MessageWriteError=1,e.MessageReadError=2}(s=t.ErrorCodes||(t.ErrorCodes={}));class i extends Error{constructor(e,t,r){super(t),this.code=n.number(e)?e:s.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,i.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=i;class o{constructor(e,t){this._method=e,this._numberOfParams=t}get method(){return this._method}get numberOfParams(){return this._numberOfParams}}t.AbstractMessageType=o,t.RequestType0=class extends o{constructor(e){super(e,0),this._=void 0}},t.RequestType=class extends o{constructor(e){super(e,1),this._=void 0}},t.RequestType1=class extends o{constructor(e){super(e,1),this._=void 0}},t.RequestType2=class extends o{constructor(e){super(e,2),this._=void 0}},t.RequestType3=class extends o{constructor(e){super(e,3),this._=void 0}},t.RequestType4=class extends o{constructor(e){super(e,4),this._=void 0}},t.RequestType5=class extends o{constructor(e){super(e,5),this._=void 0}},t.RequestType6=class extends o{constructor(e){super(e,6),this._=void 0}},t.RequestType7=class extends o{constructor(e){super(e,7),this._=void 0}},t.RequestType8=class extends o{constructor(e){super(e,8),this._=void 0}},t.RequestType9=class extends o{constructor(e){super(e,9),this._=void 0}},t.NotificationType=class extends o{constructor(e){super(e,1),this._=void 0}},t.NotificationType0=class extends o{constructor(e){super(e,0),this._=void 0}},t.NotificationType1=class extends o{constructor(e){super(e,1),this._=void 0}},t.NotificationType2=class extends o{constructor(e){super(e,2),this._=void 0}},t.NotificationType3=class extends o{constructor(e){super(e,3),this._=void 0}},t.NotificationType4=class extends o{constructor(e){super(e,4),this._=void 0}},t.NotificationType5=class extends o{constructor(e){super(e,5),this._=void 0}},t.NotificationType6=class extends o{constructor(e){super(e,6),this._=void 0}},t.NotificationType7=class extends o{constructor(e){super(e,7),this._=void 0}},t.NotificationType8=class extends o{constructor(e){super(e,8),this._=void 0}},t.NotificationType9=class extends o{constructor(e){super(e,9),this._=void 0}},t.isRequestMessage=function(e){let t=e;return t&&n.string(t.method)&&(n.string(t.id)||n.number(t.id))},t.isNotificationMessage=function(e){let t=e;return t&&n.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){let t=e;return t&&(void 0!==t.result||!!t.error)&&(n.string(t.id)||n.number(t.id)||null===t.id)}},3377:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1017),s=r(2037),i=r(6113),o=r(1808),a=r(6386),c=r(9725);t.generateRandomPipeName=function(){const e=i.randomBytes(21).toString("hex");return"win32"===process.platform?`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`:n.join(s.tmpdir(),`vscode-${e}.sock`)},t.createClientPipeTransport=function(e,t="utf-8"){let r,n=new Promise(((e,t)=>{r=e}));return new Promise(((s,i)=>{let h=o.createServer((e=>{h.close(),r([new a.SocketMessageReader(e,t),new c.SocketMessageWriter(e,t)])}));h.on("error",i),h.listen(e,(()=>{h.removeListener("error",i),s({onConnected:()=>n})}))}))},t.createServerPipeTransport=function(e,t="utf-8"){const r=o.createConnection(e);return[new a.SocketMessageReader(r,t),new c.SocketMessageWriter(r,t)]}},2674:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1808),s=r(6386),i=r(9725);t.createClientSocketTransport=function(e,t="utf-8"){let r,o=new Promise(((e,t)=>{r=e}));return new Promise(((a,c)=>{let h=n.createServer((e=>{h.close(),r([new s.SocketMessageReader(e,t),new i.SocketMessageWriter(e,t)])}));h.on("error",c),h.listen(e,"127.0.0.1",(()=>{h.removeListener("error",c),a({onConnected:()=>o})}))}))},t.createServerSocketTransport=function(e,t="utf-8"){const r=n.createConnection(e,"127.0.0.1");return[new s.SocketMessageReader(r,t),new i.SocketMessageWriter(r,t)]}},2660:function(e,t){var r;r=function(e){"use strict";const t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol:e=>`Symbol(${e})`;function r(){}const n="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0;function s(e){return"object"==typeof e&&null!==e||"function"==typeof e}const i=r,o=Promise,a=Promise.prototype.then,c=Promise.resolve.bind(o),h=Promise.reject.bind(o);function l(e){return new o(e)}function u(e){return c(e)}function d(e){return h(e)}function p(e,t,r){return a.call(e,t,r)}function f(e,t,r){p(p(e,t,r),void 0,i)}function g(e,t){f(e,t)}function m(e,t){f(e,void 0,t)}function y(e,t,r){return p(e,t,r)}function v(e){p(e,void 0,i)}const w=(()=>{const e=n&&n.queueMicrotask;if("function"==typeof e)return e;const t=u(void 0);return e=>p(t,e)})();function S(e,t,r){if("function"!=typeof e)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function b(e,t,r){try{return u(S(e,t,r))}catch(e){return d(e)}}class E{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(e){const t=this._back;let r=t;16383===t._elements.length&&(r={_elements:[],_next:void 0}),t._elements.push(e),r!==t&&(this._back=r,t._next=r),++this._size}shift(){const e=this._front;let t=e;const r=this._cursor;let n=r+1;const s=e._elements,i=s[r];return 16384===n&&(t=e._next,n=0),--this._size,this._cursor=n,e!==t&&(this._front=t),s[r]=void 0,i}forEach(e){let t=this._cursor,r=this._front,n=r._elements;for(;!(t===n.length&&void 0===r._next||t===n.length&&(r=r._next,n=r._elements,t=0,0===n.length));)e(n[t]),++t}peek(){const e=this._front,t=this._cursor;return e._elements[t]}}function C(e,t){e._ownerReadableStream=t,t._reader=e,"readable"===t._state?P(e):"closed"===t._state?function(e){P(e),k(e)}(e):x(e,t._storedError)}function T(e,t){return Sr(e._ownerReadableStream,t)}function R(e){"readable"===e._ownerReadableStream._state?A(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(e,t){x(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness"))}(e),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function _(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function P(e){e._closedPromise=l(((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r}))}function x(e,t){P(e),A(e,t)}function A(e,t){void 0!==e._closedPromise_reject&&(v(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function k(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}const M=t("[[AbortSteps]]"),I=t("[[ErrorSteps]]"),O=t("[[CancelSteps]]"),B=t("[[PullSteps]]"),q=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},F=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function L(e,t){if(void 0!==e&&"object"!=typeof(r=e)&&"function"!=typeof r)throw new TypeError(`${t} is not an object.`);var r}function D(e,t){if("function"!=typeof e)throw new TypeError(`${t} is not a function.`)}function N(e,t){if(!function(e){return"object"==typeof e&&null!==e||"function"==typeof e}(e))throw new TypeError(`${t} is not an object.`)}function j(e,t,r){if(void 0===e)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function $(e,t,r){if(void 0===e)throw new TypeError(`${t} is required in '${r}'.`)}function U(e){return Number(e)}function K(e){return 0===e?0:e}function W(e,t){const r=Number.MAX_SAFE_INTEGER;let n=Number(e);if(n=K(n),!q(n))throw new TypeError(`${t} is not a finite number`);if(n=function(e){return K(F(e))}(n),n<0||n>r)throw new TypeError(`${t} is outside the accepted range of 0 to ${r}, inclusive`);return q(n)&&0!==n?n:0}function H(e,t){if(!vr(e))throw new TypeError(`${t} is not a ReadableStream.`)}function z(e){return new Q(e)}function V(e,t){e._reader._readRequests.push(t)}function G(e,t,r){const n=e._reader._readRequests.shift();r?n._closeSteps():n._chunkSteps(t)}function Y(e){return e._reader._readRequests.length}function J(e){const t=e._reader;return void 0!==t&&!!Z(t)}class Q{constructor(e){if(j(e,1,"ReadableStreamDefaultReader"),H(e,"First parameter"),wr(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");C(this,e),this._readRequests=new E}get closed(){return Z(this)?this._closedPromise:d(ee("closed"))}cancel(e=undefined){return Z(this)?void 0===this._ownerReadableStream?d(_("cancel")):T(this,e):d(ee("cancel"))}read(){if(!Z(this))return d(ee("read"));if(void 0===this._ownerReadableStream)return d(_("read from"));let e,t;const r=l(((r,n)=>{e=r,t=n}));return X(this,{_chunkSteps:t=>e({value:t,done:!1}),_closeSteps:()=>e({value:void 0,done:!0}),_errorSteps:e=>t(e)}),r}releaseLock(){if(!Z(this))throw ee("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");R(this)}}}function Z(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")&&e instanceof Q}function X(e,t){const r=e._ownerReadableStream;r._disturbed=!0,"closed"===r._state?t._closeSteps():"errored"===r._state?t._errorSteps(r._storedError):r._readableStreamController[B](t)}function ee(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}Object.defineProperties(Q.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Q.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});const te=Object.getPrototypeOf(Object.getPrototypeOf((async function*(){})).prototype);class re{constructor(e,t){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=e,this._preventCancel=t}next(){const e=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?y(this._ongoingPromise,e,e):e(),this._ongoingPromise}return(e){const t=()=>this._returnSteps(e);return this._ongoingPromise?y(this._ongoingPromise,t,t):t()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});const e=this._reader;if(void 0===e._ownerReadableStream)return d(_("iterate"));let t,r;const n=l(((e,n)=>{t=e,r=n}));return X(e,{_chunkSteps:e=>{this._ongoingPromise=void 0,w((()=>t({value:e,done:!1})))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,R(e),t({value:void 0,done:!0})},_errorSteps:t=>{this._ongoingPromise=void 0,this._isFinished=!0,R(e),r(t)}}),n}_returnSteps(e){if(this._isFinished)return Promise.resolve({value:e,done:!0});this._isFinished=!0;const t=this._reader;if(void 0===t._ownerReadableStream)return d(_("finish iterating"));if(!this._preventCancel){const r=T(t,e);return R(t),y(r,(()=>({value:e,done:!0})))}return R(t),u({value:e,done:!0})}}const ne={next(){return se(this)?this._asyncIteratorImpl.next():d(ie("next"))},return(e){return se(this)?this._asyncIteratorImpl.return(e):d(ie("return"))}};function se(e){if(!s(e))return!1;if(!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof re}catch(e){return!1}}function ie(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}void 0!==te&&Object.setPrototypeOf(ne,te);const oe=Number.isNaN||function(e){return e!=e};function ae(e){return e.slice()}function ce(e,t,r,n,s){new Uint8Array(e).set(new Uint8Array(r,n,s),t)}function he(e,t,r){if(e.slice)return e.slice(t,r);const n=r-t,s=new ArrayBuffer(n);return ce(s,0,e,t,n),s}function le(e){const t=he(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function ue(e){const t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function de(e,t,r){if("number"!=typeof(n=r)||oe(n)||n<0||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");var n;e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function pe(e){e._queue=new E,e._queueTotalSize=0}class fe{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!ye(this))throw Ne("view");return this._view}respond(e){if(!ye(this))throw Ne("respond");if(j(e,1,"respond"),e=W(e,"First parameter"),void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");this._view.buffer,Fe(this._associatedReadableByteStreamController,e)}respondWithNewView(e){if(!ye(this))throw Ne("respondWithNewView");if(j(e,1,"respondWithNewView"),!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");e.buffer,Le(this._associatedReadableByteStreamController,e)}}Object.defineProperties(fe.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(fe.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class ge{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!me(this))throw je("byobRequest");return Be(this)}get desiredSize(){if(!me(this))throw je("desiredSize");return qe(this)}close(){if(!me(this))throw je("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");const e=this._controlledReadableByteStream._state;if("readable"!==e)throw new TypeError(`The stream (in ${e} state) is not in the readable state and cannot be closed`);Me(this)}enqueue(e){if(!me(this))throw je("enqueue");if(j(e,1,"enqueue"),!ArrayBuffer.isView(e))throw new TypeError("chunk must be an array buffer view");if(0===e.byteLength)throw new TypeError("chunk must have non-zero byteLength");if(0===e.buffer.byteLength)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");const t=this._controlledReadableByteStream._state;if("readable"!==t)throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be enqueued to`);Ie(this,e)}error(e=undefined){if(!me(this))throw je("error");Oe(this,e)}[O](e){we(this),pe(this);const t=this._cancelAlgorithm(e);return ke(this),t}[B](e){const t=this._controlledReadableByteStream;if(this._queueTotalSize>0){const t=this._queue.shift();this._queueTotalSize-=t.byteLength,Re(this);const r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return void e._chunkSteps(r)}const r=this._autoAllocateChunkSize;if(void 0!==r){let t;try{t=new ArrayBuffer(r)}catch(t){return void e._errorSteps(t)}const n={buffer:t,bufferByteLength:r,byteOffset:0,byteLength:r,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(n)}V(t,e),ve(this)}}function me(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")&&e instanceof ge}function ye(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")&&e instanceof fe}function ve(e){const t=function(e){const t=e._controlledReadableByteStream;if("readable"!==t._state)return!1;if(e._closeRequested)return!1;if(!e._started)return!1;if(J(t)&&Y(t)>0)return!0;if(We(t)&&Ke(t)>0)return!0;return qe(e)>0}(e);t&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,f(e._pullAlgorithm(),(()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ve(e))}),(t=>{Oe(e,t)}))))}function we(e){_e(e),e._pendingPullIntos=new E}function Se(e,t){let r=!1;"closed"===e._state&&(r=!0);const n=be(t);"default"===t.readerType?G(e,n,r):function(e,t,r){const n=e._reader._readIntoRequests.shift();r?n._closeSteps(t):n._chunkSteps(t)}(e,n,r)}function be(e){const t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function Ee(e,t,r,n){e._queue.push({buffer:t,byteOffset:r,byteLength:n}),e._queueTotalSize+=n}function Ce(e,t){const r=t.elementSize,n=t.bytesFilled-t.bytesFilled%r,s=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),i=t.bytesFilled+s,o=i-i%r;let a=s,c=!1;o>n&&(a=o-t.bytesFilled,c=!0);const h=e._queue;for(;a>0;){const r=h.peek(),n=Math.min(a,r.byteLength),s=t.byteOffset+t.bytesFilled;ce(t.buffer,s,r.buffer,r.byteOffset,n),r.byteLength===n?h.shift():(r.byteOffset+=n,r.byteLength-=n),e._queueTotalSize-=n,Te(0,n,t),a-=n}return c}function Te(e,t,r){r.bytesFilled+=t}function Re(e){0===e._queueTotalSize&&e._closeRequested?(ke(e),br(e._controlledReadableByteStream)):ve(e)}function _e(e){null!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function Pe(e){for(;e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;const t=e._pendingPullIntos.peek();Ce(e,t)&&(Ae(e),Se(e._controlledReadableByteStream,t))}}function xe(e,t){const r=e._pendingPullIntos.peek();_e(e),"closed"===e._controlledReadableByteStream._state?function(e,t){const r=e._controlledReadableByteStream;if(We(r))for(;Ke(r)>0;)Se(r,Ae(e))}(e):function(e,t,r){if(Te(0,t,r),r.bytesFilled<r.elementSize)return;Ae(e);const n=r.bytesFilled%r.elementSize;if(n>0){const t=r.byteOffset+r.bytesFilled,s=he(r.buffer,t-n,t);Ee(e,s,0,s.byteLength)}r.bytesFilled-=n,Se(e._controlledReadableByteStream,r),Pe(e)}(e,t,r),ve(e)}function Ae(e){return e._pendingPullIntos.shift()}function ke(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Me(e){const t=e._controlledReadableByteStream;if(!e._closeRequested&&"readable"===t._state)if(e._queueTotalSize>0)e._closeRequested=!0;else{if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Oe(e,t),t}ke(e),br(t)}}function Ie(e,t){const r=e._controlledReadableByteStream;if(e._closeRequested||"readable"!==r._state)return;const n=t.buffer,s=t.byteOffset,i=t.byteLength,o=n;if(e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek();t.buffer,t.buffer=t.buffer}_e(e),J(r)?0===Y(r)?Ee(e,o,s,i):(e._pendingPullIntos.length>0&&Ae(e),G(r,new Uint8Array(o,s,i),!1)):We(r)?(Ee(e,o,s,i),Pe(e)):Ee(e,o,s,i),ve(e)}function Oe(e,t){const r=e._controlledReadableByteStream;"readable"===r._state&&(we(e),pe(e),ke(e),Er(r,t))}function Be(e){if(null===e._byobRequest&&e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),n=Object.create(fe.prototype);!function(e,t,r){e._associatedReadableByteStreamController=t,e._view=r}(n,e,r),e._byobRequest=n}return e._byobRequest}function qe(e){const t=e._controlledReadableByteStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function Fe(e,t){const r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(0===t)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=r.buffer,xe(e,t)}function Le(e,t){const r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t.byteLength)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(0===t.byteLength)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");const n=t.byteLength;r.buffer=t.buffer,xe(e,n)}function De(e,t,r,n,s,i,o){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,pe(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=s,t._autoAllocateChunkSize=o,t._pendingPullIntos=new E,e._readableStreamController=t,f(u(r()),(()=>{t._started=!0,ve(t)}),(e=>{Oe(t,e)}))}function Ne(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function je(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function $e(e){return new He(e)}function Ue(e,t){e._reader._readIntoRequests.push(t)}function Ke(e){return e._reader._readIntoRequests.length}function We(e){const t=e._reader;return void 0!==t&&!!ze(t)}Object.defineProperties(ge.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(ge.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class He{constructor(e){if(j(e,1,"ReadableStreamBYOBReader"),H(e,"First parameter"),wr(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!me(e._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");C(this,e),this._readIntoRequests=new E}get closed(){return ze(this)?this._closedPromise:d(Ge("closed"))}cancel(e=undefined){return ze(this)?void 0===this._ownerReadableStream?d(_("cancel")):T(this,e):d(Ge("cancel"))}read(e){if(!ze(this))return d(Ge("read"));if(!ArrayBuffer.isView(e))return d(new TypeError("view must be an array buffer view"));if(0===e.byteLength)return d(new TypeError("view must have non-zero byteLength"));if(0===e.buffer.byteLength)return d(new TypeError("view's buffer must have non-zero byteLength"));if(e.buffer,void 0===this._ownerReadableStream)return d(_("read from"));let t,r;const n=l(((e,n)=>{t=e,r=n}));return Ve(this,e,{_chunkSteps:e=>t({value:e,done:!1}),_closeSteps:e=>t({value:e,done:!0}),_errorSteps:e=>r(e)}),n}releaseLock(){if(!ze(this))throw Ge("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");R(this)}}}function ze(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")&&e instanceof He}function Ve(e,t,r){const n=e._ownerReadableStream;n._disturbed=!0,"errored"===n._state?r._errorSteps(n._storedError):function(e,t,r){const n=e._controlledReadableByteStream;let s=1;t.constructor!==DataView&&(s=t.constructor.BYTES_PER_ELEMENT);const i=t.constructor,o=t.buffer,a={buffer:o,bufferByteLength:o.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:s,viewConstructor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(a),void Ue(n,r);if("closed"!==n._state){if(e._queueTotalSize>0){if(Ce(e,a)){const t=be(a);return Re(e),void r._chunkSteps(t)}if(e._closeRequested){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");return Oe(e,t),void r._errorSteps(t)}}e._pendingPullIntos.push(a),Ue(n,r),ve(e)}else{const e=new i(a.buffer,a.byteOffset,0);r._closeSteps(e)}}(n._readableStreamController,t,r)}function Ge(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Ye(e,t){const{highWaterMark:r}=e;if(void 0===r)return t;if(oe(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function Je(e){const{size:t}=e;return t||(()=>1)}function Qe(e,t){L(e,t);const r=null==e?void 0:e.highWaterMark,n=null==e?void 0:e.size;return{highWaterMark:void 0===r?void 0:U(r),size:void 0===n?void 0:Ze(n,`${t} has member 'size' that`)}}function Ze(e,t){return D(e,t),t=>U(e(t))}function Xe(e,t,r){return D(e,r),r=>b(e,t,[r])}function et(e,t,r){return D(e,r),()=>b(e,t,[])}function tt(e,t,r){return D(e,r),r=>S(e,t,[r])}function rt(e,t,r){return D(e,r),(r,n)=>b(e,t,[r,n])}function nt(e,t){if(!ct(e))throw new TypeError(`${t} is not a WritableStream.`)}Object.defineProperties(He.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(He.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});const st="function"==typeof AbortController;class it{constructor(e={},t={}){void 0===e?e=null:N(e,"First parameter");const r=Qe(t,"Second parameter"),n=function(e,t){L(e,t);const r=null==e?void 0:e.abort,n=null==e?void 0:e.close,s=null==e?void 0:e.start,i=null==e?void 0:e.type,o=null==e?void 0:e.write;return{abort:void 0===r?void 0:Xe(r,e,`${t} has member 'abort' that`),close:void 0===n?void 0:et(n,e,`${t} has member 'close' that`),start:void 0===s?void 0:tt(s,e,`${t} has member 'start' that`),write:void 0===o?void 0:rt(o,e,`${t} has member 'write' that`),type:i}}(e,"First parameter");if(at(this),void 0!==n.type)throw new RangeError("Invalid type is specified");const s=Je(r);!function(e,t,r,n){const s=Object.create(Rt.prototype);let i=()=>{},o=()=>u(void 0),a=()=>u(void 0),c=()=>u(void 0);void 0!==t.start&&(i=()=>t.start(s)),void 0!==t.write&&(o=e=>t.write(e,s)),void 0!==t.close&&(a=()=>t.close()),void 0!==t.abort&&(c=e=>t.abort(e)),Pt(e,s,i,o,a,c,r,n)}(this,n,Ye(r,1),s)}get locked(){if(!ct(this))throw Bt("locked");return ht(this)}abort(e=undefined){return ct(this)?ht(this)?d(new TypeError("Cannot abort a stream that already has a writer")):lt(this,e):d(Bt("abort"))}close(){return ct(this)?ht(this)?d(new TypeError("Cannot close a stream that already has a writer")):gt(this)?d(new TypeError("Cannot close an already-closing stream")):ut(this):d(Bt("close"))}getWriter(){if(!ct(this))throw Bt("getWriter");return ot(this)}}function ot(e){return new vt(e)}function at(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new E,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function ct(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")&&e instanceof it}function ht(e){return void 0!==e._writer}function lt(e,t){var r;if("closed"===e._state||"errored"===e._state)return u(void 0);e._writableStreamController._abortReason=t,null===(r=e._writableStreamController._abortController)||void 0===r||r.abort();const n=e._state;if("closed"===n||"errored"===n)return u(void 0);if(void 0!==e._pendingAbortRequest)return e._pendingAbortRequest._promise;let s=!1;"erroring"===n&&(s=!0,t=void 0);const i=l(((r,n)=>{e._pendingAbortRequest={_promise:void 0,_resolve:r,_reject:n,_reason:t,_wasAlreadyErroring:s}}));return e._pendingAbortRequest._promise=i,s||pt(e,t),i}function ut(e){const t=e._state;if("closed"===t||"errored"===t)return d(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));const r=l(((t,r)=>{const n={_resolve:t,_reject:r};e._closeRequest=n})),n=e._writer;var s;return void 0!==n&&e._backpressure&&"writable"===t&&zt(n),de(s=e._writableStreamController,Tt,0),kt(s),r}function dt(e,t){"writable"!==e._state?ft(e):pt(e,t)}function pt(e,t){const r=e._writableStreamController;e._state="erroring",e._storedError=t;const n=e._writer;void 0!==n&&bt(n,t),!function(e){return void 0!==e._inFlightWriteRequest||void 0!==e._inFlightCloseRequest}(e)&&r._started&&ft(e)}function ft(e){e._state="errored",e._writableStreamController[I]();const t=e._storedError;if(e._writeRequests.forEach((e=>{e._reject(t)})),e._writeRequests=new E,void 0===e._pendingAbortRequest)return void mt(e);const r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(t),void mt(e);f(e._writableStreamController[M](r._reason),(()=>{r._resolve(),mt(e)}),(t=>{r._reject(t),mt(e)}))}function gt(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function mt(e){void 0!==e._closeRequest&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);const t=e._writer;void 0!==t&&jt(t,e._storedError)}function yt(e,t){const r=e._writer;void 0!==r&&t!==e._backpressure&&(t?function(e){Ut(e)}(r):zt(r)),e._backpressure=t}Object.defineProperties(it.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(it.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});class vt{constructor(e){if(j(e,1,"WritableStreamDefaultWriter"),nt(e,"First parameter"),ht(e))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;const t=e._state;if("writable"===t)!gt(e)&&e._backpressure?Ut(this):Wt(this),Dt(this);else if("erroring"===t)Kt(this,e._storedError),Dt(this);else if("closed"===t)Wt(this),Dt(this),$t(this);else{const t=e._storedError;Kt(this,t),Nt(this,t)}}get closed(){return wt(this)?this._closedPromise:d(Ft("closed"))}get desiredSize(){if(!wt(this))throw Ft("desiredSize");if(void 0===this._ownerWritableStream)throw Lt("desiredSize");return function(e){const t=e._ownerWritableStream,r=t._state;return"errored"===r||"erroring"===r?null:"closed"===r?0:At(t._writableStreamController)}(this)}get ready(){return wt(this)?this._readyPromise:d(Ft("ready"))}abort(e=undefined){return wt(this)?void 0===this._ownerWritableStream?d(Lt("abort")):function(e,t){return lt(e._ownerWritableStream,t)}(this,e):d(Ft("abort"))}close(){if(!wt(this))return d(Ft("close"));const e=this._ownerWritableStream;return void 0===e?d(Lt("close")):gt(e)?d(new TypeError("Cannot close an already-closing stream")):St(this)}releaseLock(){if(!wt(this))throw Ft("releaseLock");void 0!==this._ownerWritableStream&&Et(this)}write(e=undefined){return wt(this)?void 0===this._ownerWritableStream?d(Lt("write to")):Ct(this,e):d(Ft("write"))}}function wt(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")&&e instanceof vt}function St(e){return ut(e._ownerWritableStream)}function bt(e,t){"pending"===e._readyPromiseState?Ht(e,t):function(e,t){Kt(e,t)}(e,t)}function Et(e){const t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");bt(e,r),function(e,t){"pending"===e._closedPromiseState?jt(e,t):function(e,t){Nt(e,t)}(e,t)}(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function Ct(e,t){const r=e._ownerWritableStream,n=r._writableStreamController,s=function(e,t){try{return e._strategySizeAlgorithm(t)}catch(t){return Mt(e,t),1}}(n,t);if(r!==e._ownerWritableStream)return d(Lt("write to"));const i=r._state;if("errored"===i)return d(r._storedError);if(gt(r)||"closed"===i)return d(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===i)return d(r._storedError);const o=function(e){return l(((t,r)=>{const n={_resolve:t,_reject:r};e._writeRequests.push(n)}))}(r);return function(e,t,r){try{de(e,t,r)}catch(t){return void Mt(e,t)}const n=e._controlledWritableStream;gt(n)||"writable"!==n._state||yt(n,It(e)),kt(e)}(n,t,s),o}Object.defineProperties(vt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(vt.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});const Tt={};class Rt{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!_t(this))throw qt("abortReason");return this._abortReason}get signal(){if(!_t(this))throw qt("signal");if(void 0===this._abortController)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(e=undefined){if(!_t(this))throw qt("error");"writable"===this._controlledWritableStream._state&&Ot(this,e)}[M](e){const t=this._abortAlgorithm(e);return xt(this),t}[I](){pe(this)}}function _t(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")&&e instanceof Rt}function Pt(e,t,r,n,s,i,o,a){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,pe(t),t._abortReason=void 0,t._abortController=function(){if(st)return new AbortController}(),t._started=!1,t._strategySizeAlgorithm=a,t._strategyHWM=o,t._writeAlgorithm=n,t._closeAlgorithm=s,t._abortAlgorithm=i;const c=It(t);yt(e,c),f(u(r()),(()=>{t._started=!0,kt(t)}),(r=>{t._started=!0,dt(e,r)}))}function xt(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function At(e){return e._strategyHWM-e._queueTotalSize}function kt(e){const t=e._controlledWritableStream;if(!e._started)return;if(void 0!==t._inFlightWriteRequest)return;if("erroring"===t._state)return void ft(t);if(0===e._queue.length)return;const r=e._queue.peek().value;r===Tt?function(e){const t=e._controlledWritableStream;(function(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0})(t),ue(e);const r=e._closeAlgorithm();xt(e),f(r,(()=>{!function(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,"erroring"===e._state&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";const t=e._writer;void 0!==t&&$t(t)}(t)}),(e=>{!function(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),dt(e,t)}(t,e)}))}(e):function(e,t){const r=e._controlledWritableStream;!function(e){e._inFlightWriteRequest=e._writeRequests.shift()}(r);f(e._writeAlgorithm(t),(()=>{!function(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}(r);const t=r._state;if(ue(e),!gt(r)&&"writable"===t){const t=It(e);yt(r,t)}kt(e)}),(t=>{"writable"===r._state&&xt(e),function(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,dt(e,t)}(r,t)}))}(e,r)}function Mt(e,t){"writable"===e._controlledWritableStream._state&&Ot(e,t)}function It(e){return At(e)<=0}function Ot(e,t){const r=e._controlledWritableStream;xt(e),pt(r,t)}function Bt(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function qt(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function Ft(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Lt(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function Dt(e){e._closedPromise=l(((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"}))}function Nt(e,t){Dt(e),jt(e,t)}function jt(e,t){void 0!==e._closedPromise_reject&&(v(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function $t(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Ut(e){e._readyPromise=l(((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r})),e._readyPromiseState="pending"}function Kt(e,t){Ut(e),Ht(e,t)}function Wt(e){Ut(e),zt(e)}function Ht(e,t){void 0!==e._readyPromise_reject&&(v(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function zt(e){void 0!==e._readyPromise_resolve&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}Object.defineProperties(Rt.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Rt.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});const Vt="undefined"!=typeof DOMException?DOMException:void 0,Gt=function(e){if("function"!=typeof e&&"object"!=typeof e)return!1;try{return new e,!0}catch(e){return!1}}(Vt)?Vt:function(){const e=function(e,t){this.message=e||"",this.name=t||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}();function Yt(e,t,n,s,i,o){const a=z(e),c=ot(t);e._disturbed=!0;let h=!1,y=u(void 0);return l(((w,S)=>{let b;if(void 0!==o){if(b=()=>{const r=new Gt("Aborted","AbortError"),n=[];s||n.push((()=>"writable"===t._state?lt(t,r):u(void 0))),i||n.push((()=>"readable"===e._state?Sr(e,r):u(void 0))),x((()=>Promise.all(n.map((e=>e())))),!0,r)},o.aborted)return void b();o.addEventListener("abort",b)}var E,C,T;if(P(e,a._closedPromise,(e=>{s?A(!0,e):x((()=>lt(t,e)),!0,e)})),P(t,c._closedPromise,(t=>{i?A(!0,t):x((()=>Sr(e,t)),!0,t)})),E=e,C=a._closedPromise,T=()=>{n?A():x((()=>function(e){const t=e._ownerWritableStream,r=t._state;return gt(t)||"closed"===r?u(void 0):"errored"===r?d(t._storedError):St(e)}(c)))},"closed"===E._state?T():g(C,T),gt(t)||"closed"===t._state){const t=new TypeError("the destination writable stream closed before all data could be piped to it");i?A(!0,t):x((()=>Sr(e,t)),!0,t)}function _(){const e=y;return p(y,(()=>e!==y?_():void 0))}function P(e,t,r){"errored"===e._state?r(e._storedError):m(t,r)}function x(e,r,n){function s(){f(e(),(()=>k(r,n)),(e=>k(!0,e)))}h||(h=!0,"writable"!==t._state||gt(t)?s():g(_(),s))}function A(e,r){h||(h=!0,"writable"!==t._state||gt(t)?k(e,r):g(_(),(()=>k(e,r))))}function k(e,t){Et(c),R(a),void 0!==o&&o.removeEventListener("abort",b),e?S(t):w(void 0)}v(l(((e,t)=>{!function n(s){s?e():p(h?u(!0):p(c._readyPromise,(()=>l(((e,t)=>{X(a,{_chunkSteps:t=>{y=p(Ct(c,t),void 0,r),e(!1)},_closeSteps:()=>e(!0),_errorSteps:t})})))),n,t)}(!1)})))}))}class Jt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Qt(this))throw ar("desiredSize");return sr(this)}close(){if(!Qt(this))throw ar("close");if(!ir(this))throw new TypeError("The stream is not in a state that permits close");tr(this)}enqueue(e=undefined){if(!Qt(this))throw ar("enqueue");if(!ir(this))throw new TypeError("The stream is not in a state that permits enqueue");return rr(this,e)}error(e=undefined){if(!Qt(this))throw ar("error");nr(this,e)}[O](e){pe(this);const t=this._cancelAlgorithm(e);return er(this),t}[B](e){const t=this._controlledReadableStream;if(this._queue.length>0){const r=ue(this);this._closeRequested&&0===this._queue.length?(er(this),br(t)):Zt(this),e._chunkSteps(r)}else V(t,e),Zt(this)}}function Qt(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")&&e instanceof Jt}function Zt(e){Xt(e)&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,f(e._pullAlgorithm(),(()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Zt(e))}),(t=>{nr(e,t)}))))}function Xt(e){const t=e._controlledReadableStream;return!!ir(e)&&!!e._started&&(!!(wr(t)&&Y(t)>0)||sr(e)>0)}function er(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function tr(e){if(!ir(e))return;const t=e._controlledReadableStream;e._closeRequested=!0,0===e._queue.length&&(er(e),br(t))}function rr(e,t){if(!ir(e))return;const r=e._controlledReadableStream;if(wr(r)&&Y(r)>0)G(r,t,!1);else{let r;try{r=e._strategySizeAlgorithm(t)}catch(t){throw nr(e,t),t}try{de(e,t,r)}catch(t){throw nr(e,t),t}}Zt(e)}function nr(e,t){const r=e._controlledReadableStream;"readable"===r._state&&(pe(e),er(e),Er(r,t))}function sr(e){const t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function ir(e){const t=e._controlledReadableStream._state;return!e._closeRequested&&"readable"===t}function or(e,t,r,n,s,i,o){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,pe(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=o,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=s,e._readableStreamController=t,f(u(r()),(()=>{t._started=!0,Zt(t)}),(e=>{nr(t,e)}))}function ar(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function cr(e,t,r){return D(e,r),r=>b(e,t,[r])}function hr(e,t,r){return D(e,r),r=>b(e,t,[r])}function lr(e,t,r){return D(e,r),r=>S(e,t,[r])}function ur(e,t){if("bytes"!=(e=`${e}`))throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function dr(e,t){if("byob"!=(e=`${e}`))throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function pr(e,t){L(e,t);const r=null==e?void 0:e.preventAbort,n=null==e?void 0:e.preventCancel,s=null==e?void 0:e.preventClose,i=null==e?void 0:e.signal;return void 0!==i&&function(e,t){if(!function(e){if("object"!=typeof e||null===e)return!1;try{return"boolean"==typeof e.aborted}catch(e){return!1}}(e))throw new TypeError(`${t} is not an AbortSignal.`)}(i,`${t} has member 'signal' that`),{preventAbort:Boolean(r),preventCancel:Boolean(n),preventClose:Boolean(s),signal:i}}Object.defineProperties(Jt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Jt.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});class fr{constructor(e={},t={}){void 0===e?e=null:N(e,"First parameter");const r=Qe(t,"Second parameter"),n=function(e,t){L(e,t);const r=e,n=null==r?void 0:r.autoAllocateChunkSize,s=null==r?void 0:r.cancel,i=null==r?void 0:r.pull,o=null==r?void 0:r.start,a=null==r?void 0:r.type;return{autoAllocateChunkSize:void 0===n?void 0:W(n,`${t} has member 'autoAllocateChunkSize' that`),cancel:void 0===s?void 0:cr(s,r,`${t} has member 'cancel' that`),pull:void 0===i?void 0:hr(i,r,`${t} has member 'pull' that`),start:void 0===o?void 0:lr(o,r,`${t} has member 'start' that`),type:void 0===a?void 0:ur(a,`${t} has member 'type' that`)}}(e,"First parameter");if(yr(this),"bytes"===n.type){if(void 0!==r.size)throw new RangeError("The strategy for a byte stream cannot have a size function");!function(e,t,r){const n=Object.create(ge.prototype);let s=()=>{},i=()=>u(void 0),o=()=>u(void 0);void 0!==t.start&&(s=()=>t.start(n)),void 0!==t.pull&&(i=()=>t.pull(n)),void 0!==t.cancel&&(o=e=>t.cancel(e));const a=t.autoAllocateChunkSize;if(0===a)throw new TypeError("autoAllocateChunkSize must be greater than 0");De(e,n,s,i,o,r,a)}(this,n,Ye(r,0))}else{const e=Je(r);!function(e,t,r,n){const s=Object.create(Jt.prototype);let i=()=>{},o=()=>u(void 0),a=()=>u(void 0);void 0!==t.start&&(i=()=>t.start(s)),void 0!==t.pull&&(o=()=>t.pull(s)),void 0!==t.cancel&&(a=e=>t.cancel(e)),or(e,s,i,o,a,r,n)}(this,n,Ye(r,1),e)}}get locked(){if(!vr(this))throw Cr("locked");return wr(this)}cancel(e=undefined){return vr(this)?wr(this)?d(new TypeError("Cannot cancel a stream that already has a reader")):Sr(this,e):d(Cr("cancel"))}getReader(e=undefined){if(!vr(this))throw Cr("getReader");return void 0===function(e,t){L(e,t);const r=null==e?void 0:e.mode;return{mode:void 0===r?void 0:dr(r,`${t} has member 'mode' that`)}}(e,"First parameter").mode?z(this):$e(this)}pipeThrough(e,t={}){if(!vr(this))throw Cr("pipeThrough");j(e,1,"pipeThrough");const r=function(e,t){L(e,t);const r=null==e?void 0:e.readable;$(r,"readable","ReadableWritablePair"),H(r,`${t} has member 'readable' that`);const n=null==e?void 0:e.writable;return $(n,"writable","ReadableWritablePair"),nt(n,`${t} has member 'writable' that`),{readable:r,writable:n}}(e,"First parameter"),n=pr(t,"Second parameter");if(wr(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(ht(r.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return v(Yt(this,r.writable,n.preventClose,n.preventAbort,n.preventCancel,n.signal)),r.readable}pipeTo(e,t={}){if(!vr(this))return d(Cr("pipeTo"));if(void 0===e)return d("Parameter 1 is required in 'pipeTo'.");if(!ct(e))return d(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let r;try{r=pr(t,"Second parameter")}catch(e){return d(e)}return wr(this)?d(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):ht(e)?d(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Yt(this,e,r.preventClose,r.preventAbort,r.preventCancel,r.signal)}tee(){if(!vr(this))throw Cr("tee");return ae(me((e=this)._readableStreamController)?function(e){let t,r,n,s,i,o=z(e),a=!1,c=!1,h=!1,d=!1,p=!1;const f=l((e=>{i=e}));function g(e){m(e._closedPromise,(t=>{e===o&&(Oe(n._readableStreamController,t),Oe(s._readableStreamController,t),d&&p||i(void 0))}))}function y(){ze(o)&&(R(o),o=z(e),g(o)),X(o,{_chunkSteps:t=>{w((()=>{c=!1,h=!1;const r=t;let o=t;if(!d&&!p)try{o=le(t)}catch(t){return Oe(n._readableStreamController,t),Oe(s._readableStreamController,t),void i(Sr(e,t))}d||Ie(n._readableStreamController,r),p||Ie(s._readableStreamController,o),a=!1,c?S():h&&b()}))},_closeSteps:()=>{a=!1,d||Me(n._readableStreamController),p||Me(s._readableStreamController),n._readableStreamController._pendingPullIntos.length>0&&Fe(n._readableStreamController,0),s._readableStreamController._pendingPullIntos.length>0&&Fe(s._readableStreamController,0),d&&p||i(void 0)},_errorSteps:()=>{a=!1}})}function v(t,r){Z(o)&&(R(o),o=$e(e),g(o));const l=r?s:n,u=r?n:s;Ve(o,t,{_chunkSteps:t=>{w((()=>{c=!1,h=!1;const n=r?p:d;if(r?d:p)n||Le(l._readableStreamController,t);else{let r;try{r=le(t)}catch(t){return Oe(l._readableStreamController,t),Oe(u._readableStreamController,t),void i(Sr(e,t))}n||Le(l._readableStreamController,t),Ie(u._readableStreamController,r)}a=!1,c?S():h&&b()}))},_closeSteps:e=>{a=!1;const t=r?p:d,n=r?d:p;t||Me(l._readableStreamController),n||Me(u._readableStreamController),void 0!==e&&(t||Le(l._readableStreamController,e),!n&&u._readableStreamController._pendingPullIntos.length>0&&Fe(u._readableStreamController,0)),t&&n||i(void 0)},_errorSteps:()=>{a=!1}})}function S(){if(a)return c=!0,u(void 0);a=!0;const e=Be(n._readableStreamController);return null===e?y():v(e._view,!1),u(void 0)}function b(){if(a)return h=!0,u(void 0);a=!0;const e=Be(s._readableStreamController);return null===e?y():v(e._view,!0),u(void 0)}function E(){}return n=mr(E,S,(function(n){if(d=!0,t=n,p){const n=ae([t,r]),s=Sr(e,n);i(s)}return f})),s=mr(E,b,(function(n){if(p=!0,r=n,d){const n=ae([t,r]),s=Sr(e,n);i(s)}return f})),g(o),[n,s]}(e):function(e,t){const r=z(e);let n,s,i,o,a,c=!1,h=!1,d=!1,p=!1;const f=l((e=>{a=e}));function g(){return c?(h=!0,u(void 0)):(c=!0,X(r,{_chunkSteps:e=>{w((()=>{h=!1;const t=e,r=e;d||rr(i._readableStreamController,t),p||rr(o._readableStreamController,r),c=!1,h&&g()}))},_closeSteps:()=>{c=!1,d||tr(i._readableStreamController),p||tr(o._readableStreamController),d&&p||a(void 0)},_errorSteps:()=>{c=!1}}),u(void 0))}function y(){}return i=gr(y,g,(function(t){if(d=!0,n=t,p){const t=ae([n,s]),r=Sr(e,t);a(r)}return f})),o=gr(y,g,(function(t){if(p=!0,s=t,d){const t=ae([n,s]),r=Sr(e,t);a(r)}return f})),m(r._closedPromise,(e=>{nr(i._readableStreamController,e),nr(o._readableStreamController,e),d&&p||a(void 0)})),[i,o]}(e));var e}values(e=undefined){if(!vr(this))throw Cr("values");return function(e,t){const r=z(e),n=new re(r,t),s=Object.create(ne);return s._asyncIteratorImpl=n,s}(this,function(e,t){L(e,"First parameter");const r=null==e?void 0:e.preventCancel;return{preventCancel:Boolean(r)}}(e).preventCancel)}}function gr(e,t,r,n=1,s=(()=>1)){const i=Object.create(fr.prototype);return yr(i),or(i,Object.create(Jt.prototype),e,t,r,n,s),i}function mr(e,t,r){const n=Object.create(fr.prototype);return yr(n),De(n,Object.create(ge.prototype),e,t,r,0,void 0),n}function yr(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function vr(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")&&e instanceof fr}function wr(e){return void 0!==e._reader}function Sr(e,t){if(e._disturbed=!0,"closed"===e._state)return u(void 0);if("errored"===e._state)return d(e._storedError);br(e);const n=e._reader;return void 0!==n&&ze(n)&&(n._readIntoRequests.forEach((e=>{e._closeSteps(void 0)})),n._readIntoRequests=new E),y(e._readableStreamController[O](t),r)}function br(e){e._state="closed";const t=e._reader;void 0!==t&&(k(t),Z(t)&&(t._readRequests.forEach((e=>{e._closeSteps()})),t._readRequests=new E))}function Er(e,t){e._state="errored",e._storedError=t;const r=e._reader;void 0!==r&&(A(r,t),Z(r)?(r._readRequests.forEach((e=>{e._errorSteps(t)})),r._readRequests=new E):(r._readIntoRequests.forEach((e=>{e._errorSteps(t)})),r._readIntoRequests=new E))}function Cr(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Tr(e,t){L(e,t);const r=null==e?void 0:e.highWaterMark;return $(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:U(r)}}Object.defineProperties(fr.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(fr.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),"symbol"==typeof t.asyncIterator&&Object.defineProperty(fr.prototype,t.asyncIterator,{value:fr.prototype.values,writable:!0,configurable:!0});const Rr=e=>e.byteLength;try{Object.defineProperty(Rr,"name",{value:"size",configurable:!0})}catch(e){}class _r{constructor(e){j(e,1,"ByteLengthQueuingStrategy"),e=Tr(e,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!xr(this))throw Pr("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!xr(this))throw Pr("size");return Rr}}function Pr(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function xr(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")&&e instanceof _r}Object.defineProperties(_r.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(_r.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});const Ar=()=>1;try{Object.defineProperty(Ar,"name",{value:"size",configurable:!0})}catch(e){}class kr{constructor(e){j(e,1,"CountQueuingStrategy"),e=Tr(e,"First parameter"),this._countQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!Ir(this))throw Mr("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!Ir(this))throw Mr("size");return Ar}}function Mr(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function Ir(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")&&e instanceof kr}function Or(e,t,r){return D(e,r),r=>b(e,t,[r])}function Br(e,t,r){return D(e,r),r=>S(e,t,[r])}function qr(e,t,r){return D(e,r),(r,n)=>b(e,t,[r,n])}Object.defineProperties(kr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(kr.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});class Fr{constructor(e={},t={},r={}){void 0===e&&(e=null);const n=Qe(t,"Second parameter"),s=Qe(r,"Third parameter"),i=function(e,t){L(e,t);const r=null==e?void 0:e.flush,n=null==e?void 0:e.readableType,s=null==e?void 0:e.start,i=null==e?void 0:e.transform,o=null==e?void 0:e.writableType;return{flush:void 0===r?void 0:Or(r,e,`${t} has member 'flush' that`),readableType:n,start:void 0===s?void 0:Br(s,e,`${t} has member 'start' that`),transform:void 0===i?void 0:qr(i,e,`${t} has member 'transform' that`),writableType:o}}(e,"First parameter");if(void 0!==i.readableType)throw new RangeError("Invalid readableType specified");if(void 0!==i.writableType)throw new RangeError("Invalid writableType specified");const o=Ye(s,0),a=Je(s),c=Ye(n,1),h=Je(n);let p;!function(e,t,r,n,s,i){function o(){return t}e._writable=function(e,t,r,n,s=1,i=(()=>1)){const o=Object.create(it.prototype);return at(o),Pt(o,Object.create(Rt.prototype),e,t,r,n,s,i),o}(o,(function(t){return function(e,t){const r=e._transformStreamController;return e._backpressure?y(e._backpressureChangePromise,(()=>{const n=e._writable;if("erroring"===n._state)throw n._storedError;return Hr(r,t)})):Hr(r,t)}(e,t)}),(function(){return function(e){const t=e._readable,r=e._transformStreamController,n=r._flushAlgorithm();return Kr(r),y(n,(()=>{if("errored"===t._state)throw t._storedError;tr(t._readableStreamController)}),(r=>{throw Dr(e,r),t._storedError}))}(e)}),(function(t){return function(e,t){return Dr(e,t),u(void 0)}(e,t)}),r,n),e._readable=gr(o,(function(){return function(e){return jr(e,!1),e._backpressureChangePromise}(e)}),(function(t){return Nr(e,t),u(void 0)}),s,i),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,jr(e,!0),e._transformStreamController=void 0}(this,l((e=>{p=e})),c,h,o,a),function(e,t){const r=Object.create($r.prototype);let n=e=>{try{return Wr(r,e),u(void 0)}catch(e){return d(e)}},s=()=>u(void 0);void 0!==t.transform&&(n=e=>t.transform(e,r)),void 0!==t.flush&&(s=()=>t.flush(r)),function(e,t,r,n){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=r,t._flushAlgorithm=n}(e,r,n,s)}(this,i),void 0!==i.start?p(i.start(this._transformStreamController)):p(void 0)}get readable(){if(!Lr(this))throw Vr("readable");return this._readable}get writable(){if(!Lr(this))throw Vr("writable");return this._writable}}function Lr(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")&&e instanceof Fr}function Dr(e,t){nr(e._readable._readableStreamController,t),Nr(e,t)}function Nr(e,t){Kr(e._transformStreamController),Mt(e._writable._writableStreamController,t),e._backpressure&&jr(e,!1)}function jr(e,t){void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=l((t=>{e._backpressureChangePromise_resolve=t})),e._backpressure=t}Object.defineProperties(Fr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Fr.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});class $r{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Ur(this))throw zr("desiredSize");return sr(this._controlledTransformStream._readable._readableStreamController)}enqueue(e=undefined){if(!Ur(this))throw zr("enqueue");Wr(this,e)}error(e=undefined){if(!Ur(this))throw zr("error");var t;t=e,Dr(this._controlledTransformStream,t)}terminate(){if(!Ur(this))throw zr("terminate");!function(e){const t=e._controlledTransformStream;tr(t._readable._readableStreamController);Nr(t,new TypeError("TransformStream terminated"))}(this)}}function Ur(e){return!!s(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")&&e instanceof $r}function Kr(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function Wr(e,t){const r=e._controlledTransformStream,n=r._readable._readableStreamController;if(!ir(n))throw new TypeError("Readable side is not in a state that permits enqueue");try{rr(n,t)}catch(e){throw Nr(r,e),r._readable._storedError}const s=function(e){return!Xt(e)}(n);s!==r._backpressure&&jr(r,!0)}function Hr(e,t){return y(e._transformAlgorithm(t),void 0,(t=>{throw Dr(e._controlledTransformStream,t),t}))}function zr(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Vr(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}Object.defineProperties($r.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty($r.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0}),e.ByteLengthQueuingStrategy=_r,e.CountQueuingStrategy=kr,e.ReadableByteStreamController=ge,e.ReadableStream=fr,e.ReadableStreamBYOBReader=He,e.ReadableStreamBYOBRequest=fe,e.ReadableStreamDefaultController=Jt,e.ReadableStreamDefaultReader=Q,e.TransformStream=Fr,e.TransformStreamDefaultController=$r,e.WritableStream=it,e.WritableStreamDefaultController=Rt,e.WritableStreamDefaultWriter=vt,Object.defineProperty(e,"__esModule",{value:!0})},r(t)},9156:(e,t,r)=>{e.exports=r(8287)},1197:e=>{var t={disableWarnings:!1,deprecationWarningMap:{},warn:function(e){!this.disableWarnings&&this.deprecationWarningMap[e]&&(console.warn("DEPRECATION WARNING: "+this.deprecationWarningMap[e]),this.deprecationWarningMap[e]=!1)}};e.exports=t},4864:(e,t,r)=>{var n=r(6749),s=r(5054),i=r(8653);const o=0,a=1,c=2,h=3;function l(e,t,r,s,a,c){i.EventTarget.call(this),(c=c||{}).assembleFragments=!0;var h=this;this._url=e,this._readyState=o,this._protocol=void 0,this._extensions="",this._bufferedAmount=0,this._binaryType="arraybuffer",this._connection=void 0,this._client=new n(c),this._client.on("connect",(function(e){p.call(h,e)})),this._client.on("connectFailed",(function(){f.call(h)})),this._client.connect(e,t,r,s,a)}function u(e,t){var r=new i.Event("close");return r.code=e,r.reason=t,r.wasClean=void 0===e||1e3===e,r}function d(e){var t=new i.Event("message");return t.data=e,t}function p(e){var t=this;this._readyState=a,this._connection=e,this._protocol=e.protocol,this._extensions=e.extensions,this._connection.on("close",(function(e,r){g.call(t,e,r)})),this._connection.on("message",(function(e){m.call(t,e)})),this.dispatchEvent(new i.Event("open"))}function f(){y.call(this),this._readyState=h;try{this.dispatchEvent(new i.Event("error"))}finally{this.dispatchEvent(u(1006,"connection failed"))}}function g(e,t){y.call(this),this._readyState=h,this.dispatchEvent(u(e,t||""))}function m(e){if(e.utf8Data)this.dispatchEvent(d(e.utf8Data));else if(e.binaryData&&"arraybuffer"===this.binaryType){for(var t=e.binaryData,r=new ArrayBuffer(t.length),n=new Uint8Array(r),s=0,i=t.length;s<i;++s)n[s]=t[s];this.dispatchEvent(d(r))}}function y(){this._client.removeAllListeners(),this._connection&&this._connection.removeAllListeners()}e.exports=l,Object.defineProperties(l.prototype,{url:{get:function(){return this._url}},readyState:{get:function(){return this._readyState}},protocol:{get:function(){return this._protocol}},extensions:{get:function(){return this._extensions}},bufferedAmount:{get:function(){return this._bufferedAmount}}}),Object.defineProperties(l.prototype,{binaryType:{get:function(){return this._binaryType},set:function(e){if("arraybuffer"!==e)throw new SyntaxError('just "arraybuffer" type allowed for "binaryType" attribute');this._binaryType=e}}}),[["CONNECTING",o],["OPEN",a],["CLOSING",c],["CLOSED",h]].forEach((function(e){Object.defineProperty(l.prototype,e[0],{get:function(){return e[1]}})})),[["CONNECTING",o],["OPEN",a],["CLOSING",c],["CLOSED",h]].forEach((function(e){Object.defineProperty(l,e[0],{get:function(){return e[1]}})})),l.prototype.send=function(e){if(this._readyState!==a)throw new Error("cannot call send() while not connected");if("string"==typeof e||e instanceof String)this._connection.sendUTF(e);else if(e instanceof Buffer)this._connection.sendBytes(e);else{if(!e.byteLength&&0!==e.byteLength)throw new Error("unknown binary data:",e);e=s(e),this._connection.sendBytes(e)}},l.prototype.close=function(e,t){switch(this._readyState){case o:f.call(this),this._client.on("connect",(function(r){e?r.close(e,t):r.close()}));break;case a:this._readyState=c,e?this._connection.close(e,t):this._connection.close()}}},6749:(e,t,r)=>{var n=r(4636),s=n.extend,i=r(3837),o=r(2361).EventEmitter,a=r(3685),c=r(5687),h=r(7310),l=r(6113),u=r(1836),d=n.bufferAllocUnsafe,p=["(",")","<",">","@",",",";",":","\\",'"',"/","[","]","?","=","{","}"," ",String.fromCharCode(9)],f=["hostname","port","method","path","headers"];function g(e){var t;switch(o.call(this),this.config={maxReceivedFrameSize:1048576,maxReceivedMessageSize:8388608,fragmentOutgoingMessages:!0,fragmentationThreshold:16384,webSocketVersion:13,assembleFragments:!0,disableNagleAlgorithm:!0,closeTimeout:5e3,tlsOptions:{}},e&&(e.tlsOptions?(t=e.tlsOptions,delete e.tlsOptions):t={},s(this.config,e),s(this.config.tlsOptions,t)),this._req=null,this.config.webSocketVersion){case 8:case 13:break;default:throw new Error("Requested webSocketVersion is not supported. Allowed values are 8 and 13.")}}i.inherits(g,o),g.prototype.connect=function(e,t,r,i,o){var l=this;if("string"==typeof t&&(t=t.length>0?[t]:[]),t instanceof Array||(t=[]),this.protocols=t,this.origin=r,this.url="string"==typeof e?h.parse(e):e,!this.url.protocol)throw new Error("You must specify a full WebSocket URL, including protocol.");if(!this.url.host)throw new Error("You must specify a full WebSocket URL, including hostname. Relative URLs are not supported.");this.secure="wss:"===this.url.protocol,this.protocols.forEach((function(e){for(var t=0;t<e.length;t++){var r=e.charCodeAt(t),n=e.charAt(t);if(r<33||r>126||-1!==p.indexOf(n))throw new Error('Protocol list contains invalid character "'+String.fromCharCode(r)+'"')}})),this.url.port||(this.url.port={"ws:":"80","wss:":"443"}[this.url.protocol]);for(var u=d(16),g=0;g<16;g++)u[g]=Math.round(255*Math.random());this.base64nonce=u.toString("base64");var m=this.url.hostname;("ws:"===this.url.protocol&&"80"!==this.url.port||"wss:"===this.url.protocol&&"443"!==this.url.port)&&(m+=":"+this.url.port);var y,v={};function w(e){l._req=null,l.emit("connectFailed",e)}this.secure&&this.config.tlsOptions.hasOwnProperty("headers")&&s(v,this.config.tlsOptions.headers),i&&s(v,i),s(v,{Upgrade:"websocket",Connection:"Upgrade","Sec-WebSocket-Version":this.config.webSocketVersion.toString(10),"Sec-WebSocket-Key":this.base64nonce,Host:v.Host||m}),this.protocols.length>0&&(v["Sec-WebSocket-Protocol"]=this.protocols.join(", ")),this.origin&&(13===this.config.webSocketVersion?v.Origin=this.origin:8===this.config.webSocketVersion&&(v["Sec-WebSocket-Origin"]=this.origin)),y=this.url.pathname?this.url.path:this.url.path?"/"+this.url.path:"/";var S={agent:!1};if(o&&s(S,o),s(S,{hostname:this.url.hostname,port:this.url.port,method:"GET",path:y,headers:v}),this.secure){var b=this.config.tlsOptions;for(var E in b)b.hasOwnProperty(E)&&-1===f.indexOf(E)&&(S[E]=b[E])}var C=this._req=(this.secure?c:a).request(S);C.on("upgrade",(function(e,t,r){l._req=null,C.removeListener("error",w),l.socket=t,l.response=e,l.firstDataChunk=r,l.validateHandshake()})),C.on("error",w),C.on("response",(function(e){if(l._req=null,n.eventEmitterListenerCount(l,"httpResponse")>0)l.emit("httpResponse",e,l),e.socket&&e.socket.end();else{var t=[];for(var r in e.headers)t.push(r+": "+e.headers[r]);l.failHandshake("Server responded with a non-101 status: "+e.statusCode+" "+e.statusMessage+"\nResponse Headers Follow:\n"+t.join("\n")+"\n")}})),C.end()},g.prototype.validateHandshake=function(){var e=this.response.headers;if(this.protocols.length>0){if(this.protocol=e["sec-websocket-protocol"],!this.protocol)return void this.failHandshake("Expected a Sec-WebSocket-Protocol header.");if(-1===this.protocols.indexOf(this.protocol))return void this.failHandshake("Server did not respond with a requested protocol.")}if(e.connection&&"upgrade"===e.connection.toLocaleLowerCase())if(e.upgrade&&"websocket"===e.upgrade.toLocaleLowerCase()){var t=l.createHash("sha1");t.update(this.base64nonce+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");var r=t.digest("base64");e["sec-websocket-accept"]?e["sec-websocket-accept"]===r?this.succeedHandshake():this.failHandshake("Sec-WebSocket-Accept header from server didn't match expected value of "+r):this.failHandshake("Expected Sec-WebSocket-Accept header from server")}else this.failHandshake("Expected an Upgrade: websocket header from the server");else this.failHandshake("Expected a Connection: Upgrade header from the server")},g.prototype.failHandshake=function(e){this.socket&&this.socket.writable&&this.socket.end(),this.emit("connectFailed",new Error(e))},g.prototype.succeedHandshake=function(){var e=new u(this.socket,[],this.protocol,!0,this.config);e.webSocketVersion=this.config.webSocketVersion,e._addSocketEventListeners(),this.emit("connect",e),this.firstDataChunk.length>0&&e.handleSocketData(this.firstDataChunk),this.firstDataChunk=null},g.prototype.abort=function(){this._req&&this._req.abort()},e.exports=g},1836:(e,t,r)=>{var n=r(3837),s=r(4636),i=r(2361).EventEmitter,o=r(9650),a=r(6748),c=r(311),h=s.bufferAllocUnsafe,l=s.bufferFromString;const u="open",d="peer_requested_close",p="ending",f="closed";var g="setImmediate"in global?global.setImmediate.bind(global):process.nextTick.bind(process),m=0;function y(e,t,r,n,c){if(this._debug=s.BufferingLogger("websocket:connection",++m),this._debug("constructor"),this._debug.enabled&&function(e,t){if(e._debug.enabled){var r=t.emit;for(var n in t.emit=function(t){e._debug("||| Socket Event  '%s'",t),r.apply(this,arguments)},t)"function"==typeof t[n]&&-1===["emit"].indexOf(n)&&function(r){var n=t[r];t[r]="on"!==r?function(){return e._debug("||| Socket method called:  %s",r),n.apply(this,arguments)}:function(){return e._debug("||| Socket method called:  %s (%s)",r,arguments[0]),n.apply(this,arguments)}}(n)}}(this,e),i.call(this),this._pingListenerCount=0,this.on("newListener",(function(e){"ping"===e&&this._pingListenerCount++})).on("removeListener",(function(e){"ping"===e&&this._pingListenerCount--})),this.config=c,this.socket=e,this.protocol=r,this.extensions=t,this.remoteAddress=e.remoteAddress,this.closeReasonCode=-1,this.closeDescription=null,this.closeEventEmitted=!1,this.maskOutgoingPackets=n,this.maskBytes=h(4),this.frameHeader=h(10),this.bufferList=new a,this.currentFrame=new o(this.maskBytes,this.frameHeader,this.config),this.fragmentationSize=0,this.frameQueue=[],this.connected=!0,this.state=u,this.waitingForCloseResponse=!1,this.receivedEnd=!1,this.closeTimeout=this.config.closeTimeout,this.assembleFragments=this.config.assembleFragments,this.maxReceivedMessageSize=this.config.maxReceivedMessageSize,this.outputBufferFull=!1,this.inputPaused=!1,this.receivedDataHandler=this.processReceivedData.bind(this),this._closeTimerHandler=this.handleCloseTimer.bind(this),this.socket.setNoDelay(this.config.disableNagleAlgorithm),this.socket.setTimeout(0),this.config.keepalive&&!this.config.useNativeKeepalive){if("number"!=typeof this.config.keepaliveInterval)throw new Error("keepaliveInterval must be specified and numeric if keepalive is true.");if(this._keepaliveTimerHandler=this.handleKeepaliveTimer.bind(this),this.setKeepaliveTimer(),this.config.dropConnectionOnKeepaliveTimeout){if("number"!=typeof this.config.keepaliveGracePeriod)throw new Error("keepaliveGracePeriod  must be specified and numeric if dropConnectionOnKeepaliveTimeout is true.");this._gracePeriodTimerHandler=this.handleGracePeriodTimer.bind(this)}}else if(this.config.keepalive&&this.config.useNativeKeepalive){if(!("setKeepAlive"in this.socket))throw new Error("Unable to use native keepalive: unsupported by this version of Node.");this.socket.setKeepAlive(!0,this.config.keepaliveInterval)}this.socket.removeAllListeners("error")}function v(e){return!(e<1e3)&&(e>=1e3&&e<=2999?-1!==[1e3,1001,1002,1003,1007,1008,1009,1010,1011,1012,1013,1014,1015].indexOf(e):e>=3e3&&e<=3999||e>=4e3&&e<=4999||!(e>=5e3)&&void 0)}y.CLOSE_REASON_NORMAL=1e3,y.CLOSE_REASON_GOING_AWAY=1001,y.CLOSE_REASON_PROTOCOL_ERROR=1002,y.CLOSE_REASON_UNPROCESSABLE_INPUT=1003,y.CLOSE_REASON_RESERVED=1004,y.CLOSE_REASON_NOT_PROVIDED=1005,y.CLOSE_REASON_ABNORMAL=1006,y.CLOSE_REASON_INVALID_DATA=1007,y.CLOSE_REASON_POLICY_VIOLATION=1008,y.CLOSE_REASON_MESSAGE_TOO_BIG=1009,y.CLOSE_REASON_EXTENSION_REQUIRED=1010,y.CLOSE_REASON_INTERNAL_SERVER_ERROR=1011,y.CLOSE_REASON_TLS_HANDSHAKE_FAILED=1015,y.CLOSE_DESCRIPTIONS={1e3:"Normal connection closure",1001:"Remote peer is going away",1002:"Protocol error",1003:"Unprocessable input",1004:"Reserved",1005:"Reason not provided",1006:"Abnormal closure, no further detail available",1007:"Invalid data received",1008:"Policy violation",1009:"Message too big",1010:"Extension requested by client is required",1011:"Internal Server Error",1015:"TLS Handshake Failed"},n.inherits(y,i),y.prototype._addSocketEventListeners=function(){this.socket.on("error",this.handleSocketError.bind(this)),this.socket.on("end",this.handleSocketEnd.bind(this)),this.socket.on("close",this.handleSocketClose.bind(this)),this.socket.on("drain",this.handleSocketDrain.bind(this)),this.socket.on("pause",this.handleSocketPause.bind(this)),this.socket.on("resume",this.handleSocketResume.bind(this)),this.socket.on("data",this.handleSocketData.bind(this))},y.prototype.setKeepaliveTimer=function(){this._debug("setKeepaliveTimer"),this.config.keepalive&&!this.config.useNativeKeepalive&&(this.clearKeepaliveTimer(),this.clearGracePeriodTimer(),this._keepaliveTimeoutID=setTimeout(this._keepaliveTimerHandler,this.config.keepaliveInterval))},y.prototype.clearKeepaliveTimer=function(){this._keepaliveTimeoutID&&clearTimeout(this._keepaliveTimeoutID)},y.prototype.handleKeepaliveTimer=function(){this._debug("handleKeepaliveTimer"),this._keepaliveTimeoutID=null,this.ping(),this.config.dropConnectionOnKeepaliveTimeout?this.setGracePeriodTimer():this.setKeepaliveTimer()},y.prototype.setGracePeriodTimer=function(){this._debug("setGracePeriodTimer"),this.clearGracePeriodTimer(),this._gracePeriodTimeoutID=setTimeout(this._gracePeriodTimerHandler,this.config.keepaliveGracePeriod)},y.prototype.clearGracePeriodTimer=function(){this._gracePeriodTimeoutID&&clearTimeout(this._gracePeriodTimeoutID)},y.prototype.handleGracePeriodTimer=function(){this._debug("handleGracePeriodTimer"),this._gracePeriodTimeoutID=null,this.drop(y.CLOSE_REASON_ABNORMAL,"Peer not responding.",!0)},y.prototype.handleSocketData=function(e){this._debug("handleSocketData"),this.setKeepaliveTimer(),this.bufferList.write(e),this.processReceivedData()},y.prototype.processReceivedData=function(){if(this._debug("processReceivedData"),this.connected&&!this.inputPaused){var e=this.currentFrame;if(e.addData(this.bufferList)){var t=this;if(e.protocolError)return this._debug("-- protocol error"),void process.nextTick((function(){t.drop(y.CLOSE_REASON_PROTOCOL_ERROR,e.dropReason)}));if(e.frameTooLarge)return this._debug("-- frame too large"),void process.nextTick((function(){t.drop(y.CLOSE_REASON_MESSAGE_TOO_BIG,e.dropReason)}));if(e.rsv1||e.rsv2||e.rsv3)return this._debug("-- illegal rsv flag"),void process.nextTick((function(){t.drop(y.CLOSE_REASON_PROTOCOL_ERROR,"Unsupported usage of rsv bits without negotiated extension.")}));this.assembleFragments||(this._debug("-- emitting frame"),process.nextTick((function(){t.emit("frame",e)}))),process.nextTick((function(){t.processFrame(e)})),this.currentFrame=new o(this.maskBytes,this.frameHeader,this.config),this.bufferList.length>0&&g(this.receivedDataHandler)}else this._debug("-- insufficient data for frame")}},y.prototype.handleSocketError=function(e){this._debug("handleSocketError: %j",e),this.state!==f?(this.closeReasonCode=y.CLOSE_REASON_ABNORMAL,this.closeDescription="Socket Error: "+e.syscall+" "+e.code,this.connected=!1,this.state=f,this.fragmentationSize=0,s.eventEmitterListenerCount(this,"error")>0&&this.emit("error",e),this.socket.destroy(),this._debug.printOutput()):this._debug("  --- Socket 'error' after 'close'")},y.prototype.handleSocketEnd=function(){this._debug("handleSocketEnd: received socket end.  state = %s",this.state),this.receivedEnd=!0,this.state!==f?this.state!==d&&this.state!==p&&(this._debug("  --- UNEXPECTED socket end."),this.socket.end()):this._debug("  --- Socket 'end' after 'close'")},y.prototype.handleSocketClose=function(e){this._debug("handleSocketClose: received socket close"),this.socketHadError=e,this.connected=!1,this.state=f,-1===this.closeReasonCode&&(this.closeReasonCode=y.CLOSE_REASON_ABNORMAL,this.closeDescription="Connection dropped by remote peer."),this.clearCloseTimer(),this.clearKeepaliveTimer(),this.clearGracePeriodTimer(),this.closeEventEmitted||(this.closeEventEmitted=!0,this._debug("-- Emitting WebSocketConnection close event"),this.emit("close",this.closeReasonCode,this.closeDescription))},y.prototype.handleSocketDrain=function(){this._debug("handleSocketDrain: socket drain event"),this.outputBufferFull=!1,this.emit("drain")},y.prototype.handleSocketPause=function(){this._debug("handleSocketPause: socket pause event"),this.inputPaused=!0,this.emit("pause")},y.prototype.handleSocketResume=function(){this._debug("handleSocketResume: socket resume event"),this.inputPaused=!1,this.emit("resume"),this.processReceivedData()},y.prototype.pause=function(){this._debug("pause: pause requested"),this.socket.pause()},y.prototype.resume=function(){this._debug("resume: resume requested"),this.socket.resume()},y.prototype.close=function(e,t){if(this.connected){if(this._debug("close: Initating clean WebSocket close sequence."),"number"!=typeof e&&(e=y.CLOSE_REASON_NORMAL),!v(e))throw new Error("Close code "+e+" is not valid.");"string"!=typeof t&&(t=y.CLOSE_DESCRIPTIONS[e]),this.closeReasonCode=e,this.closeDescription=t,this.setCloseTimer(),this.sendCloseFrame(this.closeReasonCode,this.closeDescription),this.state=p,this.connected=!1}},y.prototype.drop=function(e,t,r){this._debug("drop"),"number"!=typeof e&&(e=y.CLOSE_REASON_PROTOCOL_ERROR),"string"!=typeof t&&(t=y.CLOSE_DESCRIPTIONS[e]),this._debug("Forcefully dropping connection. skipCloseFrame: %s, code: %d, description: %s",r,e,t),this.closeReasonCode=e,this.closeDescription=t,this.frameQueue=[],this.fragmentationSize=0,r||this.sendCloseFrame(e,t),this.connected=!1,this.state=f,this.clearCloseTimer(),this.clearKeepaliveTimer(),this.clearGracePeriodTimer(),this.closeEventEmitted||(this.closeEventEmitted=!0,this._debug("Emitting WebSocketConnection close event"),this.emit("close",this.closeReasonCode,this.closeDescription)),this._debug("Drop: destroying socket"),this.socket.destroy()},y.prototype.setCloseTimer=function(){this._debug("setCloseTimer"),this.clearCloseTimer(),this._debug("Setting close timer"),this.waitingForCloseResponse=!0,this.closeTimer=setTimeout(this._closeTimerHandler,this.closeTimeout)},y.prototype.clearCloseTimer=function(){this._debug("clearCloseTimer"),this.closeTimer&&(this._debug("Clearing close timer"),clearTimeout(this.closeTimer),this.waitingForCloseResponse=!1,this.closeTimer=null)},y.prototype.handleCloseTimer=function(){this._debug("handleCloseTimer"),this.closeTimer=null,this.waitingForCloseResponse&&(this._debug("Close response not received from client.  Forcing socket end."),this.waitingForCloseResponse=!1,this.state=f,this.socket.end())},y.prototype.processFrame=function(e){if(this._debug("processFrame"),this._debug(" -- frame: %s",e),0!==this.frameQueue.length&&e.opcode>0&&e.opcode<8)this.drop(y.CLOSE_REASON_PROTOCOL_ERROR,"Illegal frame opcode 0x"+e.opcode.toString(16)+" received in middle of fragmented message.");else switch(e.opcode){case 2:this._debug("-- Binary Frame"),this.assembleFragments&&(e.fin?(this._debug("---- Emitting 'message' event"),this.emit("message",{type:"binary",binaryData:e.binaryPayload})):(this.frameQueue.push(e),this.fragmentationSize=e.length));break;case 1:if(this._debug("-- Text Frame"),this.assembleFragments)if(e.fin){if(!c(e.binaryPayload))return void this.drop(y.CLOSE_REASON_INVALID_DATA,"Invalid UTF-8 Data Received");this._debug("---- Emitting 'message' event"),this.emit("message",{type:"utf8",utf8Data:e.binaryPayload.toString("utf8")})}else this.frameQueue.push(e),this.fragmentationSize=e.length;break;case 0:if(this._debug("-- Continuation Frame"),this.assembleFragments){if(0===this.frameQueue.length)return void this.drop(y.CLOSE_REASON_PROTOCOL_ERROR,"Unexpected Continuation Frame");if(this.fragmentationSize+=e.length,this.fragmentationSize>this.maxReceivedMessageSize)return void this.drop(y.CLOSE_REASON_MESSAGE_TOO_BIG,"Maximum message size exceeded.");if(this.frameQueue.push(e),e.fin){var t=0,r=h(this.fragmentationSize),n=this.frameQueue[0].opcode;switch(this.frameQueue.forEach((function(e){e.binaryPayload.copy(r,t),t+=e.binaryPayload.length})),this.frameQueue=[],this.fragmentationSize=0,n){case 2:this.emit("message",{type:"binary",binaryData:r});break;case 1:if(!c(r))return void this.drop(y.CLOSE_REASON_INVALID_DATA,"Invalid UTF-8 Data Received");this.emit("message",{type:"utf8",utf8Data:r.toString("utf8")});break;default:return void this.drop(y.CLOSE_REASON_PROTOCOL_ERROR,"Unexpected first opcode in fragmentation sequence: 0x"+n.toString(16))}}}break;case 9:if(this._debug("-- Ping Frame"),this._pingListenerCount>0){var s=!1;this.emit("ping",(function(){s=!0}),e.binaryPayload),s||this.pong(e.binaryPayload)}else this.pong(e.binaryPayload);break;case 10:this._debug("-- Pong Frame"),this.emit("pong",e.binaryPayload);break;case 8:if(this._debug("-- Close Frame"),this.waitingForCloseResponse)return this._debug("---- Got close response from peer.  Completing closing handshake."),this.clearCloseTimer(),this.waitingForCloseResponse=!1,this.state=f,void this.socket.end();var i;if(this._debug("---- Closing handshake initiated by peer."),this.state=d,e.invalidCloseFrameLength?(this.closeReasonCode=1005,i=y.CLOSE_REASON_PROTOCOL_ERROR):-1===e.closeStatus||v(e.closeStatus)?(this.closeReasonCode=e.closeStatus,i=y.CLOSE_REASON_NORMAL):(this.closeReasonCode=e.closeStatus,i=y.CLOSE_REASON_PROTOCOL_ERROR),e.binaryPayload.length>1){if(!c(e.binaryPayload))return void this.drop(y.CLOSE_REASON_INVALID_DATA,"Invalid UTF-8 Data Received");this.closeDescription=e.binaryPayload.toString("utf8")}else this.closeDescription=y.CLOSE_DESCRIPTIONS[this.closeReasonCode];this._debug("------ Remote peer %s - code: %d - %s - close frame payload length: %d",this.remoteAddress,this.closeReasonCode,this.closeDescription,e.length),this._debug("------ responding to remote peer's close request."),this.sendCloseFrame(i,null),this.connected=!1;break;default:this._debug("-- Unrecognized Opcode %d",e.opcode),this.drop(y.CLOSE_REASON_PROTOCOL_ERROR,"Unrecognized Opcode: 0x"+e.opcode.toString(16))}},y.prototype.send=function(e,t){if(this._debug("send"),Buffer.isBuffer(e))this.sendBytes(e,t);else{if("function"!=typeof e.toString)throw new Error("Data provided must either be a Node Buffer or implement toString()");this.sendUTF(e,t)}},y.prototype.sendUTF=function(e,t){e=l(e.toString(),"utf8"),this._debug("sendUTF: %d bytes",e.length);var r=new o(this.maskBytes,this.frameHeader,this.config);r.opcode=1,r.binaryPayload=e,this.fragmentAndSend(r,t)},y.prototype.sendBytes=function(e,t){if(this._debug("sendBytes"),!Buffer.isBuffer(e))throw new Error("You must pass a Node Buffer object to WebSocketConnection.prototype.sendBytes()");var r=new o(this.maskBytes,this.frameHeader,this.config);r.opcode=2,r.binaryPayload=e,this.fragmentAndSend(r,t)},y.prototype.ping=function(e){this._debug("ping");var t=new o(this.maskBytes,this.frameHeader,this.config);t.opcode=9,t.fin=!0,e&&(Buffer.isBuffer(e)||(e=l(e.toString(),"utf8")),e.length>125&&(this._debug("WebSocket: Data for ping is longer than 125 bytes.  Truncating."),e=e.slice(0,124)),t.binaryPayload=e),this.sendFrame(t)},y.prototype.pong=function(e){this._debug("pong");var t=new o(this.maskBytes,this.frameHeader,this.config);t.opcode=10,Buffer.isBuffer(e)&&e.length>125&&(this._debug("WebSocket: Data for pong is longer than 125 bytes.  Truncating."),e=e.slice(0,124)),t.binaryPayload=e,t.fin=!0,this.sendFrame(t)},y.prototype.fragmentAndSend=function(e,t){if(this._debug("fragmentAndSend"),e.opcode>7)throw new Error("You cannot fragment control frames.");var r=this.config.fragmentationThreshold,n=e.binaryPayload.length;if(!this.config.fragmentOutgoingMessages||e.binaryPayload&&n<=r)return e.fin=!0,void this.sendFrame(e,t);for(var s=Math.ceil(n/r),i=0,a=function(e){e?"function"==typeof t&&(t(e),t=null):++i===s&&"function"==typeof t&&t()},c=1;c<=s;c++){var h=new o(this.maskBytes,this.frameHeader,this.config);h.opcode=1===c?e.opcode:0,h.fin=c===s;var l=c===s?n-r*(c-1):r,u=r*(c-1);h.binaryPayload=e.binaryPayload.slice(u,u+l),this.sendFrame(h,a)}},y.prototype.sendCloseFrame=function(e,t,r){if("number"!=typeof e&&(e=y.CLOSE_REASON_NORMAL),this._debug("sendCloseFrame state: %s, reasonCode: %d, description: %s",this.state,e,t),this.state===u||this.state===d){var n=new o(this.maskBytes,this.frameHeader,this.config);n.fin=!0,n.opcode=8,n.closeStatus=e,"string"==typeof t&&(n.binaryPayload=l(t,"utf8")),this.sendFrame(n,r),this.socket.end()}},y.prototype.sendFrame=function(e,t){this._debug("sendFrame"),e.mask=this.maskOutgoingPackets;var r=this.socket.write(e.toBuffer(),t);return this.outputBufferFull=!r,r},e.exports=y},9650:(e,t,r)=>{var n=r(1891),s=r(4636).bufferAllocUnsafe;const i=1;function o(e,t,r){this.maskBytes=e,this.frameHeader=t,this.config=r,this.maxReceivedFrameSize=r.maxReceivedFrameSize,this.protocolError=!1,this.frameTooLarge=!1,this.invalidCloseFrameLength=!1,this.parseState=i,this.closeStatus=-1}o.prototype.addData=function(e){if(this.parseState===i&&e.length>=2){e.joinInto(this.frameHeader,0,0,2),e.advance(2);var t=this.frameHeader[0],r=this.frameHeader[1];if(this.fin=Boolean(128&t),this.rsv1=Boolean(64&t),this.rsv2=Boolean(32&t),this.rsv3=Boolean(16&t),this.mask=Boolean(128&r),this.opcode=15&t,this.length=127&r,this.opcode>=8){if(this.length>125)return this.protocolError=!0,this.dropReason="Illegal control frame longer than 125 bytes.",!0;if(!this.fin)return this.protocolError=!0,this.dropReason="Control frames must not be fragmented.",!0}126===this.length?this.parseState=2:127===this.length?this.parseState=3:this.parseState=4}if(2===this.parseState)e.length>=2&&(e.joinInto(this.frameHeader,2,0,2),e.advance(2),this.length=this.frameHeader.readUInt16BE(2),this.parseState=4);else if(3===this.parseState&&e.length>=8){e.joinInto(this.frameHeader,2,0,8),e.advance(8);var o=[this.frameHeader.readUInt32BE(2),this.frameHeader.readUInt32BE(6)];if(0!==o[0])return this.protocolError=!0,this.dropReason="Unsupported 64-bit length frame received",!0;this.length=o[1],this.parseState=4}if(4===this.parseState&&(this.mask?e.length>=4&&(e.joinInto(this.maskBytes,0,0,4),e.advance(4),this.parseState=5):this.parseState=5),5===this.parseState){if(this.length>this.maxReceivedFrameSize)return this.frameTooLarge=!0,this.dropReason="Frame size of "+this.length.toString(10)+" bytes exceeds maximum accepted frame size",!0;if(0===this.length)return this.binaryPayload=s(0),this.parseState=6,!0;if(e.length>=this.length)return this.binaryPayload=e.take(this.length),e.advance(this.length),this.mask&&n.unmask(this.binaryPayload,this.maskBytes),8===this.opcode&&(1===this.length&&(this.binaryPayload=s(0),this.invalidCloseFrameLength=!0),this.length>=2&&(this.closeStatus=this.binaryPayload.readUInt16BE(0),this.binaryPayload=this.binaryPayload.slice(2))),this.parseState=6,!0}return!1},o.prototype.throwAwayPayload=function(e){return e.length>=this.length&&(e.advance(this.length),this.parseState=6,!0)},o.prototype.toBuffer=function(e){var t,r,i,o=2,a=0,c=0;this.fin&&(a|=128),this.rsv1&&(a|=64),this.rsv2&&(a|=32),this.rsv3&&(a|=16),this.mask&&(c|=128),a|=15&this.opcode,8===this.opcode?(this.length=2,this.binaryPayload&&(this.length+=this.binaryPayload.length),(r=s(this.length)).writeUInt16BE(this.closeStatus,0),this.length>2&&this.binaryPayload.copy(r,2)):this.binaryPayload?(r=this.binaryPayload,this.length=r.length):this.length=0,this.length<=125?c|=127&this.length:this.length>125&&this.length<=65535?(c|=126,o+=2):this.length>65535&&(c|=127,o+=8);var h=s(this.length+o+(this.mask?4:0));return h[0]=a,h[1]=c,i=2,this.length>125&&this.length<=65535?(h.writeUInt16BE(this.length,i),i+=2):this.length>65535&&(h.writeUInt32BE(0,i),h.writeUInt32BE(this.length,i+4),i+=8),this.mask?(t=e?0:4294967295*Math.random()>>>0,this.maskBytes.writeUInt32BE(t,0),this.maskBytes.copy(h,i),i+=4,r&&n.mask(r,this.maskBytes,h,i,this.length)):r&&r.copy(h,i),h},o.prototype.toString=function(){return"Opcode: "+this.opcode+", fin: "+this.fin+", length: "+this.length+", hasPayload: "+Boolean(this.binaryPayload)+", masked: "+this.mask},e.exports=o},2776:(e,t,r)=>{for(var n=r(6113),s=r(3837),i=r(7310),o=r(2361).EventEmitter,a=r(1836),c=/,\s*/,h=/;\s*/,l=/[\r\n]/g,u=/,\s*/,d=["(",")","<",">","@",",",";",":","\\",'"',"/","[","]","?","=","{","}"," ",String.fromCharCode(9)],p=[String.fromCharCode(127)],f=0;f<31;f++)p.push(String.fromCharCode(f));var g=/([\x00-\x20\x22\x28\x29\x2c\x2f\x3a-\x3f\x40\x5b-\x5e\x7b\x7d\x7f])/,m=/[^\x21\x23-\x2b\x2d-\x3a\x3c-\x5b\x5d-\x7e]/,y=/^"[^"]*"$/,v=/[\x00-\x20\x3b]/g,w=/[;,] */,S={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",406:"Not Acceptable",407:"Proxy Authorization Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Long",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};function b(e,t,r){o.call(this),this.socket=e,this.httpRequest=t,this.resource=t.url,this.remoteAddress=e.remoteAddress,this.remoteAddresses=[this.remoteAddress],this.serverConfig=r,this._socketIsClosing=!1,this._socketCloseHandler=this._handleSocketCloseBeforeAccept.bind(this),this.socket.on("end",this._socketCloseHandler),this.socket.on("close",this._socketCloseHandler),this._resolved=!1}function E(e){process.nextTick((function(){e.drop(1006,"TCP connection lost before handshake completed.",!0)}))}s.inherits(b,o),b.prototype.readHandshake=function(){var e=this,t=this.httpRequest;if(this.resourceURL=i.parse(this.resource,!0),this.host=t.headers.host,!this.host)throw new Error("Client must provide a Host header.");if(this.key=t.headers["sec-websocket-key"],!this.key)throw new Error("Client must provide a value for Sec-WebSocket-Key.");if(this.webSocketVersion=parseInt(t.headers["sec-websocket-version"],10),!this.webSocketVersion||isNaN(this.webSocketVersion))throw new Error("Client must provide a value for Sec-WebSocket-Version.");switch(this.webSocketVersion){case 8:case 13:break;default:var r=new Error("Unsupported websocket client version: "+this.webSocketVersion+"Only versions 8 and 13 are supported.");throw r.httpCode=426,r.headers={"Sec-WebSocket-Version":"13"},r}13===this.webSocketVersion?this.origin=t.headers.origin:8===this.webSocketVersion&&(this.origin=t.headers["sec-websocket-origin"]);var n=t.headers["sec-websocket-protocol"];if(this.protocolFullCaseMap={},this.requestedProtocols=[],n&&n.split(c).forEach((function(t){var r=t.toLocaleLowerCase();e.requestedProtocols.push(r),e.protocolFullCaseMap[r]=t})),!this.serverConfig.ignoreXForwardedFor&&t.headers["x-forwarded-for"]){var s=this.remoteAddress;this.remoteAddresses=t.headers["x-forwarded-for"].split(u),this.remoteAddresses.push(s),this.remoteAddress=this.remoteAddresses[0]}if(this.serverConfig.parseExtensions){var o=t.headers["sec-websocket-extensions"];this.requestedExtensions=this.parseExtensions(o)}else this.requestedExtensions=[];if(this.serverConfig.parseCookies){var a=t.headers.cookie;this.cookies=this.parseCookies(a)}else this.cookies=[]},b.prototype.parseExtensions=function(e){if(!e||0===e.length)return[];var t=e.toLocaleLowerCase().split(c);return t.forEach((function(e,t,r){var n=e.split(h),s=n[0],i=n.slice(1);i.forEach((function(e,t,r){var n=e.split("="),s={name:n[0],value:n[1]};r.splice(t,1,s)}));var o={name:s,params:i};r.splice(t,1,o)})),t},b.prototype.parseCookies=function(e){if(!e||"string"!=typeof e)return[];var t=[];return e.split(w).forEach((function(e){var r=e.indexOf("=");if(-1!==r){var n=e.substr(0,r).trim(),s=e.substr(++r,e.length).trim();'"'===s[0]&&(s=s.slice(1,-1)),t.push({name:n,value:decodeURIComponent(s)})}else t.push({name:e,value:null})})),t},b.prototype.accept=function(e,t,r){var s;this._verifyResolution(),e?void 0===(s=this.protocolFullCaseMap[e.toLocaleLowerCase()])&&(s=e):s=e,this.protocolFullCaseMap=null;var i=n.createHash("sha1");i.update(this.key+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");var o="HTTP/1.1 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Accept: "+i.digest("base64")+"\r\n";if(s){for(var c=0;c<s.length;c++){var h=s.charCodeAt(c),u=s.charAt(c);if(h<33||h>126||-1!==d.indexOf(u))throw this.reject(500),new Error('Illegal character "'+String.fromCharCode(u)+'" in subprotocol.')}if(-1===this.requestedProtocols.indexOf(e))throw this.reject(500),new Error("Specified protocol was not requested by the client.");s=s.replace(l,""),o+="Sec-WebSocket-Protocol: "+s+"\r\n"}if(this.requestedProtocols=null,t&&(t=t.replace(l,""),13===this.webSocketVersion?o+="Origin: "+t+"\r\n":8===this.webSocketVersion&&(o+="Sec-WebSocket-Origin: "+t+"\r\n")),r){if(!Array.isArray(r))throw this.reject(500),new Error('Value supplied for "cookies" argument must be an array.');var p={};r.forEach(function(e){if(!e.name||!e.value)throw this.reject(500),new Error('Each cookie to set must at least provide a "name" and "value"');if(e.name=e.name.replace(v,""),e.value=e.value.replace(v,""),p[e.name])throw this.reject(500),new Error("You may not specify the same cookie name twice.");p[e.name]=!0;var t=e.name.match(g);if(t)throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie name");if(t=e.value.match(y)?e.value.slice(1,-1).match(m):e.value.match(m))throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie value");var r=[e.name+"="+e.value];if(e.path){if(t=e.path.match(v))throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie path");r.push("Path="+e.path)}if(e.domain){if("string"!=typeof e.domain)throw this.reject(500),new Error("Domain must be specified and must be a string.");if(t=e.domain.match(v))throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie domain");r.push("Domain="+e.domain.toLowerCase())}if(e.expires){if(!(e.expires instanceof Date))throw this.reject(500),new Error('Value supplied for cookie "expires" must be a vaild date object');r.push("Expires="+e.expires.toGMTString())}if(e.maxage){var n=e.maxage;if("string"==typeof n&&(n=parseInt(n,10)),isNaN(n)||n<=0)throw this.reject(500),new Error('Value supplied for cookie "maxage" must be a non-zero number');n=Math.round(n),r.push("Max-Age="+n.toString(10))}if(e.secure){if("boolean"!=typeof e.secure)throw this.reject(500),new Error('Value supplied for cookie "secure" must be of type boolean');r.push("Secure")}if(e.httponly){if("boolean"!=typeof e.httponly)throw this.reject(500),new Error('Value supplied for cookie "httponly" must be of type boolean');r.push("HttpOnly")}o+="Set-Cookie: "+r.join(";")+"\r\n"}.bind(this))}this._resolved=!0,this.emit("requestResolved",this),o+="\r\n";var f=new a(this.socket,[],e,!1,this.serverConfig);f.webSocketVersion=this.webSocketVersion,f.remoteAddress=this.remoteAddress,f.remoteAddresses=this.remoteAddresses;var w=this;return this._socketIsClosing?E(f):this.socket.write(o,"ascii",(function(e){e?E(f):(w._removeSocketCloseListeners(),f._addSocketEventListeners())})),this.emit("requestAccepted",f),f},b.prototype.reject=function(e,t,r){this._verifyResolution(),this._resolved=!0,this.emit("requestResolved",this),"number"!=typeof e&&(e=403);var n="HTTP/1.1 "+e+" "+S[e]+"\r\nConnection: close\r\n";if(t&&(n+="X-WebSocket-Reject-Reason: "+(t=t.replace(l,""))+"\r\n"),r)for(var s in r){var i=r[s].toString().replace(l,"");n+=s.replace(l,"")+": "+i+"\r\n"}n+="\r\n",this.socket.end(n,"ascii"),this.emit("requestRejected",this)},b.prototype._handleSocketCloseBeforeAccept=function(){this._socketIsClosing=!0,this._removeSocketCloseListeners()},b.prototype._removeSocketCloseListeners=function(){this.socket.removeListener("end",this._socketCloseHandler),this.socket.removeListener("close",this._socketCloseHandler)},b.prototype._verifyResolution=function(){if(this._resolved)throw new Error("WebSocketRequest may only be accepted or rejected one time.")},e.exports=b},8529:(e,t,r)=>{var n=r(4636).extend,s=r(3837),i=r(2361).EventEmitter,o=r(3404);function a(e){i.call(this),this.config={server:null},e&&n(this.config,e),this.handlers=[],this._requestHandler=this.handleRequest.bind(this),this.config.server&&this.attachServer(this.config.server)}s.inherits(a,i),a.prototype.attachServer=function(e){if(!e)throw new Error("You must specify a WebSocketServer instance to attach to.");this.server=e,this.server.on("request",this._requestHandler)},a.prototype.detachServer=function(){if(!this.server)throw new Error("Cannot detach from server: not attached.");this.server.removeListener("request",this._requestHandler),this.server=null},a.prototype.mount=function(e,t,r){if(!e)throw new Error("You must specify a path for this handler.");if(t||(t="____no_protocol____"),!r)throw new Error("You must specify a callback for this handler.");if(!((e=this.pathToRegExp(e))instanceof RegExp))throw new Error("Path must be specified as either a string or a RegExp.");var n=e.toString();if(t=t.toLocaleLowerCase(),-1!==this.findHandlerIndex(n,t))throw new Error("You may only mount one handler per path/protocol combination.");this.handlers.push({path:e,pathString:n,protocol:t,callback:r})},a.prototype.unmount=function(e,t){var r=this.findHandlerIndex(this.pathToRegExp(e).toString(),t);if(-1===r)throw new Error("Unable to find a route matching the specified path and protocol.");this.handlers.splice(r,1)},a.prototype.findHandlerIndex=function(e,t){t=t.toLocaleLowerCase();for(var r=0,n=this.handlers.length;r<n;r++){var s=this.handlers[r];if(s.pathString===e&&s.protocol===t)return r}return-1},a.prototype.pathToRegExp=function(e){return"string"==typeof e&&("*"===e?e=/^.*$/:(e=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),e=new RegExp("^"+e+"$"))),e},a.prototype.handleRequest=function(e){var t=e.requestedProtocols;0===t.length&&(t=["____no_protocol____"]);for(var r=0;r<t.length;r++)for(var n=t[r].toLocaleLowerCase(),s=0,i=this.handlers.length;s<i;s++){var a=this.handlers[s];if(a.path.test(e.resourceURL.pathname)&&(n===a.protocol||"*"===a.protocol)){var c=new o(e,n);return void a.callback(c)}}e.reject(404,"No handler is available for the given request.")},e.exports=a},3404:(e,t,r)=>{var n=r(3837),s=r(2361).EventEmitter;function i(e,t){s.call(this),this.webSocketRequest=e,this.protocol="____no_protocol____"===t?null:t,this.origin=e.origin,this.resource=e.resource,this.resourceURL=e.resourceURL,this.httpRequest=e.httpRequest,this.remoteAddress=e.remoteAddress,this.webSocketVersion=e.webSocketVersion,this.requestedExtensions=e.requestedExtensions,this.cookies=e.cookies}n.inherits(i,s),i.prototype.accept=function(e,t){var r=this.webSocketRequest.accept(this.protocol,e,t);return this.emit("requestAccepted",r),r},i.prototype.reject=function(e,t,r){this.webSocketRequest.reject(e,t,r),this.emit("requestRejected",this)},e.exports=i},1051:(e,t,r)=>{var n=r(4636).extend,s=r(4636),i=r(3837),o=r(6565)("websocket:server"),a=r(2361).EventEmitter,c=r(2776),h=function(e){a.call(this),this._handlers={upgrade:this.handleUpgrade.bind(this),requestAccepted:this.handleRequestAccepted.bind(this),requestResolved:this.handleRequestResolved.bind(this)},this.connections=[],this.pendingRequests=[],e&&this.mount(e)};i.inherits(h,a),h.prototype.mount=function(e){if(this.config={httpServer:null,maxReceivedFrameSize:65536,maxReceivedMessageSize:1048576,fragmentOutgoingMessages:!0,fragmentationThreshold:16384,keepalive:!0,keepaliveInterval:2e4,dropConnectionOnKeepaliveTimeout:!0,keepaliveGracePeriod:1e4,useNativeKeepalive:!1,assembleFragments:!0,autoAcceptConnections:!1,ignoreXForwardedFor:!1,parseCookies:!0,parseExtensions:!0,disableNagleAlgorithm:!0,closeTimeout:5e3},n(this.config,e),!this.config.httpServer)throw new Error("You must specify an httpServer on which to mount the WebSocket server.");Array.isArray(this.config.httpServer)||(this.config.httpServer=[this.config.httpServer]);var t=this._handlers.upgrade;this.config.httpServer.forEach((function(e){e.on("upgrade",t)}))},h.prototype.unmount=function(){var e=this._handlers.upgrade;this.config.httpServer.forEach((function(t){t.removeListener("upgrade",e)}))},h.prototype.closeAllConnections=function(){this.connections.forEach((function(e){e.close()})),this.pendingRequests.forEach((function(e){process.nextTick((function(){e.reject(503)}))}))},h.prototype.broadcast=function(e){Buffer.isBuffer(e)?this.broadcastBytes(e):"function"==typeof e.toString&&this.broadcastUTF(e)},h.prototype.broadcastUTF=function(e){this.connections.forEach((function(t){t.sendUTF(e)}))},h.prototype.broadcastBytes=function(e){this.connections.forEach((function(t){t.sendBytes(e)}))},h.prototype.shutDown=function(){this.unmount(),this.closeAllConnections()},h.prototype.handleUpgrade=function(e,t){var r=this,n=new c(t,e,this.config);try{n.readHandshake()}catch(e){return n.reject(e.httpCode?e.httpCode:400,e.message,e.headers),o("Invalid handshake: %s",e.message),void this.emit("upgradeError",e)}this.pendingRequests.push(n),n.once("requestAccepted",this._handlers.requestAccepted),n.once("requestResolved",this._handlers.requestResolved),t.once("close",(function(){r._handlers.requestResolved(n)})),!this.config.autoAcceptConnections&&s.eventEmitterListenerCount(this,"request")>0?this.emit("request",n):this.config.autoAcceptConnections?n.accept(n.requestedProtocols[0],n.origin):n.reject(404,"No handler is configured to accept the connection.")},h.prototype.handleRequestAccepted=function(e){var t=this;e.once("close",(function(r,n){t.handleConnectionClose(e,r,n)})),this.connections.push(e),this.emit("connect",e)},h.prototype.handleConnectionClose=function(e,t,r){var n=this.connections.indexOf(e);-1!==n&&this.connections.splice(n,1),this.emit("close",e,t,r)},h.prototype.handleRequestResolved=function(e){var t=this.pendingRequests.indexOf(e);-1!==t&&this.pendingRequests.splice(t,1)},e.exports=h},4636:(e,t,r)=>{var n=t.noop=function(){};function s(e,t,r){this.logFunction=r,this.identifier=e,this.uniqueID=t,this.buffer=[]}t.extend=function(e,t){for(var r in t)e[r]=t[r]},t.eventEmitterListenerCount=r(2361).EventEmitter.listenerCount||function(e,t){return e.listeners(t).length},t.bufferAllocUnsafe=Buffer.allocUnsafe?Buffer.allocUnsafe:function(e){return new Buffer(e)},t.bufferFromString=Buffer.from?Buffer.from:function(e,t){return new Buffer(e,t)},t.BufferingLogger=function(e,t){var i=r(6565)(e);if(i.enabled){var o=new s(e,t,i),a=o.log.bind(o);return a.printOutput=o.printOutput.bind(o),a.enabled=i.enabled,a}return i.printOutput=n,i},s.prototype.log=function(){return this.buffer.push([new Date,Array.prototype.slice.call(arguments)]),this},s.prototype.clear=function(){return this.buffer=[],this},s.prototype.printOutput=function(e){e||(e=this.logFunction);var t=this.uniqueID;this.buffer.forEach((function(r){var n=r[0].toLocaleString(),s=r[1].slice(),i=s[0];null!=i&&(i="%s - %s - "+i.toString(),s.splice(0,1,i,n,t),e.apply(global,s))}))}},9387:(e,t,r)=>{e.exports=r(9794).version},8287:(e,t,r)=>{e.exports={server:r(1051),client:r(6749),router:r(8529),frame:r(9650),request:r(2776),connection:r(1836),w3cwebsocket:r(4864),deprecation:r(1197),version:r(9387)}},6237:(e,t,r)=>{function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=r(7105)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var s=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(s++,"%c"===e&&(i=s))})),e.splice(i,0,n)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())},7105:(e,t,r)=>{var n;function s(e){function r(){if(r.enabled){var e=r,s=+new Date,i=s-(n||s);e.diff=i,e.prev=n,e.curr=s,n=s;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var c=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;c++;var s=t.formatters[n];if("function"==typeof s){var i=o[c];r=s.call(e,i),o.splice(c,1),c--}return r})),t.formatArgs.call(e,o),(r.log||t.log||console.log.bind(console)).apply(e,o)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=s.debug=s.default=s).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length,s=0;s<n;s++)r[s]&&("-"===(e=r[s].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(5079),t.names=[],t.skips=[],t.formatters={}},6565:(e,t,r)=>{"undefined"!=typeof process&&"renderer"===process.type?e.exports=r(6237):e.exports=r(6938)},6938:(e,t,r)=>{var n=r(6224),s=r(3837);(t=e.exports=r(7105)).init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(){return o.write(s.format.apply(s,arguments)+"\n")},t.formatArgs=function(e){var r=this.namespace;if(this.useColors){var n=this.color,s="  [3"+n+";1m"+r+" [0m";e[0]=s+e[0].split("\n").join("\n"+s),e.push("[3"+n+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=(new Date).toUTCString()+" "+r+" "+e[0]},t.save=function(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=a,t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(i)},t.colors=[6,2,3,4,5,1],t.inspectOpts=Object.keys(process.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{});var i=parseInt(process.env.DEBUG_FD,10)||2;1!==i&&2!==i&&s.deprecate((function(){}),"except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)")();var o=1===i?process.stdout:2===i?process.stderr:function(e){var t;switch(process.binding("tty_wrap").guessHandleType(e)){case"TTY":(t=new n.WriteStream(e))._type="tty",t._handle&&t._handle.unref&&t._handle.unref();break;case"FILE":(t=new(r(7147).SyncWriteStream)(e,{autoClose:!1}))._type="fs";break;case"PIPE":case"TCP":(t=new(r(1808).Socket)({fd:e,readable:!1,writable:!0})).readable=!1,t.read=null,t._type="pipe",t._handle&&t._handle.unref&&t._handle.unref();break;default:throw new Error("Implement me. Unknown stream file type!")}return t.fd=e,t._isStdio=!0,t}(i);function a(){return process.env.DEBUG}t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts).split("\n").map((function(e){return e.trim()})).join(" ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts)},t.enable(a())},5079:e=>{var t=1e3,r=60*t,n=60*r,s=24*n;function i(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,o){o=o||{};var a,c=typeof e;if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(i){var o=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*n;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if("number"===c&&!1===isNaN(e))return o.long?i(a=e,s,"day")||i(a,n,"hour")||i(a,r,"minute")||i(a,t,"second")||a+" ms":function(e){return e>=s?Math.round(e/s)+"d":e>=n?Math.round(e/n)+"h":e>=r?Math.round(e/r)+"m":e>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},6748:(e,t,r)=>{var n=r(4300).Buffer,s=r(2361).EventEmitter,i=r(4636).bufferAllocUnsafe;function o(e){if(!(this instanceof o))return new o(e);s.call(this);var t=this;void 0===e&&(e={}),t.encoding=e.encoding;var r={next:null,buffer:null},a={next:null,buffer:null},c=0;t.__defineGetter__("length",(function(){return c}));var h=0;t.write=function(e){return r.buffer?(a.next={next:null,buffer:e},a=a.next):(r.buffer=e,a=r),c+=e.length,t.emit("write",e),!0},t.end=function(e){n.isBuffer(e)&&t.write(e)},t.push=function(){return[].concat.apply([],arguments).forEach(t.write),t},t.forEach=function(e){if(!r.buffer)return i(0);if(r.buffer.length-h<=0)return t;for(var n={buffer:r.buffer.slice(h),next:r.next};n&&n.buffer&&!e(n.buffer);)n=n.next;return t},t.join=function(e,n){if(!r.buffer)return i(0);null==e&&(e=0),null==n&&(n=t.length);var s=i(n-e),o=0;return t.forEach((function(t){if(e<o+t.length&&o<n&&t.copy(s,Math.max(0,o-e),Math.max(0,e-o),Math.min(t.length,n-o)),(o+=t.length)>n)return!0})),s},t.joinInto=function(e,n,s,o){if(!r.buffer)return new i(0);null==s&&(s=0),null==o&&(o=t.length);var a=e;if(a.length-n<o-s)throw new Error("Insufficient space available in target Buffer.");var c=0;return t.forEach((function(e){if(s<c+e.length&&c<o&&e.copy(a,Math.max(n,n+c-s),Math.max(0,s-c),Math.min(e.length,o-c)),(c+=e.length)>o)return!0})),a},t.advance=function(e){for(h+=e,c-=e;r.buffer&&h>=r.buffer.length;)h-=r.buffer.length,r=r.next?r.next:{buffer:null,next:null};return null===r.buffer&&(a={next:null,buffer:null}),t.emit("advance",e),t},t.take=function(e,r){if(null==e?e=t.length:"number"!=typeof e&&(r=e,e=t.length),r||(r=t.encoding),r){var n="";return t.forEach((function(t){if(e<=0)return!0;n+=t.toString(r,0,Math.min(e,t.length)),e-=t.length})),n}return t.join(0,e)},t.toString=function(){return t.take("binary")}}e.exports=o,e.exports.BufferList=o,r(3837).inherits(o,s)},8653:(e,t,r)=>{e.exports={EventTarget:r(9017),Event:r(9861)}},9861:e=>{e.exports=function(e){this.type=e,this.isTrusted=!1,this._yaeti=!0}},9017:e=>{function t(){"function"!=typeof this.addEventListener&&(this._listeners={},this.addEventListener=r,this.removeEventListener=n,this.dispatchEvent=s)}function r(e,t){var r,n,s;if(e&&t){for(void 0===(r=this._listeners[e])&&(this._listeners[e]=r=[]),n=0;s=r[n];n++)if(s===t)return;r.push(t)}}function n(e,t){var r,n,s;if(e&&t&&void 0!==(r=this._listeners[e])){for(n=0;s=r[n];n++)if(s===t){r.splice(n,1);break}0===r.length&&delete this._listeners[e]}}function s(e){var t,r,n,s,i,o=!1;if(!e||"string"!=typeof e.type)throw new Error("`event` must have a valid `type` property");e._yaeti&&(e.target=this,e.cancelable=!0);try{e.stopImmediatePropagation=function(){o=!0}}catch(e){}for(t=e.type,r=this._listeners[t]||[],"function"==typeof(n=this["on"+t])&&n.call(this,e),s=0;(i=r[s])&&!o;s++)i.call(this,e);return!e.defaultPrevented}e.exports=t,Object.defineProperties(t.prototype,{listeners:{get:function(){return this._listeners}}})},9496:e=>{"use strict";e.exports=require("vscode")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},2057:e=>{"use strict";e.exports=require("constants")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},7742:e=>{"use strict";e.exports=require("node:process")},2477:e=>{"use strict";e.exports=require("node:stream/web")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},1267:e=>{"use strict";e.exports=require("worker_threads")},9796:e=>{"use strict";e.exports=require("zlib")},7135:(e,t,r)=>{if(!globalThis.ReadableStream)try{const e=r(7742),{emitWarning:t}=e;try{e.emitWarning=()=>{},Object.assign(globalThis,r(2477)),e.emitWarning=t}catch(r){throw e.emitWarning=t,r}}catch(e){Object.assign(globalThis,r(2660))}try{const{Blob:e}=r(4300);e&&!e.prototype.stream&&(e.prototype.stream=function(e){let t=0;const r=this;return new ReadableStream({type:"bytes",async pull(e){const n=r.slice(t,Math.min(r.size,t+65536)),s=await n.arrayBuffer();t+=s.byteLength,e.enqueue(new Uint8Array(s)),t===r.size&&e.close()}})})}catch(e){}},7923:(e,t,r)=>{"use strict";function n(e,t){return t?t.aborted?Promise.resolve(void 0):new Promise((r=>{const n=s(e,(e=>{t.removeEventListener("abort",i),r(e)})),i=()=>{n.dispose(),t.removeEventListener("abort",i),r(void 0)};t.addEventListener("abort",i)})):new Promise((t=>s(e,t)))}r.r(t),r.d(t,{EventEmitter:()=>i,once:()=>s,toPromise:()=>n});const s=(e,t)=>{const r=e((e=>{t(e),r.dispose()}));return r};class i{constructor(){this.event=(e,t,r)=>{const n=this.add(t?e.bind(t):e);return r?.push(n),n}}get size(){return this.listeners?"function"==typeof this.listeners?1:this.listeners.length:0}fire(e){if(this.listeners)if("function"==typeof this.listeners)this.listeners(e);else for(const t of this.listeners)t(e)}dispose(){this.listeners=void 0}add(e){return this.listeners?"function"==typeof this.listeners?this.listeners=[this.listeners,e]:this.listeners.push(e):this.listeners=e,{dispose:()=>this.rm(e)}}rm(e){if(!this.listeners)return;if("function"==typeof this.listeners)return void(this.listeners===e&&(this.listeners=void 0));const t=this.listeners.indexOf(e);-1!==t&&(2===this.listeners.length?this.listeners=0===t?this.listeners[1]:this.listeners[0]:this.listeners=this.listeners.slice(0,t).concat(this.listeners.slice(t+1)))}}},9676:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DataViewIndexOutOfBoundsError:()=>K,DecodeError:()=>b,Decoder:()=>z,EXT_TIMESTAMP:()=>E,Encoder:()=>O,ExtData:()=>w,ExtensionCodec:()=>M,decode:()=>G,decodeArrayStream:()=>ne,decodeAsync:()=>re,decodeMulti:()=>Y,decodeMultiStream:()=>se,decodeStream:()=>ie,decodeTimestampExtension:()=>A,decodeTimestampToTimeSpec:()=>x,encode:()=>q,encodeDateToTimeSpec:()=>_,encodeTimeSpecToTimestamp:()=>R,encodeTimestampExtension:()=>P});var n,s,i,o=4294967295;function a(e,t,r){var n=Math.floor(r/4294967296),s=r;e.setUint32(t,n),e.setUint32(t+4,s)}function c(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var h=("undefined"==typeof process||"never"!==(null===(n=null===process||void 0===process?void 0:process.env)||void 0===n?void 0:n.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function l(e){for(var t=e.length,r=0,n=0;n<t;){var s=e.charCodeAt(n++);if(0!=(4294967168&s))if(0==(4294965248&s))r+=2;else{if(s>=55296&&s<=56319&&n<t){var i=e.charCodeAt(n);56320==(64512&i)&&(++n,s=((1023&s)<<10)+(1023&i)+65536)}r+=0==(4294901760&s)?3:4}else r++}return r}var u=h?new TextEncoder:void 0,d=h?"undefined"!=typeof process&&"force"!==(null===(s=null===process||void 0===process?void 0:process.env)||void 0===s?void 0:s.TEXT_ENCODING)?200:0:o,p=(null==u?void 0:u.encodeInto)?function(e,t,r){u.encodeInto(e,t.subarray(r))}:function(e,t,r){t.set(u.encode(e),r)},f=4096;function g(e,t,r){for(var n=t,s=n+r,i=[],o="";n<s;){var a=e[n++];if(0==(128&a))i.push(a);else if(192==(224&a)){var c=63&e[n++];i.push((31&a)<<6|c)}else if(224==(240&a)){c=63&e[n++];var h=63&e[n++];i.push((31&a)<<12|c<<6|h)}else if(240==(248&a)){var l=(7&a)<<18|(c=63&e[n++])<<12|(h=63&e[n++])<<6|63&e[n++];l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|1023&l),i.push(l)}else i.push(a);i.length>=f&&(o+=String.fromCharCode.apply(String,i),i.length=0)}return i.length>0&&(o+=String.fromCharCode.apply(String,i)),o}var m,y=h?new TextDecoder:null,v=h?"undefined"!=typeof process&&"force"!==(null===(i=null===process||void 0===process?void 0:process.env)||void 0===i?void 0:i.TEXT_DECODER)?200:0:o,w=function(e,t){this.type=e,this.data=t},S=(m=function(e,t){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},m(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),b=function(e){function t(r){var n=e.call(this,r)||this,s=Object.create(t.prototype);return Object.setPrototypeOf(n,s),Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:t.name}),n}return S(t,e),t}(Error),E=-1,C=4294967295,T=17179869183;function R(e){var t,r=e.sec,n=e.nsec;if(r>=0&&n>=0&&r<=T){if(0===n&&r<=C){var s=new Uint8Array(4);return(t=new DataView(s.buffer)).setUint32(0,r),s}var i=r/4294967296,o=4294967295&r;return s=new Uint8Array(8),(t=new DataView(s.buffer)).setUint32(0,n<<2|3&i),t.setUint32(4,o),s}return s=new Uint8Array(12),(t=new DataView(s.buffer)).setUint32(0,n),a(t,4,r),s}function _(e){var t=e.getTime(),r=Math.floor(t/1e3),n=1e6*(t-1e3*r),s=Math.floor(n/1e9);return{sec:r+s,nsec:n-1e9*s}}function P(e){return e instanceof Date?R(_(e)):null}function x(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var r=t.getUint32(0);return{sec:4294967296*(3&r)+t.getUint32(4),nsec:r>>>2};case 12:return{sec:c(t,4),nsec:t.getUint32(0)};default:throw new b("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}function A(e){var t=x(e);return new Date(1e3*t.sec+t.nsec/1e6)}var k={type:E,encode:P,decode:A},M=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(k)}return e.prototype.register=function(e){var t=e.type,r=e.encode,n=e.decode;if(t>=0)this.encoders[t]=r,this.decoders[t]=n;else{var s=1+t;this.builtInEncoders[s]=r,this.builtInDecoders[s]=n}},e.prototype.tryToEncode=function(e,t){for(var r=0;r<this.builtInEncoders.length;r++)if(null!=(n=this.builtInEncoders[r])&&null!=(s=n(e,t)))return new w(-1-r,s);for(r=0;r<this.encoders.length;r++){var n,s;if(null!=(n=this.encoders[r])&&null!=(s=n(e,t)))return new w(r,s)}return e instanceof w?e:null},e.prototype.decode=function(e,t,r){var n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,r):new w(t,e)},e.defaultCodec=new e,e}();function I(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var O=function(){function e(e,t,r,n,s,i,o,a){void 0===e&&(e=M.defaultCodec),void 0===t&&(t=void 0),void 0===r&&(r=100),void 0===n&&(n=2048),void 0===s&&(s=!1),void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===a&&(a=!1),this.extensionCodec=e,this.context=t,this.maxDepth=r,this.initialBufferSize=n,this.sortKeys=s,this.forceFloat32=i,this.ignoreUndefined=o,this.forceIntegerToFloat=a,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),r=new Uint8Array(t),n=new DataView(t);r.set(this.bytes),this.view=n,this.bytes=r},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>d){var t=l(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),p(e,this.bytes,this.pos),this.pos+=t}else t=l(e),this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,r){for(var n=e.length,s=r,i=0;i<n;){var o=e.charCodeAt(i++);if(0!=(4294967168&o)){if(0==(4294965248&o))t[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<n){var a=e.charCodeAt(i);56320==(64512&a)&&(++i,o=((1023&o)<<10)+(1023&a)+65536)}0==(4294901760&o)?(t[s++]=o>>12&15|224,t[s++]=o>>6&63|128):(t[s++]=o>>18&7|240,t[s++]=o>>12&63|128,t[s++]=o>>6&63|128)}t[s++]=63&o|128}else t[s++]=o}}(e,this.bytes,this.pos),this.pos+=t},e.prototype.encodeObject=function(e,t){var r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var r=I(e);this.writeU8a(r)},e.prototype.encodeArray=function(e,t){var r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large array: ".concat(r));this.writeU8(221),this.writeU32(r)}for(var n=0,s=e;n<s.length;n++){var i=s[n];this.doEncode(i,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var r=0,n=0,s=t;n<s.length;n++)void 0!==e[s[n]]&&r++;return r},e.prototype.encodeMap=function(e,t){var r=Object.keys(e);this.sortKeys&&r.sort();var n=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large map object: ".concat(n));this.writeU8(223),this.writeU32(n)}for(var s=0,i=r;s<i.length;s++){var o=i[s],a=e[o];this.ignoreUndefined&&void 0===a||(this.encodeString(o),this.doEncode(a,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: ".concat(t));this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,r){var n=r/4294967296,s=r;e.setUint32(t,n),e.setUint32(t+4,s)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),a(this.view,this.pos,e),this.pos+=8},e}(),B={};function q(e,t){return void 0===t&&(t=B),new O(t.extensionCodec,t.context,t.maxDepth,t.initialBufferSize,t.sortKeys,t.forceFloat32,t.ignoreUndefined,t.forceIntegerToFloat).encodeSharedRef(e)}function F(e){return"".concat(e<0?"-":"","0x").concat(Math.abs(e).toString(16).padStart(2,"0"))}var L=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var r=0;r<this.maxKeyLength;r++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,r){e:for(var n=0,s=this.caches[r-1];n<s.length;n++){for(var i=s[n],o=i.bytes,a=0;a<r;a++)if(o[a]!==e[t+a])continue e;return i.str}return null},e.prototype.store=function(e,t){var r=this.caches[e.length-1],n={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=n:r.push(n)},e.prototype.decode=function(e,t,r){var n=this.find(e,t,r);if(null!=n)return this.hit++,n;this.miss++;var s=g(e,t,r),i=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(i,s),s},e}(),D=function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},N=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,s){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,s,(t=e[r](t)).done,t.value)}))}}},j=function(e){return this instanceof j?(this.v=e,this):new j(e)},$=new DataView(new ArrayBuffer(0)),U=new Uint8Array($.buffer),K=function(){try{$.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),W=new K("Insufficient data"),H=new L,z=function(){function e(e,t,r,n,s,i,a,c){void 0===e&&(e=M.defaultCodec),void 0===t&&(t=void 0),void 0===r&&(r=o),void 0===n&&(n=o),void 0===s&&(s=o),void 0===i&&(i=o),void 0===a&&(a=o),void 0===c&&(c=H),this.extensionCodec=e,this.context=t,this.maxStrLength=r,this.maxBinLength=n,this.maxArrayLength=s,this.maxMapLength=i,this.maxExtLength=a,this.keyDecoder=c,this.totalPos=0,this.pos=0,this.view=$,this.bytes=U,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=I(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=I(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),r=I(e),n=new Uint8Array(t.length+r.length);n.set(t),n.set(r,t.length),this.setBuffer(n)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,r=this.pos;return new RangeError("Extra ".concat(t.byteLength-r," of ").concat(t.byteLength," byte(s) found at buffer[").concat(e,"]"))},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return D(this,(function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(e){var t,r,n,s,i,o,a,c;return i=this,o=void 0,c=function(){var i,o,a,c,h,l,u,d;return D(this,(function(p){switch(p.label){case 0:i=!1,p.label=1;case 1:p.trys.push([1,6,7,12]),t=N(e),p.label=2;case 2:return[4,t.next()];case 3:if((r=p.sent()).done)return[3,5];if(a=r.value,i)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{o=this.doDecodeSync(),i=!0}catch(e){if(!(e instanceof K))throw e}this.totalPos+=this.pos,p.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=p.sent(),n={error:c},[3,12];case 7:return p.trys.push([7,,10,11]),r&&!r.done&&(s=t.return)?[4,s.call(t)]:[3,9];case 8:p.sent(),p.label=9;case 9:return[3,11];case 10:if(n)throw n.error;return[7];case 11:return[7];case 12:if(i){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,o]}throw l=(h=this).headByte,u=h.pos,d=h.totalPos,new RangeError("Insufficient data in parsing ".concat(F(l)," at ").concat(d," (").concat(u," in the current buffer)"))}}))},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{s(c.next(e))}catch(e){t(e)}}function n(e){try{s(c.throw(e))}catch(e){t(e)}}function s(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(r,n)}s((c=c.apply(i,o||[])).next())}))},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(e,t||[]),i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){s[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=s[e](t)).value instanceof j?Promise.resolve(r.value.v).then(c,h):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){a("next",e)}function h(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}(this,arguments,(function(){var r,n,s,i,o,a,c,h,l;return D(this,(function(u){switch(u.label){case 0:r=t,n=-1,u.label=1;case 1:u.trys.push([1,13,14,19]),s=N(e),u.label=2;case 2:return[4,j(s.next())];case 3:if((i=u.sent()).done)return[3,12];if(o=i.value,t&&0===n)throw this.createExtraByteError(this.totalPos);this.appendBuffer(o),r&&(n=this.readArraySize(),r=!1,this.complete()),u.label=4;case 4:u.trys.push([4,9,,10]),u.label=5;case 5:return[4,j(this.doDecodeSync())];case 6:return[4,u.sent()];case 7:return u.sent(),0==--n?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((a=u.sent())instanceof K))throw a;return[3,10];case 10:this.totalPos+=this.pos,u.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return c=u.sent(),h={error:c},[3,19];case 14:return u.trys.push([14,,17,18]),i&&!i.done&&(l=s.return)?[4,j(l.call(s))]:[3,16];case 15:u.sent(),u.label=16;case 16:return[3,18];case 17:if(h)throw h.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!=(n=e-128)){this.pushMapState(n),this.complete();continue e}t={}}else if(e<160){if(0!=(n=e-144)){this.pushArrayState(n),this.complete();continue e}t=[]}else{var r=e-160;t=this.decodeUtf8String(r,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.readI64();else if(217===e)r=this.lookU8(),t=this.decodeUtf8String(r,1);else if(218===e)r=this.lookU16(),t=this.decodeUtf8String(r,2);else if(219===e)r=this.lookU32(),t=this.decodeUtf8String(r,4);else if(220===e){if(0!==(n=this.readU16())){this.pushArrayState(n),this.complete();continue e}t=[]}else if(221===e){if(0!==(n=this.readU32())){this.pushArrayState(n),this.complete();continue e}t=[]}else if(222===e){if(0!==(n=this.readU16())){this.pushMapState(n),this.complete();continue e}t={}}else if(223===e){if(0!==(n=this.readU32())){this.pushMapState(n),this.complete();continue e}t={}}else if(196===e){var n=this.lookU8();t=this.decodeBinary(n,1)}else if(197===e)n=this.lookU16(),t=this.decodeBinary(n,2);else if(198===e)n=this.lookU32(),t=this.decodeBinary(n,4);else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e)n=this.lookU8(),t=this.decodeExtension(n,1);else if(200===e)n=this.lookU16(),t=this.decodeExtension(n,2);else{if(201!==e)throw new b("Unrecognized type byte: ".concat(F(e)));n=this.lookU32(),t=this.decodeExtension(n,4)}this.complete();for(var s=this.stack;s.length>0;){var i=s[s.length-1];if(0===i.type){if(i.array[i.position]=t,i.position++,i.position!==i.size)continue e;s.pop(),t=i.array}else{if(1===i.type){if(void 0,"string"!=(o=typeof t)&&"number"!==o)throw new b("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new b("The key __proto__ is not allowed");i.key=t,i.type=2;continue e}if(i.map[i.key]=t,i.readCount++,i.readCount!==i.size){i.key=null,i.type=1;continue e}s.pop(),t=i.map}}return t}var o},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new b("Unrecognized array type byte: ".concat(F(e)))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new b("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new b("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var r;if(e>this.maxStrLength)throw new b("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw W;var n,s=this.pos+t;return n=this.stateIsMapKey()&&(null===(r=this.keyDecoder)||void 0===r?void 0:r.canBeCached(e))?this.keyDecoder.decode(this.bytes,s,e):e>v?function(e,t,r){var n=e.subarray(t,t+r);return y.decode(n)}(this.bytes,s,e):g(this.bytes,s,e),this.pos+=t+e,n},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new b("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw W;var r=this.pos+t,n=this.bytes.subarray(r,r+e);return this.pos+=t+e,n},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new b("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var r=this.view.getInt8(this.pos+t),n=this.decodeBinary(e,t+1);return this.extensionCodec.decode(n,r,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,r=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,r},e.prototype.readI64=function(){var e=c(this.view,this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}(),V={};function G(e,t){return void 0===t&&(t=V),new z(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decode(e)}function Y(e,t){return void 0===t&&(t=V),new z(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeMulti(e)}var J=function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Q=function(e){return this instanceof Q?(this.v=e,this):new Q(e)},Z=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(e,t||[]),i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){s[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=s[e](t)).value instanceof Q?Promise.resolve(r.value.v).then(c,h):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){a("next",e)}function h(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}};function X(e){return null!=e[Symbol.asyncIterator]?e:function(e){return Z(this,arguments,(function(){var t,r,n,s;return J(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,Q(t.read())];case 3:return r=i.sent(),n=r.done,s=r.value,n?[4,Q(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return function(e){if(null==e)throw new Error("Assertion Failure: value must not be null nor undefined")}(s),[4,Q(s)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e)}var ee=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},te=function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};function re(e,t){return void 0===t&&(t=V),ee(this,void 0,void 0,(function(){var r;return te(this,(function(n){return r=X(e),[2,new z(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeAsync(r)]}))}))}function ne(e,t){void 0===t&&(t=V);var r=X(e);return new z(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeArrayStream(r)}function se(e,t){void 0===t&&(t=V);var r=X(e);return new z(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeStream(r)}function ie(e,t){return void 0===t&&(t=V),se(e,t)}},4193:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5006);const s=class extends n.Z{#e=0;#t="";constructor(e,t,r={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(e,r),null===r&&(r={});const n=void 0===r.lastModified?Date.now():Number(r.lastModified);Number.isNaN(n)||(this.#e=n),this.#t=String(t)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](e){return!!e&&e instanceof n.Z&&/^(File)$/.test(e[Symbol.toStringTag])}}},749:(e,t,r)=>{"use strict";r.d(t,{t6:()=>a.Z,$B:()=>o.Z,xB:()=>l,SX:()=>h,e2:()=>u,RA:()=>d});const n=require("node:fs"),s=require("node:path");var i=r(3414),o=r(4193),a=r(5006);const{stat:c}=n.promises,h=(e,t)=>p((0,n.statSync)(e),e,t),l=(e,t)=>c(e).then((r=>p(r,e,t))),u=(e,t)=>c(e).then((r=>f(r,e,t))),d=(e,t)=>f((0,n.statSync)(e),e,t),p=(e,t,r="")=>new a.Z([new g({path:t,size:e.size,lastModified:e.mtimeMs,start:0})],{type:r}),f=(e,t,r="")=>new o.Z([new g({path:t,size:e.size,lastModified:e.mtimeMs,start:0})],(0,s.basename)(t),{type:r,lastModified:e.mtimeMs});class g{#r;#n;constructor(e){this.#r=e.path,this.#n=e.start,this.size=e.size,this.lastModified=e.lastModified}slice(e,t){return new g({path:this.#r,lastModified:this.lastModified,size:t-e,start:this.#n+e})}async*stream(){const{mtimeMs:e}=await c(this.#r);if(e>this.lastModified)throw new i("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*(0,n.createReadStream)(this.#r,{start:this.#n,end:this.#n+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}},5006:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o}),r(7135);const n=65536;async function*s(e,t=!0){for(const r of e)if("stream"in r)yield*r.stream();else if(ArrayBuffer.isView(r))if(t){let e=r.byteOffset;const t=r.byteOffset+r.byteLength;for(;e!==t;){const s=Math.min(t-e,n),i=r.buffer.slice(e,e+s);e+=i.byteLength,yield new Uint8Array(i)}}else yield r;else{let e=0,t=r;for(;e!==t.size;){const r=t.slice(e,Math.min(t.size,e+n)),s=await r.arrayBuffer();e+=s.byteLength,yield new Uint8Array(s)}}}const i=class e{#s=[];#i="";#o=0;#a="transparent";constructor(t=[],r={}){if("object"!=typeof t||null===t)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if("function"!=typeof t[Symbol.iterator])throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if("object"!=typeof r&&"function"!=typeof r)throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");null===r&&(r={});const n=new TextEncoder;for(const r of t){let t;t=ArrayBuffer.isView(r)?new Uint8Array(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)):r instanceof ArrayBuffer?new Uint8Array(r.slice(0)):r instanceof e?r:n.encode(`${r}`),this.#o+=ArrayBuffer.isView(t)?t.byteLength:t.size,this.#s.push(t)}this.#a=`${void 0===r.endings?"transparent":r.endings}`;const s=void 0===r.type?"":String(r.type);this.#i=/^[\x20-\x7E]*$/.test(s)?s:""}get size(){return this.#o}get type(){return this.#i}async text(){const e=new TextDecoder;let t="";for await(const r of s(this.#s,!1))t+=e.decode(r,{stream:!0});return t+=e.decode(),t}async arrayBuffer(){const e=new Uint8Array(this.size);let t=0;for await(const r of s(this.#s,!1))e.set(r,t),t+=r.length;return e.buffer}stream(){const e=s(this.#s,!0);return new globalThis.ReadableStream({type:"bytes",async pull(t){const r=await e.next();r.done?t.close():t.enqueue(r.value)},async cancel(){await e.return()}})}slice(t=0,r=this.size,n=""){const{size:s}=this;let i=t<0?Math.max(s+t,0):Math.min(t,s),o=r<0?Math.max(s+r,0):Math.min(r,s);const a=Math.max(o-i,0),c=this.#s,h=[];let l=0;for(const e of c){if(l>=a)break;const t=ArrayBuffer.isView(e)?e.byteLength:e.size;if(i&&t<=i)i-=t,o-=t;else{let r;ArrayBuffer.isView(e)?(r=e.subarray(i,Math.min(t,o)),l+=r.byteLength):(r=e.slice(i,Math.min(t,o)),l+=r.size),o-=t,h.push(r),i=0}}const u=new e([],{type:String(n).toLowerCase()});return u.#o=a,u.#s=h,u}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](e){return e&&"object"==typeof e&&"function"==typeof e.constructor&&("function"==typeof e.stream||"function"==typeof e.arrayBuffer)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}};Object.defineProperties(i.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});const o=i},9951:(e,t,r)=>{"use strict";r.d(t,{Ct:()=>p,au:()=>f});var n=r(5006),s=r(4193),{toStringTag:i,iterator:o,hasInstance:a}=Symbol,c=Math.random,h="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),l=(e,t,r)=>(e+="",/^(Blob|File)$/.test(t&&t[i])?[(r=void 0!==r?r+"":"File"==t[i]?t.name:"blob",e),t.name!==r||"blob"==t[i]?new s.Z([t],r,t):t]:[e,t+""]),u=(e,t)=>(t?e:e.replace(/\r?\n|\r/g,"\r\n")).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),d=(e,t,r)=>{if(t.length<r)throw new TypeError(`Failed to execute '${e}' on 'FormData': ${r} arguments required, but only ${t.length} present.`)};const p=class{#c=[];constructor(...e){if(e.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[i](){return"FormData"}[o](){return this.entries()}static[a](e){return e&&"object"==typeof e&&"FormData"===e[i]&&!h.some((t=>"function"!=typeof e[t]))}append(...e){d("append",arguments,2),this.#c.push(l(...e))}delete(e){d("delete",arguments,1),e+="",this.#c=this.#c.filter((([t])=>t!==e))}get(e){d("get",arguments,1),e+="";for(var t=this.#c,r=t.length,n=0;n<r;n++)if(t[n][0]===e)return t[n][1];return null}getAll(e,t){return d("getAll",arguments,1),t=[],e+="",this.#c.forEach((r=>r[0]===e&&t.push(r[1]))),t}has(e){return d("has",arguments,1),e+="",this.#c.some((t=>t[0]===e))}forEach(e,t){for(var[r,n]of(d("forEach",arguments,1),this))e.call(t,n,r,this)}set(...e){d("set",arguments,2);var t=[],r=!0;e=l(...e),this.#c.forEach((n=>{n[0]===e[0]?r&&(r=!t.push(e)):t.push(n)})),r&&t.push(e),this.#c=t}*entries(){yield*this.#c}*keys(){for(var[e]of this)yield e}*values(){for(var[,e]of this)yield e}};function f(e,t=n.Z){var r=`${c()}${c()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],i=`--${r}\r\nContent-Disposition: form-data; name="`;return e.forEach(((e,t)=>"string"==typeof e?s.push(i+u(t)+`"\r\n\r\n${e.replace(/\r(?!\n)|(?<!\r)\n/g,"\r\n")}\r\n`):s.push(i+u(t)+`"; filename="${u(e.name,1)}"\r\nContent-Type: ${e.type||"application/octet-stream"}\r\n\r\n`,e,"\r\n"))),s.push(`--${r}--`),new t(s,{type:"multipart/form-data; boundary="+r})}},4126:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AbortError:()=>W,Blob:()=>H.t6,FetchError:()=>p,File:()=>H.$B,FormData:()=>u.Ct,Headers:()=>A,Request:()=>U,Response:()=>O,blobFrom:()=>H.xB,blobFromSync:()=>H.SX,default:()=>V,fileFrom:()=>H.e2,fileFromSync:()=>H.RA,isRedirect:()=>M});const n=require("node:http"),s=require("node:https"),i=require("node:zlib"),o=require("node:stream"),a=require("node:buffer"),c=function(e){if(!/^data:/i.test(e))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');const t=(e=e.replace(/\r?\n/g,"")).indexOf(",");if(-1===t||t<=4)throw new TypeError("malformed data: URI");const r=e.substring(5,t).split(";");let n="",s=!1;const i=r[0]||"text/plain";let o=i;for(let e=1;e<r.length;e++)"base64"===r[e]?s=!0:r[e]&&(o+=`;${r[e]}`,0===r[e].indexOf("charset=")&&(n=r[e].substring(8)));r[0]||n.length||(o+=";charset=US-ASCII",n="US-ASCII");const a=s?"base64":"ascii",c=unescape(e.substring(t+1)),h=Buffer.from(c,a);return h.type=i,h.typeFull=o,h.charset=n,h},h=require("node:util");var l=r(5006),u=r(9951);class d extends Error{constructor(e,t){super(e),Error.captureStackTrace(this,this.constructor),this.type=t}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}}class p extends d{constructor(e,t,r){super(e,t),r&&(this.code=this.errno=r.code,this.erroredSysCall=r.syscall)}}const f=Symbol.toStringTag,g=e=>"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&"function"==typeof e.sort&&"URLSearchParams"===e[f],m=e=>e&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&/^(Blob|File)$/.test(e[f]),y=(e,t)=>{const r=new URL(t).hostname,n=new URL(e).hostname;return r===n||r.endsWith(`.${n}`)},v=(e,t)=>new URL(t).protocol===new URL(e).protocol,w=(0,h.promisify)(o.pipeline),S=Symbol("Body internals");class b{constructor(e,{size:t=0}={}){let r=null;null===e?e=null:g(e)?e=a.Buffer.from(e.toString()):m(e)||a.Buffer.isBuffer(e)||(h.types.isAnyArrayBuffer(e)?e=a.Buffer.from(e):ArrayBuffer.isView(e)?e=a.Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof o||(e instanceof u.Ct?r=(e=(0,u.au)(e)).type.split("=")[1]:e=a.Buffer.from(String(e))));let n=e;a.Buffer.isBuffer(e)?n=o.Readable.from(e):m(e)&&(n=o.Readable.from(e.stream())),this[S]={body:e,stream:n,boundary:r,disturbed:!1,error:null},this.size=t,e instanceof o&&e.on("error",(e=>{const t=e instanceof d?e:new p(`Invalid response body while trying to fetch ${this.url}: ${e.message}`,"system",e);this[S].error=t}))}get body(){return this[S].stream}get bodyUsed(){return this[S].disturbed}async arrayBuffer(){const{buffer:e,byteOffset:t,byteLength:r}=await E(this);return e.slice(t,t+r)}async formData(){const e=this.headers.get("content-type");if(e.startsWith("application/x-www-form-urlencoded")){const e=new u.Ct,t=new URLSearchParams(await this.text());for(const[r,n]of t)e.append(r,n);return e}const{toFormData:t}=await r.e(713).then(r.bind(r,1713));return t(this.body,e)}async blob(){const e=this.headers&&this.headers.get("content-type")||this[S].body&&this[S].body.type||"",t=await this.arrayBuffer();return new l.Z([t],{type:e})}async json(){const e=await this.text();return JSON.parse(e)}async text(){const e=await E(this);return(new TextDecoder).decode(e)}buffer(){return E(this)}}async function E(e){if(e[S].disturbed)throw new TypeError(`body used already for: ${e.url}`);if(e[S].disturbed=!0,e[S].error)throw e[S].error;const{body:t}=e;if(null===t)return a.Buffer.alloc(0);if(!(t instanceof o))return a.Buffer.alloc(0);const r=[];let n=0;try{for await(const s of t){if(e.size>0&&n+s.length>e.size){const r=new p(`content size at ${e.url} over limit: ${e.size}`,"max-size");throw t.destroy(r),r}n+=s.length,r.push(s)}}catch(t){throw t instanceof d?t:new p(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t)}if(!0!==t.readableEnded&&!0!==t._readableState.ended)throw new p(`Premature close of server response while trying to fetch ${e.url}`);try{return r.every((e=>"string"==typeof e))?a.Buffer.from(r.join("")):a.Buffer.concat(r,n)}catch(t){throw new p(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t)}}b.prototype.buffer=(0,h.deprecate)(b.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer"),Object.defineProperties(b.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,h.deprecate)((()=>{}),"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});const C=(e,t)=>{let r,n,{body:s}=e[S];if(e.bodyUsed)throw new Error("cannot clone body after it is used");return s instanceof o&&"function"!=typeof s.getBoundary&&(r=new o.PassThrough({highWaterMark:t}),n=new o.PassThrough({highWaterMark:t}),s.pipe(r),s.pipe(n),e[S].stream=r,s=n),s},T=(0,h.deprecate)((e=>e.getBoundary()),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),R=(e,t)=>null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":g(e)?"application/x-www-form-urlencoded;charset=UTF-8":m(e)?e.type||null:a.Buffer.isBuffer(e)||h.types.isAnyArrayBuffer(e)||ArrayBuffer.isView(e)?null:e instanceof u.Ct?`multipart/form-data; boundary=${t[S].boundary}`:e&&"function"==typeof e.getBoundary?`multipart/form-data;boundary=${T(e)}`:e instanceof o?null:"text/plain;charset=UTF-8",_=async(e,{body:t})=>{null===t?e.end():await w(t,e)},P="function"==typeof n.validateHeaderName?n.validateHeaderName:e=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){const t=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},x="function"==typeof n.validateHeaderValue?n.validateHeaderValue:(e,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){const t=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_CHAR"}),t}};class A extends URLSearchParams{constructor(e){let t=[];if(e instanceof A){const r=e.raw();for(const[e,n]of Object.entries(r))t.push(...n.map((t=>[e,t])))}else if(null==e);else{if("object"!=typeof e||h.types.isBoxedPrimitive(e))throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");{const r=e[Symbol.iterator];if(null==r)t.push(...Object.entries(e));else{if("function"!=typeof r)throw new TypeError("Header pairs must be iterable");t=[...e].map((e=>{if("object"!=typeof e||h.types.isBoxedPrimitive(e))throw new TypeError("Each header pair must be an iterable object");return[...e]})).map((e=>{if(2!==e.length)throw new TypeError("Each header pair must be a name/value tuple");return[...e]}))}}}return t=t.length>0?t.map((([e,t])=>(P(e),x(e,String(t)),[String(e).toLowerCase(),String(t)]))):void 0,super(t),new Proxy(this,{get(e,t,r){switch(t){case"append":case"set":return(r,n)=>(P(r),x(r,String(n)),URLSearchParams.prototype[t].call(e,String(r).toLowerCase(),String(n)));case"delete":case"has":case"getAll":return r=>(P(r),URLSearchParams.prototype[t].call(e,String(r).toLowerCase()));case"keys":return()=>(e.sort(),new Set(URLSearchParams.prototype.keys.call(e)).keys());default:return Reflect.get(e,t,r)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(e){const t=this.getAll(e);if(0===t.length)return null;let r=t.join(", ");return/^content-encoding$/i.test(e)&&(r=r.toLowerCase()),r}forEach(e,t=undefined){for(const r of this.keys())Reflect.apply(e,t,[this.get(r),r,this])}*values(){for(const e of this.keys())yield this.get(e)}*entries(){for(const e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce(((e,t)=>(e[t]=this.getAll(t),e)),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce(((e,t)=>{const r=this.getAll(t);return e[t]="host"===t?r[0]:r.length>1?r:r[0],e}),{})}}Object.defineProperties(A.prototype,["get","entries","forEach","values"].reduce(((e,t)=>(e[t]={enumerable:!0},e)),{}));const k=new Set([301,302,303,307,308]),M=e=>k.has(e),I=Symbol("Response internals");class O extends b{constructor(e=null,t={}){super(e,t);const r=null!=t.status?t.status:200,n=new A(t.headers);if(null!==e&&!n.has("Content-Type")){const t=R(e,this);t&&n.append("Content-Type",t)}this[I]={type:"default",url:t.url,status:r,statusText:t.statusText||"",headers:n,counter:t.counter,highWaterMark:t.highWaterMark}}get type(){return this[I].type}get url(){return this[I].url||""}get status(){return this[I].status}get ok(){return this[I].status>=200&&this[I].status<300}get redirected(){return this[I].counter>0}get statusText(){return this[I].statusText}get headers(){return this[I].headers}get highWaterMark(){return this[I].highWaterMark}clone(){return new O(C(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(e,t=302){if(!M(t))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new O(null,{headers:{location:new URL(e).toString()},status:t})}static error(){const e=new O(null,{status:0,statusText:""});return e[I].type="error",e}static json(e=undefined,t={}){const r=JSON.stringify(e);if(void 0===r)throw new TypeError("data is not JSON serializable");const n=new A(t&&t.headers);return n.has("content-type")||n.set("content-type","application/json"),new O(r,{...t,headers:n})}get[Symbol.toStringTag](){return"Response"}}Object.defineProperties(O.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});const B=require("node:url"),q=require("node:net");function F(e,t=!1){return null==e?"no-referrer":(e=new URL(e),/^(about|blob|data):$/.test(e.protocol)?"no-referrer":(e.username="",e.password="",e.hash="",t&&(e.pathname="",e.search=""),e))}const L=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]);function D(e){return!!/^about:(blank|srcdoc)$/.test(e)||"data:"===e.protocol||!!/^(blob|filesystem):$/.test(e.protocol)||function(e){if(/^(http|ws)s:$/.test(e.protocol))return!0;const t=e.host.replace(/(^\[)|(]$)/g,""),r=(0,q.isIP)(t);return!(4!==r||!/^127\./.test(t))||!(6!==r||!/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t))||"localhost"!==e.host&&!e.host.endsWith(".localhost")&&"file:"===e.protocol}(e)}const N=Symbol("Request internals"),j=e=>"object"==typeof e&&"object"==typeof e[N],$=(0,h.deprecate)((()=>{}),".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)");class U extends b{constructor(e,t={}){let r;if(j(e)?r=new URL(e.url):(r=new URL(e),e={}),""!==r.username||""!==r.password)throw new TypeError(`${r} is an url with embedded credentials.`);let n=t.method||e.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(n)&&(n=n.toUpperCase()),!j(t)&&"data"in t&&$(),(null!=t.body||j(e)&&null!==e.body)&&("GET"===n||"HEAD"===n))throw new TypeError("Request with GET/HEAD method cannot have body");const s=t.body?t.body:j(e)&&null!==e.body?C(e):null;super(s,{size:t.size||e.size||0});const i=new A(t.headers||e.headers||{});if(null!==s&&!i.has("Content-Type")){const e=R(s,this);e&&i.set("Content-Type",e)}let o=j(e)?e.signal:null;if("signal"in t&&(o=t.signal),null!=o&&("object"!=typeof(a=o)||"AbortSignal"!==a[f]&&"EventTarget"!==a[f]))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");var a;let c=null==t.referrer?e.referrer:t.referrer;if(""===c)c="no-referrer";else if(c){const e=new URL(c);c=/^about:(\/\/)?client$/.test(e)?"client":e}else c=void 0;this[N]={method:n,redirect:t.redirect||e.redirect||"follow",headers:i,parsedURL:r,signal:o,referrer:c},this.follow=void 0===t.follow?void 0===e.follow?20:e.follow:t.follow,this.compress=void 0===t.compress?void 0===e.compress||e.compress:t.compress,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent,this.highWaterMark=t.highWaterMark||e.highWaterMark||16384,this.insecureHTTPParser=t.insecureHTTPParser||e.insecureHTTPParser||!1,this.referrerPolicy=t.referrerPolicy||e.referrerPolicy||""}get method(){return this[N].method}get url(){return(0,B.format)(this[N].parsedURL)}get headers(){return this[N].headers}get redirect(){return this[N].redirect}get signal(){return this[N].signal}get referrer(){return"no-referrer"===this[N].referrer?"":"client"===this[N].referrer?"about:client":this[N].referrer?this[N].referrer.toString():void 0}get referrerPolicy(){return this[N].referrerPolicy}set referrerPolicy(e){this[N].referrerPolicy=function(e){if(!L.has(e))throw new TypeError(`Invalid referrerPolicy: ${e}`);return e}(e)}clone(){return new U(this)}get[Symbol.toStringTag](){return"Request"}}Object.defineProperties(U.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});const K=e=>{const{parsedURL:t}=e[N],r=new A(e[N].headers);r.has("Accept")||r.set("Accept","*/*");let n=null;if(null===e.body&&/^(post|put)$/i.test(e.method)&&(n="0"),null!==e.body){const t=(e=>{const{body:t}=e[S];return null===t?0:m(t)?t.size:a.Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null})(e);"number"!=typeof t||Number.isNaN(t)||(n=String(t))}n&&r.set("Content-Length",n),""===e.referrerPolicy&&(e.referrerPolicy="strict-origin-when-cross-origin"),e.referrer&&"no-referrer"!==e.referrer?e[N].referrer=function(e,{referrerURLCallback:t,referrerOriginCallback:r}={}){if("no-referrer"===e.referrer||""===e.referrerPolicy)return null;const n=e.referrerPolicy;if("about:client"===e.referrer)return"no-referrer";const s=e.referrer;let i=F(s),o=F(s,!0);i.toString().length>4096&&(i=o),t&&(i=t(i)),r&&(o=r(o));const a=new URL(e.url);switch(n){case"no-referrer":return"no-referrer";case"origin":return o;case"unsafe-url":return i;case"strict-origin":return D(i)&&!D(a)?"no-referrer":o.toString();case"strict-origin-when-cross-origin":return i.origin===a.origin?i:D(i)&&!D(a)?"no-referrer":o;case"same-origin":return i.origin===a.origin?i:"no-referrer";case"origin-when-cross-origin":return i.origin===a.origin?i:o;case"no-referrer-when-downgrade":return D(i)&&!D(a)?"no-referrer":i;default:throw new TypeError(`Invalid referrerPolicy: ${n}`)}}(e):e[N].referrer="no-referrer",e[N].referrer instanceof URL&&r.set("Referer",e.referrer),r.has("User-Agent")||r.set("User-Agent","node-fetch"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip, deflate, br");let{agent:s}=e;"function"==typeof s&&(s=s(t)),r.has("Connection")||s||r.set("Connection","close");const i=(e=>{if(e.search)return e.search;const t=e.href.length-1,r=e.hash||("#"===e.href[t]?"#":"");return"?"===e.href[t-r.length]?"?":""})(t);return{parsedURL:t,options:{path:t.pathname+i,method:e.method,headers:r[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:e.insecureHTTPParser,agent:s}}};class W extends d{constructor(e,t="aborted"){super(e,t)}}var H=r(749);const z=new Set(["data:","http:","https:"]);async function V(e,t){return new Promise(((r,h)=>{const l=new U(e,t),{parsedURL:u,options:d}=K(l);if(!z.has(u.protocol))throw new TypeError(`node-fetch cannot load ${e}. URL scheme "${u.protocol.replace(/:$/,"")}" is not supported.`);if("data:"===u.protocol){const e=c(l.url),t=new O(e,{headers:{"Content-Type":e.typeFull}});return void r(t)}const f=("https:"===u.protocol?s:n).request,{signal:g}=l;let m=null;const w=()=>{const e=new W("The operation was aborted.");h(e),l.body&&l.body instanceof o.Readable&&l.body.destroy(e),m&&m.body&&m.body.emit("error",e)};if(g&&g.aborted)return void w();const S=()=>{w(),E()},b=f(u.toString(),d);g&&g.addEventListener("abort",S);const E=()=>{b.abort(),g&&g.removeEventListener("abort",S)};b.on("error",(e=>{h(new p(`request to ${l.url} failed, reason: ${e.message}`,"system",e)),E()})),function(e,t){const r=a.Buffer.from("0\r\n\r\n");let n,s=!1,i=!1;e.on("response",(e=>{const{headers:t}=e;s="chunked"===t["transfer-encoding"]&&!t["content-length"]})),e.on("socket",(t=>{const o=()=>{if(s&&!i){const e=new Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",(e=>{m&&m.body&&m.body.destroy(e)})(e)}},c=e=>{i=0===a.Buffer.compare(e.slice(-5),r),!i&&n&&(i=0===a.Buffer.compare(n.slice(-3),r.slice(0,3))&&0===a.Buffer.compare(e.slice(-2),r.slice(3))),n=e};t.prependListener("close",o),t.on("data",c),e.on("close",(()=>{t.removeListener("close",o),t.removeListener("data",c)}))}))}(b),process.version<"v14"&&b.on("socket",(e=>{let t;e.prependListener("end",(()=>{t=e._eventsCount})),e.prependListener("close",(r=>{if(m&&t<e._eventsCount&&!r){const e=new Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",m.body.emit("error",e)}}))})),b.on("response",(e=>{b.setTimeout(0);const n=function(e=[]){return new A(e.reduce(((e,t,r,n)=>(r%2==0&&e.push(n.slice(r,r+2)),e)),[]).filter((([e,t])=>{try{return P(e),x(e,String(t)),!0}catch{return!1}})))}(e.rawHeaders);if(M(e.statusCode)){const s=n.get("Location");let i=null;try{i=null===s?null:new URL(s,l.url)}catch{if("manual"!==l.redirect)return h(new p(`uri requested responds with an invalid redirect URL: ${s}`,"invalid-redirect")),void E()}switch(l.redirect){case"error":return h(new p(`uri requested responds with a redirect, redirect mode is set to error: ${l.url}`,"no-redirect")),void E();case"manual":break;case"follow":{if(null===i)break;if(l.counter>=l.follow)return h(new p(`maximum redirect reached at: ${l.url}`,"max-redirect")),void E();const s={headers:new A(l.headers),follow:l.follow,counter:l.counter+1,agent:l.agent,compress:l.compress,method:l.method,body:C(l),signal:l.signal,size:l.size,referrer:l.referrer,referrerPolicy:l.referrerPolicy};if(!y(l.url,i)||!v(l.url,i))for(const e of["authorization","www-authenticate","cookie","cookie2"])s.headers.delete(e);if(303!==e.statusCode&&l.body&&t.body instanceof o.Readable)return h(new p("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void E();303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==l.method)||(s.method="GET",s.body=void 0,s.headers.delete("content-length"));const a=function(e){const t=(e.get("referrer-policy")||"").split(/[,\s]+/);let r="";for(const e of t)e&&L.has(e)&&(r=e);return r}(n);return a&&(s.referrerPolicy=a),r(V(new U(i,s))),void E()}default:return h(new TypeError(`Redirect option '${l.redirect}' is not a valid value of RequestRedirect`))}}g&&e.once("end",(()=>{g.removeEventListener("abort",S)}));let s=(0,o.pipeline)(e,new o.PassThrough,(e=>{e&&h(e)}));process.version<"v12.10"&&e.on("aborted",S);const a={url:l.url,status:e.statusCode,statusText:e.statusMessage,headers:n,size:l.size,counter:l.counter,highWaterMark:l.highWaterMark},c=n.get("Content-Encoding");if(!l.compress||"HEAD"===l.method||null===c||204===e.statusCode||304===e.statusCode)return m=new O(s,a),void r(m);const u={flush:i.Z_SYNC_FLUSH,finishFlush:i.Z_SYNC_FLUSH};if("gzip"===c||"x-gzip"===c)return s=(0,o.pipeline)(s,i.createGunzip(u),(e=>{e&&h(e)})),m=new O(s,a),void r(m);if("deflate"===c||"x-deflate"===c){const t=(0,o.pipeline)(e,new o.PassThrough,(e=>{e&&h(e)}));return t.once("data",(e=>{s=8==(15&e[0])?(0,o.pipeline)(s,i.createInflate(),(e=>{e&&h(e)})):(0,o.pipeline)(s,i.createInflateRaw(),(e=>{e&&h(e)})),m=new O(s,a),r(m)})),void t.once("end",(()=>{m||(m=new O(s,a),r(m))}))}if("br"===c)return s=(0,o.pipeline)(s,i.createBrotliDecompress(),(e=>{e&&h(e)})),m=new O(s,a),void r(m);m=new O(s,a),r(m)})),_(b,l).catch(h)}))}},1725:e=>{"use strict";e.exports=JSON.parse('{"name":"@microsoft/dev-tunnels-management","version":"1.0.7358","description":"Tunnels library for Visual Studio tools","keywords":["Tunnels"],"author":"Microsoft","license":"MIT","dependencies":{"buffer":"^5.2.1","debug":"^4.1.1","vscode-jsonrpc":"^4.0.0","@microsoft/dev-tunnels-contracts":"^1.0.0","axios":"^0.21.1"},"main":"./index.js"}')},730:e=>{"use strict";e.exports=JSON.parse('{"name":"@microsoft/dev-tunnels-ssh","version":"3.10.30","description":"SSH library for Dev Tunnels","repository":"https://github.com/microsoft/dev-tunnels-ssh.git","keywords":["SSH"],"author":"Microsoft","license":"MIT","dependencies":{"buffer":"^5.2.1","debug":"^4.1.1","diffie-hellman":"^5.0.3","vscode-jsonrpc":"^4.0.0"},"main":"./index.js"}')},8593:e=>{"use strict";e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')},9794:e=>{"use strict";e.exports={version:"1.0.34"}}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var i=r[e]={exports:{}};return t[e].call(i.exports,i,i.exports,n),i.exports}n.m=t,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>e+".js",n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e={898:1},n.f.require=(t,r)=>{e[t]||(t=>{var r=t.modules,s=t.ids,i=t.runtime;for(var o in r)n.o(r,o)&&(n.m[o]=r[o]);i&&i(n);for(var a=0;a<s.length;a++)e[s[a]]=1})(require("./"+n.u(t)))};var s=n(6236),i=exports;for(var o in s)i[o]=s[o];s.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();